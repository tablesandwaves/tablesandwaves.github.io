(()=>{var _m=Object.create;var Hs=Object.defineProperty;var xm=Object.getOwnPropertyDescriptor;var ym=Object.getOwnPropertyNames;var vm=Object.getPrototypeOf,wm=Object.prototype.hasOwnProperty;var bm=(r,t,e)=>t in r?Hs(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var kt=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports);var Am=(r,t,e,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of ym(t))!wm.call(r,n)&&n!==e&&Hs(r,n,{get:()=>t[n],enumerable:!(o=xm(t,n))||o.enumerable});return r};var $s=(r,t,e)=>(e=r!=null?_m(vm(r)):{},Am(t||!r||!r.__esModule?Hs(e,"default",{value:r,enumerable:!0}):e,r));var we=(r,t,e)=>(bm(r,typeof t!="symbol"?t+"":t,e),e),Sm=(r,t,e)=>{if(!t.has(r))throw TypeError("Cannot "+e)};var ba=(r,t,e)=>{if(t.has(r))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(r):t.set(r,e)};var Aa=(r,t,e)=>(Sm(r,t,"access private method"),e);var Sa=kt((Wx,on)=>{function Tm(r){if(Array.isArray(r))return r}on.exports=Tm,on.exports.__esModule=!0,on.exports.default=on.exports});var Ta=kt((jx,nn)=>{function Nm(r,t){var e=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(e!=null){var o=[],n=!0,s=!1,i,a;try{for(e=e.call(r);!(n=(i=e.next()).done)&&(o.push(i.value),!(t&&o.length===t));n=!0);}catch(c){s=!0,a=c}finally{try{!n&&e.return!=null&&e.return()}finally{if(s)throw a}}return o}}nn.exports=Nm,nn.exports.__esModule=!0,nn.exports.default=nn.exports});var Na=kt((Gx,sn)=>{function Cm(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,o=new Array(t);e<t;e++)o[e]=r[e];return o}sn.exports=Cm,sn.exports.__esModule=!0,sn.exports.default=sn.exports});var ka=kt((zx,an)=>{var Ca=Na();function km(r,t){if(!!r){if(typeof r=="string")return Ca(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);if(e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set")return Array.from(r);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Ca(r,t)}}an.exports=km,an.exports.__esModule=!0,an.exports.default=an.exports});var Oa=kt((Ux,cn)=>{function Om(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}cn.exports=Om,cn.exports.__esModule=!0,cn.exports.default=cn.exports});var Da=kt((Hx,un)=>{var Dm=Sa(),Em=Ta(),Mm=ka(),Fm=Oa();function Im(r,t){return Dm(r)||Em(r,t)||Mm(r,t)||Fm()}un.exports=Im,un.exports.__esModule=!0,un.exports.default=un.exports});var Ea=kt(($x,ln)=>{function Rm(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}ln.exports=Rm,ln.exports.__esModule=!0,ln.exports.default=ln.exports});var Fa=kt((Zx,hn)=>{function Ma(r,t){for(var e=0;e<t.length;e++){var o=t[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(r,o.key,o)}}function qm(r,t,e){return t&&Ma(r.prototype,t),e&&Ma(r,e),Object.defineProperty(r,"prototype",{writable:!1}),r}hn.exports=qm,hn.exports.__esModule=!0,hn.exports.default=hn.exports});var Zs=kt((Fn,Ia)=>{(function(r,t){typeof Fn=="object"&&typeof Ia<"u"?t(Fn,Da(),Ea(),Fa()):typeof define=="function"&&define.amd?define(["exports","@babel/runtime/helpers/slicedToArray","@babel/runtime/helpers/classCallCheck","@babel/runtime/helpers/createClass"],t):(r=typeof globalThis<"u"?globalThis:r||self,t(r.automationEvents={},r._slicedToArray,r._classCallCheck,r._createClass))})(Fn,function(r,t,e,o){"use strict";function n(V){return V&&typeof V=="object"&&"default"in V?V:{default:V}}var s=n(t),i=n(e),a=n(o),c=function(T,R,N){return{endTime:R,insertTime:N,type:"exponentialRampToValue",value:T}},u=function(T,R,N){return{endTime:R,insertTime:N,type:"linearRampToValue",value:T}},l=function(T,R){return{startTime:R,type:"setValue",value:T}},h=function(T,R,N){return{duration:N,startTime:R,type:"setValueCurve",values:T}},p=function(T,R,N){var B=N.startTime,U=N.target,J=N.timeConstant;return U+(R-U)*Math.exp((B-T)/J)},m=function(T){return T.type==="exponentialRampToValue"},f=function(T){return T.type==="linearRampToValue"},d=function(T){return m(T)||f(T)},x=function(T){return T.type==="setValue"},y=function(T){return T.type==="setValueCurve"},w=function V(T,R,N,B){var U=T[R];return U===void 0?B:d(U)||x(U)?U.value:y(U)?U.values[U.values.length-1]:p(N,V(T,R-1,U.startTime,B),U)},O=function(T,R,N,B,U){return N===void 0?[B.insertTime,U]:d(N)?[N.endTime,N.value]:x(N)?[N.startTime,N.value]:y(N)?[N.startTime+N.duration,N.values[N.values.length-1]]:[N.startTime,w(T,R-1,N.startTime,U)]},D=function(T){return T.type==="cancelAndHold"},_=function(T){return T.type==="cancelScheduledValues"},v=function(T){return D(T)||_(T)?T.cancelTime:m(T)||f(T)?T.endTime:T.startTime},b=function(T,R,N,B){var U=B.endTime,J=B.value;return N===J?J:0<N&&0<J||N<0&&J<0?N*Math.pow(J/N,(T-R)/(U-R)):0},A=function(T,R,N,B){var U=B.endTime,J=B.value;return N+(T-R)/(U-R)*(J-N)},M=function(T,R){var N=Math.floor(R),B=Math.ceil(R);return N===B?T[N]:(1-(R-N))*T[N]+(1-(B-R))*T[B]},E=function(T,R){var N=R.duration,B=R.startTime,U=R.values,J=(T-B)/N*(U.length-1);return M(U,J)},S=function(T){return T.type==="setTarget"},k=function(V){function T(R){i.default(this,T),this._automationEvents=[],this._currenTime=0,this._defaultValue=R}return a.default(T,[{key:V,value:function(){return this._automationEvents[Symbol.iterator]()}},{key:"add",value:function(N){var B=v(N);if(D(N)||_(N)){var U=this._automationEvents.findIndex(function(Pe){return _(N)&&y(Pe)?Pe.startTime+Pe.duration>=B:v(Pe)>=B}),J=this._automationEvents[U];if(U!==-1&&(this._automationEvents=this._automationEvents.slice(0,U)),D(N)){var P=this._automationEvents[this._automationEvents.length-1];if(J!==void 0&&d(J)){if(S(P))throw new Error("The internal list is malformed.");var ut=y(P)?P.startTime+P.duration:v(P),At=y(P)?P.values[P.values.length-1]:P.value,H=m(J)?b(B,ut,At,J):A(B,ut,At,J),ye=m(J)?c(H,B,this._currenTime):u(H,B,this._currenTime);this._automationEvents.push(ye)}P!==void 0&&S(P)&&this._automationEvents.push(l(this.getValue(B),B)),P!==void 0&&y(P)&&P.startTime+P.duration>B&&(this._automationEvents[this._automationEvents.length-1]=h(new Float32Array([6,7]),P.startTime,B-P.startTime))}}else{var Zt=this._automationEvents.findIndex(function(Pe){return v(Pe)>B}),te=Zt===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[Zt-1];if(te!==void 0&&y(te)&&v(te)+te.duration>B)return!1;var ve=m(N)?c(N.value,N.endTime,this._currenTime):f(N)?u(N.value,B,this._currenTime):N;if(Zt===-1)this._automationEvents.push(ve);else{if(y(N)&&B+N.duration>v(this._automationEvents[Zt]))return!1;this._automationEvents.splice(Zt,0,ve)}}return!0}},{key:"flush",value:function(N){var B=this._automationEvents.findIndex(function(P){return v(P)>N});if(B>1){var U=this._automationEvents.slice(B-1),J=U[0];S(J)&&U.unshift(l(w(this._automationEvents,B-2,J.startTime,this._defaultValue),J.startTime)),this._automationEvents=U}}},{key:"getValue",value:function(N){if(this._automationEvents.length===0)return this._defaultValue;var B=this._automationEvents.findIndex(function(zs){return v(zs)>N}),U=this._automationEvents[B],J=(B===-1?this._automationEvents.length:B)-1,P=this._automationEvents[J];if(P!==void 0&&S(P)&&(U===void 0||!d(U)||U.insertTime>N))return p(N,w(this._automationEvents,J-1,P.startTime,this._defaultValue),P);if(P!==void 0&&x(P)&&(U===void 0||!d(U)))return P.value;if(P!==void 0&&y(P)&&(U===void 0||!d(U)||P.startTime+P.duration>N))return N<P.startTime+P.duration?E(N,P):P.values[P.values.length-1];if(P!==void 0&&d(P)&&(U===void 0||!d(U)))return P.value;if(U!==void 0&&m(U)){var ut=O(this._automationEvents,J,P,U,this._defaultValue),At=s.default(ut,2),H=At[0],ye=At[1];return b(N,H,ye,U)}if(U!==void 0&&f(U)){var Zt=O(this._automationEvents,J,P,U,this._defaultValue),te=s.default(Zt,2),ve=te[0],Pe=te[1];return A(N,ve,Pe,U)}return this._defaultValue}}]),T}(Symbol.iterator),I=function(T){return{cancelTime:T,type:"cancelAndHold"}},q=function(T){return{cancelTime:T,type:"cancelScheduledValues"}},Z=function(T,R){return{endTime:R,type:"exponentialRampToValue",value:T}},W=function(T,R){return{endTime:R,type:"linearRampToValue",value:T}},z=function(T,R,N){return{startTime:R,target:T,timeConstant:N,type:"setTarget"}};r.AutomationEventList=k,r.createCancelAndHoldAutomationEvent=I,r.createCancelScheduledValuesAutomationEvent=q,r.createExponentialRampToValueAutomationEvent=Z,r.createLinearRampToValueAutomationEvent=W,r.createSetTargetAutomationEvent=z,r.createSetValueAutomationEvent=l,r.createSetValueCurveAutomationEvent=h,Object.defineProperty(r,"__esModule",{value:!0})})});var Xh=kt((uV,es)=>{var Dh,Eh,Mh,Fh,Ih,Rh,qh,Ph,Vh,Jn,Si,Lh,Bh,Wh,Fo,jh,Gh,zh,Uh,Hh,$h,Zh,Qh,ts;(function(r){var t=typeof global=="object"?global:typeof self=="object"?self:typeof this=="object"?this:{};typeof define=="function"&&define.amd?define("tslib",["exports"],function(o){r(e(t,e(o)))}):typeof es=="object"&&typeof es.exports=="object"?r(e(t,e(es.exports))):r(e(t));function e(o,n){return o!==t&&(typeof Object.create=="function"?Object.defineProperty(o,"__esModule",{value:!0}):o.__esModule=!0),function(s,i){return o[s]=n?n(s,i):i}}})(function(r){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,n){o.__proto__=n}||function(o,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(o[s]=n[s])};Dh=function(o,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(o,n);function s(){this.constructor=o}o.prototype=n===null?Object.create(n):(s.prototype=n.prototype,new s)},Eh=Object.assign||function(o){for(var n,s=1,i=arguments.length;s<i;s++){n=arguments[s];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(o[a]=n[a])}return o},Mh=function(o,n){var s={};for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&n.indexOf(i)<0&&(s[i]=o[i]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(o);a<i.length;a++)n.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(o,i[a])&&(s[i[a]]=o[i[a]]);return s},Fh=function(o,n,s,i){var a=arguments.length,c=a<3?n:i===null?i=Object.getOwnPropertyDescriptor(n,s):i,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(o,n,s,i);else for(var l=o.length-1;l>=0;l--)(u=o[l])&&(c=(a<3?u(c):a>3?u(n,s,c):u(n,s))||c);return a>3&&c&&Object.defineProperty(n,s,c),c},Ih=function(o,n){return function(s,i){n(s,i,o)}},Rh=function(o,n){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(o,n)},qh=function(o,n,s,i){function a(c){return c instanceof s?c:new s(function(u){u(c)})}return new(s||(s=Promise))(function(c,u){function l(m){try{p(i.next(m))}catch(f){u(f)}}function h(m){try{p(i.throw(m))}catch(f){u(f)}}function p(m){m.done?c(m.value):a(m.value).then(l,h)}p((i=i.apply(o,n||[])).next())})},Ph=function(o,n){var s={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},i,a,c,u;return u={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function l(p){return function(m){return h([p,m])}}function h(p){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,a&&(c=p[0]&2?a.return:p[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,p[1])).done)return c;switch(a=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return s.label++,{value:p[1],done:!1};case 5:s.label++,a=p[1],p=[0];continue;case 7:p=s.ops.pop(),s.trys.pop();continue;default:if(c=s.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){s=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){s.label=p[1];break}if(p[0]===6&&s.label<c[1]){s.label=c[1],c=p;break}if(c&&s.label<c[2]){s.label=c[2],s.ops.push(p);break}c[2]&&s.ops.pop(),s.trys.pop();continue}p=n.call(o,s)}catch(m){p=[6,m],a=0}finally{i=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}},Vh=function(o,n){for(var s in o)s!=="default"&&!Object.prototype.hasOwnProperty.call(n,s)&&ts(n,o,s)},ts=Object.create?function(o,n,s,i){i===void 0&&(i=s),Object.defineProperty(o,i,{enumerable:!0,get:function(){return n[s]}})}:function(o,n,s,i){i===void 0&&(i=s),o[i]=n[s]},Jn=function(o){var n=typeof Symbol=="function"&&Symbol.iterator,s=n&&o[n],i=0;if(s)return s.call(o);if(o&&typeof o.length=="number")return{next:function(){return o&&i>=o.length&&(o=void 0),{value:o&&o[i++],done:!o}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")},Si=function(o,n){var s=typeof Symbol=="function"&&o[Symbol.iterator];if(!s)return o;var i=s.call(o),a,c=[],u;try{for(;(n===void 0||n-- >0)&&!(a=i.next()).done;)c.push(a.value)}catch(l){u={error:l}}finally{try{a&&!a.done&&(s=i.return)&&s.call(i)}finally{if(u)throw u.error}}return c},Lh=function(){for(var o=[],n=0;n<arguments.length;n++)o=o.concat(Si(arguments[n]));return o},Bh=function(){for(var o=0,n=0,s=arguments.length;n<s;n++)o+=arguments[n].length;for(var i=Array(o),a=0,n=0;n<s;n++)for(var c=arguments[n],u=0,l=c.length;u<l;u++,a++)i[a]=c[u];return i},Wh=function(o,n,s){if(s||arguments.length===2)for(var i=0,a=n.length,c;i<a;i++)(c||!(i in n))&&(c||(c=Array.prototype.slice.call(n,0,i)),c[i]=n[i]);return o.concat(c||Array.prototype.slice.call(n))},Fo=function(o){return this instanceof Fo?(this.v=o,this):new Fo(o)},jh=function(o,n,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=s.apply(o,n||[]),a,c=[];return a={},u("next"),u("throw"),u("return"),a[Symbol.asyncIterator]=function(){return this},a;function u(d){i[d]&&(a[d]=function(x){return new Promise(function(y,w){c.push([d,x,y,w])>1||l(d,x)})})}function l(d,x){try{h(i[d](x))}catch(y){f(c[0][3],y)}}function h(d){d.value instanceof Fo?Promise.resolve(d.value.v).then(p,m):f(c[0][2],d)}function p(d){l("next",d)}function m(d){l("throw",d)}function f(d,x){d(x),c.shift(),c.length&&l(c[0][0],c[0][1])}},Gh=function(o){var n,s;return n={},i("next"),i("throw",function(a){throw a}),i("return"),n[Symbol.iterator]=function(){return this},n;function i(a,c){n[a]=o[a]?function(u){return(s=!s)?{value:Fo(o[a](u)),done:a==="return"}:c?c(u):u}:c}},zh=function(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=o[Symbol.asyncIterator],s;return n?n.call(o):(o=typeof Jn=="function"?Jn(o):o[Symbol.iterator](),s={},i("next"),i("throw"),i("return"),s[Symbol.asyncIterator]=function(){return this},s);function i(c){s[c]=o[c]&&function(u){return new Promise(function(l,h){u=o[c](u),a(l,h,u.done,u.value)})}}function a(c,u,l,h){Promise.resolve(h).then(function(p){c({value:p,done:l})},u)}},Uh=function(o,n){return Object.defineProperty?Object.defineProperty(o,"raw",{value:n}):o.raw=n,o};var e=Object.create?function(o,n){Object.defineProperty(o,"default",{enumerable:!0,value:n})}:function(o,n){o.default=n};Hh=function(o){if(o&&o.__esModule)return o;var n={};if(o!=null)for(var s in o)s!=="default"&&Object.prototype.hasOwnProperty.call(o,s)&&ts(n,o,s);return e(n,o),n},$h=function(o){return o&&o.__esModule?o:{default:o}},Zh=function(o,n,s,i){if(s==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof n=="function"?o!==n||!i:!n.has(o))throw new TypeError("Cannot read private member from an object whose class did not declare it");return s==="m"?i:s==="a"?i.call(o):i?i.value:n.get(o)},Qh=function(o,n,s,i,a){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!a)throw new TypeError("Private accessor was defined without a setter");if(typeof n=="function"?o!==n||!a:!n.has(o))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?a.call(o,s):a?a.value=s:n.set(o,s),s},r("__extends",Dh),r("__assign",Eh),r("__rest",Mh),r("__decorate",Fh),r("__param",Ih),r("__metadata",Rh),r("__awaiter",qh),r("__generator",Ph),r("__exportStar",Vh),r("__createBinding",ts),r("__values",Jn),r("__read",Si),r("__spread",Lh),r("__spreadArrays",Bh),r("__spreadArray",Wh),r("__await",Fo),r("__asyncGenerator",jh),r("__asyncDelegator",Gh),r("__asyncValues",zh),r("__makeTemplateObject",Uh),r("__importStar",Hh),r("__importDefault",$h),r("__classPrivateFieldGet",Zh),r("__classPrivateFieldSet",Qh)})});var Dn=kt((Krt,Pf)=>{var ux=[{octave:-2,note:"C",note_full:"C-2",midi:0},{octave:-2,note:"C#",note_full:"C#-2",midi:1},{octave:-2,note:"D",note_full:"D-2",midi:2},{octave:-2,note:"D#",note_full:"D#-2",midi:3},{octave:-2,note:"E",note_full:"E-2",midi:4},{octave:-2,note:"F",note_full:"F-2",midi:5},{octave:-2,note:"F#",note_full:"F#-2",midi:6},{octave:-2,note:"G",note_full:"G-2",midi:7},{octave:-2,note:"G#",note_full:"G#-2",midi:8},{octave:-2,note:"A",note_full:"A-2",midi:9},{octave:-2,note:"A#",note_full:"A#-2",midi:10},{octave:-2,note:"B",note_full:"B-2",midi:11},{octave:-1,note:"C",note_full:"C-1",midi:12},{octave:-1,note:"C#",note_full:"C#-1",midi:13},{octave:-1,note:"D",note_full:"D-1",midi:14},{octave:-1,note:"D#",note_full:"D#-1",midi:15},{octave:-1,note:"E",note_full:"E-1",midi:16},{octave:-1,note:"F",note_full:"F-1",midi:17},{octave:-1,note:"F#",note_full:"F#-1",midi:18},{octave:-1,note:"G",note_full:"G-1",midi:19},{octave:-1,note:"G#",note_full:"G#-1",midi:20},{octave:-1,note:"A",note_full:"A-1",midi:21},{octave:-1,note:"A#",note_full:"A#-1",midi:22},{octave:-1,note:"B",note_full:"B-1",midi:23},{octave:0,note:"C",note_full:"C0",midi:24},{octave:0,note:"C#",note_full:"C#0",midi:25},{octave:0,note:"D",note_full:"D0",midi:26},{octave:0,note:"D#",note_full:"D#0",midi:27},{octave:0,note:"E",note_full:"E0",midi:28},{octave:0,note:"F",note_full:"F0",midi:29},{octave:0,note:"F#",note_full:"F#0",midi:30},{octave:0,note:"G",note_full:"G0",midi:31},{octave:0,note:"G#",note_full:"G#0",midi:32},{octave:0,note:"A",note_full:"A0",midi:33},{octave:0,note:"A#",note_full:"A#0",midi:34},{octave:0,note:"B",note_full:"B0",midi:35},{octave:1,note:"C",note_full:"C1",midi:36},{octave:1,note:"C#",note_full:"C#1",midi:37},{octave:1,note:"D",note_full:"D1",midi:38},{octave:1,note:"D#",note_full:"D#1",midi:39},{octave:1,note:"E",note_full:"E1",midi:40},{octave:1,note:"F",note_full:"F1",midi:41},{octave:1,note:"F#",note_full:"F#1",midi:42},{octave:1,note:"G",note_full:"G1",midi:43},{octave:1,note:"G#",note_full:"G#1",midi:44},{octave:1,note:"A",note_full:"A1",midi:45},{octave:1,note:"A#",note_full:"A#1",midi:46},{octave:1,note:"B",note_full:"B1",midi:47},{octave:2,note:"C",note_full:"C2",midi:48},{octave:2,note:"C#",note_full:"C#2",midi:49},{octave:2,note:"D",note_full:"D2",midi:50},{octave:2,note:"D#",note_full:"D#2",midi:51},{octave:2,note:"E",note_full:"E2",midi:52},{octave:2,note:"F",note_full:"F2",midi:53},{octave:2,note:"F#",note_full:"F#2",midi:54},{octave:2,note:"G",note_full:"G2",midi:55},{octave:2,note:"G#",note_full:"G#2",midi:56},{octave:2,note:"A",note_full:"A2",midi:57},{octave:2,note:"A#",note_full:"A#2",midi:58},{octave:2,note:"B",note_full:"B2",midi:59},{octave:3,note:"C",note_full:"C3",midi:60},{octave:3,note:"C#",note_full:"C#3",midi:61},{octave:3,note:"D",note_full:"D3",midi:62},{octave:3,note:"D#",note_full:"D#3",midi:63},{octave:3,note:"E",note_full:"E3",midi:64},{octave:3,note:"F",note_full:"F3",midi:65},{octave:3,note:"F#",note_full:"F#3",midi:66},{octave:3,note:"G",note_full:"G3",midi:67},{octave:3,note:"G#",note_full:"G#3",midi:68},{octave:3,note:"A",note_full:"A3",midi:69},{octave:3,note:"A#",note_full:"A#3",midi:70},{octave:3,note:"B",note_full:"B3",midi:71},{octave:4,note:"C",note_full:"C4",midi:72},{octave:4,note:"C#",note_full:"C#4",midi:73},{octave:4,note:"D",note_full:"D4",midi:74},{octave:4,note:"D#",note_full:"D#4",midi:75},{octave:4,note:"E",note_full:"E4",midi:76},{octave:4,note:"F",note_full:"F4",midi:77},{octave:4,note:"F#",note_full:"F#4",midi:78},{octave:4,note:"G",note_full:"G4",midi:79},{octave:4,note:"G#",note_full:"G#4",midi:80},{octave:4,note:"A",note_full:"A4",midi:81},{octave:4,note:"A#",note_full:"A#4",midi:82},{octave:4,note:"B",note_full:"B4",midi:83},{octave:5,note:"C",note_full:"C5",midi:84},{octave:5,note:"C#",note_full:"C#5",midi:85},{octave:5,note:"D",note_full:"D5",midi:86},{octave:5,note:"D#",note_full:"D#5",midi:87},{octave:5,note:"E",note_full:"E5",midi:88},{octave:5,note:"F",note_full:"F5",midi:89},{octave:5,note:"F#",note_full:"F#5",midi:90},{octave:5,note:"G",note_full:"G5",midi:91},{octave:5,note:"G#",note_full:"G#5",midi:92},{octave:5,note:"A",note_full:"A5",midi:93},{octave:5,note:"A#",note_full:"A#5",midi:94},{octave:5,note:"B",note_full:"B5",midi:95},{octave:6,note:"C",note_full:"C6",midi:96},{octave:6,note:"C#",note_full:"C#6",midi:97},{octave:6,note:"D",note_full:"D6",midi:98},{octave:6,note:"D#",note_full:"D#6",midi:99},{octave:6,note:"E",note_full:"E6",midi:100},{octave:6,note:"F",note_full:"F6",midi:101},{octave:6,note:"F#",note_full:"F#6",midi:102},{octave:6,note:"G",note_full:"G6",midi:103},{octave:6,note:"G#",note_full:"G#6",midi:104},{octave:6,note:"A",note_full:"A6",midi:105},{octave:6,note:"A#",note_full:"A#6",midi:106},{octave:6,note:"B",note_full:"B6",midi:107},{octave:7,note:"C",note_full:"C7",midi:108},{octave:7,note:"C#",note_full:"C#7",midi:109},{octave:7,note:"D",note_full:"D7",midi:110},{octave:7,note:"D#",note_full:"D#7",midi:111},{octave:7,note:"E",note_full:"E7",midi:112},{octave:7,note:"F",note_full:"F7",midi:113},{octave:7,note:"F#",note_full:"F#7",midi:114},{octave:7,note:"G",note_full:"G7",midi:115},{octave:7,note:"G#",note_full:"G#7",midi:116},{octave:7,note:"A",note_full:"A7",midi:117},{octave:7,note:"A#",note_full:"A#7",midi:118},{octave:7,note:"B",note_full:"B7",midi:119},{octave:8,note:"C",note_full:"C8",midi:120},{octave:8,note:"C#",note_full:"C#8",midi:121},{octave:8,note:"D",note_full:"D8",midi:122},{octave:8,note:"D#",note_full:"D#8",midi:123},{octave:8,note:"E",note_full:"E8",midi:124},{octave:8,note:"F",note_full:"F8",midi:125},{octave:8,note:"F#",note_full:"F#8",midi:126},{octave:8,note:"G",note_full:"G8",midi:127}];Pf.exports=ux});var Bf=kt((Jrt,Lf)=>{var Vf=Dn(),gt=class{constructor(t,e,o,n,s){this.d3=s,this.svg=this.d3.select(t),this._sequence=[],this._tonicIndex=Vf.findIndex(i=>i.note_full==e),this.extent=n,this.steps=o,this.activeNotes=[],this.keyHeight=gt.octaveHeight/gt.notesPerOctave}get sequence(){return this._sequence}set sequence(t){this._sequence=t}get tonicIndex(){return this._tonicIndex}set tonicIndex(t){this._tonicIndex=t}setNotes(t,e){this._sequence=t;let o=this.d3.scaleLinear().domain([0,this._sequence.length]).range([gt.pianoRollPadding,gt.width]),n=this.d3.scaleLinear().domain([this.extent[1]+this._tonicIndex+1,this.extent[0]+this._tonicIndex]).range([0,this.keyHeight*this.activeNotes.length]),s=(gt.width-gt.pianoRollPadding)/this._sequence.length,i=this.roll.selectAll(".sequence-note").data(()=>this._sequence.reduce((a,c,u,l)=>(c!=null&&a.push({step:u,note:c}),a),[])).enter().append("rect").attr("class","sequence-note").attr("width",s).attr("height",this.keyHeight).attr("x",a=>o(a.step)).attr("y",a=>n(a.note)-this.keyHeight).attr("fill","#09c").on("click",(a,c)=>e(c.note))}render(){let t=(gt.width-gt.pianoRollPadding)/this.steps;this.activeNotes=Vf.slice(this._tonicIndex+this.extent[0],this._tonicIndex+this.extent[1]+1).reverse();let e=this.activeNotes.map(n=>n.octave).filter(lx);this.d3.selectAll("svg .transport").remove(),this.d3.selectAll(".keys").remove(),this.svg.attr("height",this.keyHeight*this.activeNotes.length+gt.transportPadding),this.transport=this.svg.append("g").attr("class","transport").attr("width",gt.width).attr("height",gt.transportPadding),this.transport.selectAll(".step").data([...Array(this.steps).keys()]).enter().append("rect").attr("class",n=>`step step-${n}`).attr("width",t).attr("height",gt.transportPadding).attr("x",n=>n*t+gt.pianoRollPadding).attr("y",0).attr("fill","#999").attr("stroke","#bbb"),this.roll=this.svg.append("g").attr("transform",`translate(0, ${gt.transportPadding})`).attr("class","keys").attr("width",gt.width).attr("height",this.keyHeight*this.activeNotes.length).attr("stroke","#aaa"),this.roll.selectAll(".key").data(this.activeNotes).enter().append("rect").attr("class","key").attr("width",gt.width-gt.pianoRollPadding).attr("height",this.keyHeight).attr("x",gt.pianoRollPadding).attr("y",(n,s)=>s*this.keyHeight).attr("fill",n=>n.note.charAt(n.note.length-1)=="#"?"#ccc":"#fff"),this.roll.selectAll(".note-label").data(this.activeNotes).enter().append("text").text(n=>n.note).attr("fill","black").attr("font-size",12).attr("x",gt.pianoRollPadding/2).attr("y",(n,s)=>s*this.keyHeight+this.keyHeight-this.keyHeight/3);let o=this.activeNotes.reduce((n,s,i,a)=>(s.note=="C"&&n.push({octave:s.octave,index:i}),n),[]);this.roll.selectAll(".octave-label").data(o).enter().append("text").text(n=>n.octave).attr("fill","black").attr("font-size",12).attr("x",20).attr("y",n=>n.index*this.keyHeight+this.keyHeight-this.keyHeight/3),this.roll.selectAll(".key-division").data(o).enter().append("line").attr("class","key-division").attr("x1",0).attr("y1",n=>n.index*this.keyHeight+this.keyHeight).attr("x2",gt.width).attr("y2",n=>n.index*this.keyHeight+this.keyHeight).attr("stroke","#333"),this.roll.selectAll(".step-division").data(new Array(this.steps).fill(0)).enter().append("line").attr("class","step-division").attr("x1",(n,s)=>s*t+gt.pianoRollPadding).attr("y1",0).attr("x2",(n,s)=>s*t+gt.pianoRollPadding).attr("y2",gt.octaveHeight*e.length).attr("stroke",(n,s)=>s%4==0?"#333":"#aaa")}},Lr=gt;we(Lr,"width",1e3),we(Lr,"octaveHeight",180),we(Lr,"notesPerOctave",12),we(Lr,"pianoRollPadding",80),we(Lr,"transportPadding",15);var lx=(r,t,e)=>e.indexOf(r)===t;Lf.exports=Lr});var jf=kt((eot,Wf)=>{var Jo=class{constructor(t,e){this.d3=e,this.wrapper=this.d3.select(t)}render(t){[""].push(...Jo.drumHits);let o=this.wrapper.append("div").attr("id","drum-labels").selectAll(".drum-label").data(Jo.drumHits).enter().append("div").attr("class","drum-label").text(s=>s=="Transport"?"":s);this.wrapper.selectAll(".drum-step").data([...Array(Jo.steps).keys()]).enter().append("div").attr("class","drum-step").attr("id",s=>`drum-step-${s}`).selectAll(".hit").data(s=>Jo.drumHits.map(i=>({step:s,hit:i}))).enter().append("button").attr("class",s=>s.hit=="Transport"?"transport":"hit").attr("id",s=>`drum-transport-${s.step}`).property("disabled",s=>s.hit=="Transport").on("click",(s,i)=>t(s,i.step,i.hit))}},En=Jo;we(En,"steps",16),we(En,"drumHits",["Transport","Kick","Snare","Hat"]);Wf.exports=En});var Vs=kt((oot,Gf)=>{var la=class{constructor(t){this._sequence=t}get sequence(){return this._sequence}set sequence(t){this._sequence=t}shift(t){let e=new Array;for(let o=0;o<this._sequence.length;o++)this._sequence[o]==null?e.push(null):e.push(this._sequence[o]+t[o%t.length]);return e}rhythm(t,e){let o=new Array,n=this.calculateLength(t),s=0;for(let i=0;i<n;i++)t[i%t.length]==0||s>=this._sequence.length&&e=="silence"?o.push(null):(o.push(this._sequence[s%this._sequence.length]),s++);return o}calculateLength(t){let e=t.filter(o=>o!=0).length;if(e==0)return 0;{let o=Math.ceil(this._sequence.length/e);return t.length*o}}};Gf.exports=la});var Uf=kt((not,zf)=>{var ha=class{constructor(t){this.kick=new t.MembraneSynth;let e=new t.Gate(-50),o=new t.MidSideCompressor,n=new t.Gain;this.kick.chain(e,o,n),n.chain(t.Destination)}hit(t){this.kick.triggerAttackRelease("C1","16n",t)}};zf.exports=ha});var $f=kt((sot,Hf)=>{var pa=class{constructor(t){this.tom=new t.MembraneSynth,this.snare=new t.NoiseSynth({noise:{type:"brown"},envelope:{attack:.005,decay:.1,sustain:.02}});let e=new t.FeedbackDelay({delayTime:"32n",feedback:.25}),o=new t.Gate(-33),n=new t.MidSideCompressor,s=new t.Gain;this.snare.chain(o,n,s),this.tom.chain(o,n,s),s.chain(t.Destination)}hit(t){this.snare.triggerAttackRelease("16n",t),this.tom.triggerAttackRelease("C2","16n",t)}};Hf.exports=pa});var Qf=kt((iot,Zf)=>{var fa=class{constructor(t){this.noise=new t.NoiseSynth({noise:{type:"pink"},envelope:{attack:.002,decay:.05,sustain:.03}});let e=new t.FeedbackDelay({delayTime:"32n",feedback:.15}),o=new t.Gate(-25),n=new t.MidSideCompressor,s=new t.Gain(.3);this.noise.chain(o,n,s),s.chain(t.Destination)}hit(t){this.noise.triggerAttackRelease("32n",t)}};Zf.exports=fa});var Kf=kt((aot,Yf)=>{var Xf=Dn(),hx=Vs(),ma=class{constructor(t,e,o,n){this.size=t??16,this.seed=e??1,this.tonic=o??"C4",this.rhythm=n??[],this.sequence=[],this.midiSequence=[],this.noteSequence=[],this.#t(),this.#e(),this.#r()}#t(){this.sequence=[0,this.seed];let t,e,o=0;for(;this.sequence.length<this.size;)t=this.sequence.slice(o,o+2),e=t[1]-t[0],this.sequence=this.sequence.concat([this.sequence[this.sequence.length-2]+-1*e,this.sequence[this.sequence.length-1]+e]),o+=1}#e(){let t=Xf.findIndex(e=>e.note_full==this.tonic);this.midiSequence=this.sequence.map(e=>e+t),this.rhythm.length>0&&(this.midiSequence=new hx(this.midiSequence).rhythm(this.rhythm,"wrap"))}#r(){this.noteSequence=this.midiSequence.map(t=>t==null?"REST":Xf[t].note_full)}};Yf.exports=ma});var em=kt((cot,tm)=>{var px=Dn(),fx=Vs(),Bs,Jf,Mn=class{constructor(t,e){ba(this,Bs);this.noteList=t,this.rhythm=e??[],this.sequence=[],this.midiSequence=[],this.noteSequence=[]}generate(t){t=="xv"&&Aa(this,Bs,Jf).call(this)}},Ls=Mn;Bs=new WeakSet,Jf=function(){this.sequence=new Array(Mn.xvStepLength).fill(-1),this.sequence[0]=this.noteList[0],this.sequence[1]=this.noteList[1];let t,e,o,n,s=this.sequence.findIndex(a=>a==-1),i=2;do{t=this.sequence.slice(0,s);for(let a=0;a<t.length;a++){e=t[a];for(let c=1;c<=Math.log2(Mn.xvStepLength);c++)o=2**c,this.sequence[a*o%Mn.xvStepLength]=e}n=this.noteList[i%this.noteList.length],s=this.sequence.findIndex(a=>a==-1),s!=-1&&(this.sequence[s]=n),i++}while(s!=-1);this.midiSequence=this.rhythm.length==0?this.sequence:new fx(this.sequence).rhythm(this.rhythm,"wrap"),this.noteSequence=this.midiSequence.map(a=>a==null?"REST":px[a].note_full)},we(Ls,"xvStepLength",31);tm.exports=Ls});var om=kt((lot,rm)=>{var Ws={major:{name:"Major",mode:"Ionian",steps:[0,2,2,1,2,2,2,1]},minor:{name:"Minor",mode:"Aeolian",steps:[0,2,1,2,2,1,2,2]}},mx=(r,t)=>{let e=Math.ceil(t/Ws[r].steps.slice(1).length),o=Ws[r].steps.slice();for(let n=0;n<e-1;n++)o=o.concat(Ws[r].steps.slice(1));return o.slice(0,t).reduce((n,s)=>n+s,0)};rm.exports={scales:Ws,degree2HalfSteps:mx}});var rn="14.7.77";var ee=$s(Zs());var Ra=()=>new DOMException("","AbortError");var qa=r=>(t,e,[o,n,s],i)=>{r(t[n],[e,o,s],a=>a[0]===e&&a[1]===o,i)};var Pa=r=>(t,e,o)=>{let n=[];for(let s=0;s<o.numberOfInputs;s+=1)n.push(new Set);r.set(t,{activeInputs:n,outputs:new Set,passiveInputs:new WeakMap,renderer:e})};var Va=r=>(t,e)=>{r.set(t,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:e})};var Ve=new WeakSet,In=new WeakMap,fo=new WeakMap,Rn=new WeakMap,pn=new WeakMap,mo=new WeakMap,qn=new WeakMap,fn=new WeakMap,mn=new WeakMap,dn=new WeakMap;var La={construct(){return La}},Ba=r=>{try{let t=new Proxy(r,La);new t}catch{return!1}return!0};var Wa=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,Qs=(r,t)=>{let e=[],o=r.replace(/^[\s]+/,""),n=o.match(Wa);for(;n!==null;){let s=n[1].slice(1,-1),i=n[0].replace(/([\s]+)?;?$/,"").replace(s,new URL(s,t).toString());e.push(i),o=o.slice(n[0].length).replace(/^[\s]+/,""),n=o.match(Wa)}return[e.join(";"),o]};var ja=r=>{if(r!==void 0&&!Array.isArray(r))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},Ga=r=>{if(!Ba(r))throw new TypeError("The given value for processorCtor should be a constructor.");if(r.prototype===null||typeof r.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},za=(r,t,e,o,n,s,i,a,c,u,l,h,p)=>{let m=0;return(f,d,x={credentials:"omit"})=>{let y=l.get(f);if(y!==void 0&&y.has(d))return Promise.resolve();let w=u.get(f);if(w!==void 0){let _=w.get(d);if(_!==void 0)return _}let O=s(f),D=O.audioWorklet===void 0?n(d).then(([_,v])=>{let[b,A]=Qs(_,v),M=`${b};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${A}
})})(window,'_AWGS')`;return e(M)}).then(()=>{let _=p._AWGS.pop();if(_===void 0)throw new SyntaxError;o(O.currentTime,O.sampleRate,()=>_(class{},void 0,(v,b)=>{if(v.trim()==="")throw t();let A=mn.get(O);if(A!==void 0){if(A.has(v))throw t();Ga(b),ja(b.parameterDescriptors),A.set(v,b)}else Ga(b),ja(b.parameterDescriptors),mn.set(O,new Map([[v,b]]))},O.sampleRate,void 0,void 0))}):Promise.all([n(d),Promise.resolve(r(h,h))]).then(([[_,v],b])=>{let A=m+1;m=A;let[M,E]=Qs(_,v),q=`${M};((AudioWorkletProcessor,registerProcessor)=>{${E}
})(${b?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${b?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${b?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${A}',class extends AudioWorkletProcessor{process(){return !1}})`,Z=new Blob([q],{type:"application/javascript; charset=utf-8"}),W=URL.createObjectURL(Z);return O.audioWorklet.addModule(W,x).then(()=>{if(a(O))return O;let z=i(O);return z.audioWorklet.addModule(W,x).then(()=>z)}).then(z=>{if(c===null)throw new SyntaxError;try{new c(z,`__sac${A}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(W))});return w===void 0?u.set(f,new Map([[d,D]])):w.set(d,D),D.then(()=>{let _=l.get(f);_===void 0?l.set(f,new Set([d])):_.add(d)}).finally(()=>{let _=u.get(f);_!==void 0&&_.delete(d)}),D}};var Ot=(r,t)=>{let e=r.get(t);if(e===void 0)throw new Error("A value with the given key could not be found.");return e};var dr=(r,t)=>{let e=Array.from(r).filter(t);if(e.length>1)throw Error("More than one element was found.");if(e.length===0)throw Error("No element was found.");let[o]=e;return r.delete(o),o};var Pn=(r,t,e,o)=>{let n=Ot(r,t),s=dr(n,i=>i[0]===e&&i[1]===o);return n.size===0&&r.delete(t),s};var Le=r=>Ot(qn,r);var be=r=>{if(Ve.has(r))throw new Error("The AudioNode is already stored.");Ve.add(r),Le(r).forEach(t=>t(!0))};var Vn=r=>"port"in r;var Be=r=>{if(!Ve.has(r))throw new Error("The AudioNode is not stored.");Ve.delete(r),Le(r).forEach(t=>t(!1))};var gn=(r,t)=>{!Vn(r)&&t.every(e=>e.size===0)&&Be(r)};var Ua=(r,t,e,o,n,s,i,a,c,u,l,h,p)=>{let m=new WeakMap;return(f,d,x,y,w)=>{let{activeInputs:O,passiveInputs:D}=s(d),{outputs:_}=s(f),v=a(f),b=A=>{let M=c(d),E=c(f);if(A){let S=Pn(D,f,x,y);r(O,f,S,!1),!w&&!h(f)&&e(E,M,x,y),p(d)&&be(d)}else{let S=o(O,f,x,y);t(D,y,S,!1),!w&&!h(f)&&n(E,M,x,y);let k=i(d);if(k===0)l(d)&&gn(d,O);else{let I=m.get(d);I!==void 0&&clearTimeout(I),m.set(d,setTimeout(()=>{l(d)&&gn(d,O)},k*1e3))}}};return u(_,[d,x,y],A=>A[0]===d&&A[1]===x&&A[2]===y,!0)?(v.add(b),l(f)?r(O,f,[x,y,b],!0):t(D,y,[f,x,b],!0),!0):!1}};var Ha=r=>(t,e,[o,n,s],i)=>{let a=t.get(o);a===void 0?t.set(o,new Set([[n,e,s]])):r(a,[n,e,s],c=>c[0]===n&&c[1]===e,i)};var $a=r=>(t,e)=>{let o=r(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});e.connect(o).connect(t.destination);let n=()=>{e.removeEventListener("ended",n),e.disconnect(o),o.disconnect()};e.addEventListener("ended",n)};var Za=r=>(t,e)=>{r(t).add(e)};var Pm={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},Qa=(r,t,e,o,n,s)=>class extends r{constructor(a,c){let u=n(a),l={...Pm,...c},h=o(u,l),p=s(u)?t():null;super(a,!1,h,p),this._nativeAnalyserNode=h}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(a){this._nativeAnalyserNode.fftSize=a}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(a){let c=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=a,!(a>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=c,e()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(a){let c=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=a,!(this._nativeAnalyserNode.maxDecibels>a))throw this._nativeAnalyserNode.minDecibels=c,e()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(a){this._nativeAnalyserNode.smoothingTimeConstant=a}getByteFrequencyData(a){this._nativeAnalyserNode.getByteFrequencyData(a)}getByteTimeDomainData(a){this._nativeAnalyserNode.getByteTimeDomainData(a)}getFloatFrequencyData(a){this._nativeAnalyserNode.getFloatFrequencyData(a)}getFloatTimeDomainData(a){this._nativeAnalyserNode.getFloatTimeDomainData(a)}};var nt=(r,t)=>r.context===t;var Xa=(r,t,e)=>()=>{let o=new WeakMap,n=async(s,i)=>{let a=t(s);if(!nt(a,i)){let u={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,fftSize:a.fftSize,maxDecibels:a.maxDecibels,minDecibels:a.minDecibels,smoothingTimeConstant:a.smoothingTimeConstant};a=r(i,u)}return o.set(i,a),await e(s,i,a),a};return{render(s,i){let a=o.get(i);return a!==void 0?Promise.resolve(a):n(s,i)}}};var go=r=>{try{r.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0};var he=()=>new DOMException("","IndexSizeError");var _o=r=>{r.getChannelData=(t=>e=>{try{return t.call(r,e)}catch(o){throw o.code===12?he():o}})(r.getChannelData)};var Vm={numberOfChannels:1},Ya=(r,t,e,o,n,s,i,a)=>{let c=null;return class Ka{constructor(l){if(n===null)throw new Error("Missing the native OfflineAudioContext constructor.");let{length:h,numberOfChannels:p,sampleRate:m}={...Vm,...l};c===null&&(c=new n(1,1,44100));let f=o!==null&&t(s,s)?new o({length:h,numberOfChannels:p,sampleRate:m}):c.createBuffer(p,h,m);if(f.numberOfChannels===0)throw e();return typeof f.copyFromChannel!="function"?(i(f),_o(f)):t(go,()=>go(f))||a(f),r.add(f),f}static[Symbol.hasInstance](l){return l!==null&&typeof l=="object"&&Object.getPrototypeOf(l)===Ka.prototype||r.has(l)}}};var St=-34028234663852886e22,wt=-St;var Qt=r=>Ve.has(r);var Lm={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},Ja=(r,t,e,o,n,s,i,a)=>class extends r{constructor(u,l){let h=s(u),p={...Lm,...l},m=n(h,p),f=i(h),d=f?t():null;super(u,!1,m,d),this._audioBufferSourceNodeRenderer=d,this._isBufferNullified=!1,this._isBufferSet=p.buffer!==null,this._nativeAudioBufferSourceNode=m,this._onended=null,this._playbackRate=e(this,f,m.playbackRate,wt,St)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(u){if(this._nativeAudioBufferSourceNode.buffer=u,u!==null){if(this._isBufferSet)throw o();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(u){this._nativeAudioBufferSourceNode.loop=u}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(u){this._nativeAudioBufferSourceNode.loopEnd=u}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(u){this._nativeAudioBufferSourceNode.loopStart=u}get onended(){return this._onended}set onended(u){let l=typeof u=="function"?a(this,u):null;this._nativeAudioBufferSourceNode.onended=l;let h=this._nativeAudioBufferSourceNode.onended;this._onended=h!==null&&h===l?u:h}get playbackRate(){return this._playbackRate}start(u=0,l=0,h){if(this._nativeAudioBufferSourceNode.start(u,l,h),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=h===void 0?[u,l]:[u,l,h]),this.context.state!=="closed"){be(this);let p=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",p),Qt(this)&&Be(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",p)}}stop(u=0){this._nativeAudioBufferSourceNode.stop(u),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=u)}};var tc=(r,t,e,o,n)=>()=>{let s=new WeakMap,i=null,a=null,c=async(u,l)=>{let h=e(u),p=nt(h,l);if(!p){let m={buffer:h.buffer,channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,loop:h.loop,loopEnd:h.loopEnd,loopStart:h.loopStart,playbackRate:h.playbackRate.value};h=t(l,m),i!==null&&h.start(...i),a!==null&&h.stop(a)}return s.set(l,h),p?await r(l,u.playbackRate,h.playbackRate):await o(l,u.playbackRate,h.playbackRate),await n(u,l,h),h};return{set start(u){i=u},set stop(u){a=u},render(u,l){let h=s.get(l);return h!==void 0?Promise.resolve(h):c(u,l)}}};var ec=r=>"playbackRate"in r;var rc=r=>"frequency"in r&&"gain"in r;var oc=r=>"offset"in r;var nc=r=>!("frequency"in r)&&"gain"in r;var sc=r=>"detune"in r&&"frequency"in r;var ic=r=>"pan"in r;var Ft=r=>Ot(In,r);var gr=r=>Ot(Rn,r);var Ln=(r,t)=>{let{activeInputs:e}=Ft(r);e.forEach(n=>n.forEach(([s])=>{t.includes(r)||Ln(s,[...t,r])}));let o=ec(r)?[r.playbackRate]:Vn(r)?Array.from(r.parameters.values()):rc(r)?[r.Q,r.detune,r.frequency,r.gain]:oc(r)?[r.offset]:nc(r)?[r.gain]:sc(r)?[r.detune,r.frequency]:ic(r)?[r.pan]:[];for(let n of o){let s=gr(n);s!==void 0&&s.activeInputs.forEach(([i])=>Ln(i,t))}Qt(r)&&Be(r)};var _r=r=>{Ln(r.destination,[])};var Bn=r=>r===void 0||typeof r=="number"||typeof r=="string"&&(r==="balanced"||r==="interactive"||r==="playback");var ac=(r,t,e,o,n,s,i,a,c)=>class extends r{constructor(l={}){if(c===null)throw new Error("Missing the native AudioContext constructor.");let h;try{h=new c(l)}catch(f){throw f.code===12&&f.message==="sampleRate is not in range"?e():f}if(h===null)throw o();if(!Bn(l.latencyHint))throw new TypeError(`The provided value '${l.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(l.sampleRate!==void 0&&h.sampleRate!==l.sampleRate)throw e();super(h,2);let{latencyHint:p}=l,{sampleRate:m}=h;if(this._baseLatency=typeof h.baseLatency=="number"?h.baseLatency:p==="balanced"?512/m:p==="interactive"||p===void 0?256/m:p==="playback"?1024/m:Math.max(2,Math.min(128,Math.round(p*m/128)))*128/m,this._nativeAudioContext=h,c.name==="webkitAudioContext"?(this._nativeGainNode=h.createGain(),this._nativeOscillatorNode=h.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(h.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,h.state==="running"){this._state="suspended";let f=()=>{this._state==="suspended"&&(this._state=null),h.removeEventListener("statechange",f)};h.addEventListener("statechange",f)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw t()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),_r(this)}))}createMediaElementSource(l){return new n(this,{mediaElement:l})}createMediaStreamDestination(){return new s(this)}createMediaStreamSource(l){return new i(this,{mediaStream:l})}createMediaStreamTrackSource(l){return new a(this,{mediaStreamTrack:l})}resume(){return this._state==="suspended"?new Promise((l,h)=>{let p=()=>{this._nativeAudioContext.removeEventListener("statechange",p),this._nativeAudioContext.state==="running"?l():this.resume().then(l,h)};this._nativeAudioContext.addEventListener("statechange",p)}):this._nativeAudioContext.resume().catch(l=>{throw l===void 0||l.code===15?t():l})}suspend(){return this._nativeAudioContext.suspend().catch(l=>{throw l===void 0?t():l})}};var cc=(r,t,e,o,n,s,i,a)=>class extends r{constructor(u,l){let h=s(u),p=i(h),m=n(h,l,p),f=p?t(a):null;super(u,!1,m,f),this._isNodeOfNativeOfflineAudioContext=p,this._nativeAudioDestinationNode=m}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(u){if(this._isNodeOfNativeOfflineAudioContext)throw o();if(u>this._nativeAudioDestinationNode.maxChannelCount)throw e();this._nativeAudioDestinationNode.channelCount=u}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(u){if(this._isNodeOfNativeOfflineAudioContext)throw o();this._nativeAudioDestinationNode.channelCountMode=u}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}};var uc=r=>{let t=new WeakMap,e=async(o,n)=>{let s=n.destination;return t.set(n,s),await r(o,n,s),s};return{render(o,n){let s=t.get(n);return s!==void 0?Promise.resolve(s):e(o,n)}}};var lc=(r,t,e,o,n,s,i,a)=>(c,u)=>{let l=u.listener,h=()=>{let _=new Float32Array(1),v=t(u,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),b=i(u),A=!1,M=[0,0,-1,0,1,0],E=[0,0,0],S=()=>{if(A)return;A=!0;let Z=o(u,256,9,0);Z.onaudioprocess=({inputBuffer:W})=>{let z=[s(W,_,0),s(W,_,1),s(W,_,2),s(W,_,3),s(W,_,4),s(W,_,5)];z.some((T,R)=>T!==M[R])&&(l.setOrientation(...z),M=z);let V=[s(W,_,6),s(W,_,7),s(W,_,8)];V.some((T,R)=>T!==E[R])&&(l.setPosition(...V),E=V)},v.connect(Z)},k=Z=>W=>{W!==M[Z]&&(M[Z]=W,l.setOrientation(...M))},I=Z=>W=>{W!==E[Z]&&(E[Z]=W,l.setPosition(...E))},q=(Z,W,z)=>{let V=e(u,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:W});V.connect(v,0,Z),V.start(),Object.defineProperty(V.offset,"defaultValue",{get(){return W}});let T=r({context:c},b,V.offset,wt,St);return a(T,"value",R=>()=>R.call(T),R=>N=>{try{R.call(T,N)}catch(B){if(B.code!==9)throw B}S(),b&&z(N)}),T.cancelAndHoldAtTime=(R=>b?()=>{throw n()}:(...N)=>{let B=R.apply(T,N);return S(),B})(T.cancelAndHoldAtTime),T.cancelScheduledValues=(R=>b?()=>{throw n()}:(...N)=>{let B=R.apply(T,N);return S(),B})(T.cancelScheduledValues),T.exponentialRampToValueAtTime=(R=>b?()=>{throw n()}:(...N)=>{let B=R.apply(T,N);return S(),B})(T.exponentialRampToValueAtTime),T.linearRampToValueAtTime=(R=>b?()=>{throw n()}:(...N)=>{let B=R.apply(T,N);return S(),B})(T.linearRampToValueAtTime),T.setTargetAtTime=(R=>b?()=>{throw n()}:(...N)=>{let B=R.apply(T,N);return S(),B})(T.setTargetAtTime),T.setValueAtTime=(R=>b?()=>{throw n()}:(...N)=>{let B=R.apply(T,N);return S(),B})(T.setValueAtTime),T.setValueCurveAtTime=(R=>b?()=>{throw n()}:(...N)=>{let B=R.apply(T,N);return S(),B})(T.setValueCurveAtTime),T};return{forwardX:q(0,0,k(0)),forwardY:q(1,0,k(1)),forwardZ:q(2,-1,k(2)),positionX:q(6,0,I(0)),positionY:q(7,0,I(1)),positionZ:q(8,0,I(2)),upX:q(3,0,k(3)),upY:q(4,1,k(4)),upZ:q(5,0,k(5))}},{forwardX:p,forwardY:m,forwardZ:f,positionX:d,positionY:x,positionZ:y,upX:w,upY:O,upZ:D}=l.forwardX===void 0?h():l;return{get forwardX(){return p},get forwardY(){return m},get forwardZ(){return f},get positionX(){return d},get positionY(){return x},get positionZ(){return y},get upX(){return w},get upY(){return O},get upZ(){return D}}};var Wr=r=>"context"in r;var xr=r=>Wr(r[0]);var Ae=(r,t,e,o)=>{for(let n of r)if(e(n)){if(o)return!1;throw Error("The set contains at least one similar element.")}return r.add(t),!0};var Xs=(r,t,[e,o],n)=>{Ae(r,[t,e,o],s=>s[0]===t&&s[1]===e,n)};var Ys=(r,[t,e,o],n)=>{let s=r.get(t);s===void 0?r.set(t,new Set([[e,o]])):Ae(s,[e,o],i=>i[0]===e,n)};var pe=r=>"inputs"in r;var xo=(r,t,e,o)=>{if(pe(t)){let n=t.inputs[o];return r.connect(n,e,0),[n,e,0]}return r.connect(t,e,o),[t,e,o]};var Ks=(r,t,e)=>{for(let o of r)if(o[0]===t&&o[1]===e)return r.delete(o),o;return null};var hc=(r,t,e)=>dr(r,o=>o[0]===t&&o[1]===e);var Js=(r,t)=>{if(!Le(r).delete(t))throw new Error("Missing the expected event listener.")};var ti=(r,t,e)=>{let o=Ot(r,t),n=dr(o,s=>s[0]===e);return o.size===0&&r.delete(t),n};var yo=(r,t,e,o)=>{pe(t)?r.disconnect(t.inputs[o],e,0):r.disconnect(t,e,o)};var ht=r=>Ot(fo,r);var jr=r=>Ot(pn,r);var rr=r=>fn.has(r);var vo=r=>!Ve.has(r);var ei=(r,t)=>new Promise(e=>{if(t!==null)e(!0);else{let o=r.createScriptProcessor(256,1,1),n=r.createGain(),s=r.createBuffer(1,2,44100),i=s.getChannelData(0);i[0]=1,i[1]=1;let a=r.createBufferSource();a.buffer=s,a.loop=!0,a.connect(o).connect(r.destination),a.connect(n),a.disconnect(n),o.onaudioprocess=c=>{let u=c.inputBuffer.getChannelData(0);Array.prototype.some.call(u,l=>l===1)?e(!0):e(!1),a.stop(),o.onaudioprocess=null,a.disconnect(o),o.disconnect(r.destination)},a.start()}});var Wn=(r,t)=>{let e=new Map;for(let o of r)for(let n of o){let s=e.get(n);e.set(n,s===void 0?1:s+1)}e.forEach((o,n)=>t(n,o))};var Gr=r=>"context"in r;var pc=r=>{let t=new Map;r.connect=(e=>(o,n=0,s=0)=>{let i=Gr(o)?e(o,n,s):e(o,n),a=t.get(o);return a===void 0?t.set(o,[{input:s,output:n}]):a.every(c=>c.input!==s||c.output!==n)&&a.push({input:s,output:n}),i})(r.connect.bind(r)),r.disconnect=(e=>(o,n,s)=>{if(e.apply(r),o===void 0)t.clear();else if(typeof o=="number")for(let[i,a]of t){let c=a.filter(u=>u.output!==o);c.length===0?t.delete(i):t.set(i,c)}else if(t.has(o))if(n===void 0)t.delete(o);else{let i=t.get(o);if(i!==void 0){let a=i.filter(c=>c.output!==n&&(c.input!==s||s===void 0));a.length===0?t.delete(o):t.set(o,a)}}for(let[i,a]of t)a.forEach(c=>{Gr(i)?r.connect(i,c.output,c.input):r.connect(i,c.output)})})(r.disconnect)};var Bm=(r,t,e,o)=>{let{activeInputs:n,passiveInputs:s}=gr(t),{outputs:i}=Ft(r),a=Le(r),c=u=>{let l=ht(r),h=jr(t);if(u){let p=ti(s,r,e);Xs(n,r,p,!1),!o&&!rr(r)&&l.connect(h,e)}else{let p=hc(n,r,e);Ys(s,p,!1),!o&&!rr(r)&&l.disconnect(h,e)}};return Ae(i,[t,e],u=>u[0]===t&&u[1]===e,!0)?(a.add(c),Qt(r)?Xs(n,r,[e,c],!0):Ys(s,[r,e,c],!0),!0):!1},Wm=(r,t,e,o)=>{let{activeInputs:n,passiveInputs:s}=Ft(t),i=Ks(n[o],r,e);return i===null?[Pn(s,r,e,o)[2],!1]:[i[2],!0]},jm=(r,t,e)=>{let{activeInputs:o,passiveInputs:n}=gr(t),s=Ks(o,r,e);return s===null?[ti(n,r,e)[1],!1]:[s[2],!0]},ri=(r,t,e,o,n)=>{let[s,i]=Wm(r,e,o,n);if(s!==null&&(Js(r,s),i&&!t&&!rr(r)&&yo(ht(r),ht(e),o,n)),Qt(e)){let{activeInputs:a}=Ft(e);gn(e,a)}},oi=(r,t,e,o)=>{let[n,s]=jm(r,e,o);n!==null&&(Js(r,n),s&&!t&&!rr(r)&&ht(r).disconnect(jr(e),o))},Gm=(r,t)=>{let e=Ft(r),o=[];for(let n of e.outputs)xr(n)?ri(r,t,...n):oi(r,t,...n),o.push(n[0]);return e.outputs.clear(),o},zm=(r,t,e)=>{let o=Ft(r),n=[];for(let s of o.outputs)s[1]===e&&(xr(s)?ri(r,t,...s):oi(r,t,...s),n.push(s[0]),o.outputs.delete(s));return n},Um=(r,t,e,o,n)=>{let s=Ft(r);return Array.from(s.outputs).filter(i=>i[0]===e&&(o===void 0||i[1]===o)&&(n===void 0||i[2]===n)).map(i=>(xr(i)?ri(r,t,...i):oi(r,t,...i),s.outputs.delete(i),i[0]))},fc=(r,t,e,o,n,s,i,a,c,u,l,h,p,m,f,d)=>class extends u{constructor(y,w,O,D){super(O),this._context=y,this._nativeAudioNode=O;let _=l(y);h(_)&&e(ei,()=>ei(_,d))!==!0&&pc(O),fo.set(this,O),qn.set(this,new Set),y.state!=="closed"&&w&&be(this),r(this,D,O)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(y){this._nativeAudioNode.channelCount=y}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(y){this._nativeAudioNode.channelCountMode=y}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(y){this._nativeAudioNode.channelInterpretation=y}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(y,w=0,O=0){if(w<0||w>=this._nativeAudioNode.numberOfOutputs)throw n();let D=l(this._context),_=f(D);if(p(y)||m(y))throw s();if(Wr(y)){let A=ht(y);try{let E=xo(this._nativeAudioNode,A,w,O),S=vo(this);(_||S)&&this._nativeAudioNode.disconnect(...E),this.context.state!=="closed"&&!S&&vo(y)&&be(y)}catch(E){throw E.code===12?s():E}if(t(this,y,w,O,_)){let E=c([this],y);Wn(E,o(_))}return y}let v=jr(y);if(v.name==="playbackRate"&&v.maxValue===1024)throw i();try{this._nativeAudioNode.connect(v,w),(_||vo(this))&&this._nativeAudioNode.disconnect(v,w)}catch(A){throw A.code===12?s():A}if(Bm(this,y,w,_)){let A=c([this],y);Wn(A,o(_))}}disconnect(y,w,O){let D,_=l(this._context),v=f(_);if(y===void 0)D=Gm(this,v);else if(typeof y=="number"){if(y<0||y>=this.numberOfOutputs)throw n();D=zm(this,v,y)}else{if(w!==void 0&&(w<0||w>=this.numberOfOutputs)||Wr(y)&&O!==void 0&&(O<0||O>=y.numberOfInputs))throw n();if(D=Um(this,v,y,w,O),D.length===0)throw s()}for(let b of D){let A=c([this],b);Wn(A,a)}}};var mc=$s(Zs()),dc=(r,t,e,o,n,s,i,a,c,u,l,h,p)=>(m,f,d,x=null,y=null)=>{let w=new mc.AutomationEventList(d.defaultValue),O=f?o(w):null,D={get defaultValue(){return d.defaultValue},get maxValue(){return x===null?d.maxValue:x},get minValue(){return y===null?d.minValue:y},get value(){return d.value},set value(_){d.value=_,D.setValueAtTime(_,m.context.currentTime)},cancelAndHoldAtTime(_){if(typeof d.cancelAndHoldAtTime=="function")O===null&&w.flush(m.context.currentTime),w.add(n(_)),d.cancelAndHoldAtTime(_);else{let v=Array.from(w).pop();O===null&&w.flush(m.context.currentTime),w.add(n(_));let b=Array.from(w).pop();d.cancelScheduledValues(_),v!==b&&b!==void 0&&(b.type==="exponentialRampToValue"?d.exponentialRampToValueAtTime(b.value,b.endTime):b.type==="linearRampToValue"?d.linearRampToValueAtTime(b.value,b.endTime):b.type==="setValue"?d.setValueAtTime(b.value,b.startTime):b.type==="setValueCurve"&&d.setValueCurveAtTime(b.values,b.startTime,b.duration))}return D},cancelScheduledValues(_){return O===null&&w.flush(m.context.currentTime),w.add(s(_)),d.cancelScheduledValues(_),D},exponentialRampToValueAtTime(_,v){if(_===0)throw new RangeError;if(!Number.isFinite(v)||v<0)throw new RangeError;return O===null&&w.flush(m.context.currentTime),w.add(i(_,v)),d.exponentialRampToValueAtTime(_,v),D},linearRampToValueAtTime(_,v){return O===null&&w.flush(m.context.currentTime),w.add(a(_,v)),d.linearRampToValueAtTime(_,v),D},setTargetAtTime(_,v,b){return O===null&&w.flush(m.context.currentTime),w.add(c(_,v,b)),d.setTargetAtTime(_,v,b),D},setValueAtTime(_,v){return O===null&&w.flush(m.context.currentTime),w.add(u(_,v)),d.setValueAtTime(_,v),D},setValueCurveAtTime(_,v,b){let A=_ instanceof Float32Array?_:new Float32Array(_);if(h!==null&&h.name==="webkitAudioContext"){let M=v+b,E=m.context.sampleRate,S=Math.ceil(v*E),k=Math.floor(M*E),I=k-S,q=new Float32Array(I);for(let W=0;W<I;W+=1){let z=(A.length-1)/b*((S+W)/E-v),V=Math.floor(z),T=Math.ceil(z);q[W]=V===T?A[V]:(1-(z-V))*A[V]+(1-(T-z))*A[T]}O===null&&w.flush(m.context.currentTime),w.add(l(q,v,b)),d.setValueCurveAtTime(q,v,b);let Z=k/E;Z<M&&p(D,q[q.length-1],Z),p(D,A[A.length-1],M)}else O===null&&w.flush(m.context.currentTime),w.add(l(A,v,b)),d.setValueCurveAtTime(A,v,b);return D}};return e.set(D,d),t.set(D,m),r(D,O),D};var gc=r=>({replay(t){for(let e of r)if(e.type==="exponentialRampToValue"){let{endTime:o,value:n}=e;t.exponentialRampToValueAtTime(n,o)}else if(e.type==="linearRampToValue"){let{endTime:o,value:n}=e;t.linearRampToValueAtTime(n,o)}else if(e.type==="setTarget"){let{startTime:o,target:n,timeConstant:s}=e;t.setTargetAtTime(n,o,s)}else if(e.type==="setValue"){let{startTime:o,value:n}=e;t.setValueAtTime(n,o)}else if(e.type==="setValueCurve"){let{duration:o,startTime:n,values:s}=e;t.setValueCurveAtTime(s,n,o)}else throw new Error("Can't apply an unknown automation.")}});var wo=class{constructor(t){this._map=new Map(t)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(t,e=null){return this._map.forEach((o,n)=>t.call(e,o,n,this))}get(t){return this._map.get(t)}has(t){return this._map.has(t)}keys(){return this._map.keys()}values(){return this._map.values()}};var Hm={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},_c=(r,t,e,o,n,s,i,a,c,u,l,h,p,m)=>class extends t{constructor(d,x,y){var w;let O=a(d),D=c(O),_=l({...Hm,...y});p(_);let v=mn.get(O),b=v?.get(x),A=D||O.state!=="closed"?O:(w=i(O))!==null&&w!==void 0?w:O,M=n(A,D?null:d.baseLatency,u,x,b,_),E=D?o(x,_,b):null;super(d,!0,M,E);let S=[];M.parameters.forEach((I,q)=>{let Z=e(this,D,I);S.push([q,Z])}),this._nativeAudioWorkletNode=M,this._onprocessorerror=null,this._parameters=new wo(S),D&&r(O,this);let{activeInputs:k}=s(this);h(M,k)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(d){let x=typeof d=="function"?m(this,d):null;this._nativeAudioWorkletNode.onprocessorerror=x;let y=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=y!==null&&y===x?d:y}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function bo(r,t,e,o,n){if(typeof r.copyFromChannel=="function")t[e].byteLength===0&&(t[e]=new Float32Array(128)),r.copyFromChannel(t[e],o,n);else{let s=r.getChannelData(o);if(t[e].byteLength===0)t[e]=s.slice(n,n+128);else{let i=new Float32Array(s.buffer,n*Float32Array.BYTES_PER_ELEMENT,128);t[e].set(i)}}}var jn=(r,t,e,o,n)=>{typeof r.copyToChannel=="function"?t[e].byteLength!==0&&r.copyToChannel(t[e],o,n):t[e].byteLength!==0&&r.getChannelData(o).set(t[e],n)};var Ao=(r,t)=>{let e=[];for(let o=0;o<r;o+=1){let n=[],s=typeof t=="number"?t:t[o];for(let i=0;i<s;i+=1)n.push(new Float32Array(128));e.push(n)}return e};var xc=(r,t)=>{let e=Ot(dn,r),o=ht(t);return Ot(e,o)};var $m=async(r,t,e,o,n,s,i)=>{let a=t===null?Math.ceil(r.context.length/128)*128:t.length,c=o.channelCount*o.numberOfInputs,u=n.reduce((x,y)=>x+y,0),l=u===0?null:e.createBuffer(u,a,e.sampleRate);if(s===void 0)throw new Error("Missing the processor constructor.");let h=Ft(r),p=await xc(e,r),m=Ao(o.numberOfInputs,o.channelCount),f=Ao(o.numberOfOutputs,n),d=Array.from(r.parameters.keys()).reduce((x,y)=>({...x,[y]:new Float32Array(128)}),{});for(let x=0;x<a;x+=128){if(o.numberOfInputs>0&&t!==null)for(let y=0;y<o.numberOfInputs;y+=1)for(let w=0;w<o.channelCount;w+=1)bo(t,m[y],w,w,x);s.parameterDescriptors!==void 0&&t!==null&&s.parameterDescriptors.forEach(({name:y},w)=>{bo(t,d,y,c+w,x)});for(let y=0;y<o.numberOfInputs;y+=1)for(let w=0;w<n[y];w+=1)f[y][w].byteLength===0&&(f[y][w]=new Float32Array(128));try{let y=m.map((O,D)=>h.activeInputs[D].size===0?[]:O),w=i(x/e.sampleRate,e.sampleRate,()=>p.process(y,f,d));if(l!==null)for(let O=0,D=0;O<o.numberOfOutputs;O+=1){for(let _=0;_<n[O];_+=1)jn(l,f[O],_,D+_,x);D+=n[O]}if(!w)break}catch(y){r.dispatchEvent(new ErrorEvent("processorerror",{colno:y.colno,filename:y.filename,lineno:y.lineno,message:y.message}));break}}return l},yc=(r,t,e,o,n,s,i,a,c,u,l,h,p,m,f,d)=>(x,y,w)=>{let O=new WeakMap,D=null,_=async(v,b)=>{let A=l(v),M=null,E=nt(A,b),S=Array.isArray(y.outputChannelCount)?y.outputChannelCount:Array.from(y.outputChannelCount);if(h===null){let k=S.reduce((W,z)=>W+z,0),I=n(b,{channelCount:Math.max(1,k),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,k)}),q=[];for(let W=0;W<v.numberOfOutputs;W+=1)q.push(o(b,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:S[W]}));let Z=i(b,{channelCount:y.channelCount,channelCountMode:y.channelCountMode,channelInterpretation:y.channelInterpretation,gain:1});Z.connect=t.bind(null,q),Z.disconnect=c.bind(null,q),M=[I,q,Z]}else E||(A=new h(b,x));if(O.set(b,M===null?A:M[2]),M!==null){if(D===null){if(w===void 0)throw new Error("Missing the processor constructor.");if(p===null)throw new Error("Missing the native OfflineAudioContext constructor.");let z=v.channelCount*v.numberOfInputs,V=w.parameterDescriptors===void 0?0:w.parameterDescriptors.length,T=z+V;D=$m(v,T===0?null:await(async()=>{let N=new p(T,Math.ceil(v.context.length/128)*128,b.sampleRate),B=[],U=[];for(let ut=0;ut<y.numberOfInputs;ut+=1)B.push(i(N,{channelCount:y.channelCount,channelCountMode:y.channelCountMode,channelInterpretation:y.channelInterpretation,gain:1})),U.push(n(N,{channelCount:y.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:y.channelCount}));let J=await Promise.all(Array.from(v.parameters.values()).map(async ut=>{let At=s(N,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:ut.value});return await m(N,ut,At.offset),At})),P=o(N,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,z+V)});for(let ut=0;ut<y.numberOfInputs;ut+=1){B[ut].connect(U[ut]);for(let At=0;At<y.channelCount;At+=1)U[ut].connect(P,At,ut*y.channelCount+At)}for(let[ut,At]of J.entries())At.connect(P,0,z+ut),At.start(0);return P.connect(N.destination),await Promise.all(B.map(ut=>f(v,N,ut))),d(N)})(),b,y,S,w,u)}let k=await D,I=e(b,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[q,Z,W]=M;k!==null&&(I.buffer=k,I.start(0)),I.connect(q);for(let z=0,V=0;z<v.numberOfOutputs;z+=1){let T=Z[z];for(let R=0;R<S[z];R+=1)q.connect(T,V+R,R);V+=S[z]}return W}if(E)for(let[k,I]of v.parameters.entries())await r(b,I,A.parameters.get(k));else for(let[k,I]of v.parameters.entries())await m(b,I,A.parameters.get(k));return await f(v,b,A),A};return{render(v,b){a(b,v);let A=O.get(b);return A!==void 0?Promise.resolve(A):_(v,b)}}};var vc=(r,t,e,o,n,s,i,a,c,u,l,h,p,m,f,d,x,y,w,O)=>class extends f{constructor(_,v){super(_,v),this._nativeContext=_,this._audioWorklet=r===void 0?void 0:{addModule:(b,A)=>r(this,b,A)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new t(this)}createBiquadFilter(){return new n(this)}createBuffer(_,v,b){return new e({length:v,numberOfChannels:_,sampleRate:b})}createBufferSource(){return new o(this)}createChannelMerger(_=6){return new s(this,{numberOfInputs:_})}createChannelSplitter(_=6){return new i(this,{numberOfOutputs:_})}createConstantSource(){return new a(this)}createConvolver(){return new c(this)}createDelay(_=1){return new l(this,{maxDelayTime:_})}createDynamicsCompressor(){return new h(this)}createGain(){return new p(this)}createIIRFilter(_,v){return new m(this,{feedback:v,feedforward:_})}createOscillator(){return new d(this)}createPanner(){return new x(this)}createPeriodicWave(_,v,b={disableNormalization:!1}){return new y(this,{...b,imag:v,real:_})}createStereoPanner(){return new w(this)}createWaveShaper(){return new O(this)}decodeAudioData(_,v,b){return u(this._nativeContext,_).then(A=>(typeof v=="function"&&v(A),A),A=>{throw typeof b=="function"&&b(A),A})}};var Zm={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},wc=(r,t,e,o,n,s,i,a)=>class extends r{constructor(u,l){let h=s(u),p={...Zm,...l},m=n(h,p),f=i(h),d=f?e():null;super(u,!1,m,d),this._Q=t(this,f,m.Q,wt,St),this._detune=t(this,f,m.detune,1200*Math.log2(wt),-1200*Math.log2(wt)),this._frequency=t(this,f,m.frequency,u.sampleRate/2,0),this._gain=t(this,f,m.gain,40*Math.log10(wt),St),this._nativeBiquadFilterNode=m,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(u){this._nativeBiquadFilterNode.type=u}getFrequencyResponse(u,l,h){try{this._nativeBiquadFilterNode.getFrequencyResponse(u,l,h)}catch(p){throw p.code===11?o():p}if(u.length!==l.length||l.length!==h.length)throw o()}};var bc=(r,t,e,o,n)=>()=>{let s=new WeakMap,i=async(a,c)=>{let u=e(a),l=nt(u,c);if(!l){let h={Q:u.Q.value,channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,detune:u.detune.value,frequency:u.frequency.value,gain:u.gain.value,type:u.type};u=t(c,h)}return s.set(c,u),l?(await r(c,a.Q,u.Q),await r(c,a.detune,u.detune),await r(c,a.frequency,u.frequency),await r(c,a.gain,u.gain)):(await o(c,a.Q,u.Q),await o(c,a.detune,u.detune),await o(c,a.frequency,u.frequency),await o(c,a.gain,u.gain)),await n(a,c,u),u};return{render(a,c){let u=s.get(c);return u!==void 0?Promise.resolve(u):i(a,c)}}};var Ac=(r,t)=>(e,o)=>{let n=t.get(e);if(n!==void 0)return n;let s=r.get(e);if(s!==void 0)return s;try{let i=o();return i instanceof Promise?(r.set(e,i),i.catch(()=>!1).then(a=>(r.delete(e),t.set(e,a),a))):(t.set(e,i),i)}catch{return t.set(e,!1),!1}};var Qm={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},Sc=(r,t,e,o,n)=>class extends r{constructor(i,a){let c=o(i),u={...Qm,...a},l=e(c,u),h=n(c)?t():null;super(i,!1,l,h)}};var Tc=(r,t,e)=>()=>{let o=new WeakMap,n=async(s,i)=>{let a=t(s);if(!nt(a,i)){let u={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=r(i,u)}return o.set(i,a),await e(s,i,a),a};return{render(s,i){let a=o.get(i);return a!==void 0?Promise.resolve(a):n(s,i)}}};var Xm={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},Nc=(r,t,e,o,n,s)=>class extends r{constructor(a,c){let u=o(a),l=s({...Xm,...c}),h=e(u,l),p=n(u)?t():null;super(a,!1,h,p)}};var Cc=(r,t,e)=>()=>{let o=new WeakMap,n=async(s,i)=>{let a=t(s);if(!nt(a,i)){let u={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=r(i,u)}return o.set(i,a),await e(s,i,a),a};return{render(s,i){let a=o.get(i);return a!==void 0?Promise.resolve(a):n(s,i)}}};var kc=r=>(t,e,o)=>r(e,t,o);var Oc=r=>(t,e,o=0,n=0)=>{let s=t[o];if(s===void 0)throw r();return Gr(e)?s.connect(e,0,n):s.connect(e,0)};var Dc=r=>(t,e)=>{let o=r(t,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),n=t.createBuffer(1,2,44100);return o.buffer=n,o.loop=!0,o.connect(e),o.start(),()=>{o.stop(),o.disconnect(e)}};var Ym={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},Ec=(r,t,e,o,n,s,i)=>class extends r{constructor(c,u){let l=n(c),h={...Ym,...u},p=o(l,h),m=s(l),f=m?e():null;super(c,!1,p,f),this._constantSourceNodeRenderer=f,this._nativeConstantSourceNode=p,this._offset=t(this,m,p.offset,wt,St),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(c){let u=typeof c=="function"?i(this,c):null;this._nativeConstantSourceNode.onended=u;let l=this._nativeConstantSourceNode.onended;this._onended=l!==null&&l===u?c:l}start(c=0){if(this._nativeConstantSourceNode.start(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=c),this.context.state!=="closed"){be(this);let u=()=>{this._nativeConstantSourceNode.removeEventListener("ended",u),Qt(this)&&Be(this)};this._nativeConstantSourceNode.addEventListener("ended",u)}}stop(c=0){this._nativeConstantSourceNode.stop(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=c)}};var Mc=(r,t,e,o,n)=>()=>{let s=new WeakMap,i=null,a=null,c=async(u,l)=>{let h=e(u),p=nt(h,l);if(!p){let m={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,offset:h.offset.value};h=t(l,m),i!==null&&h.start(i),a!==null&&h.stop(a)}return s.set(l,h),p?await r(l,u.offset,h.offset):await o(l,u.offset,h.offset),await n(u,l,h),h};return{set start(u){i=u},set stop(u){a=u},render(u,l){let h=s.get(l);return h!==void 0?Promise.resolve(h):c(u,l)}}};var Fc=r=>t=>(r[0]=t,r[0]);var Km={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},Ic=(r,t,e,o,n,s)=>class extends r{constructor(a,c){let u=o(a),l={...Km,...c},h=e(u,l),m=n(u)?t():null;super(a,!1,h,m),this._isBufferNullified=!1,this._nativeConvolverNode=h,l.buffer!==null&&s(this,l.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(a){if(this._nativeConvolverNode.buffer=a,a===null&&this._nativeConvolverNode.buffer!==null){let c=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=c.createBuffer(1,1,44100),this._isBufferNullified=!0,s(this,0)}else this._isBufferNullified=!1,s(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(a){this._nativeConvolverNode.normalize=a}};var Rc=(r,t,e)=>()=>{let o=new WeakMap,n=async(s,i)=>{let a=t(s);if(!nt(a,i)){let u={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=r(i,u)}return o.set(i,a),pe(a)?await e(s,i,a.inputs[0]):await e(s,i,a),a};return{render(s,i){let a=o.get(i);return a!==void 0?Promise.resolve(a):n(s,i)}}};var qc=(r,t)=>(e,o,n)=>{if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new t(e,o,n)}catch(s){throw s.name==="SyntaxError"?r():s}};var Pc=()=>new DOMException("","DataCloneError");var ni=r=>{let{port1:t,port2:e}=new MessageChannel;return new Promise(o=>{let n=()=>{e.onmessage=null,t.close(),e.close(),o()};e.onmessage=()=>n();try{t.postMessage(r,[r])}finally{n()}})};var Vc=(r,t,e,o,n,s,i,a,c,u,l)=>(h,p)=>{let m=i(h)?h:s(h);if(n.has(p)){let f=e();return Promise.reject(f)}try{n.add(p)}catch{}return t(c,()=>c(m))?m.decodeAudioData(p).then(f=>(ni(p).catch(()=>{}),t(a,()=>a(f))||l(f),r.add(f),f)):new Promise((f,d)=>{let x=async()=>{try{await ni(p)}catch{}},y=w=>{d(w),x()};try{m.decodeAudioData(p,w=>{typeof w.copyFromChannel!="function"&&(u(w),_o(w)),r.add(w),x().then(()=>f(w))},w=>{y(w===null?o():w)})}catch(w){y(w)}})};var Lc=(r,t,e,o,n,s,i,a)=>(c,u)=>{let l=t.get(c);if(l===void 0)throw new Error("Missing the expected cycle count.");let h=s(c.context),p=a(h);if(l===u){if(t.delete(c),!p&&i(c)){let m=o(c),{outputs:f}=e(c);for(let d of f)if(xr(d)){let x=o(d[0]);r(m,x,d[1],d[2])}else{let x=n(d[0]);m.connect(x,d[1])}}}else t.set(c,l-u)};var Jm={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},Bc=(r,t,e,o,n,s,i)=>class extends r{constructor(c,u){let l=n(c),h={...Jm,...u},p=o(l,h),m=s(l),f=m?e(h.maxDelayTime):null;super(c,!1,p,f),this._delayTime=t(this,m,p.delayTime),i(this,h.maxDelayTime)}get delayTime(){return this._delayTime}};var Wc=(r,t,e,o,n)=>s=>{let i=new WeakMap,a=async(c,u)=>{let l=e(c),h=nt(l,u);if(!h){let p={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,delayTime:l.delayTime.value,maxDelayTime:s};l=t(u,p)}return i.set(u,l),h?await r(u,c.delayTime,l.delayTime):await o(u,c.delayTime,l.delayTime),await n(c,u,l),l};return{render(c,u){let l=i.get(u);return l!==void 0?Promise.resolve(l):a(c,u)}}};var jc=r=>(t,e,o,n)=>r(t[n],s=>s[0]===e&&s[1]===o);var Gc=r=>(t,e)=>{r(t).delete(e)};var zc=r=>"delayTime"in r;var Uc=(r,t,e)=>function o(n,s){let i=Wr(s)?s:e(r,s);if(zc(i))return[];if(n[0]===i)return[n];if(n.includes(i))return[];let{outputs:a}=t(i);return Array.from(a).map(c=>o([...n,i],c[0])).reduce((c,u)=>c.concat(u),[])};var Gn=(r,t,e)=>{let o=t[e];if(o===void 0)throw r();return o},Hc=r=>(t,e=void 0,o=void 0,n=0)=>e===void 0?t.forEach(s=>s.disconnect()):typeof e=="number"?Gn(r,t,e).disconnect():Gr(e)?o===void 0?t.forEach(s=>s.disconnect(e)):n===void 0?Gn(r,t,o).disconnect(e,0):Gn(r,t,o).disconnect(e,0,n):o===void 0?t.forEach(s=>s.disconnect(e)):Gn(r,t,o).disconnect(e,0);var td={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},$c=(r,t,e,o,n,s,i,a)=>class extends r{constructor(u,l){let h=s(u),p={...td,...l},m=o(h,p),f=i(h),d=f?e():null;super(u,!1,m,d),this._attack=t(this,f,m.attack),this._knee=t(this,f,m.knee),this._nativeDynamicsCompressorNode=m,this._ratio=t(this,f,m.ratio),this._release=t(this,f,m.release),this._threshold=t(this,f,m.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(u){let l=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=u,u>2)throw this._nativeDynamicsCompressorNode.channelCount=l,n()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(u){let l=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=u,u==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=l,n()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}};var Zc=(r,t,e,o,n)=>()=>{let s=new WeakMap,i=async(a,c)=>{let u=e(a),l=nt(u,c);if(!l){let h={attack:u.attack.value,channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,knee:u.knee.value,ratio:u.ratio.value,release:u.release.value,threshold:u.threshold.value};u=t(c,h)}return s.set(c,u),l?(await r(c,a.attack,u.attack),await r(c,a.knee,u.knee),await r(c,a.ratio,u.ratio),await r(c,a.release,u.release),await r(c,a.threshold,u.threshold)):(await o(c,a.attack,u.attack),await o(c,a.knee,u.knee),await o(c,a.ratio,u.ratio),await o(c,a.release,u.release),await o(c,a.threshold,u.threshold)),await n(a,c,u),u};return{render(a,c){let u=s.get(c);return u!==void 0?Promise.resolve(u):i(a,c)}}};var Qc=()=>new DOMException("","EncodingError");var Xc=r=>t=>new Promise((e,o)=>{if(r===null){o(new SyntaxError);return}let n=r.document.head;if(n===null)o(new SyntaxError);else{let s=r.document.createElement("script"),i=new Blob([t],{type:"application/javascript"}),a=URL.createObjectURL(i),c=r.onerror,u=()=>{r.onerror=c,URL.revokeObjectURL(a)};r.onerror=(l,h,p,m,f)=>{if(h===a||h===r.location.href&&p===1&&m===1)return u(),o(f),!1;if(c!==null)return c(l,h,p,m,f)},s.onerror=()=>{u(),o(new SyntaxError)},s.onload=()=>{u(),e()},s.src=a,s.type="module",n.appendChild(s)}});var Yc=r=>class{constructor(e){this._nativeEventTarget=e,this._listeners=new WeakMap}addEventListener(e,o,n){if(o!==null){let s=this._listeners.get(o);s===void 0&&(s=r(this,o),typeof o=="function"&&this._listeners.set(o,s)),this._nativeEventTarget.addEventListener(e,s,n)}}dispatchEvent(e){return this._nativeEventTarget.dispatchEvent(e)}removeEventListener(e,o,n){let s=o===null?void 0:this._listeners.get(o);this._nativeEventTarget.removeEventListener(e,s===void 0?null:s,n)}};var Kc=r=>(t,e,o)=>{Object.defineProperties(r,{currentFrame:{configurable:!0,get(){return Math.round(t*e)}},currentTime:{configurable:!0,get(){return t}}});try{return o()}finally{r!==null&&(delete r.currentFrame,delete r.currentTime)}};var Jc=r=>async t=>{try{let e=await fetch(t);if(e.ok)return[await e.text(),e.url]}catch{}throw r()};var ed={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},tu=(r,t,e,o,n,s)=>class extends r{constructor(a,c){let u=n(a),l={...ed,...c},h=o(u,l),p=s(u),m=p?e():null;super(a,!1,h,m),this._gain=t(this,p,h.gain,wt,St)}get gain(){return this._gain}};var eu=(r,t,e,o,n)=>()=>{let s=new WeakMap,i=async(a,c)=>{let u=e(a),l=nt(u,c);if(!l){let h={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,gain:u.gain.value};u=t(c,h)}return s.set(c,u),l?await r(c,a.gain,u.gain):await o(c,a.gain,u.gain),await n(a,c,u),u};return{render(a,c){let u=s.get(c);return u!==void 0?Promise.resolve(u):i(a,c)}}};var ru=(r,t)=>e=>t(r,e);var ou=r=>t=>{let e=r(t);if(e.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return e.renderer};var nu=r=>t=>{var e;return(e=r.get(t))!==null&&e!==void 0?e:0};var su=r=>t=>{let e=r(t);if(e.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return e.renderer};var iu=r=>t=>r.get(t);var _t=()=>new DOMException("","InvalidStateError");var au=r=>t=>{let e=r.get(t);if(e===void 0)throw _t();return e};var cu=(r,t)=>e=>{let o=r.get(e);if(o!==void 0)return o;if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");return o=new t(1,1,44100),r.set(e,o),o};var uu=r=>t=>{let e=r.get(t);if(e===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return e};var So=()=>new DOMException("","InvalidAccessError");var lu=r=>{r.getFrequencyResponse=(t=>(e,o,n)=>{if(e.length!==o.length||o.length!==n.length)throw So();return t.call(r,e,o,n)})(r.getFrequencyResponse)};var rd={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},hu=(r,t,e,o,n,s)=>class extends r{constructor(a,c){let u=o(a),l=n(u),h={...rd,...c},p=t(u,l?null:a.baseLatency,h),m=l?e(h.feedback,h.feedforward):null;super(a,!1,p,m),lu(p),this._nativeIIRFilterNode=p,s(this,1)}getFrequencyResponse(a,c,u){return this._nativeIIRFilterNode.getFrequencyResponse(a,c,u)}};var zn=(r,t,e,o,n,s,i,a,c,u,l)=>{let h=u.length,p=a;for(let m=0;m<h;m+=1){let f=e[0]*u[m];for(let d=1;d<n;d+=1){let x=p-d&c-1;f+=e[d]*s[x],f-=r[d]*i[x]}for(let d=n;d<o;d+=1)f+=e[d]*s[p-d&c-1];for(let d=n;d<t;d+=1)f-=r[d]*i[p-d&c-1];s[p]=u[m],i[p]=f,p=p+1&c-1,l[m]=f}return p};var od=(r,t,e,o)=>{let n=e instanceof Float64Array?e:new Float64Array(e),s=o instanceof Float64Array?o:new Float64Array(o),i=n.length,a=s.length,c=Math.min(i,a);if(n[0]!==1){for(let f=0;f<i;f+=1)s[f]/=n[0];for(let f=1;f<a;f+=1)n[f]/=n[0]}let u=32,l=new Float32Array(u),h=new Float32Array(u),p=t.createBuffer(r.numberOfChannels,r.length,r.sampleRate),m=r.numberOfChannels;for(let f=0;f<m;f+=1){let d=r.getChannelData(f),x=p.getChannelData(f);l.fill(0),h.fill(0),zn(n,i,s,a,c,l,h,0,u,d,x)}return p},pu=(r,t,e,o,n)=>(s,i)=>{let a=new WeakMap,c=null,u=async(l,h)=>{let p=null,m=t(l),f=nt(m,h);if(h.createIIRFilter===void 0?p=r(h,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):f||(m=h.createIIRFilter(i,s)),a.set(h,p===null?m:p),p!==null){if(c===null){if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");let x=new e(l.context.destination.channelCount,l.context.length,h.sampleRate);c=(async()=>{await o(l,x,x.destination);let y=await n(x);return od(y,h,s,i)})()}let d=await c;return p.buffer=d,p.start(0),p}return await o(l,h,m),m};return{render(l,h){let p=a.get(h);return p!==void 0?Promise.resolve(p):u(l,h)}}};var fu=(r,t,e,o,n,s)=>i=>(a,c)=>{let u=r.get(a);if(u===void 0){if(!i&&s(a)){let l=o(a),{outputs:h}=e(a);for(let p of h)if(xr(p)){let m=o(p[0]);t(l,m,p[1],p[2])}else{let m=n(p[0]);l.disconnect(m,p[1])}}r.set(a,c)}else r.set(a,u+c)};var mu=(r,t)=>e=>{let o=r.get(e);return t(o)||t(e)};var du=(r,t)=>e=>r.has(e)||t(e);var gu=(r,t)=>e=>r.has(e)||t(e);var _u=(r,t)=>e=>{let o=r.get(e);return t(o)||t(e)};var xu=r=>t=>r!==null&&t instanceof r;var yu=r=>t=>r!==null&&typeof r.AudioNode=="function"&&t instanceof r.AudioNode;var vu=r=>t=>r!==null&&typeof r.AudioParam=="function"&&t instanceof r.AudioParam;var wu=(r,t)=>e=>r(e)||t(e);var bu=r=>t=>r!==null&&t instanceof r;var Au=r=>r!==null&&r.isSecureContext;var Su=(r,t,e,o)=>class extends r{constructor(s,i){let a=e(s),c=t(a,i);if(o(a))throw TypeError();super(s,!0,c,null),this._nativeMediaElementAudioSourceNode=c}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}};var nd={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},Tu=(r,t,e,o)=>class extends r{constructor(s,i){let a=e(s);if(o(a))throw new TypeError;let c={...nd,...i},u=t(a,c);super(s,!1,u,null),this._nativeMediaStreamAudioDestinationNode=u}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}};var Nu=(r,t,e,o)=>class extends r{constructor(s,i){let a=e(s),c=t(a,i);if(o(a))throw new TypeError;super(s,!0,c,null),this._nativeMediaStreamAudioSourceNode=c}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}};var Cu=(r,t,e)=>class extends r{constructor(n,s){let i=e(n),a=t(i,s);super(n,!0,a,null)}};var ku=(r,t,e,o,n)=>class extends o{constructor(i={}){if(n===null)throw new Error("Missing the native AudioContext constructor.");let a;try{a=new n(i)}catch(l){throw l.code===12&&l.message==="sampleRate is not in range"?t():l}if(a===null)throw e();if(!Bn(i.latencyHint))throw new TypeError(`The provided value '${i.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(i.sampleRate!==void 0&&a.sampleRate!==i.sampleRate)throw t();super(a,2);let{latencyHint:c}=i,{sampleRate:u}=a;if(this._baseLatency=typeof a.baseLatency=="number"?a.baseLatency:c==="balanced"?512/u:c==="interactive"||c===void 0?256/u:c==="playback"?1024/u:Math.max(2,Math.min(128,Math.round(c*u/128)))*128/u,this._nativeAudioContext=a,n.name==="webkitAudioContext"?(this._nativeGainNode=a.createGain(),this._nativeOscillatorNode=a.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(a.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,a.state==="running"){this._state="suspended";let l=()=>{this._state==="suspended"&&(this._state=null),a.removeEventListener("statechange",l)};a.addEventListener("statechange",l)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw r()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),_r(this)}))}resume(){return this._state==="suspended"?new Promise((i,a)=>{let c=()=>{this._nativeAudioContext.removeEventListener("statechange",c),this._nativeAudioContext.state==="running"?i():this.resume().then(i,a)};this._nativeAudioContext.addEventListener("statechange",c)}):this._nativeAudioContext.resume().catch(i=>{throw i===void 0||i.code===15?r():i})}suspend(){return this._nativeAudioContext.suspend().catch(i=>{throw i===void 0?r():i})}};var Ou=(r,t,e,o,n,s)=>class extends e{constructor(a,c){super(a),this._nativeContext=a,mo.set(this,a),o(a)&&n.set(a,new Set),this._destination=new r(this,c),this._listener=t(this,a),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(a){let c=typeof a=="function"?s(this,a):null;this._nativeContext.onstatechange=c;let u=this._nativeContext.onstatechange;this._onstatechange=u!==null&&u===c?a:u}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}};var Se=r=>{let t=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{let e=r.decodeAudioData(t.buffer,()=>{});return e===void 0?!1:(e.catch(()=>{}),!0)}catch{}return!1};var sd={numberOfChannels:1},Du=(r,t,e,o,n)=>class extends o{constructor(i){let{length:a,numberOfChannels:c,sampleRate:u}={...sd,...i},l=e(c,a,u);r(Se,()=>Se(l))||l.addEventListener("statechange",(()=>{let h=0,p=m=>{this._state==="running"&&(h>0?(l.removeEventListener("statechange",p),m.stopImmediatePropagation(),this._waitForThePromiseToSettle(m)):h+=1)};return p})()),super(l,c),this._length=a,this._nativeOfflineAudioContext=l,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(t()):(this._state="running",n(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,_r(this)}))}_waitForThePromiseToSettle(i){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(i):setTimeout(()=>this._waitForThePromiseToSettle(i))}};var Eu=(r,t)=>(e,o,n)=>{let s=new Set;return e.connect=(i=>(a,c=0,u=0)=>{let l=s.size===0;if(t(a))return i.call(e,a,c,u),r(s,[a,c,u],h=>h[0]===a&&h[1]===c&&h[2]===u,!0),l&&o(),a;i.call(e,a,c),r(s,[a,c],h=>h[0]===a&&h[1]===c,!0),l&&o()})(e.connect),e.disconnect=(i=>(a,c,u)=>{let l=s.size>0;if(a===void 0)i.apply(e),s.clear();else if(typeof a=="number"){i.call(e,a);for(let p of s)p[1]===a&&s.delete(p)}else{t(a)?i.call(e,a,c,u):i.call(e,a,c);for(let p of s)p[0]===a&&(c===void 0||p[1]===c)&&(u===void 0||p[2]===u)&&s.delete(p)}let h=s.size===0;l&&h&&n()})(e.disconnect),e};var st=(r,t,e)=>{let o=t[e];o!==void 0&&o!==r[e]&&(r[e]=o)};var rt=(r,t)=>{st(r,t,"channelCount"),st(r,t,"channelCountMode"),st(r,t,"channelInterpretation")};var si=r=>typeof r.getFloatTimeDomainData=="function";var Mu=r=>{r.getFloatTimeDomainData=t=>{let e=new Uint8Array(t.length);r.getByteTimeDomainData(e);let o=Math.max(e.length,r.fftSize);for(let n=0;n<o;n+=1)t[n]=(e[n]-128)*.0078125;return t}};var Fu=(r,t)=>(e,o)=>{let n=e.createAnalyser();if(rt(n,o),!(o.maxDecibels>o.minDecibels))throw t();return st(n,o,"fftSize"),st(n,o,"maxDecibels"),st(n,o,"minDecibels"),st(n,o,"smoothingTimeConstant"),r(si,()=>si(n))||Mu(n),n};var Iu=r=>r===null?null:r.hasOwnProperty("AudioBuffer")?r.AudioBuffer:null;var at=(r,t,e)=>{let o=t[e];o!==void 0&&o!==r[e].value&&(r[e].value=o)};var Ru=r=>{r.start=(t=>{let e=!1;return(o=0,n=0,s)=>{if(e)throw _t();t.call(r,o,n,s),e=!0}})(r.start)};var To=r=>{r.start=(t=>(e=0,o=0,n)=>{if(typeof n=="number"&&n<0||o<0||e<0)throw new RangeError("The parameters can't be negative.");t.call(r,e,o,n)})(r.start)};var No=r=>{r.stop=(t=>(e=0)=>{if(e<0)throw new RangeError("The parameter can't be negative.");t.call(r,e)})(r.stop)};var qu=(r,t,e,o,n,s,i,a,c,u,l)=>(h,p)=>{let m=h.createBufferSource();return rt(m,p),at(m,p,"playbackRate"),st(m,p,"buffer"),st(m,p,"loop"),st(m,p,"loopEnd"),st(m,p,"loopStart"),t(e,()=>e(h))||Ru(m),t(o,()=>o(h))||c(m),t(n,()=>n(h))||u(m,h),t(s,()=>s(h))||To(m),t(i,()=>i(h))||l(m,h),t(a,()=>a(h))||No(m),r(h,m),m};var Pu=r=>r===null?null:r.hasOwnProperty("AudioContext")?r.AudioContext:r.hasOwnProperty("webkitAudioContext")?r.webkitAudioContext:null;var Vu=(r,t)=>(e,o,n)=>{let s=e.destination;if(s.channelCount!==o)try{s.channelCount=o}catch{}n&&s.channelCountMode!=="explicit"&&(s.channelCountMode="explicit"),s.maxChannelCount===0&&Object.defineProperty(s,"maxChannelCount",{value:o});let i=r(e,{channelCount:o,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,gain:1});return t(i,"channelCount",a=>()=>a.call(i),a=>c=>{a.call(i,c);try{s.channelCount=c}catch(u){if(c>s.maxChannelCount)throw u}}),t(i,"channelCountMode",a=>()=>a.call(i),a=>c=>{a.call(i,c),s.channelCountMode=c}),t(i,"channelInterpretation",a=>()=>a.call(i),a=>c=>{a.call(i,c),s.channelInterpretation=c}),Object.defineProperty(i,"maxChannelCount",{get:()=>s.maxChannelCount}),i.connect(s),i};var Lu=r=>r===null?null:r.hasOwnProperty("AudioWorkletNode")?r.AudioWorkletNode:null;var Bu=r=>{let{port1:t}=new MessageChannel;try{t.postMessage(r)}finally{t.close()}};var Wu=(r,t,e,o,n)=>(s,i,a,c,u,l)=>{if(a!==null)try{let h=new a(s,c,l),p=new Map,m=null;if(Object.defineProperties(h,{channelCount:{get:()=>l.channelCount,set:()=>{throw r()}},channelCountMode:{get:()=>"explicit",set:()=>{throw r()}},onprocessorerror:{get:()=>m,set:f=>{typeof m=="function"&&h.removeEventListener("processorerror",m),m=typeof f=="function"?f:null,typeof m=="function"&&h.addEventListener("processorerror",m)}}}),h.addEventListener=(f=>(...d)=>{if(d[0]==="processorerror"){let x=typeof d[1]=="function"?d[1]:typeof d[1]=="object"&&d[1]!==null&&typeof d[1].handleEvent=="function"?d[1].handleEvent:null;if(x!==null){let y=p.get(d[1]);y!==void 0?d[1]=y:(d[1]=w=>{w.type==="error"?(Object.defineProperties(w,{type:{value:"processorerror"}}),x(w)):x(new ErrorEvent(d[0],{...w}))},p.set(x,d[1]))}}return f.call(h,"error",d[1],d[2]),f.call(h,...d)})(h.addEventListener),h.removeEventListener=(f=>(...d)=>{if(d[0]==="processorerror"){let x=p.get(d[1]);x!==void 0&&(p.delete(d[1]),d[1]=x)}return f.call(h,"error",d[1],d[2]),f.call(h,d[0],d[1],d[2])})(h.removeEventListener),l.numberOfOutputs!==0){let f=e(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return h.connect(f).connect(s.destination),n(h,()=>f.disconnect(),()=>f.connect(s.destination))}return h}catch(h){throw h.code===11?o():h}if(u===void 0)throw o();return Bu(l),t(s,i,u,l)};var Un=(r,t)=>r===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(r*t)))));var ju=r=>new Promise((t,e)=>{let{port1:o,port2:n}=new MessageChannel;o.onmessage=({data:s})=>{o.close(),n.close(),t(s)},o.onmessageerror=({data:s})=>{o.close(),n.close(),e(s)},n.postMessage(r)});var Gu=async(r,t)=>{let e=await ju(t);return new r(e)};var zu=(r,t,e,o)=>{let n=dn.get(r);n===void 0&&(n=new WeakMap,dn.set(r,n));let s=Gu(e,o);return n.set(t,s),s};var Uu=(r,t,e,o,n,s,i,a,c,u,l,h,p)=>(m,f,d,x)=>{if(x.numberOfInputs===0&&x.numberOfOutputs===0)throw c();let y=Array.isArray(x.outputChannelCount)?x.outputChannelCount:Array.from(x.outputChannelCount);if(y.some(j=>j<1))throw c();if(y.length!==x.numberOfOutputs)throw t();if(x.channelCountMode!=="explicit")throw c();let w=x.channelCount*x.numberOfInputs,O=y.reduce((j,K)=>j+K,0),D=d.parameterDescriptors===void 0?0:d.parameterDescriptors.length;if(w+D>6||O>6)throw c();let _=new MessageChannel,v=[],b=[];for(let j=0;j<x.numberOfInputs;j+=1)v.push(i(m,{channelCount:x.channelCount,channelCountMode:x.channelCountMode,channelInterpretation:x.channelInterpretation,gain:1})),b.push(n(m,{channelCount:x.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:x.channelCount}));let A=[];if(d.parameterDescriptors!==void 0)for(let{defaultValue:j,maxValue:K,minValue:Mt,name:yt}of d.parameterDescriptors){let it=s(m,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:x.parameterData[yt]!==void 0?x.parameterData[yt]:j===void 0?0:j});Object.defineProperties(it.offset,{defaultValue:{get:()=>j===void 0?0:j},maxValue:{get:()=>K===void 0?wt:K},minValue:{get:()=>Mt===void 0?St:Mt}}),A.push(it)}let M=o(m,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,w+D)}),E=Un(f,m.sampleRate),S=a(m,E,w+D,Math.max(1,O)),k=n(m,{channelCount:Math.max(1,O),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,O)}),I=[];for(let j=0;j<x.numberOfOutputs;j+=1)I.push(o(m,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:y[j]}));for(let j=0;j<x.numberOfInputs;j+=1){v[j].connect(b[j]);for(let K=0;K<x.channelCount;K+=1)b[j].connect(M,K,j*x.channelCount+K)}let q=new wo(d.parameterDescriptors===void 0?[]:d.parameterDescriptors.map(({name:j},K)=>{let Mt=A[K];return Mt.connect(M,0,w+K),Mt.start(0),[j,Mt.offset]}));M.connect(S);let Z=x.channelInterpretation,W=null,z=x.numberOfOutputs===0?[S]:I,V={get bufferSize(){return E},get channelCount(){return x.channelCount},set channelCount(j){throw e()},get channelCountMode(){return x.channelCountMode},set channelCountMode(j){throw e()},get channelInterpretation(){return Z},set channelInterpretation(j){for(let K of v)K.channelInterpretation=j;Z=j},get context(){return S.context},get inputs(){return v},get numberOfInputs(){return x.numberOfInputs},get numberOfOutputs(){return x.numberOfOutputs},get onprocessorerror(){return W},set onprocessorerror(j){typeof W=="function"&&V.removeEventListener("processorerror",W),W=typeof j=="function"?j:null,typeof W=="function"&&V.addEventListener("processorerror",W)},get parameters(){return q},get port(){return _.port2},addEventListener(...j){return S.addEventListener(j[0],j[1],j[2])},connect:r.bind(null,z),disconnect:u.bind(null,z),dispatchEvent(...j){return S.dispatchEvent(j[0])},removeEventListener(...j){return S.removeEventListener(j[0],j[1],j[2])}},T=new Map;_.port1.addEventListener=(j=>(...K)=>{if(K[0]==="message"){let Mt=typeof K[1]=="function"?K[1]:typeof K[1]=="object"&&K[1]!==null&&typeof K[1].handleEvent=="function"?K[1].handleEvent:null;if(Mt!==null){let yt=T.get(K[1]);yt!==void 0?K[1]=yt:(K[1]=it=>{l(m.currentTime,m.sampleRate,()=>Mt(it))},T.set(Mt,K[1]))}}return j.call(_.port1,K[0],K[1],K[2])})(_.port1.addEventListener),_.port1.removeEventListener=(j=>(...K)=>{if(K[0]==="message"){let Mt=T.get(K[1]);Mt!==void 0&&(T.delete(K[1]),K[1]=Mt)}return j.call(_.port1,K[0],K[1],K[2])})(_.port1.removeEventListener);let R=null;Object.defineProperty(_.port1,"onmessage",{get:()=>R,set:j=>{typeof R=="function"&&_.port1.removeEventListener("message",R),R=typeof j=="function"?j:null,typeof R=="function"&&(_.port1.addEventListener("message",R),_.port1.start())}}),d.prototype.port=_.port1;let N=null;zu(m,V,d,x).then(j=>N=j);let U=Ao(x.numberOfInputs,x.channelCount),J=Ao(x.numberOfOutputs,y),P=d.parameterDescriptors===void 0?[]:d.parameterDescriptors.reduce((j,{name:K})=>({...j,[K]:new Float32Array(128)}),{}),ut=!0,At=()=>{x.numberOfOutputs>0&&S.disconnect(k);for(let j=0,K=0;j<x.numberOfOutputs;j+=1){let Mt=I[j];for(let yt=0;yt<y[j];yt+=1)k.disconnect(Mt,K+yt,yt);K+=y[j]}},H=new Map;S.onaudioprocess=({inputBuffer:j,outputBuffer:K})=>{if(N!==null){let Mt=h(V);for(let yt=0;yt<E;yt+=128){for(let it=0;it<x.numberOfInputs;it+=1)for(let vt=0;vt<x.channelCount;vt+=1)bo(j,U[it],vt,vt,yt);d.parameterDescriptors!==void 0&&d.parameterDescriptors.forEach(({name:it},vt)=>{bo(j,P,it,w+vt,yt)});for(let it=0;it<x.numberOfInputs;it+=1)for(let vt=0;vt<y[it];vt+=1)J[it][vt].byteLength===0&&(J[it][vt]=new Float32Array(128));try{let it=U.map((le,mr)=>{if(Mt[mr].size>0)return H.set(mr,E/128),le;let Us=H.get(mr);return Us===void 0?[]:(le.every(dm=>dm.every(gm=>gm===0))&&(Us===1?H.delete(mr):H.set(mr,Us-1)),le)});ut=l(m.currentTime+yt/m.sampleRate,m.sampleRate,()=>N.process(it,J,P));for(let le=0,mr=0;le<x.numberOfOutputs;le+=1){for(let en=0;en<y[le];en+=1)jn(K,J[le],en,mr+en,yt);mr+=y[le]}}catch(it){ut=!1,V.dispatchEvent(new ErrorEvent("processorerror",{colno:it.colno,filename:it.filename,lineno:it.lineno,message:it.message}))}if(!ut){for(let it=0;it<x.numberOfInputs;it+=1){v[it].disconnect(b[it]);for(let vt=0;vt<x.channelCount;vt+=1)b[yt].disconnect(M,vt,it*x.channelCount+vt)}if(d.parameterDescriptors!==void 0){let it=d.parameterDescriptors.length;for(let vt=0;vt<it;vt+=1){let le=A[vt];le.disconnect(M,0,w+vt),le.stop()}}M.disconnect(S),S.onaudioprocess=null,ye?At():ve();break}}}};let ye=!1,Zt=i(m,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),te=()=>S.connect(Zt).connect(m.destination),ve=()=>{S.disconnect(Zt),Zt.disconnect()},Pe=()=>{if(ut){ve(),x.numberOfOutputs>0&&S.connect(k);for(let j=0,K=0;j<x.numberOfOutputs;j+=1){let Mt=I[j];for(let yt=0;yt<y[j];yt+=1)k.connect(Mt,K+yt,yt);K+=y[j]}}ye=!0},zs=()=>{ut&&(te(),At()),ye=!1};return te(),p(V,Pe,zs)};var ii=(r,t)=>{let e=r.createBiquadFilter();return rt(e,t),at(e,t,"Q"),at(e,t,"detune"),at(e,t,"frequency"),at(e,t,"gain"),st(e,t,"type"),e};var Hu=(r,t)=>(e,o)=>{let n=e.createChannelMerger(o.numberOfInputs);return r!==null&&r.name==="webkitAudioContext"&&t(e,n),rt(n,o),n};var $u=r=>{let t=r.numberOfOutputs;Object.defineProperty(r,"channelCount",{get:()=>t,set:e=>{if(e!==t)throw _t()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:e=>{if(e!=="explicit")throw _t()}}),Object.defineProperty(r,"channelInterpretation",{get:()=>"discrete",set:e=>{if(e!=="discrete")throw _t()}})};var Co=(r,t)=>{let e=r.createChannelSplitter(t.numberOfOutputs);return rt(e,t),$u(e),e};var Zu=(r,t,e,o,n)=>(s,i)=>{if(s.createConstantSource===void 0)return e(s,i);let a=s.createConstantSource();return rt(a,i),at(a,i,"offset"),t(o,()=>o(s))||To(a),t(n,()=>n(s))||No(a),r(s,a),a};var fe=(r,t)=>(r.connect=t.connect.bind(t),r.disconnect=t.disconnect.bind(t),r);var Qu=(r,t,e,o)=>(n,{offset:s,...i})=>{let a=n.createBuffer(1,2,44100),c=t(n,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),u=e(n,{...i,gain:s}),l=a.getChannelData(0);l[0]=1,l[1]=1,c.buffer=a,c.loop=!0;let h={get bufferSize(){},get channelCount(){return u.channelCount},set channelCount(f){u.channelCount=f},get channelCountMode(){return u.channelCountMode},set channelCountMode(f){u.channelCountMode=f},get channelInterpretation(){return u.channelInterpretation},set channelInterpretation(f){u.channelInterpretation=f},get context(){return u.context},get inputs(){return[]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return u.numberOfOutputs},get offset(){return u.gain},get onended(){return c.onended},set onended(f){c.onended=f},addEventListener(...f){return c.addEventListener(f[0],f[1],f[2])},dispatchEvent(...f){return c.dispatchEvent(f[0])},removeEventListener(...f){return c.removeEventListener(f[0],f[1],f[2])},start(f=0){c.start.call(c,f)},stop(f=0){c.stop.call(c,f)}},p=()=>c.connect(u),m=()=>c.disconnect(u);return r(n,c),o(fe(h,u),p,m)};var Xu=(r,t)=>(e,o)=>{let n=e.createConvolver();if(rt(n,o),o.disableNormalization===n.normalize&&(n.normalize=!o.disableNormalization),st(n,o,"buffer"),o.channelCount>2||(t(n,"channelCount",s=>()=>s.call(n),s=>i=>{if(i>2)throw r();return s.call(n,i)}),o.channelCountMode==="max"))throw r();return t(n,"channelCountMode",s=>()=>s.call(n),s=>i=>{if(i==="max")throw r();return s.call(n,i)}),n};var ai=(r,t)=>{let e=r.createDelay(t.maxDelayTime);return rt(e,t),at(e,t,"delayTime"),e};var Yu=r=>(t,e)=>{let o=t.createDynamicsCompressor();if(rt(o,e),e.channelCount>2||e.channelCountMode==="max")throw r();return at(o,e,"attack"),at(o,e,"knee"),at(o,e,"ratio"),at(o,e,"release"),at(o,e,"threshold"),o};var Xt=(r,t)=>{let e=r.createGain();return rt(e,t),at(e,t,"gain"),e};var Ku=r=>(t,e,o)=>{if(t.createIIRFilter===void 0)return r(t,e,o);let n=t.createIIRFilter(o.feedforward,o.feedback);return rt(n,o),n};function id(r,t){let e=t[0]*t[0]+t[1]*t[1];return[(r[0]*t[0]+r[1]*t[1])/e,(r[1]*t[0]-r[0]*t[1])/e]}function ad(r,t){return[r[0]*t[0]-r[1]*t[1],r[0]*t[1]+r[1]*t[0]]}function Ju(r,t){let e=[0,0];for(let o=r.length-1;o>=0;o-=1)e=ad(e,t),e[0]+=r[o];return e}var tl=(r,t,e,o)=>(n,s,{channelCount:i,channelCountMode:a,channelInterpretation:c,feedback:u,feedforward:l})=>{let h=Un(s,n.sampleRate),p=u instanceof Float64Array?u:new Float64Array(u),m=l instanceof Float64Array?l:new Float64Array(l),f=p.length,d=m.length,x=Math.min(f,d);if(f===0||f>20)throw o();if(p[0]===0)throw t();if(d===0||d>20)throw o();if(m[0]===0)throw t();if(p[0]!==1){for(let A=0;A<d;A+=1)m[A]/=p[0];for(let A=1;A<f;A+=1)p[A]/=p[0]}let y=e(n,h,i,i);y.channelCount=i,y.channelCountMode=a,y.channelInterpretation=c;let w=32,O=[],D=[],_=[];for(let A=0;A<i;A+=1){O.push(0);let M=new Float32Array(w),E=new Float32Array(w);M.fill(0),E.fill(0),D.push(M),_.push(E)}y.onaudioprocess=A=>{let M=A.inputBuffer,E=A.outputBuffer,S=M.numberOfChannels;for(let k=0;k<S;k+=1){let I=M.getChannelData(k),q=E.getChannelData(k);O[k]=zn(p,f,m,d,x,D[k],_[k],O[k],w,I,q)}};let v=n.sampleRate/2;return fe({get bufferSize(){return h},get channelCount(){return y.channelCount},set channelCount(A){y.channelCount=A},get channelCountMode(){return y.channelCountMode},set channelCountMode(A){y.channelCountMode=A},get channelInterpretation(){return y.channelInterpretation},set channelInterpretation(A){y.channelInterpretation=A},get context(){return y.context},get inputs(){return[y]},get numberOfInputs(){return y.numberOfInputs},get numberOfOutputs(){return y.numberOfOutputs},addEventListener(...A){return y.addEventListener(A[0],A[1],A[2])},dispatchEvent(...A){return y.dispatchEvent(A[0])},getFrequencyResponse(A,M,E){if(A.length!==M.length||M.length!==E.length)throw r();let S=A.length;for(let k=0;k<S;k+=1){let I=-Math.PI*(A[k]/v),q=[Math.cos(I),Math.sin(I)],Z=Ju(m,q),W=Ju(p,q),z=id(Z,W);M[k]=Math.sqrt(z[0]*z[0]+z[1]*z[1]),E[k]=Math.atan2(z[1],z[0])}},removeEventListener(...A){return y.removeEventListener(A[0],A[1],A[2])}},y)};var el=(r,t)=>r.createMediaElementSource(t.mediaElement);var rl=(r,t)=>{let e=r.createMediaStreamDestination();return rt(e,t),e.numberOfOutputs===1&&Object.defineProperty(e,"numberOfOutputs",{get:()=>0}),e};var ol=(r,{mediaStream:t})=>{let e=t.getAudioTracks();e.sort((s,i)=>s.id<i.id?-1:s.id>i.id?1:0);let o=e.slice(0,1),n=r.createMediaStreamSource(new MediaStream(o));return Object.defineProperty(n,"mediaStream",{value:t}),n};var nl=(r,t)=>(e,{mediaStreamTrack:o})=>{if(typeof e.createMediaStreamTrackSource=="function")return e.createMediaStreamTrackSource(o);let n=new MediaStream([o]),s=e.createMediaStreamSource(n);if(o.kind!=="audio")throw r();if(t(e))throw new TypeError;return s};var sl=r=>r===null?null:r.hasOwnProperty("OfflineAudioContext")?r.OfflineAudioContext:r.hasOwnProperty("webkitOfflineAudioContext")?r.webkitOfflineAudioContext:null;var il=(r,t,e,o,n,s)=>(i,a)=>{let c=i.createOscillator();return rt(c,a),at(c,a,"detune"),at(c,a,"frequency"),a.periodicWave!==void 0?c.setPeriodicWave(a.periodicWave):st(c,a,"type"),t(e,()=>e(i))||To(c),t(o,()=>o(i))||s(c,i),t(n,()=>n(i))||No(c),r(i,c),c};var al=r=>(t,e)=>{let o=t.createPanner();return o.orientationX===void 0?r(t,e):(rt(o,e),at(o,e,"orientationX"),at(o,e,"orientationY"),at(o,e,"orientationZ"),at(o,e,"positionX"),at(o,e,"positionY"),at(o,e,"positionZ"),st(o,e,"coneInnerAngle"),st(o,e,"coneOuterAngle"),st(o,e,"coneOuterGain"),st(o,e,"distanceModel"),st(o,e,"maxDistance"),st(o,e,"panningModel"),st(o,e,"refDistance"),st(o,e,"rolloffFactor"),o)};var cl=(r,t,e,o,n,s,i,a,c,u)=>(l,{coneInnerAngle:h,coneOuterAngle:p,coneOuterGain:m,distanceModel:f,maxDistance:d,orientationX:x,orientationY:y,orientationZ:w,panningModel:O,positionX:D,positionY:_,positionZ:v,refDistance:b,rolloffFactor:A,...M})=>{let E=l.createPanner();if(M.channelCount>2||M.channelCountMode==="max")throw i();rt(E,M);let S={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},k=e(l,{...S,channelInterpretation:"speakers",numberOfInputs:6}),I=o(l,{...M,gain:1}),q=o(l,{...S,gain:1}),Z=o(l,{...S,gain:0}),W=o(l,{...S,gain:0}),z=o(l,{...S,gain:0}),V=o(l,{...S,gain:0}),T=o(l,{...S,gain:0}),R=n(l,256,6,1),N=s(l,{...S,curve:new Float32Array([1,1]),oversample:"none"}),B=[x,y,w],U=[D,_,v],J=new Float32Array(1);R.onaudioprocess=({inputBuffer:H})=>{let ye=[c(H,J,0),c(H,J,1),c(H,J,2)];ye.some((te,ve)=>te!==B[ve])&&(E.setOrientation(...ye),B=ye);let Zt=[c(H,J,3),c(H,J,4),c(H,J,5)];Zt.some((te,ve)=>te!==U[ve])&&(E.setPosition(...Zt),U=Zt)},Object.defineProperty(Z.gain,"defaultValue",{get:()=>0}),Object.defineProperty(W.gain,"defaultValue",{get:()=>0}),Object.defineProperty(z.gain,"defaultValue",{get:()=>0}),Object.defineProperty(V.gain,"defaultValue",{get:()=>0}),Object.defineProperty(T.gain,"defaultValue",{get:()=>0});let P={get bufferSize(){},get channelCount(){return E.channelCount},set channelCount(H){if(H>2)throw i();I.channelCount=H,E.channelCount=H},get channelCountMode(){return E.channelCountMode},set channelCountMode(H){if(H==="max")throw i();I.channelCountMode=H,E.channelCountMode=H},get channelInterpretation(){return E.channelInterpretation},set channelInterpretation(H){I.channelInterpretation=H,E.channelInterpretation=H},get coneInnerAngle(){return E.coneInnerAngle},set coneInnerAngle(H){E.coneInnerAngle=H},get coneOuterAngle(){return E.coneOuterAngle},set coneOuterAngle(H){E.coneOuterAngle=H},get coneOuterGain(){return E.coneOuterGain},set coneOuterGain(H){if(H<0||H>1)throw t();E.coneOuterGain=H},get context(){return E.context},get distanceModel(){return E.distanceModel},set distanceModel(H){E.distanceModel=H},get inputs(){return[I]},get maxDistance(){return E.maxDistance},set maxDistance(H){if(H<0)throw new RangeError;E.maxDistance=H},get numberOfInputs(){return E.numberOfInputs},get numberOfOutputs(){return E.numberOfOutputs},get orientationX(){return q.gain},get orientationY(){return Z.gain},get orientationZ(){return W.gain},get panningModel(){return E.panningModel},set panningModel(H){E.panningModel=H},get positionX(){return z.gain},get positionY(){return V.gain},get positionZ(){return T.gain},get refDistance(){return E.refDistance},set refDistance(H){if(H<0)throw new RangeError;E.refDistance=H},get rolloffFactor(){return E.rolloffFactor},set rolloffFactor(H){if(H<0)throw new RangeError;E.rolloffFactor=H},addEventListener(...H){return I.addEventListener(H[0],H[1],H[2])},dispatchEvent(...H){return I.dispatchEvent(H[0])},removeEventListener(...H){return I.removeEventListener(H[0],H[1],H[2])}};h!==P.coneInnerAngle&&(P.coneInnerAngle=h),p!==P.coneOuterAngle&&(P.coneOuterAngle=p),m!==P.coneOuterGain&&(P.coneOuterGain=m),f!==P.distanceModel&&(P.distanceModel=f),d!==P.maxDistance&&(P.maxDistance=d),x!==P.orientationX.value&&(P.orientationX.value=x),y!==P.orientationY.value&&(P.orientationY.value=y),w!==P.orientationZ.value&&(P.orientationZ.value=w),O!==P.panningModel&&(P.panningModel=O),D!==P.positionX.value&&(P.positionX.value=D),_!==P.positionY.value&&(P.positionY.value=_),v!==P.positionZ.value&&(P.positionZ.value=v),b!==P.refDistance&&(P.refDistance=b),A!==P.rolloffFactor&&(P.rolloffFactor=A),(B[0]!==1||B[1]!==0||B[2]!==0)&&E.setOrientation(...B),(U[0]!==0||U[1]!==0||U[2]!==0)&&E.setPosition(...U);let ut=()=>{I.connect(E),r(I,N,0,0),N.connect(q).connect(k,0,0),N.connect(Z).connect(k,0,1),N.connect(W).connect(k,0,2),N.connect(z).connect(k,0,3),N.connect(V).connect(k,0,4),N.connect(T).connect(k,0,5),k.connect(R).connect(l.destination)},At=()=>{I.disconnect(E),a(I,N,0,0),N.disconnect(q),q.disconnect(k),N.disconnect(Z),Z.disconnect(k),N.disconnect(W),W.disconnect(k),N.disconnect(z),z.disconnect(k),N.disconnect(V),V.disconnect(k),N.disconnect(T),T.disconnect(k),k.disconnect(R),R.disconnect(l.destination)};return u(fe(P,E),ut,At)};var ul=r=>(t,{disableNormalization:e,imag:o,real:n})=>{let s=o instanceof Float32Array?o:new Float32Array(o),i=n instanceof Float32Array?n:new Float32Array(n),a=t.createPeriodicWave(i,s,{disableNormalization:e});if(Array.from(o).length<2)throw r();return a};var ko=(r,t,e,o)=>r.createScriptProcessor(t,e,o);var ll=(r,t)=>(e,o)=>{let n=o.channelCountMode;if(n==="clamped-max")throw t();if(e.createStereoPanner===void 0)return r(e,o);let s=e.createStereoPanner();return rt(s,o),at(s,o,"pan"),Object.defineProperty(s,"channelCountMode",{get:()=>n,set:i=>{if(i!==n)throw t()}}),s};var hl=(r,t,e,o,n,s)=>{let a=new Float32Array([1,1]),c=Math.PI/2,u={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},l={...u,oversample:"none"},h=(f,d,x,y)=>{let w=new Float32Array(16385),O=new Float32Array(16385);for(let M=0;M<16385;M+=1){let E=M/16384*c;w[M]=Math.cos(E),O[M]=Math.sin(E)}let D=e(f,{...u,gain:0}),_=o(f,{...l,curve:w}),v=o(f,{...l,curve:a}),b=e(f,{...u,gain:0}),A=o(f,{...l,curve:O});return{connectGraph(){d.connect(D),d.connect(v.inputs===void 0?v:v.inputs[0]),d.connect(b),v.connect(x),x.connect(_.inputs===void 0?_:_.inputs[0]),x.connect(A.inputs===void 0?A:A.inputs[0]),_.connect(D.gain),A.connect(b.gain),D.connect(y,0,0),b.connect(y,0,1)},disconnectGraph(){d.disconnect(D),d.disconnect(v.inputs===void 0?v:v.inputs[0]),d.disconnect(b),v.disconnect(x),x.disconnect(_.inputs===void 0?_:_.inputs[0]),x.disconnect(A.inputs===void 0?A:A.inputs[0]),_.disconnect(D.gain),A.disconnect(b.gain),D.disconnect(y,0,0),b.disconnect(y,0,1)}}},p=(f,d,x,y)=>{let w=new Float32Array(16385),O=new Float32Array(16385),D=new Float32Array(16385),_=new Float32Array(16385),v=Math.floor(16385/2);for(let z=0;z<16385;z+=1)if(z>v){let V=(z-v)/(16384-v)*c;w[z]=Math.cos(V),O[z]=Math.sin(V),D[z]=0,_[z]=1}else{let V=z/(16384-v)*c;w[z]=1,O[z]=0,D[z]=Math.cos(V),_[z]=Math.sin(V)}let b=t(f,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),A=e(f,{...u,gain:0}),M=o(f,{...l,curve:w}),E=e(f,{...u,gain:0}),S=o(f,{...l,curve:O}),k=o(f,{...l,curve:a}),I=e(f,{...u,gain:0}),q=o(f,{...l,curve:D}),Z=e(f,{...u,gain:0}),W=o(f,{...l,curve:_});return{connectGraph(){d.connect(b),d.connect(k.inputs===void 0?k:k.inputs[0]),b.connect(A,0),b.connect(E,0),b.connect(I,1),b.connect(Z,1),k.connect(x),x.connect(M.inputs===void 0?M:M.inputs[0]),x.connect(S.inputs===void 0?S:S.inputs[0]),x.connect(q.inputs===void 0?q:q.inputs[0]),x.connect(W.inputs===void 0?W:W.inputs[0]),M.connect(A.gain),S.connect(E.gain),q.connect(I.gain),W.connect(Z.gain),A.connect(y,0,0),I.connect(y,0,0),E.connect(y,0,1),Z.connect(y,0,1)},disconnectGraph(){d.disconnect(b),d.disconnect(k.inputs===void 0?k:k.inputs[0]),b.disconnect(A,0),b.disconnect(E,0),b.disconnect(I,1),b.disconnect(Z,1),k.disconnect(x),x.disconnect(M.inputs===void 0?M:M.inputs[0]),x.disconnect(S.inputs===void 0?S:S.inputs[0]),x.disconnect(q.inputs===void 0?q:q.inputs[0]),x.disconnect(W.inputs===void 0?W:W.inputs[0]),M.disconnect(A.gain),S.disconnect(E.gain),q.disconnect(I.gain),W.disconnect(Z.gain),A.disconnect(y,0,0),I.disconnect(y,0,0),E.disconnect(y,0,1),Z.disconnect(y,0,1)}}},m=(f,d,x,y,w)=>{if(d===1)return h(f,x,y,w);if(d===2)return p(f,x,y,w);throw n()};return(f,{channelCount:d,channelCountMode:x,pan:y,...w})=>{if(x==="max")throw n();let O=r(f,{...w,channelCount:1,channelCountMode:x,numberOfInputs:2}),D=e(f,{...w,channelCount:d,channelCountMode:x,gain:1}),_=e(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:y}),{connectGraph:v,disconnectGraph:b}=m(f,d,D,_,O);Object.defineProperty(_.gain,"defaultValue",{get:()=>0}),Object.defineProperty(_.gain,"maxValue",{get:()=>1}),Object.defineProperty(_.gain,"minValue",{get:()=>-1});let A={get bufferSize(){},get channelCount(){return D.channelCount},set channelCount(k){D.channelCount!==k&&(M&&b(),{connectGraph:v,disconnectGraph:b}=m(f,k,D,_,O),M&&v()),D.channelCount=k},get channelCountMode(){return D.channelCountMode},set channelCountMode(k){if(k==="clamped-max"||k==="max")throw n();D.channelCountMode=k},get channelInterpretation(){return D.channelInterpretation},set channelInterpretation(k){D.channelInterpretation=k},get context(){return D.context},get inputs(){return[D]},get numberOfInputs(){return D.numberOfInputs},get numberOfOutputs(){return D.numberOfOutputs},get pan(){return _.gain},addEventListener(...k){return D.addEventListener(k[0],k[1],k[2])},dispatchEvent(...k){return D.dispatchEvent(k[0])},removeEventListener(...k){return D.removeEventListener(k[0],k[1],k[2])}},M=!1,E=()=>{v(),M=!0},S=()=>{b(),M=!1};return s(fe(A,O),E,S)}};var pl=(r,t,e,o,n,s,i)=>(a,c)=>{let u=a.createWaveShaper();if(s!==null&&s.name==="webkitAudioContext"&&a.createGain().gain.automationRate===void 0)return e(a,c);rt(u,c);let l=c.curve===null||c.curve instanceof Float32Array?c.curve:new Float32Array(c.curve);if(l!==null&&l.length<2)throw t();st(u,{curve:l},"curve"),st(u,c,"oversample");let h=null,p=!1;return i(u,"curve",d=>()=>d.call(u),d=>x=>(d.call(u,x),p&&(o(x)&&h===null?h=r(a,u):!o(x)&&h!==null&&(h(),h=null)),x)),n(u,()=>{p=!0,o(u.curve)&&(h=r(a,u))},()=>{p=!1,h!==null&&(h(),h=null)})};var fl=(r,t,e,o,n)=>(s,{curve:i,oversample:a,...c})=>{let u=s.createWaveShaper(),l=s.createWaveShaper();rt(u,c),rt(l,c);let h=e(s,{...c,gain:1}),p=e(s,{...c,gain:-1}),m=e(s,{...c,gain:1}),f=e(s,{...c,gain:-1}),d=null,x=!1,y=null,w={get bufferSize(){},get channelCount(){return u.channelCount},set channelCount(_){h.channelCount=_,p.channelCount=_,u.channelCount=_,m.channelCount=_,l.channelCount=_,f.channelCount=_},get channelCountMode(){return u.channelCountMode},set channelCountMode(_){h.channelCountMode=_,p.channelCountMode=_,u.channelCountMode=_,m.channelCountMode=_,l.channelCountMode=_,f.channelCountMode=_},get channelInterpretation(){return u.channelInterpretation},set channelInterpretation(_){h.channelInterpretation=_,p.channelInterpretation=_,u.channelInterpretation=_,m.channelInterpretation=_,l.channelInterpretation=_,f.channelInterpretation=_},get context(){return u.context},get curve(){return y},set curve(_){if(_!==null&&_.length<2)throw t();if(_===null)u.curve=_,l.curve=_;else{let v=_.length,b=new Float32Array(v+2-v%2),A=new Float32Array(v+2-v%2);b[0]=_[0],A[0]=-_[v-1];let M=Math.ceil((v+1)/2),E=(v+1)/2-1;for(let S=1;S<M;S+=1){let k=S/M*E,I=Math.floor(k),q=Math.ceil(k);b[S]=I===q?_[I]:(1-(k-I))*_[I]+(1-(q-k))*_[q],A[S]=I===q?-_[v-1-I]:-((1-(k-I))*_[v-1-I])-(1-(q-k))*_[v-1-q]}b[M]=v%2===1?_[M-1]:(_[M-2]+_[M-1])/2,u.curve=b,l.curve=A}y=_,x&&(o(y)&&d===null?d=r(s,h):d!==null&&(d(),d=null))},get inputs(){return[h]},get numberOfInputs(){return u.numberOfInputs},get numberOfOutputs(){return u.numberOfOutputs},get oversample(){return u.oversample},set oversample(_){u.oversample=_,l.oversample=_},addEventListener(..._){return h.addEventListener(_[0],_[1],_[2])},dispatchEvent(..._){return h.dispatchEvent(_[0])},removeEventListener(..._){return h.removeEventListener(_[0],_[1],_[2])}};i!==null&&(w.curve=i instanceof Float32Array?i:new Float32Array(i)),a!==w.oversample&&(w.oversample=a);let O=()=>{h.connect(u).connect(m),h.connect(p).connect(l).connect(f).connect(m),x=!0,o(y)&&(d=r(s,h))},D=()=>{h.disconnect(u),u.disconnect(m),h.disconnect(p),p.disconnect(l),l.disconnect(f),f.disconnect(m),x=!1,d!==null&&(d(),d=null)};return n(fe(w,m),O,D)};var Wt=()=>new DOMException("","NotSupportedError");var cd={numberOfChannels:1},ml=(r,t,e,o,n)=>class extends r{constructor(i,a,c){let u;if(typeof i=="number"&&a!==void 0&&c!==void 0)u={length:a,numberOfChannels:i,sampleRate:c};else if(typeof i=="object")u=i;else throw new Error("The given parameters are not valid.");let{length:l,numberOfChannels:h,sampleRate:p}={...cd,...u},m=o(h,l,p);t(Se,()=>Se(m))||m.addEventListener("statechange",(()=>{let f=0,d=x=>{this._state==="running"&&(f>0?(m.removeEventListener("statechange",d),x.stopImmediatePropagation(),this._waitForThePromiseToSettle(x)):f+=1)};return d})()),super(m,h),this._length=l,this._nativeOfflineAudioContext=m,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(e()):(this._state="running",n(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,_r(this)}))}_waitForThePromiseToSettle(i){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(i):setTimeout(()=>this._waitForThePromiseToSettle(i))}};var ud={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},dl=(r,t,e,o,n,s,i)=>class extends r{constructor(c,u){let l=n(c),h={...ud,...u},p=e(l,h),m=s(l),f=m?o():null,d=c.sampleRate/2;super(c,!1,p,f),this._detune=t(this,m,p.detune,153600,-153600),this._frequency=t(this,m,p.frequency,d,-d),this._nativeOscillatorNode=p,this._onended=null,this._oscillatorNodeRenderer=f,this._oscillatorNodeRenderer!==null&&h.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=h.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(c){let u=typeof c=="function"?i(this,c):null;this._nativeOscillatorNode.onended=u;let l=this._nativeOscillatorNode.onended;this._onended=l!==null&&l===u?c:l}get type(){return this._nativeOscillatorNode.type}set type(c){this._nativeOscillatorNode.type=c,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(c){this._nativeOscillatorNode.setPeriodicWave(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=c)}start(c=0){if(this._nativeOscillatorNode.start(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=c),this.context.state!=="closed"){be(this);let u=()=>{this._nativeOscillatorNode.removeEventListener("ended",u),Qt(this)&&Be(this)};this._nativeOscillatorNode.addEventListener("ended",u)}}stop(c=0){this._nativeOscillatorNode.stop(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=c)}};var gl=(r,t,e,o,n)=>()=>{let s=new WeakMap,i=null,a=null,c=null,u=async(l,h)=>{let p=e(l),m=nt(p,h);if(!m){let f={channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,detune:p.detune.value,frequency:p.frequency.value,periodicWave:i===null?void 0:i,type:p.type};p=t(h,f),a!==null&&p.start(a),c!==null&&p.stop(c)}return s.set(h,p),m?(await r(h,l.detune,p.detune),await r(h,l.frequency,p.frequency)):(await o(h,l.detune,p.detune),await o(h,l.frequency,p.frequency)),await n(l,h,p),p};return{set periodicWave(l){i=l},set start(l){a=l},set stop(l){c=l},render(l,h){let p=s.get(h);return p!==void 0?Promise.resolve(p):u(l,h)}}};var ld={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},_l=(r,t,e,o,n,s,i)=>class extends r{constructor(c,u){let l=n(c),h={...ld,...u},p=e(l,h),m=s(l),f=m?o():null;super(c,!1,p,f),this._nativePannerNode=p,this._orientationX=t(this,m,p.orientationX,wt,St),this._orientationY=t(this,m,p.orientationY,wt,St),this._orientationZ=t(this,m,p.orientationZ,wt,St),this._positionX=t(this,m,p.positionX,wt,St),this._positionY=t(this,m,p.positionY,wt,St),this._positionZ=t(this,m,p.positionZ,wt,St),i(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(c){this._nativePannerNode.coneInnerAngle=c}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(c){this._nativePannerNode.coneOuterAngle=c}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(c){this._nativePannerNode.coneOuterGain=c}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(c){this._nativePannerNode.distanceModel=c}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(c){this._nativePannerNode.maxDistance=c}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(c){this._nativePannerNode.panningModel=c}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(c){this._nativePannerNode.refDistance=c}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(c){this._nativePannerNode.rolloffFactor=c}};var xl=(r,t,e,o,n,s,i,a,c,u)=>()=>{let l=new WeakMap,h=null,p=async(m,f)=>{let d=null,x=s(m),y={channelCount:x.channelCount,channelCountMode:x.channelCountMode,channelInterpretation:x.channelInterpretation},w={...y,coneInnerAngle:x.coneInnerAngle,coneOuterAngle:x.coneOuterAngle,coneOuterGain:x.coneOuterGain,distanceModel:x.distanceModel,maxDistance:x.maxDistance,panningModel:x.panningModel,refDistance:x.refDistance,rolloffFactor:x.rolloffFactor},O=nt(x,f);if("bufferSize"in x)d=o(f,{...y,gain:1});else if(!O){let D={...w,orientationX:x.orientationX.value,orientationY:x.orientationY.value,orientationZ:x.orientationZ.value,positionX:x.positionX.value,positionY:x.positionY.value,positionZ:x.positionZ.value};x=n(f,D)}if(l.set(f,d===null?x:d),d!==null){if(h===null){if(i===null)throw new Error("Missing the native OfflineAudioContext constructor.");let S=new i(6,m.context.length,f.sampleRate),k=t(S,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});k.connect(S.destination),h=(async()=>{let I=await Promise.all([m.orientationX,m.orientationY,m.orientationZ,m.positionX,m.positionY,m.positionZ].map(async(q,Z)=>{let W=e(S,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:Z===0?1:0});return await a(S,q,W.offset),W}));for(let q=0;q<6;q+=1)I[q].connect(k,0,q),I[q].start(0);return u(S)})()}let D=await h,_=o(f,{...y,gain:1});await c(m,f,_);let v=[];for(let S=0;S<D.numberOfChannels;S+=1)v.push(D.getChannelData(S));let b=[v[0][0],v[1][0],v[2][0]],A=[v[3][0],v[4][0],v[5][0]],M=o(f,{...y,gain:1}),E=n(f,{...w,orientationX:b[0],orientationY:b[1],orientationZ:b[2],positionX:A[0],positionY:A[1],positionZ:A[2]});_.connect(M).connect(E.inputs[0]),E.connect(d);for(let S=128;S<D.length;S+=128){let k=[v[0][S],v[1][S],v[2][S]],I=[v[3][S],v[4][S],v[5][S]];if(k.some((q,Z)=>q!==b[Z])||I.some((q,Z)=>q!==A[Z])){b=k,A=I;let q=S/f.sampleRate;M.gain.setValueAtTime(0,q),M=o(f,{...y,gain:0}),E=n(f,{...w,orientationX:b[0],orientationY:b[1],orientationZ:b[2],positionX:A[0],positionY:A[1],positionZ:A[2]}),M.gain.setValueAtTime(1,q),_.connect(M).connect(E.inputs[0]),E.connect(d)}}return d}return O?(await r(f,m.orientationX,x.orientationX),await r(f,m.orientationY,x.orientationY),await r(f,m.orientationZ,x.orientationZ),await r(f,m.positionX,x.positionX),await r(f,m.positionY,x.positionY),await r(f,m.positionZ,x.positionZ)):(await a(f,m.orientationX,x.orientationX),await a(f,m.orientationY,x.orientationY),await a(f,m.orientationZ,x.orientationZ),await a(f,m.positionX,x.positionX),await a(f,m.positionY,x.positionY),await a(f,m.positionZ,x.positionZ)),pe(x)?await c(m,f,x.inputs[0]):await c(m,f,x),x};return{render(m,f){let d=l.get(f);return d!==void 0?Promise.resolve(d):p(m,f)}}};var hd={disableNormalization:!1},yl=(r,t,e,o)=>class vl{constructor(s,i){let a=t(s),c=o({...hd,...i}),u=r(a,c);return e.add(u),u}static[Symbol.hasInstance](s){return s!==null&&typeof s=="object"&&Object.getPrototypeOf(s)===vl.prototype||e.has(s)}};var wl=(r,t)=>(e,o,n)=>(r(o).replay(n),t(o,e,n));var bl=(r,t,e)=>async(o,n,s)=>{let i=r(o);await Promise.all(i.activeInputs.map((a,c)=>Array.from(a).map(async([u,l])=>{let p=await t(u).render(u,n),m=o.context.destination;!e(u)&&(o!==m||!e(o))&&p.connect(s,l,c)})).reduce((a,c)=>[...a,...c],[]))};var Al=(r,t,e)=>async(o,n,s)=>{let i=t(o);await Promise.all(Array.from(i.activeInputs).map(async([a,c])=>{let l=await r(a).render(a,n);e(a)||l.connect(s,c)}))};var Sl=(r,t,e,o)=>n=>r(Se,()=>Se(n))?Promise.resolve(r(o,o)).then(s=>{if(!s){let i=e(n,512,0,1);n.oncomplete=()=>{i.onaudioprocess=null,i.disconnect()},i.onaudioprocess=()=>n.currentTime,i.connect(n.destination)}return n.startRendering()}):new Promise(s=>{let i=t(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.oncomplete=a=>{i.disconnect(),s(a.renderedBuffer)},i.connect(n.destination),n.startRendering()});var Tl=r=>(t,e)=>{r.set(t,e)};var Nl=r=>(t,e)=>r.set(t,e);var Cl=(r,t,e,o,n,s,i,a)=>(c,u)=>e(c).render(c,u).then(()=>Promise.all(Array.from(o(u)).map(l=>e(l).render(l,u)))).then(()=>n(u)).then(l=>(typeof l.copyFromChannel!="function"?(i(l),_o(l)):t(s,()=>s(l))||a(l),r.add(l),l));var pd={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},kl=(r,t,e,o,n,s)=>class extends r{constructor(a,c){let u=n(a),l={...pd,...c},h=e(u,l),p=s(u),m=p?o():null;super(a,!1,h,m),this._pan=t(this,p,h.pan)}get pan(){return this._pan}};var Ol=(r,t,e,o,n)=>()=>{let s=new WeakMap,i=async(a,c)=>{let u=e(a),l=nt(u,c);if(!l){let h={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,pan:u.pan.value};u=t(c,h)}return s.set(c,u),l?await r(c,a.pan,u.pan):await o(c,a.pan,u.pan),pe(u)?await n(a,c,u.inputs[0]):await n(a,c,u),u};return{render(a,c){let u=s.get(c);return u!==void 0?Promise.resolve(u):i(a,c)}}};var Dl=r=>()=>{if(r===null)return!1;try{new r({length:1,sampleRate:44100})}catch{return!1}return!0};var El=(r,t)=>async()=>{if(r===null)return!0;if(t===null)return!1;let e=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),o=new t(1,128,44100),n=URL.createObjectURL(e),s=!1,i=!1;try{await o.audioWorklet.addModule(n);let a=new r(o,"a",{numberOfOutputs:0}),c=o.createOscillator();a.port.onmessage=()=>s=!0,a.onprocessorerror=()=>i=!0,c.connect(a),c.start(0),await o.startRendering()}catch{}finally{URL.revokeObjectURL(n)}return s&&!i};var Ml=(r,t)=>()=>{if(t===null)return Promise.resolve(!1);let e=new t(1,1,44100),o=r(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(n=>{e.oncomplete=()=>{o.disconnect(),n(e.currentTime!==0)},e.startRendering()})};var ci=()=>new DOMException("","UnknownError");var fd={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},Fl=(r,t,e,o,n,s,i)=>class extends r{constructor(c,u){let l=n(c),h={...fd,...u},p=e(l,h),f=s(l)?o():null;super(c,!0,p,f),this._isCurveNullified=!1,this._nativeWaveShaperNode=p,i(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(c){if(c===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(c.length<2)throw t();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=c}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(c){this._nativeWaveShaperNode.oversample=c}};var Il=(r,t,e)=>()=>{let o=new WeakMap,n=async(s,i)=>{let a=t(s);if(!nt(a,i)){let u={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=r(i,u)}return o.set(i,a),pe(a)?await e(s,i,a.inputs[0]):await e(s,i,a),a};return{render(s,i){let a=o.get(i);return a!==void 0?Promise.resolve(a):n(s,i)}}};var Rl=()=>typeof window>"u"?null:window;var ql=(r,t)=>e=>{e.copyFromChannel=(o,n,s=0)=>{let i=r(s),a=r(n);if(a>=e.numberOfChannels)throw t();let c=e.length,u=e.getChannelData(a),l=o.length;for(let h=i<0?-i:0;h+i<c&&h<l;h+=1)o[h]=u[h+i]},e.copyToChannel=(o,n,s=0)=>{let i=r(s),a=r(n);if(a>=e.numberOfChannels)throw t();let c=e.length,u=e.getChannelData(a),l=o.length;for(let h=i<0?-i:0;h+i<c&&h<l;h+=1)u[h+i]=o[h]}};var Pl=r=>t=>{t.copyFromChannel=(e=>(o,n,s=0)=>{let i=r(s),a=r(n);if(i<t.length)return e.call(t,o,a,i)})(t.copyFromChannel),t.copyToChannel=(e=>(o,n,s=0)=>{let i=r(s),a=r(n);if(i<t.length)return e.call(t,o,a,i)})(t.copyToChannel)};var Vl=r=>(t,e)=>{let o=e.createBuffer(1,1,44100);t.buffer===null&&(t.buffer=o),r(t,"buffer",n=>()=>{let s=n.call(t);return s===o?null:s},n=>s=>n.call(t,s===null?o:s))};var Ll=(r,t)=>(e,o)=>{o.channelCount=1,o.channelCountMode="explicit",Object.defineProperty(o,"channelCount",{get:()=>1,set:()=>{throw r()}}),Object.defineProperty(o,"channelCountMode",{get:()=>"explicit",set:()=>{throw r()}});let n=e.createBufferSource();t(o,()=>{let a=o.numberOfInputs;for(let c=0;c<a;c+=1)n.connect(o,0,c)},()=>n.disconnect(o))};var ui=(r,t,e)=>r.copyFromChannel===void 0?r.getChannelData(e)[0]:(r.copyFromChannel(t,e),t[0]);var li=r=>{if(r===null)return!1;let t=r.length;return t%2!==0?r[Math.floor(t/2)]!==0:r[t/2-1]+r[t/2]!==0};var Oo=(r,t,e,o)=>{let n=r;for(;!n.hasOwnProperty(t);)n=Object.getPrototypeOf(n);let{get:s,set:i}=Object.getOwnPropertyDescriptor(n,t);Object.defineProperty(r,t,{get:e(s),set:o(i)})};var Bl=r=>({...r,outputChannelCount:r.outputChannelCount!==void 0?r.outputChannelCount:r.numberOfInputs===1&&r.numberOfOutputs===1?[r.channelCount]:Array.from({length:r.numberOfOutputs},()=>1)});var Wl=r=>({...r,channelCount:r.numberOfOutputs});var jl=r=>{let{imag:t,real:e}=r;return t===void 0?e===void 0?{...r,imag:[0,0],real:[0,0]}:{...r,imag:Array.from(e,()=>0),real:e}:e===void 0?{...r,imag:t,real:Array.from(t,()=>0)}:{...r,imag:t,real:e}};var hi=(r,t,e)=>{try{r.setValueAtTime(t,e)}catch(o){if(o.code!==9)throw o;hi(r,t,e+1e-7)}};var Gl=r=>{let t=r.createBufferSource();t.start();try{t.start()}catch{return!0}return!1};var zl=r=>{let t=r.createBufferSource(),e=r.createBuffer(1,1,44100);t.buffer=e;try{t.start(0,1)}catch{return!1}return!0};var Ul=r=>{let t=r.createBufferSource();t.start();try{t.stop()}catch{return!1}return!0};var Hn=r=>{let t=r.createOscillator();try{t.start(-1)}catch(e){return e instanceof RangeError}return!1};var pi=r=>{let t=r.createBuffer(1,1,44100),e=r.createBufferSource();e.buffer=t,e.start(),e.stop();try{return e.stop(),!0}catch{return!1}};var $n=r=>{let t=r.createOscillator();try{t.stop(-1)}catch(e){return e instanceof RangeError}return!1};var Hl=r=>{let{port1:t,port2:e}=new MessageChannel;try{t.postMessage(r)}finally{t.close(),e.close()}};var $l=r=>{r.start=(t=>(e=0,o=0,n)=>{let s=r.buffer,i=s===null?o:Math.min(s.duration,o);s!==null&&i>s.duration-.5/r.context.sampleRate?t.call(r,e,0,0):t.call(r,e,i,n)})(r.start)};var fi=(r,t)=>{let e=t.createGain();r.connect(e);let o=(n=>()=>{n.call(r,e),r.removeEventListener("ended",o)})(r.disconnect);r.addEventListener("ended",o),fe(r,e),r.stop=(n=>{let s=!1;return(i=0)=>{if(s)try{n.call(r,i)}catch{e.gain.setValueAtTime(0,i)}else n.call(r,i),s=!0}})(r.stop)};var zr=(r,t)=>e=>{let o={value:r};return Object.defineProperties(e,{currentTarget:o,target:o}),typeof t=="function"?t.call(r,e):t.handleEvent.call(r,e)};var md=qa(Ae),dd=Ha(Ae),gd=jc(dr),Ql=new WeakMap,_d=nu(Ql),me=Ac(new Map,new WeakMap),We=Rl(),Xl=Fu(me,he),mi=ou(Ft),jt=bl(Ft,mi,rr),xd=Xa(Xl,ht,jt),mt=au(mo),or=sl(We),pt=bu(or),Yl=new WeakMap,Kl=Yc(zr),Do=Pu(We),di=xu(Do),gi=yu(We),Jl=vu(We),_n=Lu(We),Tt=fc(Pa(In),Ua(md,dd,xo,gd,yo,Ft,_d,Le,ht,Ae,Qt,rr,vo),me,fu(fn,yo,Ft,ht,jr,Qt),he,So,Wt,Lc(xo,fn,Ft,ht,jr,mt,Qt,pt),Uc(Yl,Ft,Ot),Kl,mt,di,gi,Jl,pt,_n),yd=Qa(Tt,xd,he,Xl,mt,pt);var _i=new WeakSet,Zl=Iu(We),th=Fc(new Uint32Array(1)),xi=ql(th,he),yi=Pl(th),vd=Ya(_i,me,Wt,Zl,or,Dl(Zl),xi,yi);var Zn=$a(Xt),eh=Al(mi,gr,rr),je=kc(eh),Eo=qu(Zn,me,Gl,zl,Ul,Hn,pi,$n,$l,Vl(Oo),fi),Ge=wl(su(gr),eh),wd=tc(je,Eo,ht,Ge,jt),Te=dc(Va(Rn),Yl,pn,gc,ee.createCancelAndHoldAutomationEvent,ee.createCancelScheduledValuesAutomationEvent,ee.createExponentialRampToValueAutomationEvent,ee.createLinearRampToValueAutomationEvent,ee.createSetTargetAutomationEvent,ee.createSetValueAutomationEvent,ee.createSetValueCurveAutomationEvent,Do,hi),bd=Ja(Tt,wd,Te,_t,Eo,mt,pt,zr);var Ad=cc(Tt,uc,he,_t,Vu(Xt,Oo),mt,pt,jt),Sd=bc(je,ii,ht,Ge,jt),Ur=Nl(Ql),Td=wc(Tt,Te,Sd,So,ii,mt,pt,Ur),yr=Eu(Ae,gi),Nd=Ll(_t,yr),vr=Hu(Do,Nd),Cd=Tc(vr,ht,jt),kd=Sc(Tt,Cd,vr,mt,pt),Od=Cc(Co,ht,jt),Dd=Nc(Tt,Od,Co,mt,pt,Wl),Ed=Qu(Zn,Eo,Xt,yr),Mo=Zu(Zn,me,Ed,Hn,$n),Md=Mc(je,Mo,ht,Ge,jt),Fd=Ec(Tt,Te,Md,Mo,mt,pt,zr),rh=Xu(Wt,Oo),Id=Rc(rh,ht,jt),Rd=Ic(Tt,Id,rh,mt,pt,Ur),qd=Wc(je,ai,ht,Ge,jt),Pd=Bc(Tt,Te,qd,ai,mt,pt,Ur),oh=Yu(Wt),Vd=Zc(je,oh,ht,Ge,jt),Ld=$c(Tt,Te,Vd,oh,Wt,mt,pt,Ur),Bd=eu(je,Xt,ht,Ge,jt),Wd=tu(Tt,Te,Bd,Xt,mt,pt),jd=tl(So,_t,ko,Wt),Qn=Sl(me,Xt,ko,Ml(Xt,or)),Gd=pu(Eo,ht,or,jt,Qn),zd=Ku(jd),Ud=hu(Tt,zd,Gd,mt,pt,Ur),Hd=lc(Te,vr,Mo,ko,Wt,ui,pt,Oo),nh=new WeakMap,vi=Ou(Ad,Hd,Kl,pt,nh,zr),sh=il(Zn,me,Hn,pi,$n,fi),$d=gl(je,sh,ht,Ge,jt),Zd=dl(Tt,Te,sh,$d,mt,pt,zr),ih=Dc(Eo),Qd=fl(ih,_t,Xt,li,yr),Xn=pl(ih,_t,Qd,li,yr,Do,Oo),Xd=cl(xo,_t,vr,Xt,ko,Xn,Wt,yo,ui,yr),ah=al(Xd),Yd=xl(je,vr,Mo,Xt,ah,ht,or,Ge,jt,Qn),Kd=_l(Tt,Te,ah,Yd,mt,pt,Ur),Jd=ul(he),tg=yl(Jd,mt,new WeakSet,jl),eg=hl(vr,Co,Xt,Xn,Wt,yr),ch=ll(eg,Wt),rg=Ol(je,ch,ht,Ge,jt),og=kl(Tt,Te,ch,rg,mt,pt),ng=Il(Xn,ht,jt),sg=Fl(Tt,_t,Xn,ng,mt,pt,Ur),uh=Au(We),wi=Kc(We),lh=new WeakMap,ig=cu(lh,or),ag=uh?za(me,Wt,Xc(We),wi,Jc(Ra),mt,ig,pt,_n,new WeakMap,new WeakMap,El(_n,or),We):void 0,cg=wu(di,pt),ug=Vc(_i,me,Pc,Qc,new WeakSet,mt,cg,go,Se,xi,yi),hh=vc(ag,yd,vd,bd,Td,kd,Dd,Fd,Rd,ug,Pd,Ld,Wd,Ud,vi,Zd,Kd,tg,og,sg),lg=Su(Tt,el,mt,pt),hg=Tu(Tt,rl,mt,pt),pg=Nu(Tt,ol,mt,pt),fg=nl(_t,pt),mg=Cu(Tt,fg,mt),ph=ac(hh,_t,Wt,ci,lg,hg,pg,mg,Do);var bi=uu(nh),dg=Za(bi),fh=Oc(he),gg=Gc(bi),mh=Hc(he),dh=new WeakMap,_g=ru(dh,Ot),xg=Uu(fh,he,_t,vr,Co,Mo,Xt,ko,Wt,mh,wi,_g,yr),yg=Wu(_t,xg,Xt,Wt,yr),vg=yc(je,fh,Eo,vr,Co,Mo,Xt,gg,mh,wi,ht,_n,or,Ge,jt,Qn),wg=iu(lh),bg=Tl(dh),Ai=uh?_c(dg,Tt,Te,vg,yg,Ft,wg,mt,pt,_n,Bl,bg,Hl,zr):void 0;var KP=ku(_t,Wt,ci,vi,Do);var gh=qc(Wt,or),_h=Cl(_i,me,mi,bi,Qn,go,xi,yi),JP=Du(me,_t,gh,vi,_h);var xh=ml(hh,me,_t,gh,_h);var yh=mu(mo,di),vh=du(fo,gi),wh=gu(pn,Jl),bh=_u(mo,pt);function G(r,t){if(!r)throw new Error(t)}function Vt(r,t,e=1/0){if(!(t<=r&&r<=e))throw new RangeError(`Value must be within [${t}, ${e}], got: ${r}`)}function Yn(r){!r.isOffline&&r.state!=="running"&&xn('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}var Ah=console;function Sh(...r){Ah.log(...r)}function xn(...r){Ah.warn(...r)}function Dt(r){return typeof r>"u"}function Q(r){return!Dt(r)}function Th(r){return typeof r=="function"}function Gt(r){return typeof r=="number"}function Ne(r){return Object.prototype.toString.call(r)==="[object Object]"&&r.constructor===Object}function Kn(r){return typeof r=="boolean"}function Nt(r){return Array.isArray(r)}function Lt(r){return typeof r=="string"}function yn(r){return Lt(r)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(r)}function Nh(r){return new ph(r)}function Ch(r,t,e){return new xh(r,t,e)}var ze=typeof self=="object"?self:null,kh=ze&&(ze.hasOwnProperty("AudioContext")||ze.hasOwnProperty("webkitAudioContext"));function Oh(r,t,e){return G(Q(Ai),"This node only works in a secure context (https or localhost)"),new Ai(r,t,e)}var Yh=$s(Xh(),1),{__extends:lV,__assign:hV,__rest:pV,__decorate:Ht,__param:fV,__metadata:mV,__awaiter:et,__generator:dV,__exportStar:gV,__createBinding:_V,__values:xV,__read:yV,__spread:vV,__spreadArrays:wV,__spreadArray:bV,__await:AV,__asyncGenerator:SV,__asyncDelegator:TV,__asyncValues:NV,__makeTemplateObject:CV,__importStar:kV,__importDefault:OV,__classPrivateFieldGet:DV,__classPrivateFieldSet:EV}=Yh.default;var rs=class{constructor(t,e,o){this._callback=t,this._type=e,this._updateInterval=o,this._createClock()}_createWorker(){let t=new Blob([`
			// the initial timeout time
			let timeoutTime =  ${(this._updateInterval*1e3).toFixed(1)};
			// onmessage callback
			self.onmessage = function(msg){
				timeoutTime = parseInt(msg.data);
			};
			// the tick function which posts a message
			// and schedules a new tick
			function tick(){
				setTimeout(tick, timeoutTime);
				self.postMessage('tick');
			}
			// call tick initially
			tick();
			`],{type:"text/javascript"}),e=URL.createObjectURL(t),o=new Worker(e);o.onmessage=this._callback.bind(this),this._worker=o}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},this._updateInterval*1e3)}_createClock(){if(this._type==="worker")try{this._createWorker()}catch{this._type="timeout",this._createClock()}else this._type==="timeout"&&this._createTimeout()}_disposeClock(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(t){this._updateInterval=Math.max(t,128/44100),this._type==="worker"&&this._worker.postMessage(Math.max(t*1e3,1))}get type(){return this._type}set type(t){this._disposeClock(),this._type=t,this._createClock()}dispose(){this._disposeClock()}};function Ce(r){return wh(r)}function Ue(r){return vh(r)}function Io(r){return bh(r)}function wr(r){return yh(r)}function os(r){return r instanceof AudioBuffer}function Tg(r,t){return r==="value"||Ce(t)||Ue(t)||os(t)}function ke(r,...t){if(!t.length)return r;let e=t.shift();if(Ne(r)&&Ne(e))for(let o in e)Tg(o,e[o])?r[o]=e[o]:Ne(e[o])?(r[o]||Object.assign(r,{[o]:{}}),ke(r[o],e[o])):Object.assign(r,{[o]:e[o]});return ke(r,...t)}function Kh(r,t){return r.length===t.length&&r.every((e,o)=>t[o]===e)}function g(r,t,e=[],o){let n={},s=Array.from(t);if(Ne(s[0])&&o&&!Reflect.has(s[0],o)&&(Object.keys(s[0]).some(a=>Reflect.has(r,a))||(ke(n,{[o]:s[0]}),e.splice(e.indexOf(o),1),s.shift())),s.length===1&&Ne(s[0]))ke(n,s[0]);else for(let i=0;i<e.length;i++)Q(s[i])&&(n[e[i]]=s[i]);return ke(r,n)}function Jh(r){return r.constructor.getDefaults()}function re(r,t){return Dt(r)?t:r}function de(r,t){return t.forEach(e=>{Reflect.has(r,e)&&delete r[e]}),r}var It=class{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...t){(this.debug||ze&&this.toString()===ze.TONE_DEBUG_CLASS)&&Sh(this,...t)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}};It.version=rn;function Ro(r,t){return r>t+1e-6}function vn(r,t){return Ro(r,t)||Yt(r,t)}function ns(r,t){return r+1e-6<t}function Yt(r,t){return Math.abs(r-t)<1e-6}function Ti(r,t,e){return Math.max(Math.min(r,e),t)}var Et=class extends It{constructor(){super(),this.name="Timeline",this._timeline=[];let t=g(Et.getDefaults(),arguments,["memory"]);this.memory=t.memory,this.increasing=t.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(t){if(G(Reflect.has(t,"time"),"Timeline: events must have a time attribute"),t.time=t.time.valueOf(),this.increasing&&this.length){let e=this._timeline[this.length-1];G(vn(t.time,e.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(t)}else{let e=this._search(t.time);this._timeline.splice(e+1,0,t)}if(this.length>this.memory){let e=this.length-this.memory;this._timeline.splice(0,e)}return this}remove(t){let e=this._timeline.indexOf(t);return e!==-1&&this._timeline.splice(e,1),this}get(t,e="time"){let o=this._search(t,e);return o!==-1?this._timeline[o]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(t,e="time"){let o=this._search(t,e);return o+1<this._timeline.length?this._timeline[o+1]:null}getBefore(t){let e=this._timeline.length;if(e>0&&this._timeline[e-1].time<t)return this._timeline[e-1];let o=this._search(t);return o-1>=0?this._timeline[o-1]:null}cancel(t){if(this._timeline.length>1){let e=this._search(t);if(e>=0)if(Yt(this._timeline[e].time,t)){for(let o=e;o>=0&&Yt(this._timeline[o].time,t);o--)e=o;this._timeline=this._timeline.slice(0,e)}else this._timeline=this._timeline.slice(0,e+1);else this._timeline=[]}else this._timeline.length===1&&vn(this._timeline[0].time,t)&&(this._timeline=[]);return this}cancelBefore(t){let e=this._search(t);return e>=0&&(this._timeline=this._timeline.slice(e+1)),this}previousEvent(t){let e=this._timeline.indexOf(t);return e>0?this._timeline[e-1]:null}_search(t,e="time"){if(this._timeline.length===0)return-1;let o=0,n=this._timeline.length,s=n;if(n>0&&this._timeline[n-1][e]<=t)return n-1;for(;o<s;){let i=Math.floor(o+(s-o)/2),a=this._timeline[i],c=this._timeline[i+1];if(Yt(a[e],t)){for(let u=i;u<this._timeline.length;u++){let l=this._timeline[u];if(Yt(l[e],t))i=u;else break}return i}else{if(ns(a[e],t)&&Ro(c[e],t))return i;Ro(a[e],t)?s=i:o=i+1}}return-1}_iterate(t,e=0,o=this._timeline.length-1){this._timeline.slice(e,o+1).forEach(t)}forEach(t){return this._iterate(t),this}forEachBefore(t,e){let o=this._search(t);return o!==-1&&this._iterate(e,0,o),this}forEachAfter(t,e){let o=this._search(t);return this._iterate(e,o+1),this}forEachBetween(t,e,o){let n=this._search(t),s=this._search(e);return n!==-1&&s!==-1?(this._timeline[n].time!==t&&(n+=1),this._timeline[s].time===e&&(s-=1),this._iterate(o,n,s)):n===-1&&this._iterate(o,0,s),this}forEachFrom(t,e){let o=this._search(t);for(;o>=0&&this._timeline[o].time>=t;)o--;return this._iterate(e,o+1),this}forEachAtTime(t,e){let o=this._search(t);if(o!==-1&&Yt(this._timeline[o].time,t)){let n=o;for(let s=o;s>=0&&Yt(this._timeline[s].time,t);s--)n=s;this._iterate(s=>{e(s)},n,o)}return this}dispose(){return super.dispose(),this._timeline=[],this}};var tp=[];function br(r){tp.push(r)}function ep(r){tp.forEach(t=>t(r))}var rp=[];function Ar(r){rp.push(r)}function op(r){rp.forEach(t=>t(r))}var He=class extends It{constructor(){super(...arguments),this.name="Emitter"}on(t,e){return t.split(/\W+/).forEach(n=>{Dt(this._events)&&(this._events={}),this._events.hasOwnProperty(n)||(this._events[n]=[]),this._events[n].push(e)}),this}once(t,e){let o=(...n)=>{e(...n),this.off(t,o)};return this.on(t,o),this}off(t,e){return t.split(/\W+/).forEach(n=>{if(Dt(this._events)&&(this._events={}),this._events.hasOwnProperty(t))if(Dt(e))this._events[t]=[];else{let s=this._events[t];for(let i=s.length-1;i>=0;i--)s[i]===e&&s.splice(i,1)}}),this}emit(t,...e){if(this._events&&this._events.hasOwnProperty(t)){let o=this._events[t].slice(0);for(let n=0,s=o.length;n<s;n++)o[n].apply(this,e)}return this}static mixin(t){["on","once","off","emit"].forEach(e=>{let o=Object.getOwnPropertyDescriptor(He.prototype,e);Object.defineProperty(t.prototype,e,o)})}dispose(){return super.dispose(),this._events=void 0,this}};var qo=class extends He{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}};var nr=class extends qo{constructor(){super(),this.name="Context",this._constants=new Map,this._timeouts=new Et,this._timeoutIds=0,this._initialized=!1,this.isOffline=!1,this._workletModules=new Map;let t=g(nr.getDefaults(),arguments,["context"]);t.context?this._context=t.context:this._context=Nh({latencyHint:t.latencyHint}),this._ticker=new rs(this.emit.bind(this,"tick"),t.clockSource,t.updateInterval),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this._setLatencyHint(t.latencyHint),this.lookAhead=t.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){return this._initialized||(ep(this),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(t,e,o){return this._context.createBuffer(t,e,o)}createChannelMerger(t){return this._context.createChannelMerger(t)}createChannelSplitter(t){return this._context.createChannelSplitter(t)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(t){return this._context.createDelay(t)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(t,e){return this._context.createIIRFilter(t,e)}createPanner(){return this._context.createPanner()}createPeriodicWave(t,e,o){return this._context.createPeriodicWave(t,e,o)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(t){return G(wr(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(t)}createMediaElementSource(t){return G(wr(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(t)}createMediaStreamDestination(){return G(wr(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}decodeAudioData(t){return this._context.decodeAudioData(t)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(t){G(!this._initialized,"The listener cannot be set after initialization."),this._listener=t}get transport(){return this.initialize(),this._transport}set transport(t){G(!this._initialized,"The transport cannot be set after initialization."),this._transport=t}get draw(){return this.initialize(),this._draw}set draw(t){G(!this._initialized,"Draw cannot be set after initialization."),this._draw=t}get destination(){return this.initialize(),this._destination}set destination(t){G(!this._initialized,"The destination cannot be set after initialization."),this._destination=t}createAudioWorkletNode(t,e){return Oh(this.rawContext,t,e)}addAudioWorkletModule(t,e){return et(this,void 0,void 0,function*(){G(Q(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletModules.has(e)||this._workletModules.set(e,this.rawContext.audioWorklet.addModule(t)),yield this._workletModules.get(e)})}workletsAreReady(){return et(this,void 0,void 0,function*(){let t=[];this._workletModules.forEach(e=>t.push(e)),yield Promise.all(t)})}get updateInterval(){return this._ticker.updateInterval}set updateInterval(t){this._ticker.updateInterval=t}get clockSource(){return this._ticker.type}set clockSource(t){this._ticker.type=t}get latencyHint(){return this._latencyHint}_setLatencyHint(t){let e=0;if(this._latencyHint=t,Lt(t))switch(t){case"interactive":e=.1;break;case"playback":e=.5;break;case"balanced":e=.25;break}this.lookAhead=e,this.updateInterval=e/2}get rawContext(){return this._context}now(){return this._context.currentTime+this.lookAhead}immediate(){return this._context.currentTime}resume(){return wr(this._context)?this._context.resume():Promise.resolve()}close(){return et(this,void 0,void 0,function*(){wr(this._context)&&(yield this._context.close()),this._initialized&&op(this)})}getConstant(t){if(this._constants.has(t))return this._constants.get(t);{let e=this._context.createBuffer(1,128,this._context.sampleRate),o=e.getChannelData(0);for(let s=0;s<o.length;s++)o[s]=t;let n=this._context.createBufferSource();return n.channelCount=1,n.channelCountMode="explicit",n.buffer=e,n.loop=!0,n.start(0),this._constants.set(t,n),n}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(t=>this._constants[t].disconnect()),this}_timeoutLoop(){let t=this.now(),e=this._timeouts.peek();for(;this._timeouts.length&&e&&e.time<=t;)e.callback(),this._timeouts.shift(),e=this._timeouts.peek()}setTimeout(t,e){this._timeoutIds++;let o=this.now();return this._timeouts.add({callback:t,id:this._timeoutIds,time:o+e}),this._timeoutIds}clearTimeout(t){return this._timeouts.forEach(e=>{e.id===t&&this._timeouts.remove(e)}),this}clearInterval(t){return this.clearTimeout(t)}setInterval(t,e){let o=++this._timeoutIds,n=()=>{let s=this.now();this._timeouts.add({callback:()=>{t(),n()},id:o,time:s+e})};return n(),o}};var ss=class extends qo{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(t,e,o){return{}}createChannelMerger(t){return{}}createChannelSplitter(t){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(t){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(t,e){return{}}createPanner(){return{}}createPeriodicWave(t,e,o){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(t){return{}}createMediaElementSource(t){return{}}createMediaStreamDestination(){return{}}decodeAudioData(t){return Promise.resolve({})}createAudioWorkletNode(t,e){return{}}get rawContext(){return{}}addAudioWorkletModule(t,e){return et(this,void 0,void 0,function*(){return Promise.resolve()})}resume(){return Promise.resolve()}setTimeout(t,e){return 0}clearTimeout(t){return this}setInterval(t,e){return 0}clearInterval(t){return this}getConstant(t){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(t){}get destination(){return{}}set destination(t){}now(){return 0}immediate(){return 0}};function F(r,t){Nt(t)?t.forEach(e=>F(r,e)):Object.defineProperty(r,t,{enumerable:!0,writable:!1})}function Po(r,t){Nt(t)?t.forEach(e=>Po(r,e)):Object.defineProperty(r,t,{writable:!0})}var X=()=>{};var tt=class extends It{constructor(){super(),this.name="ToneAudioBuffer",this.onload=X;let t=g(tt.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=t.reverse,this.onload=t.onload,t.url&&os(t.url)||t.url instanceof tt?this.set(t.url):Lt(t.url)&&this.load(t.url).catch(t.onerror)}static getDefaults(){return{onerror:X,onload:X,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:Ct().sampleRate}set(t){return t instanceof tt?t.loaded?this._buffer=t.get():t.onload=()=>{this.set(t),this.onload(this)}:this._buffer=t,this._reversed&&this._reverse(),this}get(){return this._buffer}load(t){return et(this,void 0,void 0,function*(){let e=tt.load(t).then(o=>{this.set(o),this.onload(this)});tt.downloads.push(e);try{yield e}finally{let o=tt.downloads.indexOf(e);tt.downloads.splice(o,1)}return this})}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(t){let e=Nt(t)&&t[0].length>0,o=e?t.length:1,n=e?t[0].length:t.length,s=Ct(),i=s.createBuffer(o,n,s.sampleRate),a=!e&&o===1?[t]:t;for(let c=0;c<o;c++)i.copyToChannel(a[c],c);return this._buffer=i,this}toMono(t){if(Gt(t))this.fromArray(this.toArray(t));else{let e=new Float32Array(this.length),o=this.numberOfChannels;for(let n=0;n<o;n++){let s=this.toArray(n);for(let i=0;i<s.length;i++)e[i]+=s[i]}e=e.map(n=>n/o),this.fromArray(e)}return this}toArray(t){if(Gt(t))return this.getChannelData(t);if(this.numberOfChannels===1)return this.toArray(0);{let e=[];for(let o=0;o<this.numberOfChannels;o++)e[o]=this.getChannelData(o);return e}}getChannelData(t){return this._buffer?this._buffer.getChannelData(t):new Float32Array(0)}slice(t,e=this.duration){let o=Math.floor(t*this.sampleRate),n=Math.floor(e*this.sampleRate);G(o<n,"The start time must be less than the end time");let s=n-o,i=Ct().createBuffer(this.numberOfChannels,s,this.sampleRate);for(let a=0;a<this.numberOfChannels;a++)i.copyToChannel(this.getChannelData(a).subarray(o,n),a);return new tt(i)}_reverse(){if(this.loaded)for(let t=0;t<this.numberOfChannels;t++)this.getChannelData(t).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(t){this._reversed!==t&&(this._reversed=t,this._reverse())}static fromArray(t){return new tt().fromArray(t)}static fromUrl(t){return et(this,void 0,void 0,function*(){return yield new tt().load(t)})}static load(t){return et(this,void 0,void 0,function*(){let e=t.match(/\[([^\]\[]+\|.+)\]$/);if(e){let a=e[1].split("|"),c=a[0];for(let u of a)if(tt.supportsType(u)){c=u;break}t=t.replace(e[0],c)}let o=tt.baseUrl===""||tt.baseUrl.endsWith("/")?tt.baseUrl:tt.baseUrl+"/",n=yield fetch(o+t);if(!n.ok)throw new Error(`could not load url: ${t}`);let s=yield n.arrayBuffer();return yield Ct().decodeAudioData(s)})}static supportsType(t){let e=t.split("."),o=e[e.length-1];return document.createElement("audio").canPlayType("audio/"+o)!==""}static loaded(){return et(this,void 0,void 0,function*(){for(yield Promise.resolve();tt.downloads.length;)yield tt.downloads[0]})}};tt.baseUrl="";tt.downloads=[];var $e=class extends nr{constructor(){super({clockSource:"offline",context:Io(arguments[0])?arguments[0]:Ch(arguments[0],arguments[1]*arguments[2],arguments[2]),lookAhead:0,updateInterval:Io(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=Io(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(t){return et(this,void 0,void 0,function*(){let e=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,e++;let o=Math.floor(this.sampleRate/128);t&&e%o===0&&(yield new Promise(n=>setTimeout(n,1)))}})}render(t=!0){return et(this,void 0,void 0,function*(){yield this.workletsAreReady(),yield this._renderClock(t);let e=yield this._context.startRendering();return new tt(e)})}close(){return Promise.resolve()}};var np=new ss,Vo=np;function Ct(){return Vo===np&&kh&&Ni(new nr),Vo}function Ni(r){wr(r)?Vo=new nr(r):Io(r)?Vo=new $e(r):Vo=r}function Ci(){return Vo.resume()}if(ze&&!ze.TONE_SILENCE_LOGGING){let r="v";rn==="dev"&&(r="");let t=` * Tone.js ${r}${rn} * `;console.log(`%c${t}`,"background: #000; color: #fff")}function Sr(r){return Math.pow(10,r/20)}function Hr(r){return 20*(Math.log(r)/Math.LN10)}function $r(r){return Math.pow(2,r/12)}var is=440;function sp(){return is}function ip(r){is=r}function Zr(r){return Math.round(ki(r))}function ki(r){return 69+12*Math.log2(r/is)}function as(r){return is*Math.pow(2,(r-69)/12)}var Lo=class extends It{constructor(t,e,o){super(),this.defaultUnits="s",this._val=e,this._units=o,this.context=t,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:t=>this._frequencyToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:t=>this._ticksToUnits(parseInt(t,10)),regexp:/^(\d+)i$/i},m:{method:t=>this._beatsToUnits(parseInt(t,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(t,e)=>{let o=parseInt(t,10),n=e==="."?1.5:1;return o===1?this._beatsToUnits(this._getTimeSignature())*n:this._beatsToUnits(4/o)*n},regexp:/^(\d+)n(\.?)$/i},number:{method:t=>this._expressions[this.defaultUnits].method.call(this,t),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:t=>this._secondsToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:t=>parseInt(t,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:t=>{let e=parseInt(t,10);return this._beatsToUnits(8/(Math.floor(e)*3))},regexp:/^(\d+)t$/i},tr:{method:(t,e,o)=>{let n=0;return t&&t!=="0"&&(n+=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&e!=="0"&&(n+=this._beatsToUnits(parseFloat(e))),o&&o!=="0"&&(n+=this._beatsToUnits(parseFloat(o)/4)),n},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof Lo&&this.fromType(this._val),Dt(this._val))return this._noArg();if(Lt(this._val)&&Dt(this._units)){for(let t in this._expressions)if(this._expressions[t].regexp.test(this._val.trim())){this._units=t;break}}else if(Ne(this._val)){let t=0;for(let e in this._val)if(Q(this._val[e])){let o=this._val[e],n=new this.constructor(this.context,e).valueOf()*o;t+=n}return t}if(Q(this._units)){let t=this._expressions[this._units],e=this._val.toString().trim().match(t.regexp);return e?t.method.apply(this,e.slice(1)):t.method.call(this,this._val)}else return Lt(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(t){return 1/t}_beatsToUnits(t){return 60/this._getBpm()*t}_secondsToUnits(t){return t}_ticksToUnits(t){return t*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(t){switch(this._units=void 0,this.defaultUnits){case"s":this._val=t.toSeconds();break;case"i":this._val=t.toTicks();break;case"hz":this._val=t.toFrequency();break;case"midi":this._val=t.toMidi();break}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return this.toSeconds()*1e3}};var zt=class extends Lo{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:t=>this._now()+new this.constructor(this.context,t).valueOf(),regexp:/^\+(.+)/},quantize:{method:t=>{let e=new zt(this.context,t).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(e))},regexp:/^@(.+)/}})}quantize(t,e=1){let o=new this.constructor(this.context,t).valueOf(),n=this.valueOf(),a=Math.round(n/o)*o-n;return n+a*e}toNotation(){let t=this.toSeconds(),e=["1m"];for(let s=1;s<9;s++){let i=Math.pow(2,s);e.push(i+"n."),e.push(i+"n"),e.push(i+"t")}e.push("0");let o=e[0],n=new zt(this.context,e[0]).toSeconds();return e.forEach(s=>{let i=new zt(this.context,s).toSeconds();Math.abs(i-t)<Math.abs(n-t)&&(o=s,n=i)}),o}toBarsBeatsSixteenths(){let t=this._beatsToUnits(1),e=this.valueOf()/t;e=parseFloat(e.toFixed(4));let o=Math.floor(e/this._getTimeSignature()),n=e%1*4;e=Math.floor(e)%this._getTimeSignature();let s=n.toString();return s.length>3&&(n=parseFloat(parseFloat(s).toFixed(3))),[o,e,n].join(":")}toTicks(){let t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.round(e*this._getPPQ())}toSeconds(){return this.valueOf()}toMidi(){return Zr(this.toFrequency())}_now(){return this.context.now()}};var Rt=class extends zt{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return sp()}static set A4(t){ip(t)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(t){return this.defaultUnits==="midi"?t:Rt.mtof(t)}},note:{regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method(t,e){let n=Ng[t.toLowerCase()]+(parseInt(e,10)+1)*12;return this.defaultUnits==="midi"?n:Rt.mtof(n)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(t,e,o){let n=1;return t&&t!=="0"&&(n*=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&e!=="0"&&(n*=this._beatsToUnits(parseFloat(e))),o&&o!=="0"&&(n*=this._beatsToUnits(parseFloat(o)/4)),n}}})}transpose(t){return new Rt(this.context,this.valueOf()*$r(t))}harmonize(t){return t.map(e=>this.transpose(e))}toMidi(){return Zr(this.valueOf())}toNote(){let t=this.toFrequency(),e=Math.log2(t/Rt.A4),o=Math.round(12*e)+57,n=Math.floor(o/12);return n<0&&(o+=-12*n),Cg[o%12]+n.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){let t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.floor(e*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(t){return t}_ticksToUnits(t){return 1/(t*60/(this._getBpm()*this._getPPQ()))}_beatsToUnits(t){return 1/super._beatsToUnits(t)}_secondsToUnits(t){return 1/t}static mtof(t){return as(t)}static ftom(t){return Zr(t)}},Ng={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},Cg=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];var ge=class extends zt{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}};var ft=class extends It{constructor(){super();let t=g(ft.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=t.context}static getDefaults(){return{context:Ct()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(t){return new zt(this.context,t).toSeconds()}toFrequency(t){return new Rt(this.context,t).toFrequency()}toTicks(t){return new ge(this.context,t).toTicks()}_getPartialProperties(t){let e=this.get();return Object.keys(e).forEach(o=>{Dt(t[o])&&delete e[o]}),e}get(){let t=Jh(this);return Object.keys(t).forEach(e=>{if(Reflect.has(this,e)){let o=this[e];Q(o)&&Q(o.value)&&Q(o.setValueAtTime)?t[e]=o.value:o instanceof ft?t[e]=o._getPartialProperties(t[e]):Nt(o)||Gt(o)||Lt(o)||Kn(o)?t[e]=o:delete t[e]}}),t}set(t){return Object.keys(t).forEach(e=>{Reflect.has(this,e)&&Q(this[e])&&(this[e]&&Q(this[e].value)&&Q(this[e].setValueAtTime)?this[e].value!==t[e]&&(this[e].value=t[e]):this[e]instanceof ft?this[e].set(t[e]):this[e]=t[e])}),this}};var Oe=class extends Et{constructor(t="stopped"){super(),this.name="StateTimeline",this._initial=t,this.setStateAtTime(this._initial,0)}getValueAtTime(t){let e=this.get(t);return e!==null?e.state:this._initial}setStateAtTime(t,e,o){return Vt(e,0),this.add(Object.assign({},o,{state:t,time:e})),this}getLastState(t,e){let o=this._search(e);for(let n=o;n>=0;n--){let s=this._timeline[n];if(s.state===t)return s}}getNextState(t,e){let o=this._search(e);if(o!==-1)for(let n=o;n<this._timeline.length;n++){let s=this._timeline[n];if(s.state===t)return s}}};var Y=class extends ft{constructor(){super(g(Y.getDefaults(),arguments,["param","units","convert"])),this.name="Param",this.overridden=!1,this._minOutput=1e-7;let t=g(Y.getDefaults(),arguments,["param","units","convert"]);for(G(Q(t.param)&&(Ce(t.param)||t.param instanceof Y),"param must be an AudioParam");!Ce(t.param);)t.param=t.param._param;this._swappable=Q(t.swappable)?t.swappable:!1,this._swappable?(this.input=this.context.createGain(),this._param=t.param,this.input.connect(this._param)):this._param=this.input=t.param,this._events=new Et(1e3),this._initialValue=this._param.defaultValue,this.units=t.units,this.convert=t.convert,this._minValue=t.minValue,this._maxValue=t.maxValue,Q(t.value)&&t.value!==this._toType(this._initialValue)&&this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(ft.getDefaults(),{convert:!0,units:"number"})}get value(){let t=this.now();return this.getValueAtTime(t)}set value(t){this.cancelScheduledValues(this.now()),this.setValueAtTime(t,this.now())}get minValue(){return Q(this._minValue)?this._minValue:this.units==="time"||this.units==="frequency"||this.units==="normalRange"||this.units==="positive"||this.units==="transportTime"||this.units==="ticks"||this.units==="bpm"||this.units==="hertz"||this.units==="samples"?0:this.units==="audioRange"?-1:this.units==="decibels"?-1/0:this._param.minValue}get maxValue(){return Q(this._maxValue)?this._maxValue:this.units==="normalRange"||this.units==="audioRange"?1:this._param.maxValue}_is(t,e){return this.units===e}_assertRange(t){return Q(this.maxValue)&&Q(this.minValue)&&Vt(t,this._fromType(this.minValue),this._fromType(this.maxValue)),t}_fromType(t){return this.convert&&!this.overridden?this._is(t,"time")?this.toSeconds(t):this._is(t,"decibels")?Sr(t):this._is(t,"frequency")?this.toFrequency(t):t:this.overridden?0:t}_toType(t){return this.convert&&this.units==="decibels"?Hr(t):t}setValueAtTime(t,e){let o=this.toSeconds(e),n=this._fromType(t);return G(isFinite(n)&&isFinite(o),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(n),this.log(this.units,"setValueAtTime",t,o),this._events.add({time:o,type:"setValueAtTime",value:n}),this._param.setValueAtTime(n,o),this}getValueAtTime(t){let e=Math.max(this.toSeconds(t),0),o=this._events.getAfter(e),n=this._events.get(e),s=this._initialValue;if(n===null)s=this._initialValue;else if(n.type==="setTargetAtTime"&&(o===null||o.type==="setValueAtTime")){let i=this._events.getBefore(n.time),a;i===null?a=this._initialValue:a=i.value,n.type==="setTargetAtTime"&&(s=this._exponentialApproach(n.time,a,n.value,n.constant,e))}else if(o===null)s=n.value;else if(o.type==="linearRampToValueAtTime"||o.type==="exponentialRampToValueAtTime"){let i=n.value;if(n.type==="setTargetAtTime"){let a=this._events.getBefore(n.time);a===null?i=this._initialValue:i=a.value}o.type==="linearRampToValueAtTime"?s=this._linearInterpolate(n.time,i,o.time,o.value,e):s=this._exponentialInterpolate(n.time,i,o.time,o.value,e)}else s=n.value;return this._toType(s)}setRampPoint(t){t=this.toSeconds(t);let e=this.getValueAtTime(t);return this.cancelAndHoldAtTime(t),this._fromType(e)===0&&(e=this._toType(this._minOutput)),this.setValueAtTime(e,t),this}linearRampToValueAtTime(t,e){let o=this._fromType(t),n=this.toSeconds(e);return G(isFinite(o)&&isFinite(n),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(o),this._events.add({time:n,type:"linearRampToValueAtTime",value:o}),this.log(this.units,"linearRampToValueAtTime",t,n),this._param.linearRampToValueAtTime(o,n),this}exponentialRampToValueAtTime(t,e){let o=this._fromType(t);o=Yt(o,0)?this._minOutput:o,this._assertRange(o);let n=this.toSeconds(e);return G(isFinite(o)&&isFinite(n),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({time:n,type:"exponentialRampToValueAtTime",value:o}),this.log(this.units,"exponentialRampToValueAtTime",t,n),this._param.exponentialRampToValueAtTime(o,n),this}exponentialRampTo(t,e,o){return o=this.toSeconds(o),this.setRampPoint(o),this.exponentialRampToValueAtTime(t,o+this.toSeconds(e)),this}linearRampTo(t,e,o){return o=this.toSeconds(o),this.setRampPoint(o),this.linearRampToValueAtTime(t,o+this.toSeconds(e)),this}targetRampTo(t,e,o){return o=this.toSeconds(o),this.setRampPoint(o),this.exponentialApproachValueAtTime(t,o,e),this}exponentialApproachValueAtTime(t,e,o){e=this.toSeconds(e),o=this.toSeconds(o);let n=Math.log(o+1)/Math.log(200);return this.setTargetAtTime(t,e,n),this.cancelAndHoldAtTime(e+o*.9),this.linearRampToValueAtTime(t,e+o),this}setTargetAtTime(t,e,o){let n=this._fromType(t);G(isFinite(o)&&o>0,"timeConstant must be a number greater than 0");let s=this.toSeconds(e);return this._assertRange(n),G(isFinite(n)&&isFinite(s),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({constant:o,time:s,type:"setTargetAtTime",value:n}),this.log(this.units,"setTargetAtTime",t,s,o),this._param.setTargetAtTime(n,s,o),this}setValueCurveAtTime(t,e,o,n=1){o=this.toSeconds(o),e=this.toSeconds(e);let s=this._fromType(t[0])*n;this.setValueAtTime(this._toType(s),e);let i=o/(t.length-1);for(let a=1;a<t.length;a++){let c=this._fromType(t[a])*n;this.linearRampToValueAtTime(this._toType(c),e+a*i)}return this}cancelScheduledValues(t){let e=this.toSeconds(t);return G(isFinite(e),`Invalid argument to cancelScheduledValues: ${JSON.stringify(t)}`),this._events.cancel(e),this._param.cancelScheduledValues(e),this.log(this.units,"cancelScheduledValues",e),this}cancelAndHoldAtTime(t){let e=this.toSeconds(t),o=this._fromType(this.getValueAtTime(e));G(isFinite(e),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(t)}`),this.log(this.units,"cancelAndHoldAtTime",e,"value="+o);let n=this._events.get(e),s=this._events.getAfter(e);return n&&Yt(n.time,e)?s?(this._param.cancelScheduledValues(s.time),this._events.cancel(s.time)):(this._param.cancelAndHoldAtTime(e),this._events.cancel(e+this.sampleTime)):s&&(this._param.cancelScheduledValues(s.time),this._events.cancel(s.time),s.type==="linearRampToValueAtTime"?this.linearRampToValueAtTime(this._toType(o),e):s.type==="exponentialRampToValueAtTime"&&this.exponentialRampToValueAtTime(this._toType(o),e)),this._events.add({time:e,type:"setValueAtTime",value:o}),this._param.setValueAtTime(o,e),this}rampTo(t,e=.1,o){return this.units==="frequency"||this.units==="bpm"||this.units==="decibels"?this.exponentialRampTo(t,e,o):this.linearRampTo(t,e,o),this}apply(t){let e=this.context.currentTime;t.setValueAtTime(this.getValueAtTime(e),e);let o=this._events.get(e);if(o&&o.type==="setTargetAtTime"){let n=this._events.getAfter(o.time),s=n?n.time:e+2,i=(s-e)/10;for(let a=e;a<s;a+=i)t.linearRampToValueAtTime(this.getValueAtTime(a),a)}return this._events.forEachAfter(this.context.currentTime,n=>{n.type==="cancelScheduledValues"?t.cancelScheduledValues(n.time):n.type==="setTargetAtTime"?t.setTargetAtTime(n.value,n.time,n.constant):t[n.type](n.value,n.time)}),this}setParam(t){G(this._swappable,"The Param must be assigned as 'swappable' in the constructor");let e=this.input;return e.disconnect(this._param),this.apply(t),this._param=t,e.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(t,e,o,n,s){return o+(e-o)*Math.exp(-(s-t)/n)}_linearInterpolate(t,e,o,n,s){return e+(n-e)*((s-t)/(o-t))}_exponentialInterpolate(t,e,o,n,s){return e*Math.pow(n/e,(s-t)/(o-t))}};var C=class extends ft{constructor(){super(...arguments),this.name="ToneAudioNode",this._internalChannels=[]}get numberOfInputs(){return Q(this.input)?Ce(this.input)||this.input instanceof Y?1:this.input.numberOfInputs:0}get numberOfOutputs(){return Q(this.output)?this.output.numberOfOutputs:0}_isAudioNode(t){return Q(t)&&(t instanceof C||Ue(t))}_getInternalNodes(){let t=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&t.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&t.push(this.output),t}_setChannelProperties(t){this._getInternalNodes().forEach(o=>{o.channelCount=t.channelCount,o.channelCountMode=t.channelCountMode,o.channelInterpretation=t.channelInterpretation})}_getChannelProperties(){let t=this._getInternalNodes();G(t.length>0,"ToneAudioNode does not have any internal nodes");let e=t[0];return{channelCount:e.channelCount,channelCountMode:e.channelCountMode,channelInterpretation:e.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(t){let e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCount:t}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(t){let e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCountMode:t}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(t){let e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelInterpretation:t}))}connect(t,e=0,o=0){return Ut(this,t,e,o),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return xn("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(t,e=0,o=0){return ap(this,t,e,o),this}chain(...t){return ce(this,...t),this}fan(...t){return t.forEach(e=>this.connect(e)),this}dispose(){return super.dispose(),Q(this.input)&&(this.input instanceof C?this.input.dispose():Ue(this.input)&&this.input.disconnect()),Q(this.output)&&(this.output instanceof C?this.output.dispose():Ue(this.output)&&this.output.disconnect()),this._internalChannels=[],this}};function ce(...r){let t=r.shift();r.reduce((e,o)=>(e instanceof C?e.connect(o):Ue(e)&&Ut(e,o),o),t)}function Ut(r,t,e=0,o=0){for(G(Q(r),"Cannot connect from undefined node"),G(Q(t),"Cannot connect to undefined node"),(t instanceof C||Ue(t))&&G(t.numberOfInputs>0,"Cannot connect to node with no inputs"),G(r.numberOfOutputs>0,"Cannot connect from node with no outputs");t instanceof C||t instanceof Y;)Q(t.input)&&(t=t.input);for(;r instanceof C;)Q(r.output)&&(r=r.output);Ce(t)?r.connect(t,e):r.connect(t,e,o)}function ap(r,t,e=0,o=0){if(Q(t))for(;t instanceof C;)t=t.input;for(;!Ue(r);)Q(r.output)&&(r=r.output);Ce(t)?r.disconnect(t,e):Ue(t)?r.disconnect(t,e,o):r.disconnect()}var L=class extends C{constructor(){super(g(L.getDefaults(),arguments,["gain","units"])),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;let t=g(L.getDefaults(),arguments,["gain","units"]);this.gain=new Y({context:this.context,convert:t.convert,param:this._gainNode.gain,units:t.units,value:t.gain,minValue:t.minValue,maxValue:t.maxValue}),F(this,"gain")}static getDefaults(){return Object.assign(C.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}};var De=class extends C{constructor(t){super(t),this.onended=X,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new L({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(e){let o=this.toSeconds(e);return this._startTime!==-1&&o>=this._startTime&&(this._stopTime===-1||o<=this._stopTime)?"started":"stopped"},this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut,this._curve=t.curve,this.onended=t.onended}static getDefaults(){return Object.assign(C.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:X})}_startGain(t,e=1){G(this._startTime===-1,"Source cannot be started more than once");let o=this.toSeconds(this._fadeIn);return this._startTime=t+o,this._startTime=Math.max(this._startTime,this.context.currentTime),o>0?(this._gainNode.gain.setValueAtTime(0,t),this._curve==="linear"?this._gainNode.gain.linearRampToValueAtTime(e,t+o):this._gainNode.gain.exponentialApproachValueAtTime(e,t,o)):this._gainNode.gain.setValueAtTime(e,t),this}stop(t){return this.log("stop",t),this._stopGain(this.toSeconds(t)),this}_stopGain(t){G(this._startTime!==-1,"'start' must be called before 'stop'"),this.cancelStop();let e=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(t)+e,this._stopTime=Math.max(this._stopTime,this.context.currentTime),e>0?this._curve==="linear"?this._gainNode.gain.linearRampTo(0,e,t):this._gainNode.gain.targetRampTo(0,e,t):(this._gainNode.gain.cancelAndHoldAtTime(t),this._gainNode.gain.setValueAtTime(0,t)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{let o=this._curve==="exponential"?e*2:0;this._stopSource(this.now()+o),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==X&&(this.onended(this),this.onended=X,!this.context.isOffline)){let t=()=>this.dispose();typeof window.requestIdleCallback<"u"?window.requestIdleCallback(t):setTimeout(t,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),G(this._startTime!==-1,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.disconnect(),this}};var Tr=class extends De{constructor(){super(g(Tr.getDefaults(),arguments,["offset"])),this.name="ToneConstantSource",this._source=this.context.createConstantSource();let t=g(Tr.getDefaults(),arguments,["offset"]);Ut(this._source,this._gainNode),this.offset=new Y({context:this.context,convert:t.convert,param:this._source.offset,units:t.units,value:t.offset,minValue:t.minValue,maxValue:t.maxValue})}static getDefaults(){return Object.assign(De.getDefaults(),{convert:!0,offset:1,units:"number"})}start(t){let e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._source.start(e),this}_stopSource(t){this._source.stop(t)}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}};var $=class extends C{constructor(){super(g($.getDefaults(),arguments,["value","units"])),this.name="Signal",this.override=!0;let t=g($.getDefaults(),arguments,["value","units"]);this.output=this._constantSource=new Tr({context:this.context,convert:t.convert,offset:t.value,units:t.units,minValue:t.minValue,maxValue:t.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(C.getDefaults(),{convert:!0,units:"number",value:0})}connect(t,e=0,o=0){return Bo(this,t,e,o),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(t,e){return this._param.setValueAtTime(t,e),this}getValueAtTime(t){return this._param.getValueAtTime(t)}setRampPoint(t){return this._param.setRampPoint(t),this}linearRampToValueAtTime(t,e){return this._param.linearRampToValueAtTime(t,e),this}exponentialRampToValueAtTime(t,e){return this._param.exponentialRampToValueAtTime(t,e),this}exponentialRampTo(t,e,o){return this._param.exponentialRampTo(t,e,o),this}linearRampTo(t,e,o){return this._param.linearRampTo(t,e,o),this}targetRampTo(t,e,o){return this._param.targetRampTo(t,e,o),this}exponentialApproachValueAtTime(t,e,o){return this._param.exponentialApproachValueAtTime(t,e,o),this}setTargetAtTime(t,e,o){return this._param.setTargetAtTime(t,e,o),this}setValueCurveAtTime(t,e,o,n){return this._param.setValueCurveAtTime(t,e,o,n),this}cancelScheduledValues(t){return this._param.cancelScheduledValues(t),this}cancelAndHoldAtTime(t){return this._param.cancelAndHoldAtTime(t),this}rampTo(t,e,o){return this._param.rampTo(t,e,o),this}get value(){return this._param.value}set value(t){this._param.value=t}get convert(){return this._param.convert}set convert(t){this._param.convert=t}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(t){this._param.overridden=t}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(t){return this._param.apply(t),this}};function Bo(r,t,e,o){(t instanceof Y||Ce(t)||t instanceof $&&t.override)&&(t.cancelScheduledValues(0),t.setValueAtTime(0,0),t instanceof $&&(t.overridden=!0)),Ut(r,t,e,o)}var Qr=class extends Y{constructor(){super(g(Qr.getDefaults(),arguments,["value"])),this.name="TickParam",this._events=new Et(1/0),this._multiplier=1;let t=g(Qr.getDefaults(),arguments,["value"]);this._multiplier=t.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(t.value)}),this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(Y.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(t,e,o){e=this.toSeconds(e),this.setRampPoint(e);let n=this._fromType(t),s=this._events.get(e),i=Math.round(Math.max(1/o,1));for(let a=0;a<=i;a++){let c=o*a+e,u=this._exponentialApproach(s.time,s.value,n,o,c);this.linearRampToValueAtTime(this._toType(u),c)}return this}setValueAtTime(t,e){let o=this.toSeconds(e);super.setValueAtTime(t,e);let n=this._events.get(o),s=this._events.previousEvent(n),i=this._getTicksUntilEvent(s,o);return n.ticks=Math.max(i,0),this}linearRampToValueAtTime(t,e){let o=this.toSeconds(e);super.linearRampToValueAtTime(t,e);let n=this._events.get(o),s=this._events.previousEvent(n),i=this._getTicksUntilEvent(s,o);return n.ticks=Math.max(i,0),this}exponentialRampToValueAtTime(t,e){e=this.toSeconds(e);let o=this._fromType(t),n=this._events.get(e),s=Math.round(Math.max((e-n.time)*10,1)),i=(e-n.time)/s;for(let a=0;a<=s;a++){let c=i*a+n.time,u=this._exponentialInterpolate(n.time,n.value,e,o,c);this.linearRampToValueAtTime(this._toType(u),c)}return this}_getTicksUntilEvent(t,e){if(t===null)t={ticks:0,time:0,type:"setValueAtTime",value:0};else if(Dt(t.ticks)){let i=this._events.previousEvent(t);t.ticks=this._getTicksUntilEvent(i,t.time)}let o=this._fromType(this.getValueAtTime(t.time)),n=this._fromType(this.getValueAtTime(e)),s=this._events.get(e);return s&&s.time===e&&s.type==="setValueAtTime"&&(n=this._fromType(this.getValueAtTime(e-this.sampleTime))),.5*(e-t.time)*(o+n)+t.ticks}getTicksAtTime(t){let e=this.toSeconds(t),o=this._events.get(e);return Math.max(this._getTicksUntilEvent(o,e),0)}getDurationOfTicks(t,e){let o=this.toSeconds(e),n=this.getTicksAtTime(e);return this.getTimeOfTick(n+t)-o}getTimeOfTick(t){let e=this._events.get(t,"ticks"),o=this._events.getAfter(t,"ticks");if(e&&e.ticks===t)return e.time;if(e&&o&&o.type==="linearRampToValueAtTime"&&e.value!==o.value){let n=this._fromType(this.getValueAtTime(e.time)),i=(this._fromType(this.getValueAtTime(o.time))-n)/(o.time-e.time),a=Math.sqrt(Math.pow(n,2)-2*i*(e.ticks-t)),c=(-n+a)/i,u=(-n-a)/i;return(c>0?c:u)+e.time}else return e?e.value===0?1/0:e.time+(t-e.ticks)/e.value:t/this._initialValue}ticksToTime(t,e){return this.getDurationOfTicks(t,e)}timeToTicks(t,e){let o=this.toSeconds(e),n=this.toSeconds(t),s=this.getTicksAtTime(o);return this.getTicksAtTime(o+n)-s}_fromType(t){return this.units==="bpm"&&this.multiplier?1/(60/t/this.multiplier):super._fromType(t)}_toType(t){return this.units==="bpm"&&this.multiplier?t/this.multiplier*60:super._toType(t)}get multiplier(){return this._multiplier}set multiplier(t){let e=this.value;this._multiplier=t,this.cancelScheduledValues(0),this.setValueAtTime(e,0)}};var Xr=class extends ${constructor(){super(g(Xr.getDefaults(),arguments,["value"])),this.name="TickSignal";let t=g(Xr.getDefaults(),arguments,["value"]);this.input=this._param=new Qr({context:this.context,convert:t.convert,multiplier:t.multiplier,param:this._constantSource.offset,units:t.units,value:t.value})}static getDefaults(){return Object.assign($.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(t,e){return this._param.ticksToTime(t,e)}timeToTicks(t,e){return this._param.timeToTicks(t,e)}getTimeOfTick(t){return this._param.getTimeOfTick(t)}getDurationOfTicks(t,e){return this._param.getDurationOfTicks(t,e)}getTicksAtTime(t){return this._param.getTicksAtTime(t)}get multiplier(){return this._param.multiplier}set multiplier(t){this._param.multiplier=t}dispose(){return super.dispose(),this._param.dispose(),this}};var Yr=class extends ft{constructor(){super(g(Yr.getDefaults(),arguments,["frequency"])),this.name="TickSource",this._state=new Oe,this._tickOffset=new Et;let t=g(Yr.getDefaults(),arguments,["frequency"]);this.frequency=new Xr({context:this.context,units:t.units,value:t.frequency}),F(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},ft.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(t,e){let o=this.toSeconds(t);return this._state.getValueAtTime(o)!=="started"&&(this._state.setStateAtTime("started",o),Q(e)&&this.setTicksAtTime(e,o)),this}stop(t){let e=this.toSeconds(t);if(this._state.getValueAtTime(e)==="stopped"){let o=this._state.get(e);o&&o.time>0&&(this._tickOffset.cancel(o.time),this._state.cancel(o.time))}return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this.setTicksAtTime(0,e),this}pause(t){let e=this.toSeconds(t);return this._state.getValueAtTime(e)==="started"&&this._state.setStateAtTime("paused",e),this}cancel(t){return t=this.toSeconds(t),this._state.cancel(t),this._tickOffset.cancel(t),this}getTicksAtTime(t){let e=this.toSeconds(t),o=this._state.getLastState("stopped",e),n={state:"paused",time:e};this._state.add(n);let s=o,i=0;return this._state.forEachBetween(o.time,e+this.sampleTime,a=>{let c=s.time,u=this._tickOffset.get(a.time);u&&u.time>=s.time&&(i=u.ticks,c=u.time),s.state==="started"&&a.state!=="started"&&(i+=this.frequency.getTicksAtTime(a.time)-this.frequency.getTicksAtTime(c)),s=a}),this._state.remove(n),i}get ticks(){return this.getTicksAtTime(this.now())}set ticks(t){this.setTicksAtTime(t,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(t){let e=this.now(),o=this.frequency.timeToTicks(t,e);this.setTicksAtTime(o,e)}getSecondsAtTime(t){t=this.toSeconds(t);let e=this._state.getLastState("stopped",t),o={state:"paused",time:t};this._state.add(o);let n=e,s=0;return this._state.forEachBetween(e.time,t+this.sampleTime,i=>{let a=n.time,c=this._tickOffset.get(i.time);c&&c.time>=n.time&&(s=c.seconds,a=c.time),n.state==="started"&&i.state!=="started"&&(s+=i.time-a),n=i}),this._state.remove(o),s}setTicksAtTime(t,e){return e=this.toSeconds(e),this._tickOffset.cancel(e),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(t,e),ticks:t,time:e}),this}getStateAtTime(t){return t=this.toSeconds(t),this._state.getValueAtTime(t)}getTimeOfTick(t,e=this.now()){let o=this._tickOffset.get(e),n=this._state.get(e),s=Math.max(o.time,n.time),i=this.frequency.getTicksAtTime(s)+t-o.ticks;return this.frequency.getTimeOfTick(i)}forEachTickBetween(t,e,o){let n=this._state.get(t);this._state.forEachBetween(t,e,i=>{n&&n.state==="started"&&i.state!=="started"&&this.forEachTickBetween(Math.max(n.time,t),i.time-this.sampleTime,o),n=i});let s=null;if(n&&n.state==="started"){let i=Math.max(n.time,t),a=this.frequency.getTicksAtTime(i),c=this.frequency.getTicksAtTime(n.time),u=a-c,l=Math.ceil(u)-u;l=Yt(l,1)?0:l;let h=this.frequency.getTimeOfTick(a+l);for(;h<e;){try{o(h,Math.round(this.getTicksAtTime(h)))}catch(p){s=p;break}h+=this.frequency.getDurationOfTicks(1,h)}}if(s)throw s;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this.frequency.dispose(),this}};var sr=class extends ft{constructor(){super(g(sr.getDefaults(),arguments,["callback","frequency"])),this.name="Clock",this.callback=X,this._lastUpdate=0,this._state=new Oe("stopped"),this._boundLoop=this._loop.bind(this);let t=g(sr.getDefaults(),arguments,["callback","frequency"]);this.callback=t.callback,this._tickSource=new Yr({context:this.context,frequency:t.frequency,units:t.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,F(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(ft.getDefaults(),{callback:X,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(t,e){Yn(this.context);let o=this.toSeconds(t);return this.log("start",o),this._state.getValueAtTime(o)!=="started"&&(this._state.setStateAtTime("started",o),this._tickSource.start(o,e),o<this._lastUpdate&&this.emit("start",o,e)),this}stop(t){let e=this.toSeconds(t);return this.log("stop",e),this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._tickSource.stop(e),e<this._lastUpdate&&this.emit("stop",e),this}pause(t){let e=this.toSeconds(t);return this._state.getValueAtTime(e)==="started"&&(this._state.setStateAtTime("paused",e),this._tickSource.pause(e),e<this._lastUpdate&&this.emit("pause",e)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(t){this._tickSource.ticks=t}get seconds(){return this._tickSource.seconds}set seconds(t){this._tickSource.seconds=t}getSecondsAtTime(t){return this._tickSource.getSecondsAtTime(t)}setTicksAtTime(t,e){return this._tickSource.setTicksAtTime(t,e),this}getTimeOfTick(t,e=this.now()){return this._tickSource.getTimeOfTick(t,e)}getTicksAtTime(t){return this._tickSource.getTicksAtTime(t)}nextTickTime(t,e){let o=this.toSeconds(e),n=this.getTicksAtTime(o);return this._tickSource.getTimeOfTick(n+t,o)}_loop(){let t=this._lastUpdate,e=this.now();this._lastUpdate=e,this.log("loop",t,e),t!==e&&(this._state.forEachBetween(t,e,o=>{switch(o.state){case"started":let n=this._tickSource.getTicksAtTime(o.time);this.emit("start",o.time,n);break;case"stopped":o.time!==0&&this.emit("stop",o.time);break;case"paused":this.emit("pause",o.time);break}}),this._tickSource.forEachTickBetween(t,e,(o,n)=>{this.callback(o,n)}))}getStateAtTime(t){let e=this.toSeconds(t);return this._state.getValueAtTime(e)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}};He.mixin(sr);var Ee=class extends C{constructor(){super(g(Ee.getDefaults(),arguments,["delayTime","maxDelay"])),this.name="Delay";let t=g(Ee.getDefaults(),arguments,["delayTime","maxDelay"]),e=this.toSeconds(t.maxDelay);this._maxDelay=Math.max(e,this.toSeconds(t.delayTime)),this._delayNode=this.input=this.output=this.context.createDelay(e),this.delayTime=new Y({context:this.context,param:this._delayNode.delayTime,units:"time",value:t.delayTime,minValue:0,maxValue:this.maxDelay}),F(this,"delayTime")}static getDefaults(){return Object.assign(C.getDefaults(),{delayTime:0,maxDelay:1})}get maxDelay(){return this._maxDelay}dispose(){return super.dispose(),this._delayNode.disconnect(),this.delayTime.dispose(),this}};var Nr=class extends It{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;let t=g(Nr.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=t.baseUrl,Object.keys(t.urls).forEach(e=>{this._loadingCount++;let o=t.urls[e];this.add(e,o,this._bufferLoaded.bind(this,t.onload),t.onerror)})}static getDefaults(){return{baseUrl:"",onerror:X,onload:X,urls:{}}}has(t){return this._buffers.has(t.toString())}get(t){return G(this.has(t),`ToneAudioBuffers has no buffer named: ${t}`),this._buffers.get(t.toString())}_bufferLoaded(t){this._loadingCount--,this._loadingCount===0&&t&&t()}get loaded(){return Array.from(this._buffers).every(([t,e])=>e.loaded)}add(t,e,o=X,n=X){return Lt(e)?this._buffers.set(t.toString(),new tt(this.baseUrl+e,o,n)):this._buffers.set(t.toString(),new tt(e,o,n)),this}dispose(){return super.dispose(),this._buffers.forEach(t=>t.dispose()),this._buffers.clear(),this}};var bt=class extends ge{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(t){return this._getPPQ()*t}_secondsToUnits(t){return Math.floor(t/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(t){return t}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}};var Oi=class extends ft{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new Et,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(t,e){return this._events.add({callback:t,time:this.toSeconds(e)}),this._events.length===1&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(t){return this._events.cancel(this.toSeconds(t)),this}_drawLoop(){let t=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=t;){let e=this._events.shift();e&&t-e.time<=this.expiration&&e.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}};br(r=>{r.draw=new Oi({context:r})});Ar(r=>{r.draw.dispose()});var cs=class extends It{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(t){G(Q(t.time),"Events must have a time property"),G(Q(t.duration),"Events must have a duration parameter"),t.time=t.time.valueOf();let e=new Di(t.time,t.time+t.duration,t);for(this._root===null?this._root=e:this._root.insert(e),this._length++;e!==null;)e.updateHeight(),e.updateMax(),this._rebalance(e),e=e.parent;return this}remove(t){if(this._root!==null){let e=[];this._root.search(t.time,e);for(let o of e)if(o.event===t){this._removeNode(o),this._length--;break}}return this}get length(){return this._length}cancel(t){return this.forEachFrom(t,e=>this.remove(e)),this}_setRoot(t){this._root=t,this._root!==null&&(this._root.parent=null)}_replaceNodeInParent(t,e){t.parent!==null?(t.isLeftChild()?t.parent.left=e:t.parent.right=e,this._rebalance(t.parent)):this._setRoot(e)}_removeNode(t){if(t.left===null&&t.right===null)this._replaceNodeInParent(t,null);else if(t.right===null)this._replaceNodeInParent(t,t.left);else if(t.left===null)this._replaceNodeInParent(t,t.right);else{let e=t.getBalance(),o,n=null;if(e>0)if(t.left.right===null)o=t.left,o.right=t.right,n=o;else{for(o=t.left.right;o.right!==null;)o=o.right;o.parent&&(o.parent.right=o.left,n=o.parent,o.left=t.left,o.right=t.right)}else if(t.right.left===null)o=t.right,o.left=t.left,n=o;else{for(o=t.right.left;o.left!==null;)o=o.left;o.parent&&(o.parent.left=o.right,n=o.parent,o.left=t.left,o.right=t.right)}t.parent!==null?t.isLeftChild()?t.parent.left=o:t.parent.right=o:this._setRoot(o),n&&this._rebalance(n)}t.dispose()}_rotateLeft(t){let e=t.parent,o=t.isLeftChild(),n=t.right;n&&(t.right=n.left,n.left=t),e!==null?o?e.left=n:e.right=n:this._setRoot(n)}_rotateRight(t){let e=t.parent,o=t.isLeftChild(),n=t.left;n&&(t.left=n.right,n.right=t),e!==null?o?e.left=n:e.right=n:this._setRoot(n)}_rebalance(t){let e=t.getBalance();e>1&&t.left?t.left.getBalance()<0?this._rotateLeft(t.left):this._rotateRight(t):e<-1&&t.right&&(t.right.getBalance()>0?this._rotateRight(t.right):this._rotateLeft(t))}get(t){if(this._root!==null){let e=[];if(this._root.search(t,e),e.length>0){let o=e[0];for(let n=1;n<e.length;n++)e[n].low>o.low&&(o=e[n]);return o.event}}return null}forEach(t){if(this._root!==null){let e=[];this._root.traverse(o=>e.push(o)),e.forEach(o=>{o.event&&t(o.event)})}return this}forEachAtTime(t,e){if(this._root!==null){let o=[];this._root.search(t,o),o.forEach(n=>{n.event&&e(n.event)})}return this}forEachFrom(t,e){if(this._root!==null){let o=[];this._root.searchAfter(t,o),o.forEach(n=>{n.event&&e(n.event)})}return this}dispose(){return super.dispose(),this._root!==null&&this._root.traverse(t=>t.dispose()),this._root=null,this}},Di=class{constructor(t,e,o){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=o,this.low=t,this.high=e,this.max=this.high}insert(t){t.low<=this.low?this.left===null?this.left=t:this.left.insert(t):this.right===null?this.right=t:this.right.insert(t)}search(t,e){t>this.max||(this.left!==null&&this.left.search(t,e),this.low<=t&&this.high>t&&e.push(this),!(this.low>t)&&this.right!==null&&this.right.search(t,e))}searchAfter(t,e){this.low>=t&&(e.push(this),this.left!==null&&this.left.searchAfter(t,e)),this.right!==null&&this.right.searchAfter(t,e)}traverse(t){t(this),this.left!==null&&this.left.traverse(t),this.right!==null&&this.right.traverse(t)}updateHeight(){this.left!==null&&this.right!==null?this.height=Math.max(this.left.height,this.right.height)+1:this.right!==null?this.height=this.right.height+1:this.left!==null?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,this.left!==null&&(this.max=Math.max(this.max,this.left.max)),this.right!==null&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let t=0;return this.left!==null&&this.right!==null?t=this.left.height-this.right.height:this.left!==null?t=this.left.height+1:this.right!==null&&(t=-(this.right.height+1)),t}isLeftChild(){return this.parent!==null&&this.parent.left===this}get left(){return this._left}set left(t){this._left=t,t!==null&&(t.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(t){this._right=t,t!==null&&(t.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}};var Kt=class extends C{constructor(){super(g(Kt.getDefaults(),arguments,["volume"])),this.name="Volume";let t=g(Kt.getDefaults(),arguments,["volume"]);this.input=this.output=new L({context:this.context,gain:t.volume,units:"decibels"}),this.volume=this.output.gain,F(this,"volume"),this._unmutedVolume=t.volume,this.mute=t.mute}static getDefaults(){return Object.assign(C.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(t){!this.mute&&t?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!t&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}};var Wo=class extends C{constructor(){super(g(Wo.getDefaults(),arguments)),this.name="Destination",this.input=new Kt({context:this.context}),this.output=new L({context:this.context}),this.volume=this.input.volume;let t=g(Wo.getDefaults(),arguments);ce(this.input,this.output,this.context.rawContext.destination),this.mute=t.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(C.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(t){this.input.mute=t}chain(...t){return this.input.disconnect(),t.unshift(this.input),t.push(this.output),ce(...t),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}};br(r=>{r.destination=new Wo({context:r})});Ar(r=>{r.destination.dispose()});var us=class extends It{constructor(t){super(),this.name="TimelineValue",this._timeline=new Et({memory:10}),this._initialValue=t}set(t,e){return this._timeline.add({value:t,time:e}),this}get(t){let e=this._timeline.get(t);return e?e.value:this._initialValue}};var _e=class{constructor(t,e){this.id=_e._eventId++;let o=Object.assign(_e.getDefaults(),e);this.transport=t,this.callback=o.callback,this._once=o.once,this.time=o.time}static getDefaults(){return{callback:X,once:!1,time:0}}invoke(t){this.callback&&(this.callback(t),this._once&&this.transport.clear(this.id))}dispose(){return this.callback=void 0,this}};_e._eventId=0;var jo=class extends _e{constructor(t,e){super(t,e),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);let o=Object.assign(jo.getDefaults(),e);this.duration=new bt(t.context,o.duration).valueOf(),this._interval=new bt(t.context,o.interval).valueOf(),this._nextTick=o.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},_e.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(t){this._createEvents(t),super.invoke(t)}_createEvents(t){let e=this.transport.getTicksAtTime(t);e>=this.time&&e>=this._nextTick&&this._nextTick+this._interval<this.time+this.duration&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new bt(this.context,this._nextTick).toSeconds()))}_restart(t){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.time;let e=this.transport.getTicksAtTime(t);e>this.time&&(this._nextTick=this.time+Math.ceil((e-this.time)/this._interval)*this._interval),this._currentId=this.transport.scheduleOnce(this.invoke.bind(this),new bt(this.context,this._nextTick).toSeconds()),this._nextTick+=this._interval,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new bt(this.context,this._nextTick).toSeconds())}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this}};var Kr=class extends ft{constructor(){super(g(Kr.getDefaults(),arguments)),this.name="Transport",this._loop=new us(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new Et,this._repeatedEvents=new cs,this._syncedSignals=[],this._swingAmount=0;let t=g(Kr.getDefaults(),arguments);this._ppq=t.ppq,this._clock=new sr({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=t.ppq,this.bpm.setValueAtTime(t.bpm,0),F(this,"bpm"),this._timeSignature=t.timeSignature,this._swingTicks=t.ppq/2}static getDefaults(){return Object.assign(ft.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(t,e){if(this._loop.get(t)&&e>=this._loopEnd&&(this.emit("loopEnd",t),this._clock.setTicksAtTime(this._loopStart,t),e=this._loopStart,this.emit("loopStart",t,this._clock.getSecondsAtTime(t)),this.emit("loop",t)),this._swingAmount>0&&e%this._ppq!==0&&e%(this._swingTicks*2)!==0){let o=e%(this._swingTicks*2)/(this._swingTicks*2),n=Math.sin(o*Math.PI)*this._swingAmount;t+=new bt(this.context,this._swingTicks*2/3).toSeconds()*n}this._timeline.forEachAtTime(e,o=>o.invoke(t))}schedule(t,e){let o=new _e(this,{callback:t,time:new ge(this.context,e).toTicks()});return this._addEvent(o,this._timeline)}scheduleRepeat(t,e,o,n=1/0){let s=new jo(this,{callback:t,duration:new zt(this.context,n).toTicks(),interval:new zt(this.context,e).toTicks(),time:new ge(this.context,o).toTicks()});return this._addEvent(s,this._repeatedEvents)}scheduleOnce(t,e){let o=new _e(this,{callback:t,once:!0,time:new ge(this.context,e).toTicks()});return this._addEvent(o,this._timeline)}clear(t){if(this._scheduledEvents.hasOwnProperty(t)){let e=this._scheduledEvents[t.toString()];e.timeline.remove(e.event),e.event.dispose(),delete this._scheduledEvents[t.toString()]}return this}_addEvent(t,e){return this._scheduledEvents[t.id.toString()]={event:t,timeline:e},e.add(t),t.id}cancel(t=0){let e=this.toTicks(t);return this._timeline.forEachFrom(e,o=>this.clear(o.id)),this._repeatedEvents.forEachFrom(e,o=>this.clear(o.id)),this}_bindClockEvents(){this._clock.on("start",(t,e)=>{e=new bt(this.context,e).toSeconds(),this.emit("start",t,e)}),this._clock.on("stop",t=>{this.emit("stop",t)}),this._clock.on("pause",t=>{this.emit("pause",t)})}get state(){return this._clock.getStateAtTime(this.now())}start(t,e){let o;return Q(e)&&(o=this.toTicks(e)),this._clock.start(t,o),this}stop(t){return this._clock.stop(t),this}pause(t){return this._clock.pause(t),this}toggle(t){return t=this.toSeconds(t),this._clock.getStateAtTime(t)!=="started"?this.start(t):this.stop(t),this}get timeSignature(){return this._timeSignature}set timeSignature(t){Nt(t)&&(t=t[0]/t[1]*4),this._timeSignature=t}get loopStart(){return new zt(this.context,this._loopStart,"i").toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t)}get loopEnd(){return new zt(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t)}get loop(){return this._loop.get(this.now())}set loop(t){this._loop.set(t,this.now())}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get swing(){return this._swingAmount}set swing(t){this._swingAmount=t}get swingSubdivision(){return new bt(this.context,this._swingTicks).toNotation()}set swingSubdivision(t){this._swingTicks=this.toTicks(t)}get position(){let t=this.now(),e=this._clock.getTicksAtTime(t);return new bt(this.context,e).toBarsBeatsSixteenths()}set position(t){let e=this.toTicks(t);this.ticks=e}get seconds(){return this._clock.seconds}set seconds(t){let e=this.now(),o=this._clock.frequency.timeToTicks(t,e);this.ticks=o}get progress(){if(this.loop){let t=this.now();return(this._clock.getTicksAtTime(t)-this._loopStart)/(this._loopEnd-this._loopStart)}else return 0}get ticks(){return this._clock.ticks}set ticks(t){if(this._clock.ticks!==t){let e=this.now();if(this.state==="started"){let o=this._clock.getTicksAtTime(e),n=this._clock.frequency.getDurationOfTicks(Math.ceil(o)-o,e),s=e+n;this.emit("stop",s),this._clock.setTicksAtTime(t,s),this.emit("start",s,this._clock.getSecondsAtTime(s))}else this._clock.setTicksAtTime(t,e)}}getTicksAtTime(t){return Math.round(this._clock.getTicksAtTime(t))}getSecondsAtTime(t){return this._clock.getSecondsAtTime(t)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(t){this._clock.frequency.multiplier=t}nextSubdivision(t){if(t=this.toTicks(t),this.state!=="started")return 0;{let e=this.now(),o=this.getTicksAtTime(e),n=t-o%t;return this._clock.nextTickTime(n,e)}}syncSignal(t,e){if(!e){let n=this.now();if(t.getValueAtTime(n)!==0){let i=1/(60/this.bpm.getValueAtTime(n)/this.PPQ);e=t.getValueAtTime(n)/i}else e=0}let o=new L(e);return this.bpm.connect(o),o.connect(t._param),this._syncedSignals.push({initial:t.value,ratio:o,signal:t}),t.value=0,this}unsyncSignal(t){for(let e=this._syncedSignals.length-1;e>=0;e--){let o=this._syncedSignals[e];o.signal===t&&(o.ratio.dispose(),o.signal.value=o.initial,this._syncedSignals.splice(e,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),Po(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}};He.mixin(Kr);br(r=>{r.transport=new Kr({context:r})});Ar(r=>{r.transport.dispose()});var ot=class extends C{constructor(t){super(t),this.input=void 0,this._state=new Oe("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=X,this._syncedStop=X,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new Kt({context:this.context,mute:t.mute,volume:t.volume}),this.volume=this._volume.volume,F(this,"volume"),this.onstop=t.onstop}static getDefaults(){return Object.assign(C.getDefaults(),{mute:!1,onstop:X,volume:0})}get state(){return this._synced?this.context.transport.state==="started"?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}_clampToCurrentTime(t){return this._synced?t:Math.max(t,this.context.currentTime)}start(t,e,o){let n=Dt(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(n=this._clampToCurrentTime(n),!this._synced&&this._state.getValueAtTime(n)==="started")G(Ro(n,this._state.get(n).time),"Start time must be strictly greater than previous start time"),this._state.cancel(n),this._state.setStateAtTime("started",n),this.log("restart",n),this.restart(n,e,o);else if(this.log("start",n),this._state.setStateAtTime("started",n),this._synced){let s=this._state.get(n);s&&(s.offset=this.toSeconds(re(e,0)),s.duration=o?this.toSeconds(o):void 0);let i=this.context.transport.schedule(a=>{this._start(a,e,o)},n);this._scheduled.push(i),this.context.transport.state==="started"&&this.context.transport.getSecondsAtTime(this.immediate())>n&&this._syncedStart(this.now(),this.context.transport.seconds)}else Yn(this.context),this._start(n,e,o);return this}stop(t){let e=Dt(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(e=this._clampToCurrentTime(e),this._state.getValueAtTime(e)==="started"||Q(this._state.getNextState("started",e))){if(this.log("stop",e),!this._synced)this._stop(e);else{let o=this.context.transport.schedule(this._stop.bind(this),e);this._scheduled.push(o)}this._state.cancel(e),this._state.setStateAtTime("stopped",e)}return this}restart(t,e,o){return t=this.toSeconds(t),this._state.getValueAtTime(t)==="started"&&(this._state.cancel(t),this._restart(t,e,o)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(t,e)=>{if(e>0){let o=this._state.get(e);if(o&&o.state==="started"&&o.time!==e){let n=e-this.toSeconds(o.time),s;o.duration&&(s=this.toSeconds(o.duration)-n),this._start(t,this.toSeconds(o.offset)+n,s)}}},this._syncedStop=t=>{let e=this.context.transport.getSecondsAtTime(Math.max(t-this.sampleTime,0));this._state.getValueAtTime(e)==="started"&&this._stop(t)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(t=>this.context.transport.clear(t)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=X,this.unsync(),this._volume.dispose(),this._state.dispose(),this}};var ue=class extends De{constructor(){super(g(ue.getDefaults(),arguments,["url","onload"])),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;let t=g(ue.getDefaults(),arguments,["url","onload"]);Ut(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new Y({context:this.context,param:this._source.playbackRate,units:"positive",value:t.playbackRate}),this.loop=t.loop,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this._buffer=new tt(t.url,t.onload,t.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(De.getDefaults(),{url:new tt,loop:!1,loopEnd:0,loopStart:0,onload:X,onerror:X,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t}get curve(){return this._curve}set curve(t){this._curve=t}start(t,e,o,n=1){G(this.buffer.loaded,"buffer is either not set or not loaded");let s=this.toSeconds(t);this._startGain(s,n),this.loop?e=re(e,this.loopStart):e=re(e,0);let i=Math.max(this.toSeconds(e),0);if(this.loop){let a=this.toSeconds(this.loopEnd)||this.buffer.duration,c=this.toSeconds(this.loopStart),u=a-c;vn(i,a)&&(i=(i-c)%u+c),Yt(i,this.buffer.duration)&&(i=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,ns(i,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(s,i)),Q(o)){let a=this.toSeconds(o);a=Math.max(a,0),this.stop(s+a)}return this}_stopSource(t){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(t)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(t){this._source.loopStart=this.toSeconds(t)}get loopEnd(){return this._source.loopEnd}set loopEnd(t){this._source.loopEnd=this.toSeconds(t)}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._source.loop}set loop(t){this._source.loop=t,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}};var Ze=class extends ot{constructor(){super(g(Ze.getDefaults(),arguments,["type"])),this.name="Noise",this._source=null;let t=g(Ze.getDefaults(),arguments,["type"]);this._playbackRate=t.playbackRate,this.type=t.type,this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut}static getDefaults(){return Object.assign(ot.getDefaults(),{fadeIn:0,fadeOut:0,playbackRate:1,type:"white"})}get type(){return this._type}set type(t){if(G(t in cp,"Noise: invalid type: "+t),this._type!==t&&(this._type=t,this.state==="started")){let e=this.now();this._stop(e),this._start(e)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._source&&(this._source.playbackRate.value=t)}_start(t){let e=cp[this._type];this._source=new ue({url:e,context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,loop:!0,onended:()=>this.onstop(this),playbackRate:this._playbackRate}).connect(this.output),this._source.start(this.toSeconds(t),Math.random()*(e.duration-.001))}_stop(t){this._source&&(this._source.stop(this.toSeconds(t)),this._source=null)}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t,this._source&&(this._source.fadeIn=this._fadeIn)}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t,this._source&&(this._source.fadeOut=this._fadeOut)}_restart(t){this._stop(t),this._start(t)}dispose(){return super.dispose(),this._source&&this._source.disconnect(),this}},Go=44100*5,Ei=2,ir={brown:null,pink:null,white:null},cp={get brown(){if(!ir.brown){let r=[];for(let t=0;t<Ei;t++){let e=new Float32Array(Go);r[t]=e;let o=0;for(let n=0;n<Go;n++){let s=Math.random()*2-1;e[n]=(o+.02*s)/1.02,o=e[n],e[n]*=3.5}}ir.brown=new tt().fromArray(r)}return ir.brown},get pink(){if(!ir.pink){let r=[];for(let t=0;t<Ei;t++){let e=new Float32Array(Go);r[t]=e;let o,n,s,i,a,c,u;o=n=s=i=a=c=u=0;for(let l=0;l<Go;l++){let h=Math.random()*2-1;o=.99886*o+h*.0555179,n=.99332*n+h*.0750759,s=.969*s+h*.153852,i=.8665*i+h*.3104856,a=.55*a+h*.5329522,c=-.7616*c-h*.016898,e[l]=o+n+s+i+a+c+u+h*.5362,e[l]*=.11,u=h*.115926}}ir.pink=new tt().fromArray(r)}return ir.pink},get white(){if(!ir.white){let r=[];for(let t=0;t<Ei;t++){let e=new Float32Array(Go);r[t]=e;for(let o=0;o<Go;o++)e[o]=Math.random()*2-1}ir.white=new tt().fromArray(r)}return ir.white}};function oe(r,t){return et(this,void 0,void 0,function*(){let e=t/r.context.sampleRate,o=new $e(1,e,r.context.sampleRate);return new r.constructor(Object.assign(r.get(),{frequency:2/e,detune:0,context:o})).toDestination().start(0),(yield o.render()).getChannelData(0)})}var Cr=class extends De{constructor(){super(g(Cr.getDefaults(),arguments,["frequency","type"])),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];let t=g(Cr.getDefaults(),arguments,["frequency","type"]);Ut(this._oscillator,this._gainNode),this.type=t.type,this.frequency=new Y({context:this.context,param:this._oscillator.frequency,units:"frequency",value:t.frequency}),this.detune=new Y({context:this.context,param:this._oscillator.detune,units:"cents",value:t.detune}),F(this,["frequency","detune"])}static getDefaults(){return Object.assign(De.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(t){let e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._oscillator.start(e),this}_stopSource(t){this._oscillator.stop(t)}setPeriodicWave(t){return this._oscillator.setPeriodicWave(t),this}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}};var ct=class extends ot{constructor(){super(g(ct.getDefaults(),arguments,["frequency","type"])),this.name="Oscillator",this._oscillator=null;let t=g(ct.getDefaults(),arguments,["frequency","type"]);this.frequency=new $({context:this.context,units:"frequency",value:t.frequency}),F(this,"frequency"),this.detune=new $({context:this.context,units:"cents",value:t.detune}),F(this,"detune"),this._partials=t.partials,this._partialCount=t.partialCount,this._type=t.type,t.partialCount&&t.type!=="custom"&&(this._type=this.baseType+t.partialCount.toString()),this.phase=t.phase}static getDefaults(){return Object.assign(ot.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(t){let e=this.toSeconds(t),o=new Cr({context:this.context,onended:()=>this.onstop(this)});this._oscillator=o,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(e)}_stop(t){let e=this.toSeconds(t);this._oscillator&&this._oscillator.stop(e)}_restart(t){let e=this.toSeconds(t);return this.log("restart",e),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(e),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if(this._type==="custom")return ct._periodicWaveCache.find(e=>e.phase===this._phase&&Kh(e.partials,this._partials));{let t=ct._periodicWaveCache.find(e=>e.type===this._type&&e.phase===this._phase);return this._partialCount=t?t.partialCount:this._partialCount,t}}get type(){return this._type}set type(t){this._type=t;let e=["sine","square","sawtooth","triangle"].indexOf(t)!==-1;if(this._phase===0&&e)this._wave=void 0,this._partialCount=0,this._oscillator!==null&&(this._oscillator.type=t);else{let o=this._getCachedPeriodicWave();if(Q(o)){let{partials:n,wave:s}=o;this._wave=s,this._partials=n,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave)}else{let[n,s]=this._getRealImaginary(t,this._phase),i=this.context.createPeriodicWave(n,s);this._wave=i,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave),ct._periodicWaveCache.push({imag:s,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:n,type:this._type,wave:this._wave}),ct._periodicWaveCache.length>100&&ct._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(t){this.partialCount&&this._type!=="custom"&&t!=="custom"?this.type=t+this.partialCount:this.type=t}get partialCount(){return this._partialCount}set partialCount(t){Vt(t,0);let e=this._type,o=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(o&&(e=o[1]),this._type!=="custom")t===0?this.type=e:this.type=e+t.toString();else{let n=new Float32Array(t);this._partials.forEach((s,i)=>n[i]=s),this._partials=Array.from(n),this.type=this._type}}_getRealImaginary(t,e){let n=2048,s=new Float32Array(n),i=new Float32Array(n),a=1;if(t==="custom"){if(a=this._partials.length+1,this._partialCount=this._partials.length,n=a,this._partials.length===0)return[s,i]}else{let c=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(t);c?(a=parseInt(c[2],10)+1,this._partialCount=parseInt(c[2],10),t=c[1],a=Math.max(a,2),n=a):this._partialCount=0,this._partials=[]}for(let c=1;c<n;++c){let u=2/(c*Math.PI),l;switch(t){case"sine":l=c<=a?1:0,this._partials[c-1]=l;break;case"square":l=c&1?2*u:0,this._partials[c-1]=l;break;case"sawtooth":l=u*(c&1?1:-1),this._partials[c-1]=l;break;case"triangle":c&1?l=2*(u*u)*(c-1>>1&1?-1:1):l=0,this._partials[c-1]=l;break;case"custom":l=this._partials[c-1];break;default:throw new TypeError("Oscillator: invalid type: "+t)}l!==0?(s[c]=-l*Math.sin(e*c),i[c]=l*Math.cos(e*c)):(s[c]=0,i[c]=0)}return[s,i]}_inverseFFT(t,e,o){let n=0,s=t.length;for(let i=0;i<s;i++)n+=t[i]*Math.cos(i*o)+e[i]*Math.sin(i*o);return n}getInitialValue(){let[t,e]=this._getRealImaginary(this._type,0),o=0,n=Math.PI*2,s=32;for(let i=0;i<s;i++)o=Math.max(this._inverseFFT(t,e,i/s*n),o);return Ti(-this._inverseFFT(t,e,this._phase)/o,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(t){this._phase=t*Math.PI/180,this.type=this._type}asArray(t=1024){return et(this,void 0,void 0,function*(){return oe(this,t)})}dispose(){return super.dispose(),this._oscillator!==null&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}};ct._periodicWaveCache=[];var qt=class extends C{constructor(){super(Object.assign(g(qt.getDefaults(),arguments,["context"])))}connect(t,e=0,o=0){return Bo(this,t,e,o),this}};var Bt=class extends qt{constructor(){super(Object.assign(g(Bt.getDefaults(),arguments,["mapping","length"]))),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;let t=g(Bt.getDefaults(),arguments,["mapping","length"]);Nt(t.mapping)||t.mapping instanceof Float32Array?this.curve=Float32Array.from(t.mapping):Th(t.mapping)&&this.setMap(t.mapping,t.length)}static getDefaults(){return Object.assign($.getDefaults(),{length:1024})}setMap(t,e=1024){let o=new Float32Array(e);for(let n=0,s=e;n<s;n++){let i=n/(s-1)*2-1;o[n]=t(i,n)}return this.curve=o,this}get curve(){return this._shaper.curve}set curve(t){this._shaper.curve=t}get oversample(){return this._shaper.oversample}set oversample(t){let e=["none","2x","4x"].some(o=>o.includes(t));G(e,"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.disconnect(),this}};var zo=class extends qt{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new Bt({context:this.context,mapping:t=>(t+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}};var lt=class extends ${constructor(){super(Object.assign(g(lt.getDefaults(),arguments,["value"]))),this.name="Multiply",this.override=!1;let t=g(lt.getDefaults(),arguments,["value"]);this._mult=this.input=this.output=new L({context:this.context,minValue:t.minValue,maxValue:t.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign($.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}};var kr=class extends ot{constructor(){super(g(kr.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="AMOscillator",this._modulationScale=new zo({context:this.context}),this._modulationNode=new L({context:this.context});let t=g(kr.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new ct({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new ct({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new lt({context:this.context,units:"positive",value:t.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),F(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(ct.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){this._modulator.restart(t),this._carrier.restart(t)}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return et(this,void 0,void 0,function*(){return oe(this,t)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}};var ar=class extends ot{constructor(){super(g(ar.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="FMOscillator",this._modulationNode=new L({context:this.context,gain:0});let t=g(ar.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new ct({context:this.context,detune:t.detune,frequency:0,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.detune=this._carrier.detune,this.frequency=new $({context:this.context,units:"frequency",value:t.frequency}),this._modulator=new ct({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new lt({context:this.context,units:"positive",value:t.harmonicity}),this.modulationIndex=new lt({context:this.context,units:"positive",value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),F(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(ct.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){return this._modulator.restart(t),this._carrier.restart(t),this}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return et(this,void 0,void 0,function*(){return oe(this,t)})}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}};var Qe=class extends ot{constructor(){super(g(Qe.getDefaults(),arguments,["frequency","width"])),this.name="PulseOscillator",this._widthGate=new L({context:this.context,gain:0}),this._thresh=new Bt({context:this.context,mapping:e=>e<=0?-1:1});let t=g(Qe.getDefaults(),arguments,["frequency","width"]);this.width=new $({context:this.context,units:"audioRange",value:t.width}),this._triangle=new ct({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),F(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(ot.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(t){t=this.toSeconds(t),this._triangle.start(t),this._widthGate.gain.setValueAtTime(1,t)}_stop(t){t=this.toSeconds(t),this._triangle.stop(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(0,t)}_restart(t){this._triangle.restart(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(1,t)}get phase(){return this._triangle.phase}set phase(t){this._triangle.phase=t}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(t){this._triangle.type=t}asArray(t=1024){return et(this,void 0,void 0,function*(){return oe(this,t)})}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}};var Or=class extends ot{constructor(){super(g(Or.getDefaults(),arguments,["frequency","type","spread"])),this.name="FatOscillator",this._oscillators=[];let t=g(Or.getDefaults(),arguments,["frequency","type","spread"]);this.frequency=new $({context:this.context,units:"frequency",value:t.frequency}),this.detune=new $({context:this.context,units:"cents",value:t.detune}),this._spread=t.spread,this._type=t.type,this._phase=t.phase,this._partials=t.partials,this._partialCount=t.partialCount,this.count=t.count,F(this,["frequency","detune"])}static getDefaults(){return Object.assign(ct.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(t){t=this.toSeconds(t),this._forEach(e=>e.start(t))}_stop(t){t=this.toSeconds(t),this._forEach(e=>e.stop(t))}_restart(t){this._forEach(e=>e.restart(t))}_forEach(t){for(let e=0;e<this._oscillators.length;e++)t(this._oscillators[e],e)}get type(){return this._type}set type(t){this._type=t,this._forEach(e=>e.type=t)}get spread(){return this._spread}set spread(t){if(this._spread=t,this._oscillators.length>1){let e=-t/2,o=t/(this._oscillators.length-1);this._forEach((n,s)=>n.detune.value=e+o*s)}}get count(){return this._oscillators.length}set count(t){if(Vt(t,1),this._oscillators.length!==t){this._forEach(e=>e.dispose()),this._oscillators=[];for(let e=0;e<t;e++){let o=new ct({context:this.context,volume:-6-t*1.1,type:this._type,phase:this._phase+e/t*360,partialCount:this._partialCount,onstop:e===0?()=>this.onstop(this):X});this.type==="custom"&&(o.partials=this._partials),this.frequency.connect(o.frequency),this.detune.connect(o.detune),o.detune.overridden=!1,o.connect(this.output),this._oscillators[e]=o}this.spread=this._spread,this.state==="started"&&this._forEach(e=>e.start())}}get phase(){return this._phase}set phase(t){this._phase=t,this._forEach((e,o)=>e.phase=this._phase+o/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(t){this._forEach(e=>e.baseType=t),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this._type="custom",this._forEach(e=>e.partials=t))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(t){this._partialCount=t,this._forEach(e=>e.partialCount=t),this._type=this._oscillators[0].type}asArray(t=1024){return et(this,void 0,void 0,function*(){return oe(this,t)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(t=>t.dispose()),this}};var Dr=class extends ot{constructor(){super(g(Dr.getDefaults(),arguments,["frequency","modulationFrequency"])),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new lt({context:this.context,value:2});let t=g(Dr.getDefaults(),arguments,["frequency","modulationFrequency"]);this._pulse=new Qe({context:this.context,frequency:t.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new ct({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),F(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(ot.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(t){t=this.toSeconds(t),this._modulator.start(t),this._pulse.start(t)}_stop(t){t=this.toSeconds(t),this._modulator.stop(t),this._pulse.stop(t)}_restart(t){this._modulator.restart(t),this._pulse.restart(t)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(t){this._modulator.phase=t}asArray(t=1024){return et(this,void 0,void 0,function*(){return oe(this,t)})}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}};var up={am:kr,fat:Or,fm:ar,oscillator:ct,pulse:Qe,pwm:Dr},Xe=class extends ot{constructor(){super(g(Xe.getDefaults(),arguments,["frequency","type"])),this.name="OmniOscillator";let t=g(Xe.getDefaults(),arguments,["frequency","type"]);this.frequency=new $({context:this.context,units:"frequency",value:t.frequency}),this.detune=new $({context:this.context,units:"cents",value:t.detune}),F(this,["frequency","detune"]),this.set(t)}static getDefaults(){return Object.assign(ct.getDefaults(),ar.getDefaults(),kr.getDefaults(),Or.getDefaults(),Qe.getDefaults(),Dr.getDefaults())}_start(t){this._oscillator.start(t)}_stop(t){this._oscillator.stop(t)}_restart(t){return this._oscillator.restart(t),this}get type(){let t="";return["am","fm","fat"].some(e=>this._sourceType===e)&&(t=this._sourceType),t+this._oscillator.type}set type(t){t.substr(0,2)==="fm"?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):t.substr(0,2)==="am"?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):t.substr(0,3)==="fat"?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(3)):t==="pwm"?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):t==="pulse"?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=t)}get partials(){return this._oscillator.partials}set partials(t){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partials=t)}get partialCount(){return this._oscillator.partialCount}set partialCount(t){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partialCount=t)}set(t){return Reflect.has(t,"type")&&t.type&&(this.type=t.type),super.set(t),this}_createNewOscillator(t){if(t!==this._sourceType){this._sourceType=t;let e=up[t],o=this.now();if(this._oscillator){let n=this._oscillator;n.stop(o),this.context.setTimeout(()=>n.dispose(),this.blockTime)}this._oscillator=new e({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),this.state==="started"&&this._oscillator.start(o)}}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t}get sourceType(){return this._sourceType}set sourceType(t){let e="sine";this._oscillator.type!=="pwm"&&this._oscillator.type!=="pulse"&&(e=this._oscillator.type),t==="fm"?this.type="fm"+e:t==="am"?this.type="am"+e:t==="fat"?this.type="fat"+e:t==="oscillator"?this.type=e:t==="pulse"?this.type="pulse":t==="pwm"&&(this.type="pwm")}_getOscType(t,e){return t instanceof up[e]}get baseType(){return this._oscillator.baseType}set baseType(t){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&t!=="pulse"&&t!=="pwm"&&(this._oscillator.baseType=t)}get width(){if(this._getOscType(this._oscillator,"pulse"))return this._oscillator.width}get count(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.count}set count(t){this._getOscType(this._oscillator,"fat")&&Gt(t)&&(this._oscillator.count=t)}get spread(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.spread}set spread(t){this._getOscType(this._oscillator,"fat")&&Gt(t)&&(this._oscillator.spread=t)}get modulationType(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.modulationType}set modulationType(t){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&Lt(t)&&(this._oscillator.modulationType=t)}get modulationIndex(){if(this._getOscType(this._oscillator,"fm"))return this._oscillator.modulationIndex}get harmonicity(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.harmonicity}get modulationFrequency(){if(this._getOscType(this._oscillator,"pwm"))return this._oscillator.modulationFrequency}asArray(t=1024){return et(this,void 0,void 0,function*(){return oe(this,t)})}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}};var Ye=class extends ${constructor(){super(Object.assign(g(Ye.getDefaults(),arguments,["value"]))),this.override=!1,this.name="Add",this._sum=new L({context:this.context}),this.input=this._sum,this.output=this._sum,this.addend=this._param,ce(this._constantSource,this._sum)}static getDefaults(){return Object.assign($.getDefaults(),{value:0})}dispose(){return super.dispose(),this._sum.dispose(),this}};function hs(r,t=1/0){let e=new WeakMap;return function(o,n){Reflect.defineProperty(o,n,{configurable:!0,enumerable:!0,get:function(){return e.get(this)},set:function(s){Vt(s,r,t),e.set(this,s)}})}}function ne(r,t=1/0){let e=new WeakMap;return function(o,n){Reflect.defineProperty(o,n,{configurable:!0,enumerable:!0,get:function(){return e.get(this)},set:function(s){Vt(this.toSeconds(s),r,t),e.set(this,s)}})}}var Er=class extends ot{constructor(){super(g(Er.getDefaults(),arguments,["url","onload"])),this.name="Player",this._activeSources=new Set;let t=g(Er.getDefaults(),arguments,["url","onload"]);this._buffer=new tt({onload:this._onload.bind(this,t.onload),onerror:t.onerror,reverse:t.reverse,url:t.url}),this.autostart=t.autostart,this._loop=t.loop,this._loopStart=t.loopStart,this._loopEnd=t.loopEnd,this._playbackRate=t.playbackRate,this.fadeIn=t.fadeIn,this.fadeOut=t.fadeOut}static getDefaults(){return Object.assign(ot.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:X,onerror:X,playbackRate:1,reverse:!1})}load(t){return et(this,void 0,void 0,function*(){return yield this._buffer.load(t),this._onload(),this})}_onload(t=X){t(),this.autostart&&this.start()}_onSourceEnd(t){this.onstop(this),this._activeSources.delete(t),this._activeSources.size===0&&!this._synced&&this._state.getValueAtTime(this.now())==="started"&&(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(t,e,o){return super.start(t,e,o),this}_start(t,e,o){this._loop?e=re(e,this._loopStart):e=re(e,0);let n=this.toSeconds(e),s=o;o=re(o,Math.max(this._buffer.duration-n,0));let i=this.toSeconds(o);i=i/this._playbackRate,t=this.toSeconds(t);let a=new ue({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);!this._loop&&!this._synced&&(this._state.cancel(t+i),this._state.setStateAtTime("stopped",t+i,{implicitEnd:!0})),this._activeSources.add(a),this._loop&&Dt(s)?a.start(t,n):a.start(t,n,i-this.toSeconds(this.fadeOut))}_stop(t){let e=this.toSeconds(t);this._activeSources.forEach(o=>o.stop(e))}restart(t,e,o){return super.restart(t,e,o),this}_restart(t,e,o){this._stop(t),this._start(t,e,o)}seek(t,e){let o=this.toSeconds(e);if(this._state.getValueAtTime(o)==="started"){let n=this.toSeconds(t);this._stop(o),this._start(o,n)}return this}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get loopStart(){return this._loopStart}set loopStart(t){this._loopStart=t,this.buffer.loaded&&Vt(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach(e=>{e.loopStart=t})}get loopEnd(){return this._loopEnd}set loopEnd(t){this._loopEnd=t,this.buffer.loaded&&Vt(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach(e=>{e.loopEnd=t})}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._loop}set loop(t){if(this._loop!==t&&(this._loop=t,this._activeSources.forEach(e=>{e.loop=t}),t)){let e=this._state.getNextState("stopped",this.now());e&&this._state.cancel(e.time)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t;let e=this.now(),o=this._state.getNextState("stopped",e);o&&o.implicitEnd&&(this._state.cancel(o.time),this._activeSources.forEach(n=>n.cancelStop())),this._activeSources.forEach(n=>{n.playbackRate.setValueAtTime(t,e)})}get reverse(){return this._buffer.reverse}set reverse(t){this._buffer.reverse=t}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(t=>t.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}};Ht([ne(0)],Er.prototype,"fadeIn",void 0);Ht([ne(0)],Er.prototype,"fadeOut",void 0);var ps=class extends qt{constructor(){super(...arguments),this.name="Abs",this._abs=new Bt({context:this.context,mapping:t=>Math.abs(t)<.001?0:Math.abs(t)}),this.input=this._abs,this.output=this._abs}dispose(){return super.dispose(),this._abs.dispose(),this}};var fs=class extends qt{constructor(){super(...arguments),this.name="GainToAudio",this._norm=new Bt({context:this.context,mapping:t=>Math.abs(t)*2-1}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}};var wn=class extends qt{constructor(){super(...arguments),this.name="Negate",this._multiply=new lt({context:this.context,value:-1}),this.input=this._multiply,this.output=this._multiply}dispose(){return super.dispose(),this._multiply.dispose(),this}};var Me=class extends ${constructor(){super(Object.assign(g(Me.getDefaults(),arguments,["value"]))),this.override=!1,this.name="Subtract",this._sum=new L({context:this.context}),this.input=this._sum,this.output=this._sum,this._neg=new wn({context:this.context}),this.subtrahend=this._param,ce(this._constantSource,this._neg,this._sum)}static getDefaults(){return Object.assign($.getDefaults(),{value:0})}dispose(){return super.dispose(),this._neg.dispose(),this._sum.dispose(),this}};var Uo=class extends qt{constructor(){super(Object.assign(g(Uo.getDefaults(),arguments))),this.name="GreaterThanZero",this._thresh=this.output=new Bt({context:this.context,length:127,mapping:t=>t<=0?0:1}),this._scale=this.input=new lt({context:this.context,value:1e4}),this._scale.connect(this._thresh)}dispose(){return super.dispose(),this._scale.dispose(),this._thresh.dispose(),this}};var Jr=class extends ${constructor(){super(Object.assign(g(Jr.getDefaults(),arguments,["value"]))),this.name="GreaterThan",this.override=!1;let t=g(Jr.getDefaults(),arguments,["value"]);this._subtract=this.input=new Me({context:this.context,value:t.value}),this._gtz=this.output=new Uo({context:this.context}),this.comparator=this._param=this._subtract.subtrahend,F(this,"comparator"),this._subtract.connect(this._gtz)}static getDefaults(){return Object.assign($.getDefaults(),{value:0})}dispose(){return super.dispose(),this._gtz.dispose(),this._subtract.dispose(),this.comparator.dispose(),this}};var Pt=class extends C{constructor(){super(g(Pt.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="Envelope",this._sig=new $({context:this.context,value:0}),this.output=this._sig,this.input=void 0;let t=g(Pt.getDefaults(),arguments,["attack","decay","sustain","release"]);this.attack=t.attack,this.decay=t.decay,this.sustain=t.sustain,this.release=t.release,this.attackCurve=t.attackCurve,this.releaseCurve=t.releaseCurve,this.decayCurve=t.decayCurve}static getDefaults(){return Object.assign(C.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(t,e){if(Lt(t))return t;{let o;for(o in ms)if(ms[o][e]===t)return o;return t}}_setCurve(t,e,o){if(Lt(o)&&Reflect.has(ms,o)){let n=ms[o];Ne(n)?t!=="_decayCurve"&&(this[t]=n[e]):this[t]=n}else if(Nt(o)&&t!=="_decayCurve")this[t]=o;else throw new Error("Envelope: invalid curve: "+o)}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(t){this._setCurve("_attackCurve","In",t)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(t){this._setCurve("_releaseCurve","Out",t)}get decayCurve(){return this._decayCurve}set decayCurve(t){G(["linear","exponential"].some(e=>e===t),`Invalid envelope curve: ${t}`),this._decayCurve=t}triggerAttack(t,e=1){this.log("triggerAttack",t,e),t=this.toSeconds(t);let n=this.toSeconds(this.attack),s=this.toSeconds(this.decay),i=this.getValueAtTime(t);if(i>0){let a=1/n;n=(1-i)/a}if(n<this.sampleTime)this._sig.cancelScheduledValues(t),this._sig.setValueAtTime(e,t);else if(this._attackCurve==="linear")this._sig.linearRampTo(e,n,t);else if(this._attackCurve==="exponential")this._sig.targetRampTo(e,n,t);else{this._sig.cancelAndHoldAtTime(t);let a=this._attackCurve;for(let c=1;c<a.length;c++)if(a[c-1]<=i&&i<=a[c]){a=this._attackCurve.slice(c),a[0]=i;break}this._sig.setValueCurveAtTime(a,t,n,e)}if(s&&this.sustain<1){let a=e*this.sustain,c=t+n;this.log("decay",c),this._decayCurve==="linear"?this._sig.linearRampToValueAtTime(a,s+c):this._sig.exponentialApproachValueAtTime(a,c,s)}return this}triggerRelease(t){this.log("triggerRelease",t),t=this.toSeconds(t);let e=this.getValueAtTime(t);if(e>0){let o=this.toSeconds(this.release);o<this.sampleTime?this._sig.setValueAtTime(0,t):this._releaseCurve==="linear"?this._sig.linearRampTo(0,o,t):this._releaseCurve==="exponential"?this._sig.targetRampTo(0,o,t):(G(Nt(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(t),this._sig.setValueCurveAtTime(this._releaseCurve,t,o,e))}return this}getValueAtTime(t){return this._sig.getValueAtTime(t)}triggerAttackRelease(t,e,o=1){return e=this.toSeconds(e),this.triggerAttack(e,o),this.triggerRelease(e+this.toSeconds(t)),this}cancel(t){return this._sig.cancelScheduledValues(this.toSeconds(t)),this}connect(t,e=0,o=0){return Bo(this,t,e,o),this}asArray(t=1024){return et(this,void 0,void 0,function*(){let e=t/this.context.sampleRate,o=new $e(1,e,this.context.sampleRate),n=this.toSeconds(this.attack)+this.toSeconds(this.decay),s=n+this.toSeconds(this.release),i=s*.1,a=s+i,c=new this.constructor(Object.assign(this.get(),{attack:e*this.toSeconds(this.attack)/a,decay:e*this.toSeconds(this.decay)/a,release:e*this.toSeconds(this.release)/a,context:o}));return c._sig.toDestination(),c.triggerAttackRelease(e*(n+i)/a,0),(yield o.render()).getChannelData(0)})}dispose(){return super.dispose(),this._sig.dispose(),this}};Ht([ne(0)],Pt.prototype,"attack",void 0);Ht([ne(0)],Pt.prototype,"decay",void 0);Ht([hs(0,1)],Pt.prototype,"sustain",void 0);Ht([ne(0)],Pt.prototype,"release",void 0);var ms=(()=>{let t,e,o=[];for(t=0;t<128;t++)o[t]=Math.sin(t/(128-1)*(Math.PI/2));let n=[],s=6.4;for(t=0;t<128-1;t++){e=t/(128-1);let p=Math.sin(e*(Math.PI*2)*s-Math.PI/2)+1;n[t]=p/10+e*.83}n[128-1]=1;let i=[],a=5;for(t=0;t<128;t++)i[t]=Math.ceil(t/(128-1)*a)/a;let c=[];for(t=0;t<128;t++)e=t/(128-1),c[t]=.5*(1-Math.cos(Math.PI*e));let u=[];for(t=0;t<128;t++){e=t/(128-1);let p=Math.pow(e,3)*4+.2,m=Math.cos(p*Math.PI*2*e);u[t]=Math.abs(m*(1-e))}function l(p){let m=new Array(p.length);for(let f=0;f<p.length;f++)m[f]=1-p[f];return m}function h(p){return p.slice(0).reverse()}return{bounce:{In:l(u),Out:u},cosine:{In:o,Out:h(o)},exponential:"exponential",linear:"linear",ripple:{In:n,Out:l(n)},sine:{In:c,Out:l(c)},step:{In:i,Out:l(i)}}})();var $t=class extends C{constructor(){super(g($t.getDefaults(),arguments)),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease;let t=g($t.getDefaults(),arguments);this._volume=this.output=new Kt({context:this.context,volume:t.volume}),this.volume=this._volume.volume,F(this,"volume")}static getDefaults(){return Object.assign(C.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0)),this}_syncState(){let t=!1;return this._synced||(this._synced=!0,t=!0),t}_syncMethod(t,e){let o=this["_original_"+t]=this[t];this[t]=(...n)=>{let s=n[e],i=this.context.transport.schedule(a=>{n[e]=a,o.apply(this,n)},s);this._scheduledEvents.push(i)}}unsync(){return this._scheduledEvents.forEach(t=>this.context.transport.clear(t)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease),this}triggerAttackRelease(t,e,o,n){let s=this.toSeconds(o),i=this.toSeconds(e);return this.triggerAttack(t,s,n),this.triggerRelease(s+i),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}};var Jt=class extends $t{constructor(){super(g(Jt.getDefaults(),arguments));let t=g(Jt.getDefaults(),arguments);this.portamento=t.portamento,this.onsilence=t.onsilence}static getDefaults(){return Object.assign($t.getDefaults(),{detune:0,onsilence:X,portamento:0})}triggerAttack(t,e,o=1){this.log("triggerAttack",t,e,o);let n=this.toSeconds(e);return this._triggerEnvelopeAttack(n,o),this.setNote(t,n),this}triggerRelease(t){this.log("triggerRelease",t);let e=this.toSeconds(t);return this._triggerEnvelopeRelease(e),this}setNote(t,e){let o=this.toSeconds(e),n=t instanceof Rt?t.toFrequency():t;if(this.portamento>0&&this.getLevelAtTime(o)>.05){let s=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(n,s,o)}else this.frequency.setValueAtTime(n,o);return this}};Ht([ne(0)],Jt.prototype,"portamento",void 0);var cr=class extends Pt{constructor(){super(g(cr.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new L({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}};var xe=class extends Jt{constructor(){super(g(xe.getDefaults(),arguments)),this.name="Synth";let t=g(xe.getDefaults(),arguments);this.oscillator=new Xe(Object.assign({context:this.context,detune:t.detune,onstop:()=>this.onsilence(this)},t.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new cr(Object.assign({context:this.context},t.envelope)),this.oscillator.chain(this.envelope,this.output),F(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(Jt.getDefaults(),{envelope:Object.assign(de(Pt.getDefaults(),Object.keys(C.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(de(Xe.getDefaults(),[...Object.keys(ot.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(t,e){if(this.envelope.triggerAttack(t,e),this.oscillator.start(t),this.envelope.sustain===0){let o=this.toSeconds(this.envelope.attack),n=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+o+n)}}_triggerEnvelopeRelease(t){this.envelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}};var ur=class extends xe{constructor(){super(g(ur.getDefaults(),arguments)),this.name="MembraneSynth",this.portamento=0;let t=g(ur.getDefaults(),arguments);this.pitchDecay=t.pitchDecay,this.octaves=t.octaves,F(this,["oscillator","envelope"])}static getDefaults(){return ke(Jt.getDefaults(),xe.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(t,e){let o=this.toSeconds(e),n=this.toFrequency(t instanceof Rt?t.toFrequency():t),s=n*this.octaves;return this.oscillator.frequency.setValueAtTime(s,o),this.oscillator.frequency.exponentialRampToValueAtTime(n,o+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}};Ht([hs(0)],ur.prototype,"octaves",void 0);Ht([ne(0)],ur.prototype,"pitchDecay",void 0);var to=class extends $t{constructor(){super(g(to.getDefaults(),arguments)),this.name="NoiseSynth";let t=g(to.getDefaults(),arguments);this.noise=new Ze(Object.assign({context:this.context},t.noise)),this.envelope=new cr(Object.assign({context:this.context},t.envelope)),this.noise.chain(this.envelope,this.output)}static getDefaults(){return Object.assign($t.getDefaults(),{envelope:Object.assign(de(Pt.getDefaults(),Object.keys(C.getDefaults())),{decay:.1,sustain:0}),noise:Object.assign(de(Ze.getDefaults(),Object.keys(ot.getDefaults())),{type:"white"})})}triggerAttack(t,e=1){return t=this.toSeconds(t),this.envelope.triggerAttack(t,e),this.noise.start(t),this.envelope.sustain===0&&this.noise.stop(t+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay)),this}triggerRelease(t){return t=this.toSeconds(t),this.envelope.triggerRelease(t),this.noise.stop(t+this.toSeconds(this.envelope.release)),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",0),this._syncMethod("triggerRelease",0)),this}triggerAttackRelease(t,e,o=1){return e=this.toSeconds(e),t=this.toSeconds(t),this.triggerAttack(e,o),this.triggerRelease(e+t),this}dispose(){return super.dispose(),this.noise.dispose(),this.envelope.dispose(),this}};var lp=new Set;function $o(r){lp.add(r)}function gs(r,t){let e=`registerProcessor("${r}", ${t})`;lp.add(e)}var Dg=`
	/**
	 * The base AudioWorkletProcessor for use in Tone.js. Works with the [[ToneAudioWorklet]]. 
	 */
	class ToneAudioWorkletProcessor extends AudioWorkletProcessor {

		constructor(options) {
			
			super(options);
			/**
			 * If the processor was disposed or not. Keep alive until it's disposed.
			 */
			this.disposed = false;
		   	/** 
			 * The number of samples in the processing block
			 */
			this.blockSize = 128;
			/**
			 * the sample rate
			 */
			this.sampleRate = sampleRate;

			this.port.onmessage = (event) => {
				// when it receives a dispose 
				if (event.data === "dispose") {
					this.disposed = true;
				}
			};
		}
	}
`;$o(Dg);var Eg=`
	/**
	 * Abstract class for a single input/output processor. 
	 * has a 'generate' function which processes one sample at a time
	 */
	class SingleIOProcessor extends ToneAudioWorkletProcessor {

		constructor(options) {
			super(Object.assign(options, {
				numberOfInputs: 1,
				numberOfOutputs: 1
			}));
			/**
			 * Holds the name of the parameter and a single value of that
			 * parameter at the current sample
			 * @type { [name: string]: number }
			 */
			this.params = {}
		}

		/**
		 * Generate an output sample from the input sample and parameters
		 * @abstract
		 * @param input number
		 * @param channel number
		 * @param parameters { [name: string]: number }
		 * @returns number
		 */
		generate(){}

		/**
		 * Update the private params object with the 
		 * values of the parameters at the given index
		 * @param parameters { [name: string]: Float32Array },
		 * @param index number
		 */
		updateParams(parameters, index) {
			for (const paramName in parameters) {
				const param = parameters[paramName];
				if (param.length > 1) {
					this.params[paramName] = parameters[paramName][index];
				} else {
					this.params[paramName] = parameters[paramName][0];
				}
			}
		}

		/**
		 * Process a single frame of the audio
		 * @param inputs Float32Array[][]
		 * @param outputs Float32Array[][]
		 */
		process(inputs, outputs, parameters) {
			const input = inputs[0];
			const output = outputs[0];
			// get the parameter values
			const channelCount = Math.max(input && input.length || 0, output.length);
			for (let sample = 0; sample < this.blockSize; sample++) {
				this.updateParams(parameters, sample);
				for (let channel = 0; channel < channelCount; channel++) {
					const inputSample = input && input.length ? input[channel][sample] : 0;
					output[channel][sample] = this.generate(inputSample, channel, this.params);
				}
			}
			return !this.disposed;
		}
	};
`;$o(Eg);var Mg=`
	/**
	 * A multichannel buffer for use within an AudioWorkletProcessor as a delay line
	 */
	class DelayLine {
		
		constructor(size, channels) {
			this.buffer = [];
			this.writeHead = []
			this.size = size;

			// create the empty channels
			for (let i = 0; i < channels; i++) {
				this.buffer[i] = new Float32Array(this.size);
				this.writeHead[i] = 0;
			}
		}

		/**
		 * Push a value onto the end
		 * @param channel number
		 * @param value number
		 */
		push(channel, value) {
			this.writeHead[channel] += 1;
			if (this.writeHead[channel] > this.size) {
				this.writeHead[channel] = 0;
			}
			this.buffer[channel][this.writeHead[channel]] = value;
		}

		/**
		 * Get the recorded value of the channel given the delay
		 * @param channel number
		 * @param delay number delay samples
		 */
		get(channel, delay) {
			let readHead = this.writeHead[channel] - Math.floor(delay);
			if (readHead < 0) {
				readHead += this.size;
			}
			return this.buffer[channel][readHead];
		}
	}
`;$o(Mg);var hp="feedback-comb-filter",Fg=`
	class FeedbackCombFilterWorklet extends SingleIOProcessor {

		constructor(options) {
			super(options);
			this.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);
		}

		static get parameterDescriptors() {
			return [{
				name: "delayTime",
				defaultValue: 0.1,
				minValue: 0,
				maxValue: 1,
				automationRate: "k-rate"
			}, {
				name: "feedback",
				defaultValue: 0.5,
				minValue: 0,
				maxValue: 0.9999,
				automationRate: "k-rate"
			}];
		}

		generate(input, channel, parameters) {
			const delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);
			this.delayLine.push(channel, input + delayedSample * parameters.feedback);
			return delayedSample;
		}
	}
`;gs(hp,Fg);var Mr=class extends C{constructor(){super(g(Mr.getDefaults(),arguments,["frequency","type"])),this.name="OnePoleFilter";let t=g(Mr.getDefaults(),arguments,["frequency","type"]);this._frequency=t.frequency,this._type=t.type,this.input=new L({context:this.context}),this.output=new L({context:this.context}),this._createFilter()}static getDefaults(){return Object.assign(C.getDefaults(),{frequency:880,type:"lowpass"})}_createFilter(){let t=this._filter,e=this.toFrequency(this._frequency),o=1/(2*Math.PI*e);if(this._type==="lowpass"){let n=1/(o*this.context.sampleRate),s=n-1;this._filter=this.context.createIIRFilter([n,0],[1,s])}else{let n=1/(o*this.context.sampleRate)-1;this._filter=this.context.createIIRFilter([1,-1],[1,n])}this.input.chain(this._filter,this.output),t&&this.context.setTimeout(()=>{this.disposed||(this.input.disconnect(t),t.disconnect())},this.blockTime)}get frequency(){return this._frequency}set frequency(t){this._frequency=t,this._createFilter()}get type(){return this._type}set type(t){this._type=t,this._createFilter()}getFrequencyResponse(t=128){let e=new Float32Array(t);for(let s=0;s<t;s++){let a=Math.pow(s/t,2)*(2e4-20)+20;e[s]=a}let o=new Float32Array(t),n=new Float32Array(t);return this._filter.getFrequencyResponse(e,o,n),o}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this._filter.disconnect(),this}};var eo=class extends $t{constructor(){super(g(eo.getDefaults(),arguments,["urls","onload","baseUrl"],"urls")),this.name="Sampler",this._activeSources=new Map;let t=g(eo.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),e={};Object.keys(t.urls).forEach(o=>{let n=parseInt(o,10);if(G(yn(o)||Gt(n)&&isFinite(n),`url key is neither a note or midi pitch: ${o}`),yn(o)){let s=new Rt(this.context,o).toMidi();e[s]=t.urls[o]}else Gt(n)&&isFinite(n)&&(e[n]=t.urls[n])}),this._buffers=new Nr({urls:e,onload:t.onload,baseUrl:t.baseUrl,onerror:t.onerror}),this.attack=t.attack,this.release=t.release,this.curve=t.curve,this._buffers.loaded&&Promise.resolve().then(t.onload)}static getDefaults(){return Object.assign($t.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:X,onerror:X,release:.1,urls:{}})}_findClosest(t){let o=0;for(;o<96;){if(this._buffers.has(t+o))return-o;if(this._buffers.has(t-o))return o;o++}throw new Error(`No available buffers for note: ${t}`)}triggerAttack(t,e,o=1){return this.log("triggerAttack",t,e,o),Array.isArray(t)||(t=[t]),t.forEach(n=>{let s=ki(new Rt(this.context,n).toFrequency()),i=Math.round(s),a=s-i,c=this._findClosest(i),u=i-c,l=this._buffers.get(u),h=$r(c+a),p=new ue({url:l,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:h}).connect(this.output);p.start(e,0,l.duration/h,o),Nt(this._activeSources.get(i))||this._activeSources.set(i,[]),this._activeSources.get(i).push(p),p.onended=()=>{if(this._activeSources&&this._activeSources.has(i)){let m=this._activeSources.get(i),f=m.indexOf(p);f!==-1&&m.splice(f,1)}}}),this}triggerRelease(t,e){return this.log("triggerRelease",t,e),Array.isArray(t)||(t=[t]),t.forEach(o=>{let n=new Rt(this.context,o).toMidi();if(this._activeSources.has(n)&&this._activeSources.get(n).length){let s=this._activeSources.get(n);e=this.toSeconds(e),s.forEach(i=>{i.stop(e)}),this._activeSources.set(n,[])}}),this}releaseAll(t){let e=this.toSeconds(t);return this._activeSources.forEach(o=>{for(;o.length;)o.shift().stop(e)}),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(t,e,o,n=1){let s=this.toSeconds(o);return this.triggerAttack(t,s,n),Nt(e)?(G(Nt(t),"notes must be an array when duration is array"),t.forEach((i,a)=>{let c=e[Math.min(a,e.length-1)];this.triggerRelease(i,s+this.toSeconds(c))})):this.triggerRelease(t,s+this.toSeconds(e)),this}add(t,e,o){if(G(yn(t)||isFinite(t),`note must be a pitch or midi: ${t}`),yn(t)){let n=new Rt(this.context,t).toMidi();this._buffers.add(n,e,o)}else this._buffers.add(t,e,o);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(t=>{t.forEach(e=>e.dispose())}),this._activeSources.clear(),this}};Ht([ne(0)],eo.prototype,"attack",void 0);Ht([ne(0)],eo.prototype,"release",void 0);var lr=class extends ft{constructor(){super(g(lr.getDefaults(),arguments,["callback","value"])),this.name="ToneEvent",this._state=new Oe("stopped"),this._startOffset=0;let t=g(lr.getDefaults(),arguments,["callback","value"]);this._loop=t.loop,this.callback=t.callback,this.value=t.value,this._loopStart=this.toTicks(t.loopStart),this._loopEnd=this.toTicks(t.loopEnd),this._playbackRate=t.playbackRate,this._probability=t.probability,this._humanize=t.humanize,this.mute=t.mute,this._playbackRate=t.playbackRate,this._state.increasing=!0,this._rescheduleEvents()}static getDefaults(){return Object.assign(ft.getDefaults(),{callback:X,humanize:!1,loop:!1,loopEnd:"1m",loopStart:0,mute:!1,playbackRate:1,probability:1,value:null})}_rescheduleEvents(t=-1){this._state.forEachFrom(t,e=>{let o;if(e.state==="started"){e.id!==-1&&this.context.transport.clear(e.id);let n=e.time+Math.round(this.startOffset/this._playbackRate);if(this._loop===!0||Gt(this._loop)&&this._loop>1){o=1/0,Gt(this._loop)&&(o=this._loop*this._getLoopDuration());let s=this._state.getAfter(n);s!==null&&(o=Math.min(o,s.time-n)),o!==1/0&&(this._state.setStateAtTime("stopped",n+o+1,{id:-1}),o=new bt(this.context,o));let i=new bt(this.context,this._getLoopDuration());e.id=this.context.transport.scheduleRepeat(this._tick.bind(this),i,new bt(this.context,n),o)}else e.id=this.context.transport.schedule(this._tick.bind(this),new bt(this.context,n))}})}get state(){return this._state.getValueAtTime(this.context.transport.ticks)}get startOffset(){return this._startOffset}set startOffset(t){this._startOffset=t}get probability(){return this._probability}set probability(t){this._probability=t}get humanize(){return this._humanize}set humanize(t){this._humanize=t}start(t){let e=this.toTicks(t);return this._state.getValueAtTime(e)==="stopped"&&(this._state.add({id:-1,state:"started",time:e}),this._rescheduleEvents(e)),this}stop(t){this.cancel(t);let e=this.toTicks(t);if(this._state.getValueAtTime(e)==="started"){this._state.setStateAtTime("stopped",e,{id:-1});let o=this._state.getBefore(e),n=e;o!==null&&(n=o.time),this._rescheduleEvents(n)}return this}cancel(t){t=re(t,-1/0);let e=this.toTicks(t);return this._state.forEachFrom(e,o=>{this.context.transport.clear(o.id)}),this._state.cancel(e),this}_tick(t){let e=this.context.transport.getTicksAtTime(t);if(!this.mute&&this._state.getValueAtTime(e)==="started"){if(this.probability<1&&Math.random()>this.probability)return;if(this.humanize){let o=.02;Kn(this.humanize)||(o=this.toSeconds(this.humanize)),t+=(Math.random()*2-1)*o}this.callback(t,this.value)}}_getLoopDuration(){return Math.round((this._loopEnd-this._loopStart)/this._playbackRate)}get loop(){return this._loop}set loop(t){this._loop=t,this._rescheduleEvents()}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._rescheduleEvents()}get loopEnd(){return new bt(this.context,this._loopEnd).toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t),this._loop&&this._rescheduleEvents()}get loopStart(){return new bt(this.context,this._loopStart).toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t),this._loop&&this._rescheduleEvents()}get progress(){if(this._loop){let t=this.context.transport.ticks,e=this._state.get(t);if(e!==null&&e.state==="started"){let o=this._getLoopDuration();return(t-e.time)%o/o}else return 0}else return 0}dispose(){return super.dispose(),this.cancel(),this._state.dispose(),this}};var Fr=class extends ft{constructor(){super(g(Fr.getDefaults(),arguments,["callback","interval"])),this.name="Loop";let t=g(Fr.getDefaults(),arguments,["callback","interval"]);this._event=new lr({context:this.context,callback:this._tick.bind(this),loop:!0,loopEnd:t.interval,playbackRate:t.playbackRate,probability:t.probability}),this.callback=t.callback,this.iterations=t.iterations}static getDefaults(){return Object.assign(ft.getDefaults(),{interval:"4n",callback:X,playbackRate:1,iterations:1/0,probability:1,mute:!1,humanize:!1})}start(t){return this._event.start(t),this}stop(t){return this._event.stop(t),this}cancel(t){return this._event.cancel(t),this}_tick(t){this.callback(t)}get state(){return this._event.state}get progress(){return this._event.progress}get interval(){return this._event.loopEnd}set interval(t){this._event.loopEnd=t}get playbackRate(){return this._event.playbackRate}set playbackRate(t){this._event.playbackRate=t}get humanize(){return this._event.humanize}set humanize(t){this._event.humanize=t}get probability(){return this._event.probability}set probability(t){this._event.probability=t}get mute(){return this._event.mute}set mute(t){this._event.mute=t}get iterations(){return this._event.loop===!0?1/0:this._event.loop}set iterations(t){t===1/0?this._event.loop=!0:this._event.loop=t}dispose(){return super.dispose(),this._event.dispose(),this}};var hr=class extends C{constructor(){super(Object.assign(g(hr.getDefaults(),arguments,["fade"]))),this.name="CrossFade",this._panner=this.context.createStereoPanner(),this._split=this.context.createChannelSplitter(2),this._g2a=new fs({context:this.context}),this.a=new L({context:this.context,gain:0}),this.b=new L({context:this.context,gain:0}),this.output=new L({context:this.context}),this._internalChannels=[this.a,this.b];let t=g(hr.getDefaults(),arguments,["fade"]);this.fade=new $({context:this.context,units:"normalRange",value:t.fade}),F(this,"fade"),this.context.getConstant(1).connect(this._panner),this._panner.connect(this._split),this._panner.channelCount=1,this._panner.channelCountMode="explicit",Ut(this._split,this.a.gain,0),Ut(this._split,this.b.gain,1),this.fade.chain(this._g2a,this._panner.pan),this.a.connect(this.output),this.b.connect(this.output)}static getDefaults(){return Object.assign(C.getDefaults(),{fade:.5})}dispose(){return super.dispose(),this.a.dispose(),this.b.dispose(),this.output.dispose(),this.fade.dispose(),this._g2a.dispose(),this._panner.disconnect(),this._split.disconnect(),this}};var se=class extends C{constructor(t){super(t),this.name="Effect",this._dryWet=new hr({context:this.context}),this.wet=this._dryWet.fade,this.effectSend=new L({context:this.context}),this.effectReturn=new L({context:this.context}),this.input=new L({context:this.context}),this.output=this._dryWet,this.input.fan(this._dryWet.a,this.effectSend),this.effectReturn.connect(this._dryWet.b),this.wet.setValueAtTime(t.wet,0),this._internalChannels=[this.effectReturn,this.effectSend],F(this,"wet")}static getDefaults(){return Object.assign(C.getDefaults(),{wet:1})}connectEffect(t){return this._internalChannels.push(t),this.effectSend.chain(t,this.effectReturn),this}dispose(){return super.dispose(),this._dryWet.dispose(),this.effectSend.dispose(),this.effectReturn.dispose(),this.wet.dispose(),this}};var Ir=class extends C{constructor(){super(Object.assign(g(Ir.getDefaults(),arguments,["pan"]))),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner;let t=g(Ir.getDefaults(),arguments,["pan"]);this.pan=new Y({context:this.context,param:this._panner.pan,value:t.pan,minValue:-1,maxValue:1}),this._panner.channelCount=t.channelCount,this._panner.channelCountMode="explicit",F(this,"pan")}static getDefaults(){return Object.assign(C.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}};var Rr=class extends C{constructor(){super(g(Rr.getDefaults(),arguments,["smoothing"])),this.name="Follower";let t=g(Rr.getDefaults(),arguments,["smoothing"]);this._abs=this.input=new ps({context:this.context}),this._lowpass=this.output=new Mr({context:this.context,frequency:1/this.toSeconds(t.smoothing),type:"lowpass"}),this._abs.connect(this._lowpass),this._smoothing=t.smoothing}static getDefaults(){return Object.assign(C.getDefaults(),{smoothing:.05})}get smoothing(){return this._smoothing}set smoothing(t){this._smoothing=t,this._lowpass.frequency=1/this.toSeconds(this.smoothing)}dispose(){return super.dispose(),this._abs.dispose(),this._lowpass.dispose(),this}};var pp="bit-crusher",Vg=`
	class BitCrusherWorklet extends SingleIOProcessor {

		static get parameterDescriptors() {
			return [{
				name: "bits",
				defaultValue: 12,
				minValue: 1,
				maxValue: 16,
				automationRate: 'k-rate'
			}];
		}

		generate(input, _channel, parameters) {
			const step = Math.pow(0.5, parameters.bits - 1);
			const val = step * Math.floor(input / step + 0.5);
			return val;
		}
	}
`;gs(pp,Vg);var Ke=class extends C{constructor(){super(g(Ke.getDefaults(),arguments,["channels"])),this.name="Split";let t=g(Ke.getDefaults(),arguments,["channels"]);this._splitter=this.input=this.output=this.context.createChannelSplitter(t.channels),this._internalChannels=[this._splitter]}static getDefaults(){return Object.assign(C.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._splitter.disconnect(),this}};var Fe=class extends C{constructor(){super(g(Fe.getDefaults(),arguments,["channels"])),this.name="Merge";let t=g(Fe.getDefaults(),arguments,["channels"]);this._merger=this.output=this.input=this.context.createChannelMerger(t.channels)}static getDefaults(){return Object.assign(C.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._merger.disconnect(),this}};var Zo=class extends se{constructor(t){super(t),this.name="FeedbackEffect",this._feedbackGain=new L({context:this.context,gain:t.feedback,units:"normalRange"}),this.feedback=this._feedbackGain.gain,F(this,"feedback"),this.effectReturn.chain(this._feedbackGain,this.effectSend)}static getDefaults(){return Object.assign(se.getDefaults(),{feedback:.125})}dispose(){return super.dispose(),this._feedbackGain.dispose(),this.feedback.dispose(),this}};var ro=class extends Zo{constructor(){super(g(ro.getDefaults(),arguments,["delayTime","feedback"])),this.name="FeedbackDelay";let t=g(ro.getDefaults(),arguments,["delayTime","feedback"]);this._delayNode=new Ee({context:this.context,delayTime:t.delayTime,maxDelay:t.maxDelay}),this.delayTime=this._delayNode.delayTime,this.connectEffect(this._delayNode),F(this,"delayTime")}static getDefaults(){return Object.assign(Zo.getDefaults(),{delayTime:.25,maxDelay:1})}dispose(){return super.dispose(),this._delayNode.dispose(),this.delayTime.dispose(),this}};var E$=[1557/44100,1617/44100,1491/44100,1422/44100,1277/44100,1356/44100,1188/44100,1116/44100];var L$=[1687/25e3,1601/25e3,2053/25e3,2251/25e3];var oo=class extends C{constructor(){super(g(oo.getDefaults(),arguments)),this.name="MidSideSplit",this._split=this.input=new Ke({channels:2,context:this.context}),this._midAdd=new Ye({context:this.context}),this.mid=new lt({context:this.context,value:Math.SQRT1_2}),this._sideSubtract=new Me({context:this.context}),this.side=new lt({context:this.context,value:Math.SQRT1_2}),this._split.connect(this._midAdd,0),this._split.connect(this._midAdd.addend,1),this._split.connect(this._sideSubtract,0),this._split.connect(this._sideSubtract.subtrahend,1),this._midAdd.connect(this.mid),this._sideSubtract.connect(this.side)}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._midAdd.dispose(),this._sideSubtract.dispose(),this._split.dispose(),this}};var no=class extends C{constructor(){super(g(no.getDefaults(),arguments)),this.name="MidSideMerge",this.mid=new L({context:this.context}),this.side=new L({context:this.context}),this._left=new Ye({context:this.context}),this._leftMult=new lt({context:this.context,value:Math.SQRT1_2}),this._right=new Me({context:this.context}),this._rightMult=new lt({context:this.context,value:Math.SQRT1_2}),this._merge=this.output=new Fe({context:this.context}),this.mid.fan(this._left),this.side.connect(this._left.addend),this.mid.connect(this._right),this.side.connect(this._right.subtrahend),this._left.connect(this._leftMult),this._right.connect(this._rightMult),this._leftMult.connect(this._merge,0,0),this._rightMult.connect(this._merge,0,1)}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._leftMult.dispose(),this._rightMult.dispose(),this._left.dispose(),this._right.dispose(),this}};var xt=class extends C{constructor(){super(g(xt.getDefaults(),arguments,["solo"])),this.name="Solo";let t=g(xt.getDefaults(),arguments,["solo"]);this.input=this.output=new L({context:this.context}),xt._allSolos.has(this.context)||xt._allSolos.set(this.context,new Set),xt._allSolos.get(this.context).add(this),this.solo=t.solo}static getDefaults(){return Object.assign(C.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(t){t?this._addSolo():this._removeSolo(),xt._allSolos.get(this.context).forEach(e=>e._updateSolo())}get muted(){return this.input.gain.value===0}_addSolo(){xt._soloed.has(this.context)||xt._soloed.set(this.context,new Set),xt._soloed.get(this.context).add(this)}_removeSolo(){xt._soloed.has(this.context)&&xt._soloed.get(this.context).delete(this)}_isSoloed(){return xt._soloed.has(this.context)&&xt._soloed.get(this.context).has(this)}_noSolos(){return!xt._soloed.has(this.context)||xt._soloed.has(this.context)&&xt._soloed.get(this.context).size===0}_updateSolo(){this._isSoloed()?this.input.gain.value=1:this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),xt._allSolos.get(this.context).delete(this),this._removeSolo(),this}};xt._allSolos=new Map;xt._soloed=new Map;var so=class extends C{constructor(){super(g(so.getDefaults(),arguments,["pan","volume"])),this.name="PanVol";let t=g(so.getDefaults(),arguments,["pan","volume"]);this._panner=this.input=new Ir({context:this.context,pan:t.pan,channelCount:t.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new Kt({context:this.context,volume:t.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=t.mute,F(this,["pan","volume"])}static getDefaults(){return Object.assign(C.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}};var pr=class extends C{constructor(){super(g(pr.getDefaults(),arguments,["volume","pan"])),this.name="Channel";let t=g(pr.getDefaults(),arguments,["volume","pan"]);this._solo=this.input=new xt({solo:t.solo,context:this.context}),this._panVol=this.output=new so({context:this.context,pan:t.pan,volume:t.volume,mute:t.mute,channelCount:t.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),F(this,["pan","volume"])}static getDefaults(){return Object.assign(C.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(t){this._solo.solo=t}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(t){this._panVol.mute=t}_getBus(t){return pr.buses.has(t)||pr.buses.set(t,new L({context:this.context})),pr.buses.get(t)}send(t,e=0){let o=this._getBus(t),n=new L({context:this.context,units:"decibels",gain:e});return this.connect(n),n.connect(o),n}receive(t){return this._getBus(t).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}};pr.buses=new Map;var Fi=class extends C{constructor(){super(...arguments),this.name="Listener",this.positionX=new Y({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new Y({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new Y({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new Y({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new Y({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new Y({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new Y({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new Y({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new Y({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(C.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}};br(r=>{r.listener=new Fi({context:r})});Ar(r=>{r.listener.dispose()});var Je=class extends C{constructor(){super(g(Je.getDefaults(),arguments,["threshold","ratio"])),this.name="Compressor",this._compressor=this.context.createDynamicsCompressor(),this.input=this._compressor,this.output=this._compressor;let t=g(Je.getDefaults(),arguments,["threshold","ratio"]);this.threshold=new Y({minValue:this._compressor.threshold.minValue,maxValue:this._compressor.threshold.maxValue,context:this.context,convert:!1,param:this._compressor.threshold,units:"decibels",value:t.threshold}),this.attack=new Y({minValue:this._compressor.attack.minValue,maxValue:this._compressor.attack.maxValue,context:this.context,param:this._compressor.attack,units:"time",value:t.attack}),this.release=new Y({minValue:this._compressor.release.minValue,maxValue:this._compressor.release.maxValue,context:this.context,param:this._compressor.release,units:"time",value:t.release}),this.knee=new Y({minValue:this._compressor.knee.minValue,maxValue:this._compressor.knee.maxValue,context:this.context,convert:!1,param:this._compressor.knee,units:"decibels",value:t.knee}),this.ratio=new Y({minValue:this._compressor.ratio.minValue,maxValue:this._compressor.ratio.maxValue,context:this.context,convert:!1,param:this._compressor.ratio,units:"positive",value:t.ratio}),F(this,["knee","release","attack","ratio","threshold"])}static getDefaults(){return Object.assign(C.getDefaults(),{attack:.003,knee:30,ratio:12,release:.25,threshold:-24})}get reduction(){return this._compressor.reduction}dispose(){return super.dispose(),this._compressor.disconnect(),this.attack.dispose(),this.release.dispose(),this.threshold.dispose(),this.ratio.dispose(),this.knee.dispose(),this}};var io=class extends C{constructor(){super(Object.assign(g(io.getDefaults(),arguments,["threshold","smoothing"]))),this.name="Gate";let t=g(io.getDefaults(),arguments,["threshold","smoothing"]);this._follower=new Rr({context:this.context,smoothing:t.smoothing}),this._gt=new Jr({context:this.context,value:Sr(t.threshold)}),this.input=new L({context:this.context}),this._gate=this.output=new L({context:this.context}),this.input.connect(this._gate),this.input.chain(this._follower,this._gt,this._gate.gain)}static getDefaults(){return Object.assign(C.getDefaults(),{smoothing:.1,threshold:-40})}get threshold(){return Hr(this._gt.value)}set threshold(t){this._gt.value=Sr(t)}get smoothing(){return this._follower.smoothing}set smoothing(t){this._follower.smoothing=t}dispose(){return super.dispose(),this.input.dispose(),this._follower.dispose(),this._gt.dispose(),this._gate.dispose(),this}};var ao=class extends C{constructor(){super(Object.assign(g(ao.getDefaults(),arguments))),this.name="MidSideCompressor";let t=g(ao.getDefaults(),arguments);this._midSideSplit=this.input=new oo({context:this.context}),this._midSideMerge=this.output=new no({context:this.context}),this.mid=new Je(Object.assign(t.mid,{context:this.context})),this.side=new Je(Object.assign(t.side,{context:this.context})),this._midSideSplit.mid.chain(this.mid,this._midSideMerge.mid),this._midSideSplit.side.chain(this.side,this._midSideMerge.side),F(this,["mid","side"])}static getDefaults(){return Object.assign(C.getDefaults(),{mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},side:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10}})}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._midSideSplit.dispose(),this._midSideMerge.dispose(),this}};var fp=Ct().transport;var mp=Ct().destination,OK=Ct().destination;var DK=Ct().listener;var EK=Ct().draw;var MK=Ct();var xs="http://www.w3.org/1999/xhtml",Ii={svg:"http://www.w3.org/2000/svg",xhtml:xs,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ys(r){var t=r+="",e=t.indexOf(":");return e>=0&&(t=r.slice(0,e))!=="xmlns"&&(r=r.slice(e+1)),Ii.hasOwnProperty(t)?{space:Ii[t],local:r}:r}function jg(r){return function(){var t=this.ownerDocument,e=this.namespaceURI;return e===xs&&t.documentElement.namespaceURI===xs?t.createElement(r):t.createElementNS(e,r)}}function Gg(r){return function(){return this.ownerDocument.createElementNS(r.space,r.local)}}function vs(r){var t=ys(r);return(t.local?Gg:jg)(t)}function zg(){}function ws(r){return r==null?zg:function(){return this.querySelector(r)}}function dp(r){typeof r!="function"&&(r=ws(r));for(var t=this._groups,e=t.length,o=new Array(e),n=0;n<e;++n)for(var s=t[n],i=s.length,a=o[n]=new Array(i),c,u,l=0;l<i;++l)(c=s[l])&&(u=r.call(c,c.__data__,l,s))&&("__data__"in c&&(u.__data__=c.__data__),a[l]=u);return new dt(o,this._parents)}function bn(r){return r==null?[]:Array.isArray(r)?r:Array.from(r)}function Ug(){return[]}function gp(r){return r==null?Ug:function(){return this.querySelectorAll(r)}}function Hg(r){return function(){return bn(r.apply(this,arguments))}}function _p(r){typeof r=="function"?r=Hg(r):r=gp(r);for(var t=this._groups,e=t.length,o=[],n=[],s=0;s<e;++s)for(var i=t[s],a=i.length,c,u=0;u<a;++u)(c=i[u])&&(o.push(r.call(c,c.__data__,u,i)),n.push(c));return new dt(o,n)}function xp(r){return function(){return this.matches(r)}}function bs(r){return function(t){return t.matches(r)}}var $g=Array.prototype.find;function Zg(r){return function(){return $g.call(this.children,r)}}function Qg(){return this.firstElementChild}function yp(r){return this.select(r==null?Qg:Zg(typeof r=="function"?r:bs(r)))}var Xg=Array.prototype.filter;function Yg(){return Array.from(this.children)}function Kg(r){return function(){return Xg.call(this.children,r)}}function vp(r){return this.selectAll(r==null?Yg:Kg(typeof r=="function"?r:bs(r)))}function wp(r){typeof r!="function"&&(r=xp(r));for(var t=this._groups,e=t.length,o=new Array(e),n=0;n<e;++n)for(var s=t[n],i=s.length,a=o[n]=[],c,u=0;u<i;++u)(c=s[u])&&r.call(c,c.__data__,u,s)&&a.push(c);return new dt(o,this._parents)}function As(r){return new Array(r.length)}function bp(){return new dt(this._enter||this._groups.map(As),this._parents)}function An(r,t){this.ownerDocument=r.ownerDocument,this.namespaceURI=r.namespaceURI,this._next=null,this._parent=r,this.__data__=t}An.prototype={constructor:An,appendChild:function(r){return this._parent.insertBefore(r,this._next)},insertBefore:function(r,t){return this._parent.insertBefore(r,t)},querySelector:function(r){return this._parent.querySelector(r)},querySelectorAll:function(r){return this._parent.querySelectorAll(r)}};function Ap(r){return function(){return r}}function Jg(r,t,e,o,n,s){for(var i=0,a,c=t.length,u=s.length;i<u;++i)(a=t[i])?(a.__data__=s[i],o[i]=a):e[i]=new An(r,s[i]);for(;i<c;++i)(a=t[i])&&(n[i]=a)}function t_(r,t,e,o,n,s,i){var a,c,u=new Map,l=t.length,h=s.length,p=new Array(l),m;for(a=0;a<l;++a)(c=t[a])&&(p[a]=m=i.call(c,c.__data__,a,t)+"",u.has(m)?n[a]=c:u.set(m,c));for(a=0;a<h;++a)m=i.call(r,s[a],a,s)+"",(c=u.get(m))?(o[a]=c,c.__data__=s[a],u.delete(m)):e[a]=new An(r,s[a]);for(a=0;a<l;++a)(c=t[a])&&u.get(p[a])===c&&(n[a]=c)}function e_(r){return r.__data__}function Sp(r,t){if(!arguments.length)return Array.from(this,e_);var e=t?t_:Jg,o=this._parents,n=this._groups;typeof r!="function"&&(r=Ap(r));for(var s=n.length,i=new Array(s),a=new Array(s),c=new Array(s),u=0;u<s;++u){var l=o[u],h=n[u],p=h.length,m=r_(r.call(l,l&&l.__data__,u,o)),f=m.length,d=a[u]=new Array(f),x=i[u]=new Array(f),y=c[u]=new Array(p);e(l,h,d,x,y,m,t);for(var w=0,O=0,D,_;w<f;++w)if(D=d[w]){for(w>=O&&(O=w+1);!(_=x[O])&&++O<f;);D._next=_||null}}return i=new dt(i,o),i._enter=a,i._exit=c,i}function r_(r){return typeof r=="object"&&"length"in r?r:Array.from(r)}function Tp(){return new dt(this._exit||this._groups.map(As),this._parents)}function Np(r,t,e){var o=this.enter(),n=this,s=this.exit();return typeof r=="function"?(o=r(o),o&&(o=o.selection())):o=o.append(r+""),t!=null&&(n=t(n),n&&(n=n.selection())),e==null?s.remove():e(s),o&&n?o.merge(n).order():n}function Cp(r){for(var t=r.selection?r.selection():r,e=this._groups,o=t._groups,n=e.length,s=o.length,i=Math.min(n,s),a=new Array(n),c=0;c<i;++c)for(var u=e[c],l=o[c],h=u.length,p=a[c]=new Array(h),m,f=0;f<h;++f)(m=u[f]||l[f])&&(p[f]=m);for(;c<n;++c)a[c]=e[c];return new dt(a,this._parents)}function kp(){for(var r=this._groups,t=-1,e=r.length;++t<e;)for(var o=r[t],n=o.length-1,s=o[n],i;--n>=0;)(i=o[n])&&(s&&i.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(i,s),s=i);return this}function Op(r){r||(r=o_);function t(h,p){return h&&p?r(h.__data__,p.__data__):!h-!p}for(var e=this._groups,o=e.length,n=new Array(o),s=0;s<o;++s){for(var i=e[s],a=i.length,c=n[s]=new Array(a),u,l=0;l<a;++l)(u=i[l])&&(c[l]=u);c.sort(t)}return new dt(n,this._parents).order()}function o_(r,t){return r<t?-1:r>t?1:r>=t?0:NaN}function Dp(){var r=arguments[0];return arguments[0]=this,r.apply(null,arguments),this}function Ep(){return Array.from(this)}function Mp(){for(var r=this._groups,t=0,e=r.length;t<e;++t)for(var o=r[t],n=0,s=o.length;n<s;++n){var i=o[n];if(i)return i}return null}function Fp(){let r=0;for(let t of this)++r;return r}function Ip(){return!this.node()}function Rp(r){for(var t=this._groups,e=0,o=t.length;e<o;++e)for(var n=t[e],s=0,i=n.length,a;s<i;++s)(a=n[s])&&r.call(a,a.__data__,s,n);return this}function n_(r){return function(){this.removeAttribute(r)}}function s_(r){return function(){this.removeAttributeNS(r.space,r.local)}}function i_(r,t){return function(){this.setAttribute(r,t)}}function a_(r,t){return function(){this.setAttributeNS(r.space,r.local,t)}}function c_(r,t){return function(){var e=t.apply(this,arguments);e==null?this.removeAttribute(r):this.setAttribute(r,e)}}function u_(r,t){return function(){var e=t.apply(this,arguments);e==null?this.removeAttributeNS(r.space,r.local):this.setAttributeNS(r.space,r.local,e)}}function qp(r,t){var e=ys(r);if(arguments.length<2){var o=this.node();return e.local?o.getAttributeNS(e.space,e.local):o.getAttribute(e)}return this.each((t==null?e.local?s_:n_:typeof t=="function"?e.local?u_:c_:e.local?a_:i_)(e,t))}function Ss(r){return r.ownerDocument&&r.ownerDocument.defaultView||r.document&&r||r.defaultView}function l_(r){return function(){this.style.removeProperty(r)}}function h_(r,t,e){return function(){this.style.setProperty(r,t,e)}}function p_(r,t,e){return function(){var o=t.apply(this,arguments);o==null?this.style.removeProperty(r):this.style.setProperty(r,o,e)}}function Pp(r,t,e){return arguments.length>1?this.each((t==null?l_:typeof t=="function"?p_:h_)(r,t,e??"")):f_(this.node(),r)}function f_(r,t){return r.style.getPropertyValue(t)||Ss(r).getComputedStyle(r,null).getPropertyValue(t)}function m_(r){return function(){delete this[r]}}function d_(r,t){return function(){this[r]=t}}function g_(r,t){return function(){var e=t.apply(this,arguments);e==null?delete this[r]:this[r]=e}}function Vp(r,t){return arguments.length>1?this.each((t==null?m_:typeof t=="function"?g_:d_)(r,t)):this.node()[r]}function Lp(r){return r.trim().split(/^|\s+/)}function Ri(r){return r.classList||new Bp(r)}function Bp(r){this._node=r,this._names=Lp(r.getAttribute("class")||"")}Bp.prototype={add:function(r){var t=this._names.indexOf(r);t<0&&(this._names.push(r),this._node.setAttribute("class",this._names.join(" ")))},remove:function(r){var t=this._names.indexOf(r);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(r){return this._names.indexOf(r)>=0}};function Wp(r,t){for(var e=Ri(r),o=-1,n=t.length;++o<n;)e.add(t[o])}function jp(r,t){for(var e=Ri(r),o=-1,n=t.length;++o<n;)e.remove(t[o])}function __(r){return function(){Wp(this,r)}}function x_(r){return function(){jp(this,r)}}function y_(r,t){return function(){(t.apply(this,arguments)?Wp:jp)(this,r)}}function Gp(r,t){var e=Lp(r+"");if(arguments.length<2){for(var o=Ri(this.node()),n=-1,s=e.length;++n<s;)if(!o.contains(e[n]))return!1;return!0}return this.each((typeof t=="function"?y_:t?__:x_)(e,t))}function v_(){this.textContent=""}function w_(r){return function(){this.textContent=r}}function b_(r){return function(){var t=r.apply(this,arguments);this.textContent=t??""}}function zp(r){return arguments.length?this.each(r==null?v_:(typeof r=="function"?b_:w_)(r)):this.node().textContent}function A_(){this.innerHTML=""}function S_(r){return function(){this.innerHTML=r}}function T_(r){return function(){var t=r.apply(this,arguments);this.innerHTML=t??""}}function Up(r){return arguments.length?this.each(r==null?A_:(typeof r=="function"?T_:S_)(r)):this.node().innerHTML}function N_(){this.nextSibling&&this.parentNode.appendChild(this)}function Hp(){return this.each(N_)}function C_(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function $p(){return this.each(C_)}function Zp(r){var t=typeof r=="function"?r:vs(r);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function k_(){return null}function Qp(r,t){var e=typeof r=="function"?r:vs(r),o=t==null?k_:typeof t=="function"?t:ws(t);return this.select(function(){return this.insertBefore(e.apply(this,arguments),o.apply(this,arguments)||null)})}function O_(){var r=this.parentNode;r&&r.removeChild(this)}function Xp(){return this.each(O_)}function D_(){var r=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(r,this.nextSibling):r}function E_(){var r=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(r,this.nextSibling):r}function Yp(r){return this.select(r?E_:D_)}function Kp(r){return arguments.length?this.property("__data__",r):this.node().__data__}function M_(r){return function(t){r.call(this,t,this.__data__)}}function F_(r){return r.trim().split(/^|\s+/).map(function(t){var e="",o=t.indexOf(".");return o>=0&&(e=t.slice(o+1),t=t.slice(0,o)),{type:t,name:e}})}function I_(r){return function(){var t=this.__on;if(!!t){for(var e=0,o=-1,n=t.length,s;e<n;++e)s=t[e],(!r.type||s.type===r.type)&&s.name===r.name?this.removeEventListener(s.type,s.listener,s.options):t[++o]=s;++o?t.length=o:delete this.__on}}}function R_(r,t,e){return function(){var o=this.__on,n,s=M_(t);if(o){for(var i=0,a=o.length;i<a;++i)if((n=o[i]).type===r.type&&n.name===r.name){this.removeEventListener(n.type,n.listener,n.options),this.addEventListener(n.type,n.listener=s,n.options=e),n.value=t;return}}this.addEventListener(r.type,s,e),n={type:r.type,name:r.name,value:t,listener:s,options:e},o?o.push(n):this.__on=[n]}}function Jp(r,t,e){var o=F_(r+""),n,s=o.length,i;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,u=a.length,l;c<u;++c)for(n=0,l=a[c];n<s;++n)if((i=o[n]).type===l.type&&i.name===l.name)return l.value}return}for(a=t?R_:I_,n=0;n<s;++n)this.each(a(o[n],t,e));return this}function tf(r,t,e){var o=Ss(r),n=o.CustomEvent;typeof n=="function"?n=new n(t,e):(n=o.document.createEvent("Event"),e?(n.initEvent(t,e.bubbles,e.cancelable),n.detail=e.detail):n.initEvent(t,!1,!1)),r.dispatchEvent(n)}function q_(r,t){return function(){return tf(this,r,t)}}function P_(r,t){return function(){return tf(this,r,t.apply(this,arguments))}}function ef(r,t){return this.each((typeof t=="function"?P_:q_)(r,t))}function*rf(){for(var r=this._groups,t=0,e=r.length;t<e;++t)for(var o=r[t],n=0,s=o.length,i;n<s;++n)(i=o[n])&&(yield i)}var Sn=[null];function dt(r,t){this._groups=r,this._parents=t}function V_(){return new dt([[document.documentElement]],Sn)}function L_(){return this}dt.prototype=V_.prototype={constructor:dt,select:dp,selectAll:_p,selectChild:yp,selectChildren:vp,filter:wp,data:Sp,enter:bp,exit:Tp,join:Np,merge:Cp,selection:L_,order:kp,sort:Op,call:Dp,nodes:Ep,node:Mp,size:Fp,empty:Ip,each:Rp,attr:qp,style:Pp,property:Vp,classed:Gp,text:zp,html:Up,raise:Hp,lower:$p,append:Zp,insert:Qp,remove:Xp,clone:Yp,datum:Kp,on:Jp,dispatch:ef,[Symbol.iterator]:rf};function qi(r){return typeof r=="string"?new dt([[document.querySelector(r)]],[document.documentElement]):new dt([[r]],Sn)}function Pi(r){return typeof r=="string"?new dt([document.querySelectorAll(r)],[document.documentElement]):new dt([bn(r)],Sn)}function Qo(r,t){return r==null||t==null?NaN:r<t?-1:r>t?1:r>=t?0:NaN}function Ts(r){let t=r,e=r,o=r;r.length!==2&&(t=(a,c)=>r(a)-c,e=Qo,o=(a,c)=>Qo(r(a),c));function n(a,c,u=0,l=a.length){if(u<l){if(e(c,c)!==0)return l;do{let h=u+l>>>1;o(a[h],c)<0?u=h+1:l=h}while(u<l)}return u}function s(a,c,u=0,l=a.length){if(u<l){if(e(c,c)!==0)return l;do{let h=u+l>>>1;o(a[h],c)<=0?u=h+1:l=h}while(u<l)}return u}function i(a,c,u=0,l=a.length){let h=n(a,c,u,l-1);return h>u&&t(a[h-1],c)>-t(a[h],c)?h-1:h}return{left:n,center:i,right:s}}function Vi(r){return r===null?NaN:+r}var of=Ts(Qo),nf=of.right,B_=of.left,W_=Ts(Vi).center,Li=nf;var Bi=Math.sqrt(50),Wi=Math.sqrt(10),ji=Math.sqrt(2);function Ns(r,t,e){var o,n=-1,s,i,a;if(t=+t,r=+r,e=+e,r===t&&e>0)return[r];if((o=t<r)&&(s=r,r=t,t=s),(a=Cs(r,t,e))===0||!isFinite(a))return[];if(a>0){let c=Math.round(r/a),u=Math.round(t/a);for(c*a<r&&++c,u*a>t&&--u,i=new Array(s=u-c+1);++n<s;)i[n]=(c+n)*a}else{a=-a;let c=Math.round(r*a),u=Math.round(t*a);for(c/a<r&&++c,u/a>t&&--u,i=new Array(s=u-c+1);++n<s;)i[n]=(c+n)/a}return o&&i.reverse(),i}function Cs(r,t,e){var o=(t-r)/Math.max(0,e),n=Math.floor(Math.log(o)/Math.LN10),s=o/Math.pow(10,n);return n>=0?(s>=Bi?10:s>=Wi?5:s>=ji?2:1)*Math.pow(10,n):-Math.pow(10,-n)/(s>=Bi?10:s>=Wi?5:s>=ji?2:1)}function Gi(r,t,e){var o=Math.abs(t-r)/Math.max(0,e),n=Math.pow(10,Math.floor(Math.log(o)/Math.LN10)),s=o/n;return s>=Bi?n*=10:s>=Wi?n*=5:s>=ji&&(n*=2),t<r?-n:n}function sf(r,t){switch(arguments.length){case 0:break;case 1:this.range(r);break;default:this.range(t).domain(r);break}return this}function ks(r,t,e){r.prototype=t.prototype=e,e.constructor=r}function zi(r,t){var e=Object.create(r.prototype);for(var o in t)e[o]=t[o];return e}function Cn(){}var Tn=.7,Es=1/Tn,Xo="\\s*([+-]?\\d+)\\s*",Nn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",tr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",j_=/^#([0-9a-f]{3,8})$/,G_=new RegExp(`^rgb\\(${Xo},${Xo},${Xo}\\)$`),z_=new RegExp(`^rgb\\(${tr},${tr},${tr}\\)$`),U_=new RegExp(`^rgba\\(${Xo},${Xo},${Xo},${Nn}\\)$`),H_=new RegExp(`^rgba\\(${tr},${tr},${tr},${Nn}\\)$`),$_=new RegExp(`^hsl\\(${Nn},${tr},${tr}\\)$`),Z_=new RegExp(`^hsla\\(${Nn},${tr},${tr},${Nn}\\)$`),af={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ks(Cn,qr,{copy(r){return Object.assign(new this.constructor,this,r)},displayable(){return this.rgb().displayable()},hex:cf,formatHex:cf,formatHex8:Q_,formatHsl:X_,formatRgb:uf,toString:uf});function cf(){return this.rgb().formatHex()}function Q_(){return this.rgb().formatHex8()}function X_(){return df(this).formatHsl()}function uf(){return this.rgb().formatRgb()}function qr(r){var t,e;return r=(r+"").trim().toLowerCase(),(t=j_.exec(r))?(e=t[1].length,t=parseInt(t[1],16),e===6?lf(t):e===3?new ie(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):e===8?Os(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):e===4?Os(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=G_.exec(r))?new ie(t[1],t[2],t[3],1):(t=z_.exec(r))?new ie(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=U_.exec(r))?Os(t[1],t[2],t[3],t[4]):(t=H_.exec(r))?Os(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=$_.exec(r))?ff(t[1],t[2]/100,t[3]/100,1):(t=Z_.exec(r))?ff(t[1],t[2]/100,t[3]/100,t[4]):af.hasOwnProperty(r)?lf(af[r]):r==="transparent"?new ie(NaN,NaN,NaN,0):null}function lf(r){return new ie(r>>16&255,r>>8&255,r&255,1)}function Os(r,t,e,o){return o<=0&&(r=t=e=NaN),new ie(r,t,e,o)}function Y_(r){return r instanceof Cn||(r=qr(r)),r?(r=r.rgb(),new ie(r.r,r.g,r.b,r.opacity)):new ie}function Yo(r,t,e,o){return arguments.length===1?Y_(r):new ie(r,t,e,o??1)}function ie(r,t,e,o){this.r=+r,this.g=+t,this.b=+e,this.opacity=+o}ks(ie,Yo,zi(Cn,{brighter(r){return r=r==null?Es:Math.pow(Es,r),new ie(this.r*r,this.g*r,this.b*r,this.opacity)},darker(r){return r=r==null?Tn:Math.pow(Tn,r),new ie(this.r*r,this.g*r,this.b*r,this.opacity)},rgb(){return this},clamp(){return new ie(uo(this.r),uo(this.g),uo(this.b),Ms(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:hf,formatHex:hf,formatHex8:K_,formatRgb:pf,toString:pf}));function hf(){return`#${co(this.r)}${co(this.g)}${co(this.b)}`}function K_(){return`#${co(this.r)}${co(this.g)}${co(this.b)}${co((isNaN(this.opacity)?1:this.opacity)*255)}`}function pf(){let r=Ms(this.opacity);return`${r===1?"rgb(":"rgba("}${uo(this.r)}, ${uo(this.g)}, ${uo(this.b)}${r===1?")":`, ${r})`}`}function Ms(r){return isNaN(r)?1:Math.max(0,Math.min(1,r))}function uo(r){return Math.max(0,Math.min(255,Math.round(r)||0))}function co(r){return r=uo(r),(r<16?"0":"")+r.toString(16)}function ff(r,t,e,o){return o<=0?r=t=e=NaN:e<=0||e>=1?r=t=NaN:t<=0&&(r=NaN),new Ie(r,t,e,o)}function df(r){if(r instanceof Ie)return new Ie(r.h,r.s,r.l,r.opacity);if(r instanceof Cn||(r=qr(r)),!r)return new Ie;if(r instanceof Ie)return r;r=r.rgb();var t=r.r/255,e=r.g/255,o=r.b/255,n=Math.min(t,e,o),s=Math.max(t,e,o),i=NaN,a=s-n,c=(s+n)/2;return a?(t===s?i=(e-o)/a+(e<o)*6:e===s?i=(o-t)/a+2:i=(t-e)/a+4,a/=c<.5?s+n:2-s-n,i*=60):a=c>0&&c<1?0:i,new Ie(i,a,c,r.opacity)}function gf(r,t,e,o){return arguments.length===1?df(r):new Ie(r,t,e,o??1)}function Ie(r,t,e,o){this.h=+r,this.s=+t,this.l=+e,this.opacity=+o}ks(Ie,gf,zi(Cn,{brighter(r){return r=r==null?Es:Math.pow(Es,r),new Ie(this.h,this.s,this.l*r,this.opacity)},darker(r){return r=r==null?Tn:Math.pow(Tn,r),new Ie(this.h,this.s,this.l*r,this.opacity)},rgb(){var r=this.h%360+(this.h<0)*360,t=isNaN(r)||isNaN(this.s)?0:this.s,e=this.l,o=e+(e<.5?e:1-e)*t,n=2*e-o;return new ie(Ui(r>=240?r-240:r+120,n,o),Ui(r,n,o),Ui(r<120?r+240:r-120,n,o),this.opacity)},clamp(){return new Ie(mf(this.h),Ds(this.s),Ds(this.l),Ms(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let r=Ms(this.opacity);return`${r===1?"hsl(":"hsla("}${mf(this.h)}, ${Ds(this.s)*100}%, ${Ds(this.l)*100}%${r===1?")":`, ${r})`}`}}));function mf(r){return r=(r||0)%360,r<0?r+360:r}function Ds(r){return Math.max(0,Math.min(1,r||0))}function Ui(r,t,e){return(r<60?t+(e-t)*r/60:r<180?e:r<240?t+(e-t)*(240-r)/60:t)*255}function Hi(r,t,e,o,n){var s=r*r,i=s*r;return((1-3*r+3*s-i)*t+(4-6*s+3*i)*e+(1+3*r+3*s-3*i)*o+i*n)/6}function _f(r){var t=r.length-1;return function(e){var o=e<=0?e=0:e>=1?(e=1,t-1):Math.floor(e*t),n=r[o],s=r[o+1],i=o>0?r[o-1]:2*n-s,a=o<t-1?r[o+2]:2*s-n;return Hi((e-o/t)*t,i,n,s,a)}}function xf(r){var t=r.length;return function(e){var o=Math.floor(((e%=1)<0?++e:e)*t),n=r[(o+t-1)%t],s=r[o%t],i=r[(o+1)%t],a=r[(o+2)%t];return Hi((e-o/t)*t,n,s,i,a)}}var kn=r=>()=>r;function J_(r,t){return function(e){return r+e*t}}function tx(r,t,e){return r=Math.pow(r,e),t=Math.pow(t,e)-r,e=1/e,function(o){return Math.pow(r+o*t,e)}}function yf(r){return(r=+r)==1?Fs:function(t,e){return e-t?tx(t,e,r):kn(isNaN(t)?e:t)}}function Fs(r,t){var e=t-r;return e?J_(r,e):kn(isNaN(r)?t:r)}var $i=function r(t){var e=yf(t);function o(n,s){var i=e((n=Yo(n)).r,(s=Yo(s)).r),a=e(n.g,s.g),c=e(n.b,s.b),u=Fs(n.opacity,s.opacity);return function(l){return n.r=i(l),n.g=a(l),n.b=c(l),n.opacity=u(l),n+""}}return o.gamma=r,o}(1);function vf(r){return function(t){var e=t.length,o=new Array(e),n=new Array(e),s=new Array(e),i,a;for(i=0;i<e;++i)a=Yo(t[i]),o[i]=a.r||0,n[i]=a.g||0,s[i]=a.b||0;return o=r(o),n=r(n),s=r(s),a.opacity=1,function(c){return a.r=o(c),a.g=n(c),a.b=s(c),a+""}}}var bet=vf(_f),Aet=vf(xf);function wf(r,t){t||(t=[]);var e=r?Math.min(t.length,r.length):0,o=t.slice(),n;return function(s){for(n=0;n<e;++n)o[n]=r[n]*(1-s)+t[n]*s;return o}}function bf(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}function Af(r,t){var e=t?t.length:0,o=r?Math.min(e,r.length):0,n=new Array(o),s=new Array(e),i;for(i=0;i<o;++i)n[i]=lo(r[i],t[i]);for(;i<e;++i)s[i]=t[i];return function(a){for(i=0;i<o;++i)s[i]=n[i](a);return s}}function Sf(r,t){var e=new Date;return r=+r,t=+t,function(o){return e.setTime(r*(1-o)+t*o),e}}function Pr(r,t){return r=+r,t=+t,function(e){return r*(1-e)+t*e}}function Tf(r,t){var e={},o={},n;(r===null||typeof r!="object")&&(r={}),(t===null||typeof t!="object")&&(t={});for(n in t)n in r?e[n]=lo(r[n],t[n]):o[n]=t[n];return function(s){for(n in e)o[n]=e[n](s);return o}}var Qi=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Zi=new RegExp(Qi.source,"g");function ex(r){return function(){return r}}function rx(r){return function(t){return r(t)+""}}function Nf(r,t){var e=Qi.lastIndex=Zi.lastIndex=0,o,n,s,i=-1,a=[],c=[];for(r=r+"",t=t+"";(o=Qi.exec(r))&&(n=Zi.exec(t));)(s=n.index)>e&&(s=t.slice(e,s),a[i]?a[i]+=s:a[++i]=s),(o=o[0])===(n=n[0])?a[i]?a[i]+=n:a[++i]=n:(a[++i]=null,c.push({i,x:Pr(o,n)})),e=Zi.lastIndex;return e<t.length&&(s=t.slice(e),a[i]?a[i]+=s:a[++i]=s),a.length<2?c[0]?rx(c[0].x):ex(t):(t=c.length,function(u){for(var l=0,h;l<t;++l)a[(h=c[l]).i]=h.x(u);return a.join("")})}function lo(r,t){var e=typeof t,o;return t==null||e==="boolean"?kn(t):(e==="number"?Pr:e==="string"?(o=qr(t))?(t=o,$i):Nf:t instanceof qr?$i:t instanceof Date?Sf:bf(t)?wf:Array.isArray(t)?Af:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Tf:Pr)(r,t)}function Xi(r,t){return r=+r,t=+t,function(e){return Math.round(r*(1-e)+t*e)}}function Yi(r){return function(){return r}}function Ki(r){return+r}var Cf=[0,1];function Ko(r){return r}function Ji(r,t){return(t-=r=+r)?function(e){return(e-r)/t}:Yi(isNaN(t)?NaN:.5)}function ox(r,t){var e;return r>t&&(e=r,r=t,t=e),function(o){return Math.max(r,Math.min(t,o))}}function nx(r,t,e){var o=r[0],n=r[1],s=t[0],i=t[1];return n<o?(o=Ji(n,o),s=e(i,s)):(o=Ji(o,n),s=e(s,i)),function(a){return s(o(a))}}function sx(r,t,e){var o=Math.min(r.length,t.length)-1,n=new Array(o),s=new Array(o),i=-1;for(r[o]<r[0]&&(r=r.slice().reverse(),t=t.slice().reverse());++i<o;)n[i]=Ji(r[i],r[i+1]),s[i]=e(t[i],t[i+1]);return function(a){var c=Li(r,a,1,o)-1;return s[c](n[c](a))}}function kf(r,t){return t.domain(r.domain()).range(r.range()).interpolate(r.interpolate()).clamp(r.clamp()).unknown(r.unknown())}function ix(){var r=Cf,t=Cf,e=lo,o,n,s,i=Ko,a,c,u;function l(){var p=Math.min(r.length,t.length);return i!==Ko&&(i=ox(r[0],r[p-1])),a=p>2?sx:nx,c=u=null,h}function h(p){return p==null||isNaN(p=+p)?s:(c||(c=a(r.map(o),t,e)))(o(i(p)))}return h.invert=function(p){return i(n((u||(u=a(t,r.map(o),Pr)))(p)))},h.domain=function(p){return arguments.length?(r=Array.from(p,Ki),l()):r.slice()},h.range=function(p){return arguments.length?(t=Array.from(p),l()):t.slice()},h.rangeRound=function(p){return t=Array.from(p),e=Xi,l()},h.clamp=function(p){return arguments.length?(i=p?!0:Ko,l()):i!==Ko},h.interpolate=function(p){return arguments.length?(e=p,l()):e},h.unknown=function(p){return arguments.length?(s=p,h):s},function(p,m){return o=p,n=m,l()}}function ta(){return ix()(Ko,Ko)}function Of(r){return Math.abs(r=Math.round(r))>=1e21?r.toLocaleString("en").replace(/,/g,""):r.toString(10)}function ho(r,t){if((e=(r=t?r.toExponential(t-1):r.toExponential()).indexOf("e"))<0)return null;var e,o=r.slice(0,e);return[o.length>1?o[0]+o.slice(2):o,+r.slice(e+1)]}function er(r){return r=ho(Math.abs(r)),r?r[1]:NaN}function Df(r,t){return function(e,o){for(var n=e.length,s=[],i=0,a=r[0],c=0;n>0&&a>0&&(c+a+1>o&&(a=Math.max(1,o-c)),s.push(e.substring(n-=a,n+a)),!((c+=a+1)>o));)a=r[i=(i+1)%r.length];return s.reverse().join(t)}}function Ef(r){return function(t){return t.replace(/[0-9]/g,function(e){return r[+e]})}}var ax=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Vr(r){if(!(t=ax.exec(r)))throw new Error("invalid format: "+r);var t;return new Is({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Vr.prototype=Is.prototype;function Is(r){this.fill=r.fill===void 0?" ":r.fill+"",this.align=r.align===void 0?">":r.align+"",this.sign=r.sign===void 0?"-":r.sign+"",this.symbol=r.symbol===void 0?"":r.symbol+"",this.zero=!!r.zero,this.width=r.width===void 0?void 0:+r.width,this.comma=!!r.comma,this.precision=r.precision===void 0?void 0:+r.precision,this.trim=!!r.trim,this.type=r.type===void 0?"":r.type+""}Is.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Mf(r){t:for(var t=r.length,e=1,o=-1,n;e<t;++e)switch(r[e]){case".":o=n=e;break;case"0":o===0&&(o=e),n=e;break;default:if(!+r[e])break t;o>0&&(o=0);break}return o>0?r.slice(0,o)+r.slice(n+1):r}var ea;function Ff(r,t){var e=ho(r,t);if(!e)return r+"";var o=e[0],n=e[1],s=n-(ea=Math.max(-8,Math.min(8,Math.floor(n/3)))*3)+1,i=o.length;return s===i?o:s>i?o+new Array(s-i+1).join("0"):s>0?o.slice(0,s)+"."+o.slice(s):"0."+new Array(1-s).join("0")+ho(r,Math.max(0,t+s-1))[0]}function ra(r,t){var e=ho(r,t);if(!e)return r+"";var o=e[0],n=e[1];return n<0?"0."+new Array(-n).join("0")+o:o.length>n+1?o.slice(0,n+1)+"."+o.slice(n+1):o+new Array(n-o.length+2).join("0")}var oa={"%":(r,t)=>(r*100).toFixed(t),b:r=>Math.round(r).toString(2),c:r=>r+"",d:Of,e:(r,t)=>r.toExponential(t),f:(r,t)=>r.toFixed(t),g:(r,t)=>r.toPrecision(t),o:r=>Math.round(r).toString(8),p:(r,t)=>ra(r*100,t),r:ra,s:Ff,X:r=>Math.round(r).toString(16).toUpperCase(),x:r=>Math.round(r).toString(16)};function na(r){return r}var If=Array.prototype.map,Rf=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function qf(r){var t=r.grouping===void 0||r.thousands===void 0?na:Df(If.call(r.grouping,Number),r.thousands+""),e=r.currency===void 0?"":r.currency[0]+"",o=r.currency===void 0?"":r.currency[1]+"",n=r.decimal===void 0?".":r.decimal+"",s=r.numerals===void 0?na:Ef(If.call(r.numerals,String)),i=r.percent===void 0?"%":r.percent+"",a=r.minus===void 0?"\u2212":r.minus+"",c=r.nan===void 0?"NaN":r.nan+"";function u(h){h=Vr(h);var p=h.fill,m=h.align,f=h.sign,d=h.symbol,x=h.zero,y=h.width,w=h.comma,O=h.precision,D=h.trim,_=h.type;_==="n"?(w=!0,_="g"):oa[_]||(O===void 0&&(O=12),D=!0,_="g"),(x||p==="0"&&m==="=")&&(x=!0,p="0",m="=");var v=d==="$"?e:d==="#"&&/[boxX]/.test(_)?"0"+_.toLowerCase():"",b=d==="$"?o:/[%p]/.test(_)?i:"",A=oa[_],M=/[defgprs%]/.test(_);O=O===void 0?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,O)):Math.max(0,Math.min(20,O));function E(S){var k=v,I=b,q,Z,W;if(_==="c")I=A(S)+I,S="";else{S=+S;var z=S<0||1/S<0;if(S=isNaN(S)?c:A(Math.abs(S),O),D&&(S=Mf(S)),z&&+S==0&&f!=="+"&&(z=!1),k=(z?f==="("?f:a:f==="-"||f==="("?"":f)+k,I=(_==="s"?Rf[8+ea/3]:"")+I+(z&&f==="("?")":""),M){for(q=-1,Z=S.length;++q<Z;)if(W=S.charCodeAt(q),48>W||W>57){I=(W===46?n+S.slice(q+1):S.slice(q))+I,S=S.slice(0,q);break}}}w&&!x&&(S=t(S,1/0));var V=k.length+S.length+I.length,T=V<y?new Array(y-V+1).join(p):"";switch(w&&x&&(S=t(T+S,T.length?y-I.length:1/0),T=""),m){case"<":S=k+S+I+T;break;case"=":S=k+T+S+I;break;case"^":S=T.slice(0,V=T.length>>1)+k+S+I+T.slice(V);break;default:S=T+k+S+I;break}return s(S)}return E.toString=function(){return h+""},E}function l(h,p){var m=u((h=Vr(h),h.type="f",h)),f=Math.max(-8,Math.min(8,Math.floor(er(p)/3)))*3,d=Math.pow(10,-f),x=Rf[8+f/3];return function(y){return m(d*y)+x}}return{format:u,formatPrefix:l}}var Rs,qs,Ps;sa({thousands:",",grouping:[3],currency:["$",""]});function sa(r){return Rs=qf(r),qs=Rs.format,Ps=Rs.formatPrefix,Rs}function ia(r){return Math.max(0,-er(Math.abs(r)))}function aa(r,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(er(t)/3)))*3-er(Math.abs(r)))}function ca(r,t){return r=Math.abs(r),t=Math.abs(t)-r,Math.max(0,er(t)-er(r))+1}function ua(r,t,e,o){var n=Gi(r,t,e),s;switch(o=Vr(o??",f"),o.type){case"s":{var i=Math.max(Math.abs(r),Math.abs(t));return o.precision==null&&!isNaN(s=aa(n,i))&&(o.precision=s),Ps(o,i)}case"":case"e":case"g":case"p":case"r":{o.precision==null&&!isNaN(s=ca(n,Math.max(Math.abs(r),Math.abs(t))))&&(o.precision=s-(o.type==="e"));break}case"f":case"%":{o.precision==null&&!isNaN(s=ia(n))&&(o.precision=s-(o.type==="%")*2);break}}return qs(o)}function cx(r){var t=r.domain;return r.ticks=function(e){var o=t();return Ns(o[0],o[o.length-1],e??10)},r.tickFormat=function(e,o){var n=t();return ua(n[0],n[n.length-1],e??10,o)},r.nice=function(e){e==null&&(e=10);var o=t(),n=0,s=o.length-1,i=o[n],a=o[s],c,u,l=10;for(a<i&&(u=i,i=a,a=u,u=n,n=s,s=u);l-- >0;){if(u=Cs(i,a,e),u===c)return o[n]=i,o[s]=a,t(o);if(u>0)i=Math.floor(i/u)*u,a=Math.ceil(a/u)*u;else if(u<0)i=Math.ceil(i*u)/u,a=Math.floor(a*u)/u;else break;c=u}return r},r}function On(){var r=ta();return r.copy=function(){return kf(r,On())},sf.apply(r,arguments),cx(r)}var qe={Synth:xe,Loop:Fr,Transport:fp,start:Ci,NoiseSynth:to,FeedbackDelay:ro,Gate:io,MidSideCompressor:ao,Gain:L,Destination:mp,MembraneSynth:ur},ae={select:qi,selectAll:Pi,scaleLinear:On},dx=Bf(),gx=jf(),nm=Vs(),_x=Uf(),xx=$f(),yx=Qf(),vx=Kf(),wx=em(),Br=Dn(),bx=om(),Ax=new _x(qe),Sx=new xx(qe),Tx=new yx(qe),hm=new qe.Synth().toDestination(),sm=new qe.Loop(r=>{if(fr=fr==15?0:fr+=1,ae.selectAll(".drum-step .transport").style("background-color","#999"),ae.select(`#drum-transport-${fr%16}`).style("background-color","yellow"),Gs[fr][0]==1&&Ax.hit(r),Gs[fr][1]==1&&Sx.hit(r),Gs[fr][2]==1&&Tx.hit(r),fr%fm==0&&(_a+=1,js=_a%Re.noteSequence.length,da=Re.noteSequence[js],da!="REST"&&hm.triggerAttackRelease(da,"16n",r),ae.selectAll("svg .transport .step").attr("fill","#999"),ae.select(`svg .transport .step-${js}`).attr("fill","yellow"),pm&&js==Re.noteSequence.length-1)){let t=parseInt(document.getElementById("rhythm-step-count").value),e=parseInt(document.getElementById("rhythm-cycle").value),o=t>=e?2:t+1;document.getElementById("rhythm-step-count").value=o,document.querySelectorAll(".rhythm-steps button").forEach((n,s)=>{n.disabled=s>=o}),va(),wa(),mm()}},"16n"),Nx={"4N":4,"8N":2,"16N":1},Cx={Kick:0,Snare:1,Hat:2},im=!1,pm=!1,fr=-1,_a=-1,fm=2,xa,ya,am,da,js,Re,cm,um,po,tn,Gs=[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],kx=()=>{qe.Transport.state!=="started"?(qe.Transport.bpm.value=document.getElementById("bpm").value,sm.start(0),qe.Transport.start()):(qe.Transport.stop(),sm.stop(),fr=-1,_a=-1)},Ox=r=>{hm.triggerAttackRelease(Br[r].note_full,"16n")},va=()=>{if(document.getElementById("infinity-series")!==null)po=document.getElementById("tonic").value,cm=parseInt(document.getElementById("seed-distance").value),um=parseInt(document.getElementById("series-length").value),tn=ga(),Re=new vx(um,cm,po,tn),document.querySelector("#infinity-series .sequence").textContent=Re.sequence.join(" ");else if(document.getElementById("self-similarity")!==null){let r=Array.from(document.querySelectorAll(".input-note")).map(t=>Br.findIndex(e=>e.note_full==t.value));po=Br[r.slice(0).sort()[0]].note_full,tn=ga(),Re=new wx(r,tn),Re.generate("xv")}else if(document.getElementById("scales-as-vectors")!==null){tn=ga(!0),po=document.getElementById("tonic").value;let r=document.getElementById("seq-length").value,t=document.getElementById("scale").value,e=Br.findIndex(l=>l.note_full==po),o=Array.from(document.querySelectorAll("#motif select")).filter(l=>l.disabled==!1).map(l=>l.value==0?null:parseInt(l.value)),n=Array.from(document.querySelectorAll("#shifts select")).filter(l=>l.disabled==!1).map(l=>parseInt(l.value)),s=new nm(o).rhythm(tn),i=new nm(s).shift(n),a;i.length<r?a=i.concat(new Array(r-i.length).fill(null)):a=i.slice(0,r);let c=a.map(l=>l==null?null:bx.degree2HalfSteps(t,l)+e),u=c.map(l=>l==null?"REST":Br[l].note_full);ya=[0,24],Re={sequence:a,midiSequence:c,noteSequence:u}}},ga=r=>r!=null||document.getElementById("apply-rhythm").checked?Array.from(document.querySelectorAll("#rhythm button:enabled")).map(t=>t.classList.contains("active")?1:0):[],Dx=r=>{r.target.classList.toggle("active")},Ex=(r,t,e)=>{r.target.classList.toggle("active"),Gs[t][Cx[e]]=r.target.classList.contains("active")?1:0},lm=r=>{let t=document.getElementById("apply-rhythm").checked;document.getElementById("rhythm").classList.toggle("active"),document.querySelectorAll("#rhythm button").forEach(e=>e.disabled=!t),document.querySelectorAll("#rhythm input[type=number]").forEach(e=>e.disabled=!t)},Mx=r=>{document.getElementById("bpm-value").textContent=r.target.value,qe.Transport.bpm.rampTo(r.target.value,2)},Fx=r=>{fm=Nx[r.target.value]},Ix=r=>{document.querySelectorAll("#rhythm button").forEach((t,e)=>{e>=r.target.value?t.disabled=!0:t.disabled=!1})},Rx=()=>{let r;document.getElementById("scales-as-vectors")!=null?(Px(),r=[48]):document.getElementById("self-similarity")!=null?(document.getElementById("apply-rhythm").addEventListener("change",lm),document.getElementById("ratio-index").addEventListener("change",qx),r=[60,72,63,67,67]):document.getElementById("infinity-series")!=null&&(document.getElementById("apply-rhythm").addEventListener("change",lm),r=[60]),ae.selectAll("#tonic, .input-note").selectAll(".tonic-note").data(Br).enter().append("option").attr("class",t=>`note-${t.note_full}`).attr("value",t=>t.note_full).text(t=>t.note_full),document.querySelectorAll("#tonic, .input-note").forEach((t,e)=>{let o=Br[r[e]].note_full;t.querySelector(`option[value="${o}"]`).setAttribute("selected","selected")}),va(),wa(),am=new gx("#drum-machine",ae),am.render(Ex)},wa=()=>{let r=Br.findIndex(o=>o.note_full==po),t=Re.midiSequence.slice(0).sort().filter(o=>o!==null),e;ya==null?e=[t[0]-r,t[t.length-1]-r]:e=ya,xa=new dx(".piano-roll",po,Re.midiSequence.length,e,ae),xa.render()},mm=()=>{xa.setNotes(Re.midiSequence,Ox),ae.select("#play-pause").property("disabled",!1),ae.select("#bpm").property("disabled",!1),ae.select("#step-rate").property("disabled",!1)},qx=r=>{let t="#self-replicating-melody td",e=new Array;document.querySelectorAll(t).forEach((s,i)=>{s.textContent==r.target.value?(s.classList.add("active"),e.push(i)):s.classList.remove("active")});let o=e.map(s=>s%15),n="#self-replicating-melody thead th:not(.first)";document.querySelectorAll(n).forEach((s,i)=>{o.includes(i)?s.classList.add("active"):s.classList.remove("active")})},Px=()=>{let r=[1,2,3,4,5,6,7,0],t=[0,1,2,3,4,5,6,7],e=[1,5,0,5,3,0,7,0,0,4,1,0],o=[7,7,0,0,7,0,0,0,0,0,7,0];["#scale-degrees","#shift-degrees"].forEach(n=>{ae.selectAll(n).selectAll("select").data(new Array(12).fill(1)).enter().append("select").selectAll(".scale-degree").data(n=="#scale-degrees"?r:t).enter().append("option").attr("class","scale-degree").attr("value",s=>s).text(s=>n=="#scale-degrees"&&s==0?"R":s)}),document.querySelectorAll("#scale-degrees select").forEach((n,s)=>{let i=e[s];n.querySelector(`option[value="${i}"]`).selected="selected"}),document.querySelectorAll("#shift-degrees select").forEach((n,s)=>{let i=o[s];n.querySelector(`option[value="${i}"]`).selected="selected"}),ae.select("#motif-length").on("change",n=>{document.querySelectorAll("#scale-degrees select").forEach((s,i)=>{s.disabled=i>=n.target.value})}),ae.select("#shift-seq-length").on("change",n=>{document.querySelectorAll("#shift-degrees select").forEach((s,i)=>{s.disabled=i>=n.target.value})}),document.getElementById("rhythm-step-count").addEventListener("change",n=>{document.querySelectorAll(".rhythm-steps button").forEach((s,i)=>{s.disabled=i>=n.target.value})}),ae.select("#apply-cycle").on("change",n=>pm=n.target.checked)},Vx=()=>{Rx(),document.querySelector("button#generate").addEventListener("click",()=>{im||(qe.start(),im=!0),va(),wa(),mm(),document.getElementById("current-sequence").style.visibility="visible"}),document.querySelector("button#play-pause").addEventListener("click",kx),document.querySelectorAll("#rhythm button").forEach(r=>r.addEventListener("click",Dx)),document.getElementById("bpm").addEventListener("input",Mx),document.getElementById("step-rate").addEventListener("input",Fx),document.getElementById("rhythm-step-count").addEventListener("change",Ix)};document.addEventListener("DOMContentLoaded",Vx);})();
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
/**
 * Tone.js
 * @author Yotam Mann
 * @license http://opensource.org/licenses/MIT MIT License
 * @copyright 2014-2019 Yotam Mann
 */
