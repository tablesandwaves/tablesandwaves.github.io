/*! For license information please see main.js.LICENSE.txt */
(()=>{var t={228:t=>{t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i},t.exports.__esModule=!0,t.exports.default=t.exports},858:t=>{t.exports=function(t){if(Array.isArray(t))return t},t.exports.__esModule=!0,t.exports.default=t.exports},575:t=>{t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports},913:t=>{function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}t.exports=function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t},t.exports.__esModule=!0,t.exports.default=t.exports},884:t=>{t.exports=function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,s,r=[],o=!0,a=!1;try{for(n=n.call(t);!(o=(i=n.next()).done)&&(r.push(i.value),!e||r.length!==e);o=!0);}catch(t){a=!0,s=t}finally{try{o||null==n.return||n.return()}finally{if(a)throw s}}return r}},t.exports.__esModule=!0,t.exports.default=t.exports},521:t=>{t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports},38:(t,e,n)=>{var i=n(858),s=n(884),r=n(379),o=n(521);t.exports=function(t,e){return i(t)||s(t,e)||r(t,e)||o()},t.exports.__esModule=!0,t.exports.default=t.exports},379:(t,e,n)=>{var i=n(228);t.exports=function(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports},382:function(t,e,n){!function(t,e,n,i){"use strict";function s(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var r=s(e),o=s(n),a=s(i),c=function(t,e,n){return{endTime:e,insertTime:n,type:"exponentialRampToValue",value:t}},u=function(t,e,n){return{endTime:e,insertTime:n,type:"linearRampToValue",value:t}},l=function(t,e){return{startTime:e,type:"setValue",value:t}},h=function(t,e,n){return{duration:n,startTime:e,type:"setValueCurve",values:t}},f=function(t,e,n){var i=n.startTime,s=n.target,r=n.timeConstant;return s+(e-s)*Math.exp((i-t)/r)},d=function(t){return"exponentialRampToValue"===t.type},p=function(t){return"linearRampToValue"===t.type},_=function(t){return d(t)||p(t)},m=function(t){return"setValue"===t.type},g=function(t){return"setValueCurve"===t.type},v=function t(e,n,i,s){var r=e[n];return void 0===r?s:_(r)||m(r)?r.value:g(r)?r.values[r.values.length-1]:f(i,t(e,n-1,r.startTime,s),r)},y=function(t,e,n,i,s){return void 0===n?[i.insertTime,s]:_(n)?[n.endTime,n.value]:m(n)?[n.startTime,n.value]:g(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,v(t,e-1,n.startTime,s)]},b=function(t){return"cancelAndHold"===t.type},x=function(t){return"cancelScheduledValues"===t.type},w=function(t){return b(t)||x(t)?t.cancelTime:d(t)||p(t)?t.endTime:t.startTime},T=function(t,e,n,i){var s=i.endTime,r=i.value;return n===r?r:0<n&&0<r||n<0&&r<0?n*Math.pow(r/n,(t-e)/(s-e)):0},M=function(t,e,n,i){return n+(t-e)/(i.endTime-e)*(i.value-n)},S=function(t,e){var n=e.duration,i=e.startTime,s=e.values;return function(t,e){var n=Math.floor(e),i=Math.ceil(e);return n===i?t[n]:(1-(e-n))*t[n]+(1-(i-e))*t[i]}(s,(t-i)/n*(s.length-1))},A=function(t){return"setTarget"===t.type},k=function(t){function e(t){o.default(this,e),this._automationEvents=[],this._currenTime=0,this._defaultValue=t}return a.default(e,[{key:t,value:function(){return this._automationEvents[Symbol.iterator]()}},{key:"add",value:function(t){var e=w(t);if(b(t)||x(t)){var n=this._automationEvents.findIndex((function(n){return x(t)&&g(n)?n.startTime+n.duration>=e:w(n)>=e})),i=this._automationEvents[n];if(-1!==n&&(this._automationEvents=this._automationEvents.slice(0,n)),b(t)){var s=this._automationEvents[this._automationEvents.length-1];if(void 0!==i&&_(i)){if(A(s))throw new Error("The internal list is malformed.");var r=g(s)?s.startTime+s.duration:w(s),o=g(s)?s.values[s.values.length-1]:s.value,a=d(i)?T(e,r,o,i):M(e,r,o,i),f=d(i)?c(a,e,this._currenTime):u(a,e,this._currenTime);this._automationEvents.push(f)}void 0!==s&&A(s)&&this._automationEvents.push(l(this.getValue(e),e)),void 0!==s&&g(s)&&s.startTime+s.duration>e&&(this._automationEvents[this._automationEvents.length-1]=h(new Float32Array([6,7]),s.startTime,e-s.startTime))}}else{var m=this._automationEvents.findIndex((function(t){return w(t)>e})),v=-1===m?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[m-1];if(void 0!==v&&g(v)&&w(v)+v.duration>e)return!1;var y=d(t)?c(t.value,t.endTime,this._currenTime):p(t)?u(t.value,e,this._currenTime):t;if(-1===m)this._automationEvents.push(y);else{if(g(t)&&e+t.duration>w(this._automationEvents[m]))return!1;this._automationEvents.splice(m,0,y)}}return!0}},{key:"flush",value:function(t){var e=this._automationEvents.findIndex((function(e){return w(e)>t}));if(e>1){var n=this._automationEvents.slice(e-1),i=n[0];A(i)&&n.unshift(l(v(this._automationEvents,e-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=n}}},{key:"getValue",value:function(t){if(0===this._automationEvents.length)return this._defaultValue;var e=this._automationEvents.findIndex((function(e){return w(e)>t})),n=this._automationEvents[e],i=(-1===e?this._automationEvents.length:e)-1,s=this._automationEvents[i];if(void 0!==s&&A(s)&&(void 0===n||!_(n)||n.insertTime>t))return f(t,v(this._automationEvents,i-1,s.startTime,this._defaultValue),s);if(void 0!==s&&m(s)&&(void 0===n||!_(n)))return s.value;if(void 0!==s&&g(s)&&(void 0===n||!_(n)||s.startTime+s.duration>t))return t<s.startTime+s.duration?S(t,s):s.values[s.values.length-1];if(void 0!==s&&_(s)&&(void 0===n||!_(n)))return s.value;if(void 0!==n&&d(n)){var o=y(this._automationEvents,i,s,n,this._defaultValue),a=r.default(o,2),c=a[0],u=a[1];return T(t,c,u,n)}if(void 0!==n&&p(n)){var l=y(this._automationEvents,i,s,n,this._defaultValue),h=r.default(l,2),b=h[0],x=h[1];return M(t,b,x,n)}return this._defaultValue}}]),e}(Symbol.iterator);t.AutomationEventList=k,t.createCancelAndHoldAutomationEvent=function(t){return{cancelTime:t,type:"cancelAndHold"}},t.createCancelScheduledValuesAutomationEvent=function(t){return{cancelTime:t,type:"cancelScheduledValues"}},t.createExponentialRampToValueAutomationEvent=function(t,e){return{endTime:e,type:"exponentialRampToValue",value:t}},t.createLinearRampToValueAutomationEvent=function(t,e){return{endTime:e,type:"linearRampToValue",value:t}},t.createSetTargetAutomationEvent=function(t,e,n){return{startTime:e,target:t,timeConstant:n,type:"setTarget"}},t.createSetValueAutomationEvent=l,t.createSetValueCurveAutomationEvent=h,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(38),n(575),n(913))},785:(t,e,n)=>{"use strict";n.r(e),n.d(e,{AMOscillator:()=>Gr,AMSynth:()=>Mo,Abs:()=>ao,Add:()=>Jr,AmplitudeEnvelope:()=>xo,Analyser:()=>Ya,AudioToGain:()=>Ur,AutoFilter:()=>ua,AutoPanner:()=>ha,AutoWah:()=>da,BaseContext:()=>Ss,BiquadFilter:()=>So,BitCrusher:()=>_a,Buffer:()=>Ac,BufferSource:()=>Cc,Buffers:()=>kc,Channel:()=>tc,Chebyshev:()=>ga,Chorus:()=>wa,Clock:()=>pr,Compressor:()=>oc,Context:()=>As,Convolver:()=>fc,CrossFade:()=>oa,DCMeter:()=>$a,Delay:()=>_r,Destination:()=>gc,Distortion:()=>Ta,Draw:()=>wc,DuoSynth:()=>Do,EQ3:()=>hc,Emitter:()=>Ms,Envelope:()=>go,FFT:()=>Za,FMOscillator:()=>Yr,FMSynth:()=>Eo,FatOscillator:()=>Xr,FeedbackCombFilter:()=>jo,FeedbackDelay:()=>Sa,Filter:()=>Ao,Follower:()=>fa,Freeverb:()=>Ea,Frequency:()=>$s,FrequencyClass:()=>Hs,FrequencyEnvelope:()=>ko,FrequencyShifter:()=>ka,Gain:()=>or,GainToAudio:()=>co,Gate:()=>ac,GrainPlayer:()=>oo,GreaterThan:()=>fo,GreaterThanZero:()=>ho,IntervalTimeline:()=>Tr,JCReverb:()=>Na,LFO:()=>eo,Limiter:()=>cc,Listener:()=>bc,Loop:()=>Ho,LowpassCombFilter:()=>Bo,Master:()=>vc,MembraneSynth:()=>qo,Merge:()=>ya,MetalSynth:()=>Ro,Meter:()=>Xa,MidSideCompressor:()=>uc,MidSideMerge:()=>La,MidSideSplit:()=>ja,Midi:()=>yr,MidiClass:()=>vr,Mono:()=>ec,MonoSynth:()=>Co,MultibandCompressor:()=>lc,MultibandSplit:()=>nc,Multiply:()=>Wr,Negate:()=>uo,Noise:()=>qr,NoiseSynth:()=>No,Offline:()=>mr,OfflineContext:()=>Os,OmniOscillator:()=>Qr,OnePoleFilter:()=>Lo,Oscillator:()=>jr,PWMOscillator:()=>Zr,PanVol:()=>Ka,Panner:()=>la,Panner3D:()=>sc,Param:()=>er,Part:()=>Xo,Pattern:()=>sa,Phaser:()=>Va,PingPongDelay:()=>Ia,PitchShift:()=>Pa,Player:()=>so,Players:()=>ro,PluckSynth:()=>Uo,PolySynth:()=>Wo,Pow:()=>po,PulseOscillator:()=>Hr,Recorder:()=>rc,Reverb:()=>za,Sampler:()=>Go,Scale:()=>Kr,ScaleExp:()=>_o,Sequence:()=>ra,Signal:()=>ur,Solo:()=>Ja,Split:()=>va,StateTimeline:()=>tr,StereoWidener:()=>Ua,Subtract:()=>lo,SyncedSignal:()=>mo,Synth:()=>wo,Ticks:()=>xr,TicksClass:()=>br,Time:()=>Ys,TimeClass:()=>Gs,Timeline:()=>ys,ToneAudioBuffer:()=>Es,ToneAudioBuffers:()=>gr,ToneAudioNode:()=>nr,ToneBufferSource:()=>Rr,ToneEvent:()=>Yo,ToneOscillatorNode:()=>zr,Transport:()=>_c,TransportTime:()=>Js,TransportTimeClass:()=>Qs,Tremolo:()=>Wa,Unit:()=>s,UserMedia:()=>Pr,Vibrato:()=>Ga,Volume:()=>Sr,WaveShaper:()=>Br,Waveform:()=>Qa,Zero:()=>to,connect:()=>sr,connectSeries:()=>ir,connectSignal:()=>lr,context:()=>Mc,dbToGain:()=>Ps,debug:()=>i,defaultArg:()=>ls,disconnect:()=>rr,ftom:()=>Ls,gainToDb:()=>Vs,getContext:()=>Ns,getDestination:()=>yc,getDraw:()=>Tc,getListener:()=>xc,getTransport:()=>mc,immediate:()=>pc,intervalToFrequencyRatio:()=>zs,isArray:()=>Xi,isBoolean:()=>Hi,isDefined:()=>Ui,isFunction:()=>Wi,isNote:()=>$i,isNumber:()=>Gi,isObject:()=>Yi,isString:()=>Zi,isUndef:()=>Bi,loaded:()=>Sc,mtof:()=>Us,now:()=>dc,optionsFromArguments:()=>us,setContext:()=>Fs,start:()=>Is,supported:()=>Ni,version:()=>r});var i={};n.r(i),n.d(i,{assert:()=>Fi,assertContextRunning:()=>Pi,assertRange:()=>Ii,log:()=>ji,setLogger:()=>zi,warn:()=>Li});var s={};n.r(s);const r="14.7.77";var o=n(382);const a=new WeakSet,c=new WeakMap,u=new WeakMap,l=new WeakMap,h=new WeakMap,f=new WeakMap,d=new WeakMap,p=new WeakMap,_=new WeakMap,m=new WeakMap,g={construct:()=>g},v=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,y=(t,e)=>{const n=[];let i=t.replace(/^[\s]+/,""),s=i.match(v);for(;null!==s;){const t=s[1].slice(1,-1),r=s[0].replace(/([\s]+)?;?$/,"").replace(t,new URL(t,e).toString());n.push(r),i=i.slice(s[0].length).replace(/^[\s]+/,""),s=i.match(v)}return[n.join(";"),i]},b=t=>{if(void 0!==t&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},x=t=>{if(!(t=>{try{new new Proxy(t,g)}catch{return!1}return!0})(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(null===t.prototype||"object"!=typeof t.prototype)throw new TypeError("The given value for processorCtor should have a prototype.")},w=(t,e)=>{const n=t.get(e);if(void 0===n)throw new Error("A value with the given key could not be found.");return n},T=(t,e)=>{const n=Array.from(t).filter(e);if(n.length>1)throw Error("More than one element was found.");if(0===n.length)throw Error("No element was found.");const[i]=n;return t.delete(i),i},M=(t,e,n,i)=>{const s=w(t,e),r=T(s,(t=>t[0]===n&&t[1]===i));return 0===s.size&&t.delete(e),r},S=t=>w(d,t),A=t=>{if(a.has(t))throw new Error("The AudioNode is already stored.");a.add(t),S(t).forEach((t=>t(!0)))},k=t=>"port"in t,C=t=>{if(!a.has(t))throw new Error("The AudioNode is not stored.");a.delete(t),S(t).forEach((t=>t(!1)))},D=(t,e)=>{!k(t)&&e.every((t=>0===t.size))&&C(t)},E={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},O=(t,e)=>t.context===e,R=t=>{try{t.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},q=()=>new DOMException("","IndexSizeError"),N=t=>{var e;t.getChannelData=(e=t.getChannelData,n=>{try{return e.call(t,n)}catch(t){if(12===t.code)throw q();throw t}})},F={numberOfChannels:1},I=-34028234663852886e22,P=-I,V=t=>a.has(t),z={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},j=t=>w(c,t),L=t=>w(l,t),B=(t,e)=>{const{activeInputs:n}=j(t);n.forEach((n=>n.forEach((([n])=>{e.includes(t)||B(n,[...e,t])}))));const i=(t=>"playbackRate"in t)(t)?[t.playbackRate]:k(t)?Array.from(t.parameters.values()):(t=>"frequency"in t&&"gain"in t)(t)?[t.Q,t.detune,t.frequency,t.gain]:(t=>"offset"in t)(t)?[t.offset]:(t=>!("frequency"in t)&&"gain"in t)(t)?[t.gain]:(t=>"detune"in t&&"frequency"in t)(t)?[t.detune,t.frequency]:(t=>"pan"in t)(t)?[t.pan]:[];for(const t of i){const n=L(t);void 0!==n&&n.activeInputs.forEach((([t])=>B(t,e)))}V(t)&&C(t)},U=t=>{B(t.destination,[])},W=t=>"context"in t,G=t=>W(t[0]),Y=(t,e,n,i)=>{for(const e of t)if(n(e)){if(i)return!1;throw Error("The set contains at least one similar element.")}return t.add(e),!0},H=(t,e,[n,i],s)=>{Y(t,[e,n,i],(t=>t[0]===e&&t[1]===n),s)},X=(t,[e,n,i],s)=>{const r=t.get(e);void 0===r?t.set(e,new Set([[n,i]])):Y(r,[n,i],(t=>t[0]===n),s)},Z=t=>"inputs"in t,$=(t,e,n,i)=>{if(Z(e)){const s=e.inputs[i];return t.connect(s,n,0),[s,n,0]}return t.connect(e,n,i),[e,n,i]},Q=(t,e,n)=>{for(const i of t)if(i[0]===e&&i[1]===n)return t.delete(i),i;return null},J=(t,e)=>{if(!S(t).delete(e))throw new Error("Missing the expected event listener.")},K=(t,e,n)=>{const i=w(t,e),s=T(i,(t=>t[0]===n));return 0===i.size&&t.delete(e),s},tt=(t,e,n,i)=>{Z(e)?t.disconnect(e.inputs[i],n,0):t.disconnect(e,n,i)},et=t=>w(u,t),nt=t=>w(h,t),it=t=>p.has(t),st=t=>!a.has(t),rt=(t,e)=>new Promise((n=>{if(null!==e)n(!0);else{const e=t.createScriptProcessor(256,1,1),i=t.createGain(),s=t.createBuffer(1,2,44100),r=s.getChannelData(0);r[0]=1,r[1]=1;const o=t.createBufferSource();o.buffer=s,o.loop=!0,o.connect(e).connect(t.destination),o.connect(i),o.disconnect(i),e.onaudioprocess=i=>{const s=i.inputBuffer.getChannelData(0);Array.prototype.some.call(s,(t=>1===t))?n(!0):n(!1),o.stop(),e.onaudioprocess=null,o.disconnect(e),e.disconnect(t.destination)},o.start()}})),ot=(t,e)=>{const n=new Map;for(const e of t)for(const t of e){const e=n.get(t);n.set(t,void 0===e?1:e+1)}n.forEach(((t,n)=>e(n,t)))},at=t=>"context"in t,ct=t=>{const e=new Map;t.connect=(t=>(n,i=0,s=0)=>{const r=at(n)?t(n,i,s):t(n,i),o=e.get(n);return void 0===o?e.set(n,[{input:s,output:i}]):o.every((t=>t.input!==s||t.output!==i))&&o.push({input:s,output:i}),r})(t.connect.bind(t)),t.disconnect=(n=>(i,s,r)=>{if(n.apply(t),void 0===i)e.clear();else if("number"==typeof i)for(const[t,n]of e){const s=n.filter((t=>t.output!==i));0===s.length?e.delete(t):e.set(t,s)}else if(e.has(i))if(void 0===s)e.delete(i);else{const t=e.get(i);if(void 0!==t){const n=t.filter((t=>t.output!==s&&(t.input!==r||void 0===r)));0===n.length?e.delete(i):e.set(i,n)}}for(const[n,i]of e)i.forEach((e=>{at(n)?t.connect(n,e.output,e.input):t.connect(n,e.output)}))})(t.disconnect)},ut=(t,e,n,i,s)=>{const[r,o]=((t,e,n,i)=>{const{activeInputs:s,passiveInputs:r}=j(e),o=Q(s[i],t,n);return null===o?[M(r,t,n,i)[2],!1]:[o[2],!0]})(t,n,i,s);if(null!==r&&(J(t,r),!o||e||it(t)||tt(et(t),et(n),i,s)),V(n)){const{activeInputs:t}=j(n);D(n,t)}},lt=(t,e,n,i)=>{const[s,r]=((t,e,n)=>{const{activeInputs:i,passiveInputs:s}=L(e),r=Q(i,t,n);return null===r?[K(s,t,n)[1],!1]:[r[2],!0]})(t,n,i);null!==s&&(J(t,s),!r||e||it(t)||et(t).disconnect(nt(n),i))};class ht{constructor(t){this._map=new Map(t)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(t,e=null){return this._map.forEach(((n,i)=>t.call(e,n,i,this)))}get(t){return this._map.get(t)}has(t){return this._map.has(t)}keys(){return this._map.keys()}values(){return this._map.values()}}const ft={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}};function dt(t,e,n,i,s){if("function"==typeof t.copyFromChannel)0===e[n].byteLength&&(e[n]=new Float32Array(128)),t.copyFromChannel(e[n],i,s);else{const r=t.getChannelData(i);if(0===e[n].byteLength)e[n]=r.slice(s,s+128);else{const t=new Float32Array(r.buffer,s*Float32Array.BYTES_PER_ELEMENT,128);e[n].set(t)}}}const pt=(t,e,n,i,s)=>{"function"==typeof t.copyToChannel?0!==e[n].byteLength&&t.copyToChannel(e[n],i,s):0!==e[n].byteLength&&t.getChannelData(i).set(e[n],s)},_t=(t,e)=>{const n=[];for(let i=0;i<t;i+=1){const t=[],s="number"==typeof e?e:e[i];for(let e=0;e<s;e+=1)t.push(new Float32Array(128));n.push(t)}return n},mt=async(t,e,n,i,s,r,o)=>{const a=null===e?128*Math.ceil(t.context.length/128):e.length,c=i.channelCount*i.numberOfInputs,u=s.reduce(((t,e)=>t+e),0),l=0===u?null:n.createBuffer(u,a,n.sampleRate);if(void 0===r)throw new Error("Missing the processor constructor.");const h=j(t),f=await((t,e)=>{const n=w(m,t),i=et(e);return w(n,i)})(n,t),d=_t(i.numberOfInputs,i.channelCount),p=_t(i.numberOfOutputs,s),_=Array.from(t.parameters.keys()).reduce(((t,e)=>({...t,[e]:new Float32Array(128)})),{});for(let u=0;u<a;u+=128){if(i.numberOfInputs>0&&null!==e)for(let t=0;t<i.numberOfInputs;t+=1)for(let n=0;n<i.channelCount;n+=1)dt(e,d[t],n,n,u);void 0!==r.parameterDescriptors&&null!==e&&r.parameterDescriptors.forEach((({name:t},n)=>{dt(e,_,t,c+n,u)}));for(let t=0;t<i.numberOfInputs;t+=1)for(let e=0;e<s[t];e+=1)0===p[t][e].byteLength&&(p[t][e]=new Float32Array(128));try{const t=d.map(((t,e)=>0===h.activeInputs[e].size?[]:t)),e=o(u/n.sampleRate,n.sampleRate,(()=>f.process(t,p,_)));if(null!==l)for(let t=0,e=0;t<i.numberOfOutputs;t+=1){for(let n=0;n<s[t];n+=1)pt(l,p[t],n,e+n,u);e+=s[t]}if(!e)break}catch(e){t.dispatchEvent(new ErrorEvent("processorerror",{colno:e.colno,filename:e.filename,lineno:e.lineno,message:e.message}));break}}return l},gt={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},vt={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},yt={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},bt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},xt={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},wt=t=>{const{port1:e,port2:n}=new MessageChannel;return new Promise((i=>{const s=()=>{n.onmessage=null,e.close(),n.close(),i()};n.onmessage=()=>s();try{e.postMessage(t,[t])}finally{s()}}))},Tt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},Mt=(t,e,n)=>{const i=e[n];if(void 0===i)throw t();return i},St={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},At={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},kt=()=>new DOMException("","InvalidStateError"),Ct=()=>new DOMException("","InvalidAccessError"),Dt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},Et=(t,e,n,i,s,r,o,a,c,u,l)=>{const h=u.length;let f=a;for(let a=0;a<h;a+=1){let h=n[0]*u[a];for(let e=1;e<s;e+=1){const i=f-e&c-1;h+=n[e]*r[i],h-=t[e]*o[i]}for(let t=s;t<i;t+=1)h+=n[t]*r[f-t&c-1];for(let n=s;n<e;n+=1)h-=t[n]*o[f-n&c-1];r[f]=u[a],o[f]=h,f=f+1&c-1,l[a]=h}return f},Ot={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},Rt=t=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=t.decodeAudioData(e.buffer,(()=>{}));return void 0!==n&&(n.catch((()=>{})),!0)}catch{}return!1},qt=(t,e,n)=>{const i=e[n];void 0!==i&&i!==t[n]&&(t[n]=i)},Nt=(t,e)=>{qt(t,e,"channelCount"),qt(t,e,"channelCountMode"),qt(t,e,"channelInterpretation")},Ft=t=>"function"==typeof t.getFloatTimeDomainData,It=(t,e,n)=>{const i=e[n];void 0!==i&&i!==t[n].value&&(t[n].value=i)},Pt=t=>{t.start=(e=>(n=0,i=0,s)=>{if("number"==typeof s&&s<0||i<0||n<0)throw new RangeError("The parameters can't be negative.");e.call(t,n,i,s)})(t.start)},Vt=t=>{var e;t.stop=(e=t.stop,(n=0)=>{if(n<0)throw new RangeError("The parameter can't be negative.");e.call(t,n)})},zt=(t,e)=>null===t?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*e))))),jt=(t,e)=>{const n=t.createBiquadFilter();return Nt(n,e),It(n,e,"Q"),It(n,e,"detune"),It(n,e,"frequency"),It(n,e,"gain"),qt(n,e,"type"),n},Lt=(t,e)=>{const n=t.createChannelSplitter(e.numberOfOutputs);return Nt(n,e),(t=>{const e=t.numberOfOutputs;Object.defineProperty(t,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw kt()}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:t=>{if("explicit"!==t)throw kt()}}),Object.defineProperty(t,"channelInterpretation",{get:()=>"discrete",set:t=>{if("discrete"!==t)throw kt()}})})(n),n},Bt=(t,e)=>(t.connect=e.connect.bind(e),t.disconnect=e.disconnect.bind(e),t),Ut=(t,e)=>{const n=t.createDelay(e.maxDelayTime);return Nt(n,e),It(n,e,"delayTime"),n},Wt=(t,e)=>{const n=t.createGain();return Nt(n,e),It(n,e,"gain"),n};function Gt(t,e){const n=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/n,(t[1]*e[0]-t[0]*e[1])/n]}function Yt(t,e){let n=[0,0];for(let r=t.length-1;r>=0;r-=1)s=e,n=[(i=n)[0]*s[0]-i[1]*s[1],i[0]*s[1]+i[1]*s[0]],n[0]+=t[r];var i,s;return n}const Ht=(t,e,n,i)=>t.createScriptProcessor(e,n,i),Xt=()=>new DOMException("","NotSupportedError"),Zt={numberOfChannels:1},$t={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},Qt={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},Jt={disableNormalization:!1},Kt={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},te=()=>new DOMException("","UnknownError"),ee={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},ne=(t,e,n)=>void 0===t.copyFromChannel?t.getChannelData(n)[0]:(t.copyFromChannel(e,n),e[0]),ie=t=>{if(null===t)return!1;const e=t.length;return e%2!=0?0!==t[Math.floor(e/2)]:t[e/2-1]+t[e/2]!==0},se=(t,e,n,i)=>{let s=t;for(;!s.hasOwnProperty(e);)s=Object.getPrototypeOf(s);const{get:r,set:o}=Object.getOwnPropertyDescriptor(s,e);Object.defineProperty(t,e,{get:n(r),set:i(o)})},re=(t,e,n)=>{try{t.setValueAtTime(e,n)}catch(i){if(9!==i.code)throw i;re(t,e,n+1e-7)}},oe=t=>{const e=t.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1},ae=t=>{const e=t.createBuffer(1,1,44100),n=t.createBufferSource();n.buffer=e,n.start(),n.stop();try{return n.stop(),!0}catch{return!1}},ce=t=>{const e=t.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1},ue=()=>{try{new DOMException}catch{return!1}return!0},le=()=>new Promise((t=>{const e=new ArrayBuffer(0),{port1:n,port2:i}=new MessageChannel;n.onmessage=({data:e})=>t(null!==e),i.postMessage(e,[e])})),he=(t,e)=>{const n=e.createGain();t.connect(n);const i=(e=>()=>{e.call(t,n),t.removeEventListener("ended",i)})(t.disconnect);t.addEventListener("ended",i),Bt(t,n),t.stop=(e=>{let i=!1;return(s=0)=>{if(i)try{e.call(t,s)}catch{n.gain.setValueAtTime(0,s)}else e.call(t,s),i=!0}})(t.stop)},fe=(t,e)=>n=>{const i={value:t};return Object.defineProperties(n,{currentTarget:i,target:i}),"function"==typeof e?e.call(t,n):e.handleEvent.call(t,n)},de=(t=>(e,n,[i,s,r],o)=>{t(e[s],[n,i,r],(t=>t[0]===n&&t[1]===i),o)})(Y),pe=(t=>(e,n,[i,s,r],o)=>{const a=e.get(i);void 0===a?e.set(i,new Set([[s,n,r]])):t(a,[s,n,r],(t=>t[0]===s&&t[1]===n),o)})(Y),_e=(t=>(e,n,i,s)=>t(e[s],(t=>t[0]===n&&t[1]===i)))(T),me=new WeakMap,ge=(t=>e=>{var n;return null!==(n=t.get(e))&&void 0!==n?n:0})(me),ve=(ye=new Map,be=new WeakMap,(t,e)=>{const n=be.get(t);if(void 0!==n)return n;const i=ye.get(t);if(void 0!==i)return i;try{const n=e();return n instanceof Promise?(ye.set(t,n),n.catch((()=>!1)).then((e=>(ye.delete(t),be.set(t,e),e)))):(be.set(t,n),n)}catch{return be.set(t,!1),!1}});var ye,be;const xe="undefined"==typeof window?null:window,we=((t,e)=>(n,i)=>{const s=n.createAnalyser();if(Nt(s,i),!(i.maxDecibels>i.minDecibels))throw e();return qt(s,i,"fftSize"),qt(s,i,"maxDecibels"),qt(s,i,"minDecibels"),qt(s,i,"smoothingTimeConstant"),t(Ft,(()=>Ft(s)))||(t=>{t.getFloatTimeDomainData=e=>{const n=new Uint8Array(e.length);t.getByteTimeDomainData(n);const i=Math.max(n.length,t.fftSize);for(let t=0;t<i;t+=1)e[t]=.0078125*(n[t]-128);return e}})(s),s})(ve,q),Te=(t=>e=>{const n=t(e);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer})(j),Me=((t,e,n)=>async(i,s,r)=>{const o=t(i);await Promise.all(o.activeInputs.map(((t,o)=>Array.from(t).map((async([t,a])=>{const c=e(t),u=await c.render(t,s),l=i.context.destination;n(t)||i===l&&n(i)||u.connect(r,a,o)})))).reduce(((t,e)=>[...t,...e]),[]))})(j,Te,it),Se=((t,e,n)=>()=>{const i=new WeakMap;return{render(s,r){const o=i.get(r);return void 0!==o?Promise.resolve(o):(async(s,r)=>{let o=e(s);if(!O(o,r)){const e={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,fftSize:o.fftSize,maxDecibels:o.maxDecibels,minDecibels:o.minDecibels,smoothingTimeConstant:o.smoothingTimeConstant};o=t(r,e)}return i.set(r,o),await n(s,r,o),o})(s,r)}}})(we,et,Me),Ae=(ke=f,t=>{const e=ke.get(t);if(void 0===e)throw kt();return e});var ke;const Ce=(t=>null===t?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null)(xe),De=(t=>e=>null!==t&&e instanceof t)(Ce),Ee=new WeakMap,Oe=(t=>class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(e,n,i){if(null!==n){let s=this._listeners.get(n);void 0===s&&(s=t(this,n),"function"==typeof n&&this._listeners.set(n,s)),this._nativeEventTarget.addEventListener(e,s,i)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,e,n){const i=null===e?void 0:this._listeners.get(e);this._nativeEventTarget.removeEventListener(t,void 0===i?null:i,n)}})(fe),Re=(t=>null===t?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null)(xe),qe=(t=>e=>null!==t&&e instanceof t)(Re),Ne=(t=>e=>null!==t&&"function"==typeof t.AudioNode&&e instanceof t.AudioNode)(xe),Fe=(t=>e=>null!==t&&"function"==typeof t.AudioParam&&e instanceof t.AudioParam)(xe),Ie=(t=>null===t?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null)(xe),Pe=((t,e,n,i,s,r,o,a,c,l,h,f,p,_,m,g)=>class extends l{constructor(e,i,s,r){super(s),this._context=e,this._nativeAudioNode=s;const o=h(e);f(o)&&!0!==n(rt,(()=>rt(o,g)))&&ct(s),u.set(this,s),d.set(this,new Set),"closed"!==e.state&&i&&A(this),t(this,r,s)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(t){this._nativeAudioNode.channelCount=t}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(t){this._nativeAudioNode.channelCountMode=t}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(t){this._nativeAudioNode.channelInterpretation=t}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(t,n=0,a=0){if(n<0||n>=this._nativeAudioNode.numberOfOutputs)throw s();const u=h(this._context),l=m(u);if(p(t)||_(t))throw r();if(W(t)){const s=et(t);try{const e=$(this._nativeAudioNode,s,n,a),i=st(this);(l||i)&&this._nativeAudioNode.disconnect(...e),"closed"!==this.context.state&&!i&&st(t)&&A(t)}catch(t){if(12===t.code)throw r();throw t}if(e(this,t,n,a,l)){const e=c([this],t);ot(e,i(l))}return t}const f=nt(t);if("playbackRate"===f.name&&1024===f.maxValue)throw o();try{this._nativeAudioNode.connect(f,n),(l||st(this))&&this._nativeAudioNode.disconnect(f,n)}catch(t){if(12===t.code)throw r();throw t}if(((t,e,n,i)=>{const{activeInputs:s,passiveInputs:r}=L(e),{outputs:o}=j(t),a=S(t),c=o=>{const a=et(t),c=nt(e);if(o){const e=K(r,t,n);H(s,t,e,!1),i||it(t)||a.connect(c,n)}else{const e=((t,e,n)=>T(t,(t=>t[0]===e&&t[1]===n)))(s,t,n);X(r,e,!1),i||it(t)||a.disconnect(c,n)}};return!!Y(o,[e,n],(t=>t[0]===e&&t[1]===n),!0)&&(a.add(c),V(t)?H(s,t,[n,c],!0):X(r,[t,n,c],!0),!0)})(this,t,n,l)){const e=c([this],t);ot(e,i(l))}}disconnect(t,e,n){let i;const o=h(this._context),u=m(o);if(void 0===t)i=((t,e)=>{const n=j(t),i=[];for(const s of n.outputs)G(s)?ut(t,e,...s):lt(t,e,...s),i.push(s[0]);return n.outputs.clear(),i})(this,u);else if("number"==typeof t){if(t<0||t>=this.numberOfOutputs)throw s();i=((t,e,n)=>{const i=j(t),s=[];for(const r of i.outputs)r[1]===n&&(G(r)?ut(t,e,...r):lt(t,e,...r),s.push(r[0]),i.outputs.delete(r));return s})(this,u,t)}else{if(void 0!==e&&(e<0||e>=this.numberOfOutputs))throw s();if(W(t)&&void 0!==n&&(n<0||n>=t.numberOfInputs))throw s();if(i=((t,e,n,i,s)=>{const r=j(t);return Array.from(r.outputs).filter((t=>!(t[0]!==n||void 0!==i&&t[1]!==i||void 0!==s&&t[2]!==s))).map((n=>(G(n)?ut(t,e,...n):lt(t,e,...n),r.outputs.delete(n),n[0])))})(this,u,t,e,n),0===i.length)throw r()}for(const t of i){const e=c([this],t);ot(e,a)}}})((Ve=c,(t,e,n)=>{const i=[];for(let t=0;t<n.numberOfInputs;t+=1)i.push(new Set);Ve.set(t,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:e})}),((t,e,n,i,s,r,o,a,c,u,l,h,f)=>{const d=new WeakMap;return(p,_,m,g,v)=>{const{activeInputs:y,passiveInputs:b}=r(_),{outputs:x}=r(p),w=a(p),T=r=>{const a=c(_),u=c(p);if(r){const e=M(b,p,m,g);t(y,p,e,!1),v||h(p)||n(u,a,m,g),f(_)&&A(_)}else{const t=i(y,p,m,g);e(b,g,t,!1),v||h(p)||s(u,a,m,g);const n=o(_);if(0===n)l(_)&&D(_,y);else{const t=d.get(_);void 0!==t&&clearTimeout(t),d.set(_,setTimeout((()=>{l(_)&&D(_,y)}),1e3*n))}}};return!!u(x,[_,m,g],(t=>t[0]===_&&t[1]===m&&t[2]===g),!0)&&(w.add(T),l(p)?t(y,p,[m,g,T],!0):e(b,g,[p,m,T],!0),!0)}})(de,pe,$,_e,tt,j,ge,S,et,Y,V,it,st),ve,((t,e,n,i,s,r)=>o=>(a,c)=>{const u=t.get(a);if(void 0===u){if(!o&&r(a)){const t=i(a),{outputs:r}=n(a);for(const n of r)if(G(n)){const s=i(n[0]);e(t,s,n[1],n[2])}else{const e=s(n[0]);t.disconnect(e,n[1])}}t.set(a,c)}else t.set(a,u+c)})(p,tt,j,et,nt,V),q,Ct,Xt,((t,e,n,i,s,r,o,a)=>(c,u)=>{const l=e.get(c);if(void 0===l)throw new Error("Missing the expected cycle count.");const h=r(c.context),f=a(h);if(l===u){if(e.delete(c),!f&&o(c)){const e=i(c),{outputs:r}=n(c);for(const n of r)if(G(n)){const s=i(n[0]);t(e,s,n[1],n[2])}else{const t=s(n[0]);e.connect(t,n[1])}}}else e.set(c,l-u)})($,p,j,et,nt,Ae,V,De),((t,e,n)=>function i(s,r){const o=W(r)?r:n(t,r);if((t=>"delayTime"in t)(o))return[];if(s[0]===o)return[s];if(s.includes(o))return[];const{outputs:a}=e(o);return Array.from(a).map((t=>i([...s,o],t[0]))).reduce(((t,e)=>t.concat(e)),[])})(Ee,j,w),Oe,Ae,qe,Ne,Fe,De,Ie);var Ve;const ze=((t,e,n,i,s,r)=>class extends t{constructor(t,n){const o=s(t),a={...E,...n},c=i(o,a);super(t,!1,c,r(o)?e():null),this._nativeAnalyserNode=c}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(t){this._nativeAnalyserNode.fftSize=t}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(t){const e=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=t,!(t>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=e,n()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(t){const e=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=t,!(this._nativeAnalyserNode.maxDecibels>t))throw this._nativeAnalyserNode.minDecibels=e,n()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(t){this._nativeAnalyserNode.smoothingTimeConstant=t}getByteFrequencyData(t){this._nativeAnalyserNode.getByteFrequencyData(t)}getByteTimeDomainData(t){this._nativeAnalyserNode.getByteTimeDomainData(t)}getFloatFrequencyData(t){this._nativeAnalyserNode.getFloatFrequencyData(t)}getFloatTimeDomainData(t){this._nativeAnalyserNode.getFloatTimeDomainData(t)}})(Pe,Se,q,we,Ae,De),je=new WeakSet,Le=(t=>null===t?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null)(xe),Be=(Ue=new Uint32Array(1),t=>(Ue[0]=t,Ue[0]));var Ue;const We=((t,e)=>n=>{n.copyFromChannel=(i,s,r=0)=>{const o=t(r),a=t(s);if(a>=n.numberOfChannels)throw e();const c=n.length,u=n.getChannelData(a),l=i.length;for(let t=o<0?-o:0;t+o<c&&t<l;t+=1)i[t]=u[t+o]},n.copyToChannel=(i,s,r=0)=>{const o=t(r),a=t(s);if(a>=n.numberOfChannels)throw e();const c=n.length,u=n.getChannelData(a),l=i.length;for(let t=o<0?-o:0;t+o<c&&t<l;t+=1)u[t+o]=i[t]}})(Be,q),Ge=(t=>e=>{e.copyFromChannel=(n=>(i,s,r=0)=>{const o=t(r),a=t(s);if(o<e.length)return n.call(e,i,a,o)})(e.copyFromChannel),e.copyToChannel=(n=>(i,s,r=0)=>{const o=t(r),a=t(s);if(o<e.length)return n.call(e,i,a,o)})(e.copyToChannel)})(Be),Ye=((t,e,n,i,s,r,o,a)=>{let c=null;return class u{constructor(u){if(null===s)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:l,numberOfChannels:h,sampleRate:f}={...F,...u};null===c&&(c=new s(1,1,44100));const d=null!==i&&e(r,r)?new i({length:l,numberOfChannels:h,sampleRate:f}):c.createBuffer(h,l,f);if(0===d.numberOfChannels)throw n();return"function"!=typeof d.copyFromChannel?(o(d),N(d)):e(R,(()=>R(d)))||a(d),t.add(d),d}static[Symbol.hasInstance](e){return null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===u.prototype||t.has(e)}}})(je,ve,Xt,Le,Ce,(t=>()=>{if(null===t)return!1;try{new t({length:1,sampleRate:44100})}catch{return!1}return!0})(Le),We,Ge),He=(t=>(e,n)=>{const i=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(i).connect(e.destination);const s=()=>{n.removeEventListener("ended",s),n.disconnect(i),i.disconnect()};n.addEventListener("ended",s)})(Wt),Xe=((t,e,n)=>async(i,s,r)=>{const o=e(i);await Promise.all(Array.from(o.activeInputs).map((async([e,i])=>{const o=t(e),a=await o.render(e,s);n(e)||a.connect(r,i)})))})(Te,L,it),Ze=(t=>(e,n,i)=>t(n,e,i))(Xe),$e=((t,e,n,i,s,r,o,a,c,u,l)=>(c,h)=>{const f=c.createBufferSource();return Nt(f,h),It(f,h,"playbackRate"),qt(f,h,"buffer"),qt(f,h,"loop"),qt(f,h,"loopEnd"),qt(f,h,"loopStart"),e(n,(()=>n(c)))||(t=>{t.start=(e=>{let n=!1;return(i=0,s=0,r)=>{if(n)throw kt();e.call(t,i,s,r),n=!0}})(t.start)})(f),e(i,(()=>i(c)))||(t=>{t.start=(e=>(n=0,i=0,s)=>{const r=t.buffer,o=null===r?i:Math.min(r.duration,i);null!==r&&o>r.duration-.5/t.context.sampleRate?e.call(t,n,0,0):e.call(t,n,o,s)})(t.start)})(f),e(s,(()=>s(c)))||u(f,c),e(r,(()=>r(c)))||Pt(f),e(o,(()=>o(c)))||l(f,c),e(a,(()=>a(c)))||Vt(f),t(c,f),f})(He,ve,(t=>{const e=t.createBufferSource();e.start();try{e.start()}catch{return!0}return!1}),(t=>{const e=t.createBufferSource(),n=t.createBuffer(1,1,44100);e.buffer=n;try{e.start(0,1)}catch{return!1}return!0}),(t=>{const e=t.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0}),oe,ae,ce,0,(t=>(e,n)=>{const i=n.createBuffer(1,1,44100);null===e.buffer&&(e.buffer=i),t(e,"buffer",(t=>()=>{const n=t.call(e);return n===i?null:n}),(t=>n=>t.call(e,null===n?i:n)))})(se),he),Qe=((t,e)=>(n,i,s)=>(t(i).replay(s),e(i,n,s)))((t=>e=>{const n=t(e);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer})(L),Xe),Je=((t,e,n,i,s)=>()=>{const r=new WeakMap;let o=null,a=null;return{set start(t){o=t},set stop(t){a=t},render(c,u){const l=r.get(u);return void 0!==l?Promise.resolve(l):(async(c,u)=>{let l=n(c);const h=O(l,u);if(!h){const t={buffer:l.buffer,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,loop:l.loop,loopEnd:l.loopEnd,loopStart:l.loopStart,playbackRate:l.playbackRate.value};l=e(u,t),null!==o&&l.start(...o),null!==a&&l.stop(a)}return r.set(u,l),h?await t(u,c.playbackRate,l.playbackRate):await i(u,c.playbackRate,l.playbackRate),await s(c,u,l),l})(c,u)}}})(Ze,$e,et,Qe,Me),Ke=((t,e,n,i,s,r,a,c,u,l,h,f,d)=>(i,p,_,m=null,g=null)=>{const v=new o.AutomationEventList(_.defaultValue),y=p?(t=>({replay(e){for(const n of t)if("exponentialRampToValue"===n.type){const{endTime:t,value:i}=n;e.exponentialRampToValueAtTime(i,t)}else if("linearRampToValue"===n.type){const{endTime:t,value:i}=n;e.linearRampToValueAtTime(i,t)}else if("setTarget"===n.type){const{startTime:t,target:i,timeConstant:s}=n;e.setTargetAtTime(i,t,s)}else if("setValue"===n.type){const{startTime:t,value:i}=n;e.setValueAtTime(i,t)}else{if("setValueCurve"!==n.type)throw new Error("Can't apply an unknown automation.");{const{duration:t,startTime:i,values:s}=n;e.setValueCurveAtTime(s,i,t)}}}}))(v):null,b={get defaultValue(){return _.defaultValue},get maxValue(){return null===m?_.maxValue:m},get minValue(){return null===g?_.minValue:g},get value(){return _.value},set value(t){_.value=t,b.setValueAtTime(t,i.context.currentTime)},cancelAndHoldAtTime(t){if("function"==typeof _.cancelAndHoldAtTime)null===y&&v.flush(i.context.currentTime),v.add(s(t)),_.cancelAndHoldAtTime(t);else{const e=Array.from(v).pop();null===y&&v.flush(i.context.currentTime),v.add(s(t));const n=Array.from(v).pop();_.cancelScheduledValues(t),e!==n&&void 0!==n&&("exponentialRampToValue"===n.type?_.exponentialRampToValueAtTime(n.value,n.endTime):"linearRampToValue"===n.type?_.linearRampToValueAtTime(n.value,n.endTime):"setValue"===n.type?_.setValueAtTime(n.value,n.startTime):"setValueCurve"===n.type&&_.setValueCurveAtTime(n.values,n.startTime,n.duration))}return b},cancelScheduledValues:t=>(null===y&&v.flush(i.context.currentTime),v.add(r(t)),_.cancelScheduledValues(t),b),exponentialRampToValueAtTime(t,e){if(0===t)throw new RangeError;if(!Number.isFinite(e)||e<0)throw new RangeError;return null===y&&v.flush(i.context.currentTime),v.add(a(t,e)),_.exponentialRampToValueAtTime(t,e),b},linearRampToValueAtTime:(t,e)=>(null===y&&v.flush(i.context.currentTime),v.add(c(t,e)),_.linearRampToValueAtTime(t,e),b),setTargetAtTime:(t,e,n)=>(null===y&&v.flush(i.context.currentTime),v.add(u(t,e,n)),_.setTargetAtTime(t,e,n),b),setValueAtTime:(t,e)=>(null===y&&v.flush(i.context.currentTime),v.add(l(t,e)),_.setValueAtTime(t,e),b),setValueCurveAtTime(t,e,n){const s=t instanceof Float32Array?t:new Float32Array(t);if(null!==f&&"webkitAudioContext"===f.name){const t=e+n,r=i.context.sampleRate,o=Math.ceil(e*r),a=Math.floor(t*r),c=a-o,u=new Float32Array(c);for(let t=0;t<c;t+=1){const i=(s.length-1)/n*((o+t)/r-e),a=Math.floor(i),c=Math.ceil(i);u[t]=a===c?s[a]:(1-(i-a))*s[a]+(1-(c-i))*s[c]}null===y&&v.flush(i.context.currentTime),v.add(h(u,e,n)),_.setValueCurveAtTime(u,e,n);const l=a/r;l<t&&d(b,u[u.length-1],l),d(b,s[s.length-1],t)}else null===y&&v.flush(i.context.currentTime),v.add(h(s,e,n)),_.setValueCurveAtTime(s,e,n);return b}};return n.set(b,_),e.set(b,i),t(b,y),b})((tn=l,(t,e)=>{tn.set(t,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:e})}),Ee,h,0,o.createCancelAndHoldAutomationEvent,o.createCancelScheduledValuesAutomationEvent,o.createExponentialRampToValueAutomationEvent,o.createLinearRampToValueAutomationEvent,o.createSetTargetAutomationEvent,o.createSetValueAutomationEvent,o.createSetValueCurveAutomationEvent,Re,re);var tn;const en=((t,e,n,i,s,r,o,a)=>class extends t{constructor(t,i){const a=r(t),c={...z,...i},u=s(a,c),l=o(a),h=l?e():null;super(t,!1,u,h),this._audioBufferSourceNodeRenderer=h,this._isBufferNullified=!1,this._isBufferSet=null!==c.buffer,this._nativeAudioBufferSourceNode=u,this._onended=null,this._playbackRate=n(this,l,u.playbackRate,P,I)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(t){if(this._nativeAudioBufferSourceNode.buffer=t,null!==t){if(this._isBufferSet)throw i();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(t){this._nativeAudioBufferSourceNode.loop=t}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(t){this._nativeAudioBufferSourceNode.loopEnd=t}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(t){this._nativeAudioBufferSourceNode.loopStart=t}get onended(){return this._onended}set onended(t){const e="function"==typeof t?a(this,t):null;this._nativeAudioBufferSourceNode.onended=e;const n=this._nativeAudioBufferSourceNode.onended;this._onended=null!==n&&n===e?t:n}get playbackRate(){return this._playbackRate}start(t=0,e=0,n){if(this._nativeAudioBufferSourceNode.start(t,e,n),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.start=void 0===n?[t,e]:[t,e,n]),"closed"!==this.context.state){A(this);const t=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",t),V(this)&&C(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",t)}}stop(t=0){this._nativeAudioBufferSourceNode.stop(t),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.stop=t)}})(Pe,Je,Ke,kt,$e,Ae,De,fe),nn=((t,e,n,i,s,r,o,a)=>class extends t{constructor(t,e){const n=r(t),i=o(n),c=s(n,e,i);super(t,!1,c,i?(t=>{const e=new WeakMap;return{render(n,i){const s=e.get(i);return void 0!==s?Promise.resolve(s):(async(n,i)=>{const s=i.destination;return e.set(i,s),await t(n,i,s),s})(n,i)}}})(a):null),this._isNodeOfNativeOfflineAudioContext=i,this._nativeAudioDestinationNode=c}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(t){if(this._isNodeOfNativeOfflineAudioContext)throw i();if(t>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=t}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(t){if(this._isNodeOfNativeOfflineAudioContext)throw i();this._nativeAudioDestinationNode.channelCountMode=t}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}})(Pe,0,q,kt,((t,e)=>(n,i,s)=>{const r=n.destination;if(r.channelCount!==i)try{r.channelCount=i}catch{}s&&"explicit"!==r.channelCountMode&&(r.channelCountMode="explicit"),0===r.maxChannelCount&&Object.defineProperty(r,"maxChannelCount",{value:i});const o=t(n,{channelCount:i,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,gain:1});return e(o,"channelCount",(t=>()=>t.call(o)),(t=>e=>{t.call(o,e);try{r.channelCount=e}catch(t){if(e>r.maxChannelCount)throw t}})),e(o,"channelCountMode",(t=>()=>t.call(o)),(t=>e=>{t.call(o,e),r.channelCountMode=e})),e(o,"channelInterpretation",(t=>()=>t.call(o)),(t=>e=>{t.call(o,e),r.channelInterpretation=e})),Object.defineProperty(o,"maxChannelCount",{get:()=>r.maxChannelCount}),o.connect(r),o})(Wt,se),Ae,De,Me),sn=((t,e,n,i,s)=>()=>{const r=new WeakMap;return{render(o,a){const c=r.get(a);return void 0!==c?Promise.resolve(c):(async(o,a)=>{let c=n(o);const u=O(c,a);if(!u){const t={Q:c.Q.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,detune:c.detune.value,frequency:c.frequency.value,gain:c.gain.value,type:c.type};c=e(a,t)}return r.set(a,c),u?(await t(a,o.Q,c.Q),await t(a,o.detune,c.detune),await t(a,o.frequency,c.frequency),await t(a,o.gain,c.gain)):(await i(a,o.Q,c.Q),await i(a,o.detune,c.detune),await i(a,o.frequency,c.frequency),await i(a,o.gain,c.gain)),await s(o,a,c),c})(o,a)}}})(Ze,jt,et,Qe,Me),rn=(t=>(e,n)=>t.set(e,n))(me),on=((t,e,n,i,s,r,o,a)=>class extends t{constructor(t,i){const c=r(t),u={...gt,...i},l=s(c,u),h=o(c);super(t,!1,l,h?n():null),this._Q=e(this,h,l.Q,P,I),this._detune=e(this,h,l.detune,1200*Math.log2(P),-1200*Math.log2(P)),this._frequency=e(this,h,l.frequency,t.sampleRate/2,0),this._gain=e(this,h,l.gain,40*Math.log10(P),I),this._nativeBiquadFilterNode=l,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(t){this._nativeBiquadFilterNode.type=t}getFrequencyResponse(t,e,n){try{this._nativeBiquadFilterNode.getFrequencyResponse(t,e,n)}catch(t){if(11===t.code)throw i();throw t}if(t.length!==e.length||e.length!==n.length)throw i()}})(Pe,Ke,sn,Ct,jt,Ae,De,rn),an=((t,e)=>(n,i,s)=>{const r=new Set;return n.connect=(s=>(o,a=0,c=0)=>{const u=0===r.size;if(e(o))return s.call(n,o,a,c),t(r,[o,a,c],(t=>t[0]===o&&t[1]===a&&t[2]===c),!0),u&&i(),o;s.call(n,o,a),t(r,[o,a],(t=>t[0]===o&&t[1]===a),!0),u&&i()})(n.connect),n.disconnect=(t=>(i,o,a)=>{const c=r.size>0;if(void 0===i)t.apply(n),r.clear();else if("number"==typeof i){t.call(n,i);for(const t of r)t[1]===i&&r.delete(t)}else{e(i)?t.call(n,i,o,a):t.call(n,i,o);for(const t of r)t[0]!==i||void 0!==o&&t[1]!==o||void 0!==a&&t[2]!==a||r.delete(t)}const u=0===r.size;c&&u&&s()})(n.disconnect),n})(Y,Ne),cn=((t,e)=>(n,i)=>{i.channelCount=1,i.channelCountMode="explicit",Object.defineProperty(i,"channelCount",{get:()=>1,set:()=>{throw t()}}),Object.defineProperty(i,"channelCountMode",{get:()=>"explicit",set:()=>{throw t()}});const s=n.createBufferSource();e(i,(()=>{const t=i.numberOfInputs;for(let e=0;e<t;e+=1)s.connect(i,0,e)}),(()=>s.disconnect(i)))})(kt,an),un=((t,e)=>(n,i)=>{const s=n.createChannelMerger(i.numberOfInputs);return null!==t&&"webkitAudioContext"===t.name&&e(n,s),Nt(s,i),s})(Re,cn),ln=((t,e,n)=>()=>{const i=new WeakMap;return{render(s,r){const o=i.get(r);return void 0!==o?Promise.resolve(o):(async(s,r)=>{let o=e(s);if(!O(o,r)){const e={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,numberOfInputs:o.numberOfInputs};o=t(r,e)}return i.set(r,o),await n(s,r,o),o})(s,r)}}})(un,et,Me),hn=((t,e,n,i,s)=>class extends t{constructor(t,r){const o=i(t),a={...vt,...r};super(t,!1,n(o,a),s(o)?e():null)}})(Pe,ln,un,Ae,De),fn=((t,e,n)=>()=>{const i=new WeakMap;return{render(s,r){const o=i.get(r);return void 0!==o?Promise.resolve(o):(async(s,r)=>{let o=e(s);if(!O(o,r)){const e={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,numberOfOutputs:o.numberOfOutputs};o=t(r,e)}return i.set(r,o),await n(s,r,o),o})(s,r)}}})(Lt,et,Me),dn=((t,e,n,i,s,r)=>class extends t{constructor(t,r){const o=i(t),a=(t=>({...t,channelCount:t.numberOfOutputs}))({...yt,...r});super(t,!1,n(o,a),s(o)?e():null)}})(Pe,fn,Lt,Ae,De),pn=((t,e,n,i)=>(s,{offset:r,...o})=>{const a=s.createBuffer(1,2,44100),c=e(s,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),u=n(s,{...o,gain:r}),l=a.getChannelData(0);l[0]=1,l[1]=1,c.buffer=a,c.loop=!0;const h={get bufferSize(){},get channelCount(){return u.channelCount},set channelCount(t){u.channelCount=t},get channelCountMode(){return u.channelCountMode},set channelCountMode(t){u.channelCountMode=t},get channelInterpretation(){return u.channelInterpretation},set channelInterpretation(t){u.channelInterpretation=t},get context(){return u.context},get inputs(){return[]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return u.numberOfOutputs},get offset(){return u.gain},get onended(){return c.onended},set onended(t){c.onended=t},addEventListener:(...t)=>c.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>c.dispatchEvent(t[0]),removeEventListener:(...t)=>c.removeEventListener(t[0],t[1],t[2]),start(t=0){c.start.call(c,t)},stop(t=0){c.stop.call(c,t)}};return t(s,c),i(Bt(h,u),(()=>c.connect(u)),(()=>c.disconnect(u)))})(He,$e,Wt,an),_n=((t,e,n,i,s)=>(r,o)=>{if(void 0===r.createConstantSource)return n(r,o);const a=r.createConstantSource();return Nt(a,o),It(a,o,"offset"),e(i,(()=>i(r)))||Pt(a),e(s,(()=>s(r)))||Vt(a),t(r,a),a})(He,ve,pn,oe,ce),mn=((t,e,n,i,s)=>()=>{const r=new WeakMap;let o=null,a=null;return{set start(t){o=t},set stop(t){a=t},render(c,u){const l=r.get(u);return void 0!==l?Promise.resolve(l):(async(c,u)=>{let l=n(c);const h=O(l,u);if(!h){const t={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,offset:l.offset.value};l=e(u,t),null!==o&&l.start(o),null!==a&&l.stop(a)}return r.set(u,l),h?await t(u,c.offset,l.offset):await i(u,c.offset,l.offset),await s(c,u,l),l})(c,u)}}})(Ze,_n,et,Qe,Me),gn=((t,e,n,i,s,r,o)=>class extends t{constructor(t,o){const a=s(t),c={...bt,...o},u=i(a,c),l=r(a),h=l?n():null;super(t,!1,u,h),this._constantSourceNodeRenderer=h,this._nativeConstantSourceNode=u,this._offset=e(this,l,u.offset,P,I),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(t){const e="function"==typeof t?o(this,t):null;this._nativeConstantSourceNode.onended=e;const n=this._nativeConstantSourceNode.onended;this._onended=null!==n&&n===e?t:n}start(t=0){if(this._nativeConstantSourceNode.start(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.start=t),"closed"!==this.context.state){A(this);const t=()=>{this._nativeConstantSourceNode.removeEventListener("ended",t),V(this)&&C(this)};this._nativeConstantSourceNode.addEventListener("ended",t)}}stop(t=0){this._nativeConstantSourceNode.stop(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.stop=t)}})(Pe,Ke,mn,_n,Ae,De,fe),vn=((t,e)=>(n,i)=>{const s=n.createConvolver();if(Nt(s,i),i.disableNormalization===s.normalize&&(s.normalize=!i.disableNormalization),qt(s,i,"buffer"),i.channelCount>2)throw t();if(e(s,"channelCount",(t=>()=>t.call(s)),(e=>n=>{if(n>2)throw t();return e.call(s,n)})),"max"===i.channelCountMode)throw t();return e(s,"channelCountMode",(t=>()=>t.call(s)),(e=>n=>{if("max"===n)throw t();return e.call(s,n)})),s})(Xt,se),yn=((t,e,n)=>()=>{const i=new WeakMap;return{render(s,r){const o=i.get(r);return void 0!==o?Promise.resolve(o):(async(s,r)=>{let o=e(s);if(!O(o,r)){const e={buffer:o.buffer,channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,disableNormalization:!o.normalize};o=t(r,e)}return i.set(r,o),Z(o)?await n(s,r,o.inputs[0]):await n(s,r,o),o})(s,r)}}})(vn,et,Me),bn=((t,e,n,i,s,r)=>class extends t{constructor(t,o){const a=i(t),c={...xt,...o},u=n(a,c);super(t,!1,u,s(a)?e():null),this._isBufferNullified=!1,this._nativeConvolverNode=u,null!==c.buffer&&r(this,c.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(t){if(this._nativeConvolverNode.buffer=t,null===t&&null!==this._nativeConvolverNode.buffer){const t=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=t.createBuffer(1,1,44100),this._isBufferNullified=!0,r(this,0)}else this._isBufferNullified=!1,r(this,null===this._nativeConvolverNode.buffer?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(t){this._nativeConvolverNode.normalize=t}})(Pe,yn,vn,Ae,De,rn),xn=((t,e,n,i,s)=>r=>{const o=new WeakMap;return{render(a,c){const u=o.get(c);return void 0!==u?Promise.resolve(u):(async(a,c)=>{let u=n(a);const l=O(u,c);if(!l){const t={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,delayTime:u.delayTime.value,maxDelayTime:r};u=e(c,t)}return o.set(c,u),l?await t(c,a.delayTime,u.delayTime):await i(c,a.delayTime,u.delayTime),await s(a,c,u),u})(a,c)}}})(Ze,Ut,et,Qe,Me),wn=((t,e,n,i,s,r,o)=>class extends t{constructor(t,a){const c=s(t),u={...Tt,...a},l=i(c,u),h=r(c);super(t,!1,l,h?n(u.maxDelayTime):null),this._delayTime=e(this,h,l.delayTime),o(this,u.maxDelayTime)}get delayTime(){return this._delayTime}})(Pe,Ke,xn,Ut,Ae,De,rn),Tn=(t=>(e,n)=>{const i=e.createDynamicsCompressor();if(Nt(i,n),n.channelCount>2)throw t();if("max"===n.channelCountMode)throw t();return It(i,n,"attack"),It(i,n,"knee"),It(i,n,"ratio"),It(i,n,"release"),It(i,n,"threshold"),i})(Xt),Mn=((t,e,n,i,s)=>()=>{const r=new WeakMap;return{render(o,a){const c=r.get(a);return void 0!==c?Promise.resolve(c):(async(o,a)=>{let c=n(o);const u=O(c,a);if(!u){const t={attack:c.attack.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,knee:c.knee.value,ratio:c.ratio.value,release:c.release.value,threshold:c.threshold.value};c=e(a,t)}return r.set(a,c),u?(await t(a,o.attack,c.attack),await t(a,o.knee,c.knee),await t(a,o.ratio,c.ratio),await t(a,o.release,c.release),await t(a,o.threshold,c.threshold)):(await i(a,o.attack,c.attack),await i(a,o.knee,c.knee),await i(a,o.ratio,c.ratio),await i(a,o.release,c.release),await i(a,o.threshold,c.threshold)),await s(o,a,c),c})(o,a)}}})(Ze,Tn,et,Qe,Me),Sn=((t,e,n,i,s,r,o,a)=>class extends t{constructor(t,s){const c=r(t),u={...St,...s},l=i(c,u),h=o(c);super(t,!1,l,h?n():null),this._attack=e(this,h,l.attack),this._knee=e(this,h,l.knee),this._nativeDynamicsCompressorNode=l,this._ratio=e(this,h,l.ratio),this._release=e(this,h,l.release),this._threshold=e(this,h,l.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(t){const e=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=t,t>2)throw this._nativeDynamicsCompressorNode.channelCount=e,s()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(t){const e=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=t,"max"===t)throw this._nativeDynamicsCompressorNode.channelCountMode=e,s()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return"number"==typeof this._nativeDynamicsCompressorNode.reduction.value?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}})(Pe,Ke,Mn,Tn,Xt,Ae,De,rn),An=((t,e,n,i,s)=>()=>{const r=new WeakMap;return{render(o,a){const c=r.get(a);return void 0!==c?Promise.resolve(c):(async(o,a)=>{let c=n(o);const u=O(c,a);if(!u){const t={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,gain:c.gain.value};c=e(a,t)}return r.set(a,c),u?await t(a,o.gain,c.gain):await i(a,o.gain,c.gain),await s(o,a,c),c})(o,a)}}})(Ze,Wt,et,Qe,Me),kn=((t,e,n,i,s,r)=>class extends t{constructor(t,o){const a=s(t),c={...At,...o},u=i(a,c),l=r(a);super(t,!1,u,l?n():null),this._gain=e(this,l,u.gain,P,I)}get gain(){return this._gain}})(Pe,Ke,An,Wt,Ae,De),Cn=((t,e,n,i)=>(s,r,{channelCount:o,channelCountMode:a,channelInterpretation:c,feedback:u,feedforward:l})=>{const h=zt(r,s.sampleRate),f=u instanceof Float64Array?u:new Float64Array(u),d=l instanceof Float64Array?l:new Float64Array(l),p=f.length,_=d.length,m=Math.min(p,_);if(0===p||p>20)throw i();if(0===f[0])throw e();if(0===_||_>20)throw i();if(0===d[0])throw e();if(1!==f[0]){for(let t=0;t<_;t+=1)d[t]/=f[0];for(let t=1;t<p;t+=1)f[t]/=f[0]}const g=n(s,h,o,o);g.channelCount=o,g.channelCountMode=a,g.channelInterpretation=c;const v=[],y=[],b=[];for(let t=0;t<o;t+=1){v.push(0);const t=new Float32Array(32),e=new Float32Array(32);t.fill(0),e.fill(0),y.push(t),b.push(e)}g.onaudioprocess=t=>{const e=t.inputBuffer,n=t.outputBuffer,i=e.numberOfChannels;for(let t=0;t<i;t+=1){const i=e.getChannelData(t),s=n.getChannelData(t);v[t]=Et(f,p,d,_,m,y[t],b[t],v[t],32,i,s)}};const x=s.sampleRate/2;return Bt({get bufferSize(){return h},get channelCount(){return g.channelCount},set channelCount(t){g.channelCount=t},get channelCountMode(){return g.channelCountMode},set channelCountMode(t){g.channelCountMode=t},get channelInterpretation(){return g.channelInterpretation},set channelInterpretation(t){g.channelInterpretation=t},get context(){return g.context},get inputs(){return[g]},get numberOfInputs(){return g.numberOfInputs},get numberOfOutputs(){return g.numberOfOutputs},addEventListener:(...t)=>g.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>g.dispatchEvent(t[0]),getFrequencyResponse(e,n,i){if(e.length!==n.length||n.length!==i.length)throw t();const s=e.length;for(let t=0;t<s;t+=1){const s=-Math.PI*(e[t]/x),r=[Math.cos(s),Math.sin(s)],o=Gt(Yt(d,r),Yt(f,r));n[t]=Math.sqrt(o[0]*o[0]+o[1]*o[1]),i[t]=Math.atan2(o[1],o[0])}},removeEventListener:(...t)=>g.removeEventListener(t[0],t[1],t[2])},g)})(Ct,kt,Ht,Xt),Dn=((t,e,n,i)=>s=>t(Rt,(()=>Rt(s)))?Promise.resolve(t(i,i)).then((t=>{if(!t){const t=n(s,512,0,1);s.oncomplete=()=>{t.onaudioprocess=null,t.disconnect()},t.onaudioprocess=()=>s.currentTime,t.connect(s.destination)}return s.startRendering()})):new Promise((t=>{const n=e(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});s.oncomplete=e=>{n.disconnect(),t(e.renderedBuffer)},n.connect(s.destination),s.startRendering()})))(ve,Wt,Ht,((t,e)=>()=>{if(null===e)return Promise.resolve(!1);const n=new e(1,1,44100),i=t(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise((t=>{n.oncomplete=()=>{i.disconnect(),t(0!==n.currentTime)},n.startRendering()}))})(Wt,Ce)),En=((t,e,n,i,s)=>(r,o)=>{const a=new WeakMap;let c=null;return{render(u,l){const h=a.get(l);return void 0!==h?Promise.resolve(h):(async(u,l)=>{let h=null,f=e(u);const d=O(f,l);if(void 0===l.createIIRFilter?h=t(l,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):d||(f=l.createIIRFilter(o,r)),a.set(l,null===h?f:h),null!==h){if(null===c){if(null===n)throw new Error("Missing the native OfflineAudioContext constructor.");const t=new n(u.context.destination.channelCount,u.context.length,l.sampleRate);c=(async()=>(await i(u,t,t.destination),((t,e,n,i)=>{const s=n instanceof Float64Array?n:new Float64Array(n),r=i instanceof Float64Array?i:new Float64Array(i),o=s.length,a=r.length,c=Math.min(o,a);if(1!==s[0]){for(let t=0;t<o;t+=1)r[t]/=s[0];for(let t=1;t<a;t+=1)s[t]/=s[0]}const u=new Float32Array(32),l=new Float32Array(32),h=e.createBuffer(t.numberOfChannels,t.length,t.sampleRate),f=t.numberOfChannels;for(let e=0;e<f;e+=1){const n=t.getChannelData(e),i=h.getChannelData(e);u.fill(0),l.fill(0),Et(s,o,r,a,c,u,l,0,32,n,i)}return h})(await s(t),l,r,o)))()}const t=await c;return h.buffer=t,h.start(0),h}return await i(u,l,f),f})(u,l)}}})($e,et,Ce,Me,Dn),On=(t=>(e,n,i)=>{if(void 0===e.createIIRFilter)return t(e,n,i);const s=e.createIIRFilter(i.feedforward,i.feedback);return Nt(s,i),s})(Cn),Rn=((t,e,n,i,s,r)=>class extends t{constructor(t,o){const a=i(t),c=s(a),u={...Dt,...o},l=e(a,c?null:t.baseLatency,u);super(t,!1,l,c?n(u.feedback,u.feedforward):null),(t=>{var e;t.getFrequencyResponse=(e=t.getFrequencyResponse,(n,i,s)=>{if(n.length!==i.length||i.length!==s.length)throw Ct();return e.call(t,n,i,s)})})(l),this._nativeIIRFilterNode=l,r(this,1)}getFrequencyResponse(t,e,n){return this._nativeIIRFilterNode.getFrequencyResponse(t,e,n)}})(Pe,On,En,Ae,De,rn),qn=((t,e,n,i,s,r,o,a)=>(c,u)=>{const l=u.listener,{forwardX:h,forwardY:f,forwardZ:d,positionX:p,positionY:_,positionZ:m,upX:g,upY:v,upZ:y}=void 0===l.forwardX?(()=>{const h=new Float32Array(1),f=e(u,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),d=o(u);let p=!1,_=[0,0,-1,0,1,0],m=[0,0,0];const g=()=>{if(p)return;p=!0;const t=i(u,256,9,0);t.onaudioprocess=({inputBuffer:t})=>{const e=[r(t,h,0),r(t,h,1),r(t,h,2),r(t,h,3),r(t,h,4),r(t,h,5)];e.some(((t,e)=>t!==_[e]))&&(l.setOrientation(...e),_=e);const n=[r(t,h,6),r(t,h,7),r(t,h,8)];n.some(((t,e)=>t!==m[e]))&&(l.setPosition(...n),m=n)},f.connect(t)},v=t=>e=>{e!==_[t]&&(_[t]=e,l.setOrientation(..._))},y=t=>e=>{e!==m[t]&&(m[t]=e,l.setPosition(...m))},b=(e,i,r)=>{const o=n(u,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:i});o.connect(f,0,e),o.start(),Object.defineProperty(o.offset,"defaultValue",{get:()=>i});const l=t({context:c},d,o.offset,P,I);var h,p,_,m,v,y,b;return a(l,"value",(t=>()=>t.call(l)),(t=>e=>{try{t.call(l,e)}catch(t){if(9!==t.code)throw t}g(),d&&r(e)})),l.cancelAndHoldAtTime=(h=l.cancelAndHoldAtTime,d?()=>{throw s()}:(...t)=>{const e=h.apply(l,t);return g(),e}),l.cancelScheduledValues=(p=l.cancelScheduledValues,d?()=>{throw s()}:(...t)=>{const e=p.apply(l,t);return g(),e}),l.exponentialRampToValueAtTime=(_=l.exponentialRampToValueAtTime,d?()=>{throw s()}:(...t)=>{const e=_.apply(l,t);return g(),e}),l.linearRampToValueAtTime=(m=l.linearRampToValueAtTime,d?()=>{throw s()}:(...t)=>{const e=m.apply(l,t);return g(),e}),l.setTargetAtTime=(v=l.setTargetAtTime,d?()=>{throw s()}:(...t)=>{const e=v.apply(l,t);return g(),e}),l.setValueAtTime=(y=l.setValueAtTime,d?()=>{throw s()}:(...t)=>{const e=y.apply(l,t);return g(),e}),l.setValueCurveAtTime=(b=l.setValueCurveAtTime,d?()=>{throw s()}:(...t)=>{const e=b.apply(l,t);return g(),e}),l};return{forwardX:b(0,0,v(0)),forwardY:b(1,0,v(1)),forwardZ:b(2,-1,v(2)),positionX:b(6,0,y(0)),positionY:b(7,0,y(1)),positionZ:b(8,0,y(2)),upX:b(3,0,v(3)),upY:b(4,1,v(4)),upZ:b(5,0,v(5))}})():l;return{get forwardX(){return h},get forwardY(){return f},get forwardZ(){return d},get positionX(){return p},get positionY(){return _},get positionZ(){return m},get upX(){return g},get upY(){return v},get upZ(){return y}}})(Ke,un,_n,Ht,Xt,ne,De,se),Nn=new WeakMap,Fn=((t,e,n,i,s,r)=>class extends n{constructor(n,r){super(n),this._nativeContext=n,f.set(this,n),i(n)&&s.set(n,new Set),this._destination=new t(this,r),this._listener=e(this,n),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(t){const e="function"==typeof t?r(this,t):null;this._nativeContext.onstatechange=e;const n=this._nativeContext.onstatechange;this._onstatechange=null!==n&&n===e?t:n}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}})(nn,qn,Oe,De,Nn,fe),In=((t,e,n,i,s,r)=>(o,a)=>{const c=o.createOscillator();return Nt(c,a),It(c,a,"detune"),It(c,a,"frequency"),void 0!==a.periodicWave?c.setPeriodicWave(a.periodicWave):qt(c,a,"type"),e(n,(()=>n(o)))||Pt(c),e(i,(()=>i(o)))||r(c,o),e(s,(()=>s(o)))||Vt(c),t(o,c),c})(He,ve,oe,ae,ce,he),Pn=((t,e,n,i,s)=>()=>{const r=new WeakMap;let o=null,a=null,c=null;return{set periodicWave(t){o=t},set start(t){a=t},set stop(t){c=t},render(u,l){const h=r.get(l);return void 0!==h?Promise.resolve(h):(async(u,l)=>{let h=n(u);const f=O(h,l);if(!f){const t={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,detune:h.detune.value,frequency:h.frequency.value,periodicWave:null===o?void 0:o,type:h.type};h=e(l,t),null!==a&&h.start(a),null!==c&&h.stop(c)}return r.set(l,h),f?(await t(l,u.detune,h.detune),await t(l,u.frequency,h.frequency)):(await i(l,u.detune,h.detune),await i(l,u.frequency,h.frequency)),await s(u,l,h),h})(u,l)}}})(Ze,In,et,Qe,Me),Vn=((t,e,n,i,s,r,o)=>class extends t{constructor(t,o){const a=s(t),c={...$t,...o},u=n(a,c),l=r(a),h=l?i():null,f=t.sampleRate/2;super(t,!1,u,h),this._detune=e(this,l,u.detune,153600,-153600),this._frequency=e(this,l,u.frequency,f,-f),this._nativeOscillatorNode=u,this._onended=null,this._oscillatorNodeRenderer=h,null!==this._oscillatorNodeRenderer&&void 0!==c.periodicWave&&(this._oscillatorNodeRenderer.periodicWave=c.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(t){const e="function"==typeof t?o(this,t):null;this._nativeOscillatorNode.onended=e;const n=this._nativeOscillatorNode.onended;this._onended=null!==n&&n===e?t:n}get type(){return this._nativeOscillatorNode.type}set type(t){this._nativeOscillatorNode.type=t,null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(t){this._nativeOscillatorNode.setPeriodicWave(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=t)}start(t=0){if(this._nativeOscillatorNode.start(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.start=t),"closed"!==this.context.state){A(this);const t=()=>{this._nativeOscillatorNode.removeEventListener("ended",t),V(this)&&C(this)};this._nativeOscillatorNode.addEventListener("ended",t)}}stop(t=0){this._nativeOscillatorNode.stop(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.stop=t)}})(Pe,Ke,In,Pn,Ae,De,fe),zn=(t=>(e,n)=>{const i=t(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),s=e.createBuffer(1,2,44100);return i.buffer=s,i.loop=!0,i.connect(n),i.start(),()=>{i.stop(),i.disconnect(n)}})($e),jn=((t,e,n,i,s)=>(r,{curve:o,oversample:a,...c})=>{const u=r.createWaveShaper(),l=r.createWaveShaper();Nt(u,c),Nt(l,c);const h=n(r,{...c,gain:1}),f=n(r,{...c,gain:-1}),d=n(r,{...c,gain:1}),p=n(r,{...c,gain:-1});let _=null,m=!1,g=null;const v={get bufferSize(){},get channelCount(){return u.channelCount},set channelCount(t){h.channelCount=t,f.channelCount=t,u.channelCount=t,d.channelCount=t,l.channelCount=t,p.channelCount=t},get channelCountMode(){return u.channelCountMode},set channelCountMode(t){h.channelCountMode=t,f.channelCountMode=t,u.channelCountMode=t,d.channelCountMode=t,l.channelCountMode=t,p.channelCountMode=t},get channelInterpretation(){return u.channelInterpretation},set channelInterpretation(t){h.channelInterpretation=t,f.channelInterpretation=t,u.channelInterpretation=t,d.channelInterpretation=t,l.channelInterpretation=t,p.channelInterpretation=t},get context(){return u.context},get curve(){return g},set curve(n){if(null!==n&&n.length<2)throw e();if(null===n)u.curve=n,l.curve=n;else{const t=n.length,e=new Float32Array(t+2-t%2),i=new Float32Array(t+2-t%2);e[0]=n[0],i[0]=-n[t-1];const s=Math.ceil((t+1)/2),r=(t+1)/2-1;for(let o=1;o<s;o+=1){const a=o/s*r,c=Math.floor(a),u=Math.ceil(a);e[o]=c===u?n[c]:(1-(a-c))*n[c]+(1-(u-a))*n[u],i[o]=c===u?-n[t-1-c]:-(1-(a-c))*n[t-1-c]-(1-(u-a))*n[t-1-u]}e[s]=t%2==1?n[s-1]:(n[s-2]+n[s-1])/2,u.curve=e,l.curve=i}g=n,m&&(i(g)&&null===_?_=t(r,h):null!==_&&(_(),_=null))},get inputs(){return[h]},get numberOfInputs(){return u.numberOfInputs},get numberOfOutputs(){return u.numberOfOutputs},get oversample(){return u.oversample},set oversample(t){u.oversample=t,l.oversample=t},addEventListener:(...t)=>h.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>h.dispatchEvent(t[0]),removeEventListener:(...t)=>h.removeEventListener(t[0],t[1],t[2])};return null!==o&&(v.curve=o instanceof Float32Array?o:new Float32Array(o)),a!==v.oversample&&(v.oversample=a),s(Bt(v,d),(()=>{h.connect(u).connect(d),h.connect(f).connect(l).connect(p).connect(d),m=!0,i(g)&&(_=t(r,h))}),(()=>{h.disconnect(u),u.disconnect(d),h.disconnect(f),f.disconnect(l),l.disconnect(p),p.disconnect(d),m=!1,null!==_&&(_(),_=null)}))})(zn,kt,Wt,ie,an),Ln=((t,e,n,i,s,r,o)=>(a,c)=>{const u=a.createWaveShaper();if(null!==r&&"webkitAudioContext"===r.name&&void 0===a.createGain().gain.automationRate)return n(a,c);Nt(u,c);const l=null===c.curve||c.curve instanceof Float32Array?c.curve:new Float32Array(c.curve);if(null!==l&&l.length<2)throw e();qt(u,{curve:l},"curve"),qt(u,c,"oversample");let h=null,f=!1;return o(u,"curve",(t=>()=>t.call(u)),(e=>n=>(e.call(u,n),f&&(i(n)&&null===h?h=t(a,u):i(n)||null===h||(h(),h=null)),n))),s(u,(()=>{f=!0,i(u.curve)&&(h=t(a,u))}),(()=>{f=!1,null!==h&&(h(),h=null)}))})(zn,kt,jn,ie,an,Re,se),Bn=((t,e,n,i,s,r,o,a,c,u)=>(l,{coneInnerAngle:h,coneOuterAngle:f,coneOuterGain:d,distanceModel:p,maxDistance:_,orientationX:m,orientationY:g,orientationZ:v,panningModel:y,positionX:b,positionY:x,positionZ:w,refDistance:T,rolloffFactor:M,...S})=>{const A=l.createPanner();if(S.channelCount>2)throw o();if("max"===S.channelCountMode)throw o();Nt(A,S);const k={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},C=n(l,{...k,channelInterpretation:"speakers",numberOfInputs:6}),D=i(l,{...S,gain:1}),E=i(l,{...k,gain:1}),O=i(l,{...k,gain:0}),R=i(l,{...k,gain:0}),q=i(l,{...k,gain:0}),N=i(l,{...k,gain:0}),F=i(l,{...k,gain:0}),I=s(l,256,6,1),P=r(l,{...k,curve:new Float32Array([1,1]),oversample:"none"});let V=[m,g,v],z=[b,x,w];const j=new Float32Array(1);I.onaudioprocess=({inputBuffer:t})=>{const e=[c(t,j,0),c(t,j,1),c(t,j,2)];e.some(((t,e)=>t!==V[e]))&&(A.setOrientation(...e),V=e);const n=[c(t,j,3),c(t,j,4),c(t,j,5)];n.some(((t,e)=>t!==z[e]))&&(A.setPosition(...n),z=n)},Object.defineProperty(O.gain,"defaultValue",{get:()=>0}),Object.defineProperty(R.gain,"defaultValue",{get:()=>0}),Object.defineProperty(q.gain,"defaultValue",{get:()=>0}),Object.defineProperty(N.gain,"defaultValue",{get:()=>0}),Object.defineProperty(F.gain,"defaultValue",{get:()=>0});const L={get bufferSize(){},get channelCount(){return A.channelCount},set channelCount(t){if(t>2)throw o();D.channelCount=t,A.channelCount=t},get channelCountMode(){return A.channelCountMode},set channelCountMode(t){if("max"===t)throw o();D.channelCountMode=t,A.channelCountMode=t},get channelInterpretation(){return A.channelInterpretation},set channelInterpretation(t){D.channelInterpretation=t,A.channelInterpretation=t},get coneInnerAngle(){return A.coneInnerAngle},set coneInnerAngle(t){A.coneInnerAngle=t},get coneOuterAngle(){return A.coneOuterAngle},set coneOuterAngle(t){A.coneOuterAngle=t},get coneOuterGain(){return A.coneOuterGain},set coneOuterGain(t){if(t<0||t>1)throw e();A.coneOuterGain=t},get context(){return A.context},get distanceModel(){return A.distanceModel},set distanceModel(t){A.distanceModel=t},get inputs(){return[D]},get maxDistance(){return A.maxDistance},set maxDistance(t){if(t<0)throw new RangeError;A.maxDistance=t},get numberOfInputs(){return A.numberOfInputs},get numberOfOutputs(){return A.numberOfOutputs},get orientationX(){return E.gain},get orientationY(){return O.gain},get orientationZ(){return R.gain},get panningModel(){return A.panningModel},set panningModel(t){A.panningModel=t},get positionX(){return q.gain},get positionY(){return N.gain},get positionZ(){return F.gain},get refDistance(){return A.refDistance},set refDistance(t){if(t<0)throw new RangeError;A.refDistance=t},get rolloffFactor(){return A.rolloffFactor},set rolloffFactor(t){if(t<0)throw new RangeError;A.rolloffFactor=t},addEventListener:(...t)=>D.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>D.dispatchEvent(t[0]),removeEventListener:(...t)=>D.removeEventListener(t[0],t[1],t[2])};return h!==L.coneInnerAngle&&(L.coneInnerAngle=h),f!==L.coneOuterAngle&&(L.coneOuterAngle=f),d!==L.coneOuterGain&&(L.coneOuterGain=d),p!==L.distanceModel&&(L.distanceModel=p),_!==L.maxDistance&&(L.maxDistance=_),m!==L.orientationX.value&&(L.orientationX.value=m),g!==L.orientationY.value&&(L.orientationY.value=g),v!==L.orientationZ.value&&(L.orientationZ.value=v),y!==L.panningModel&&(L.panningModel=y),b!==L.positionX.value&&(L.positionX.value=b),x!==L.positionY.value&&(L.positionY.value=x),w!==L.positionZ.value&&(L.positionZ.value=w),T!==L.refDistance&&(L.refDistance=T),M!==L.rolloffFactor&&(L.rolloffFactor=M),1===V[0]&&0===V[1]&&0===V[2]||A.setOrientation(...V),0===z[0]&&0===z[1]&&0===z[2]||A.setPosition(...z),u(Bt(L,A),(()=>{D.connect(A),t(D,P,0,0),P.connect(E).connect(C,0,0),P.connect(O).connect(C,0,1),P.connect(R).connect(C,0,2),P.connect(q).connect(C,0,3),P.connect(N).connect(C,0,4),P.connect(F).connect(C,0,5),C.connect(I).connect(l.destination)}),(()=>{D.disconnect(A),a(D,P,0,0),P.disconnect(E),E.disconnect(C),P.disconnect(O),O.disconnect(C),P.disconnect(R),R.disconnect(C),P.disconnect(q),q.disconnect(C),P.disconnect(N),N.disconnect(C),P.disconnect(F),F.disconnect(C),C.disconnect(I),I.disconnect(l.destination)}))})($,kt,un,Wt,Ht,Ln,Xt,tt,ne,an),Un=(t=>(e,n)=>{const i=e.createPanner();return void 0===i.orientationX?t(e,n):(Nt(i,n),It(i,n,"orientationX"),It(i,n,"orientationY"),It(i,n,"orientationZ"),It(i,n,"positionX"),It(i,n,"positionY"),It(i,n,"positionZ"),qt(i,n,"coneInnerAngle"),qt(i,n,"coneOuterAngle"),qt(i,n,"coneOuterGain"),qt(i,n,"distanceModel"),qt(i,n,"maxDistance"),qt(i,n,"panningModel"),qt(i,n,"refDistance"),qt(i,n,"rolloffFactor"),i)})(Bn),Wn=((t,e,n,i,s,r,o,a,c,u)=>()=>{const l=new WeakMap;let h=null;return{render(f,d){const p=l.get(d);return void 0!==p?Promise.resolve(p):(async(f,d)=>{let p=null,_=r(f);const m={channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation},g={...m,coneInnerAngle:_.coneInnerAngle,coneOuterAngle:_.coneOuterAngle,coneOuterGain:_.coneOuterGain,distanceModel:_.distanceModel,maxDistance:_.maxDistance,panningModel:_.panningModel,refDistance:_.refDistance,rolloffFactor:_.rolloffFactor},v=O(_,d);if("bufferSize"in _)p=i(d,{...m,gain:1});else if(!v){const t={...g,orientationX:_.orientationX.value,orientationY:_.orientationY.value,orientationZ:_.orientationZ.value,positionX:_.positionX.value,positionY:_.positionY.value,positionZ:_.positionZ.value};_=s(d,t)}if(l.set(d,null===p?_:p),null!==p){if(null===h){if(null===o)throw new Error("Missing the native OfflineAudioContext constructor.");const t=new o(6,f.context.length,d.sampleRate),i=e(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});i.connect(t.destination),h=(async()=>{const e=await Promise.all([f.orientationX,f.orientationY,f.orientationZ,f.positionX,f.positionY,f.positionZ].map((async(e,i)=>{const s=n(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:0===i?1:0});return await a(t,e,s.offset),s})));for(let t=0;t<6;t+=1)e[t].connect(i,0,t),e[t].start(0);return u(t)})()}const t=await h,r=i(d,{...m,gain:1});await c(f,d,r);const l=[];for(let e=0;e<t.numberOfChannels;e+=1)l.push(t.getChannelData(e));let _=[l[0][0],l[1][0],l[2][0]],v=[l[3][0],l[4][0],l[5][0]],y=i(d,{...m,gain:1}),b=s(d,{...g,orientationX:_[0],orientationY:_[1],orientationZ:_[2],positionX:v[0],positionY:v[1],positionZ:v[2]});r.connect(y).connect(b.inputs[0]),b.connect(p);for(let e=128;e<t.length;e+=128){const t=[l[0][e],l[1][e],l[2][e]],n=[l[3][e],l[4][e],l[5][e]];if(t.some(((t,e)=>t!==_[e]))||n.some(((t,e)=>t!==v[e]))){_=t,v=n;const o=e/d.sampleRate;y.gain.setValueAtTime(0,o),y=i(d,{...m,gain:0}),b=s(d,{...g,orientationX:_[0],orientationY:_[1],orientationZ:_[2],positionX:v[0],positionY:v[1],positionZ:v[2]}),y.gain.setValueAtTime(1,o),r.connect(y).connect(b.inputs[0]),b.connect(p)}}return p}return v?(await t(d,f.orientationX,_.orientationX),await t(d,f.orientationY,_.orientationY),await t(d,f.orientationZ,_.orientationZ),await t(d,f.positionX,_.positionX),await t(d,f.positionY,_.positionY),await t(d,f.positionZ,_.positionZ)):(await a(d,f.orientationX,_.orientationX),await a(d,f.orientationY,_.orientationY),await a(d,f.orientationZ,_.orientationZ),await a(d,f.positionX,_.positionX),await a(d,f.positionY,_.positionY),await a(d,f.positionZ,_.positionZ)),Z(_)?await c(f,d,_.inputs[0]):await c(f,d,_),_})(f,d)}}})(Ze,un,_n,Wt,Un,et,Ce,Qe,Me,Dn),Gn=((t,e,n,i,s,r,o)=>class extends t{constructor(t,a){const c=s(t),u={...Qt,...a},l=n(c,u),h=r(c);super(t,!1,l,h?i():null),this._nativePannerNode=l,this._orientationX=e(this,h,l.orientationX,P,I),this._orientationY=e(this,h,l.orientationY,P,I),this._orientationZ=e(this,h,l.orientationZ,P,I),this._positionX=e(this,h,l.positionX,P,I),this._positionY=e(this,h,l.positionY,P,I),this._positionZ=e(this,h,l.positionZ,P,I),o(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(t){this._nativePannerNode.coneInnerAngle=t}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(t){this._nativePannerNode.coneOuterAngle=t}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(t){this._nativePannerNode.coneOuterGain=t}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(t){this._nativePannerNode.distanceModel=t}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(t){this._nativePannerNode.maxDistance=t}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(t){this._nativePannerNode.panningModel=t}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(t){this._nativePannerNode.refDistance=t}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(t){this._nativePannerNode.rolloffFactor=t}})(Pe,Ke,Un,Wn,Ae,De,rn),Yn=(t=>(e,{disableNormalization:n,imag:i,real:s})=>{const r=i instanceof Float32Array?i:new Float32Array(i),o=s instanceof Float32Array?s:new Float32Array(s),a=e.createPeriodicWave(o,r,{disableNormalization:n});if(Array.from(i).length<2)throw t();return a})(q),Hn=((t,e,n,i)=>class i{constructor(i,s){const r=e(i),o=(t=>{const{imag:e,real:n}=t;return void 0===e?void 0===n?{...t,imag:[0,0],real:[0,0]}:{...t,imag:Array.from(n,(()=>0)),real:n}:void 0===n?{...t,imag:e,real:Array.from(e,(()=>0))}:{...t,imag:e,real:n}})({...Jt,...s}),a=t(r,o);return n.add(a),a}static[Symbol.hasInstance](t){return null!==t&&"object"==typeof t&&Object.getPrototypeOf(t)===i.prototype||n.has(t)}})(Yn,Ae,new WeakSet),Xn=((t,e,n,i,s,r)=>{const o=16385,a=new Float32Array([1,1]),c=Math.PI/2,u={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},l={...u,oversample:"none"},h=(t,r,h,f,d)=>{if(1===r)return((t,e,s,r)=>{const h=new Float32Array(o),f=new Float32Array(o);for(let t=0;t<o;t+=1){const e=t/16384*c;h[t]=Math.cos(e),f[t]=Math.sin(e)}const d=n(t,{...u,gain:0}),p=i(t,{...l,curve:h}),_=i(t,{...l,curve:a}),m=n(t,{...u,gain:0}),g=i(t,{...l,curve:f});return{connectGraph(){e.connect(d),e.connect(void 0===_.inputs?_:_.inputs[0]),e.connect(m),_.connect(s),s.connect(void 0===p.inputs?p:p.inputs[0]),s.connect(void 0===g.inputs?g:g.inputs[0]),p.connect(d.gain),g.connect(m.gain),d.connect(r,0,0),m.connect(r,0,1)},disconnectGraph(){e.disconnect(d),e.disconnect(void 0===_.inputs?_:_.inputs[0]),e.disconnect(m),_.disconnect(s),s.disconnect(void 0===p.inputs?p:p.inputs[0]),s.disconnect(void 0===g.inputs?g:g.inputs[0]),p.disconnect(d.gain),g.disconnect(m.gain),d.disconnect(r,0,0),m.disconnect(r,0,1)}}})(t,h,f,d);if(2===r)return((t,s,r,h)=>{const f=new Float32Array(o),d=new Float32Array(o),p=new Float32Array(o),_=new Float32Array(o),m=Math.floor(8192.5);for(let t=0;t<o;t+=1)if(t>m){const e=(t-m)/(16384-m)*c;f[t]=Math.cos(e),d[t]=Math.sin(e),p[t]=0,_[t]=1}else{const e=t/(16384-m)*c;f[t]=1,d[t]=0,p[t]=Math.cos(e),_[t]=Math.sin(e)}const g=e(t,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),v=n(t,{...u,gain:0}),y=i(t,{...l,curve:f}),b=n(t,{...u,gain:0}),x=i(t,{...l,curve:d}),w=i(t,{...l,curve:a}),T=n(t,{...u,gain:0}),M=i(t,{...l,curve:p}),S=n(t,{...u,gain:0}),A=i(t,{...l,curve:_});return{connectGraph(){s.connect(g),s.connect(void 0===w.inputs?w:w.inputs[0]),g.connect(v,0),g.connect(b,0),g.connect(T,1),g.connect(S,1),w.connect(r),r.connect(void 0===y.inputs?y:y.inputs[0]),r.connect(void 0===x.inputs?x:x.inputs[0]),r.connect(void 0===M.inputs?M:M.inputs[0]),r.connect(void 0===A.inputs?A:A.inputs[0]),y.connect(v.gain),x.connect(b.gain),M.connect(T.gain),A.connect(S.gain),v.connect(h,0,0),T.connect(h,0,0),b.connect(h,0,1),S.connect(h,0,1)},disconnectGraph(){s.disconnect(g),s.disconnect(void 0===w.inputs?w:w.inputs[0]),g.disconnect(v,0),g.disconnect(b,0),g.disconnect(T,1),g.disconnect(S,1),w.disconnect(r),r.disconnect(void 0===y.inputs?y:y.inputs[0]),r.disconnect(void 0===x.inputs?x:x.inputs[0]),r.disconnect(void 0===M.inputs?M:M.inputs[0]),r.disconnect(void 0===A.inputs?A:A.inputs[0]),y.disconnect(v.gain),x.disconnect(b.gain),M.disconnect(T.gain),A.disconnect(S.gain),v.disconnect(h,0,0),T.disconnect(h,0,0),b.disconnect(h,0,1),S.disconnect(h,0,1)}}})(t,h,f,d);throw s()};return(e,{channelCount:i,channelCountMode:o,pan:a,...c})=>{if("max"===o)throw s();const u=t(e,{...c,channelCount:1,channelCountMode:o,numberOfInputs:2}),l=n(e,{...c,channelCount:i,channelCountMode:o,gain:1}),f=n(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:a});let{connectGraph:d,disconnectGraph:p}=h(e,i,l,f,u);Object.defineProperty(f.gain,"defaultValue",{get:()=>0}),Object.defineProperty(f.gain,"maxValue",{get:()=>1}),Object.defineProperty(f.gain,"minValue",{get:()=>-1});const _={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(t){l.channelCount!==t&&(m&&p(),({connectGraph:d,disconnectGraph:p}=h(e,t,l,f,u)),m&&d()),l.channelCount=t},get channelCountMode(){return l.channelCountMode},set channelCountMode(t){if("clamped-max"===t||"max"===t)throw s();l.channelCountMode=t},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(t){l.channelInterpretation=t},get context(){return l.context},get inputs(){return[l]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get pan(){return f.gain},addEventListener:(...t)=>l.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>l.dispatchEvent(t[0]),removeEventListener:(...t)=>l.removeEventListener(t[0],t[1],t[2])};let m=!1;return r(Bt(_,u),(()=>{d(),m=!0}),(()=>{p(),m=!1}))}})(un,Lt,Wt,Ln,Xt,an),Zn=((t,e)=>(n,i)=>{const s=i.channelCountMode;if("clamped-max"===s)throw e();if(void 0===n.createStereoPanner)return t(n,i);const r=n.createStereoPanner();return Nt(r,i),It(r,i,"pan"),Object.defineProperty(r,"channelCountMode",{get:()=>s,set:t=>{if(t!==s)throw e()}}),r})(Xn,Xt),$n=((t,e,n,i,s)=>()=>{const r=new WeakMap;return{render(o,a){const c=r.get(a);return void 0!==c?Promise.resolve(c):(async(o,a)=>{let c=n(o);const u=O(c,a);if(!u){const t={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,pan:c.pan.value};c=e(a,t)}return r.set(a,c),u?await t(a,o.pan,c.pan):await i(a,o.pan,c.pan),Z(c)?await s(o,a,c.inputs[0]):await s(o,a,c),c})(o,a)}}})(Ze,Zn,et,Qe,Me),Qn=((t,e,n,i,s,r)=>class extends t{constructor(t,o){const a=s(t),c={...Kt,...o},u=n(a,c),l=r(a);super(t,!1,u,l?i():null),this._pan=e(this,l,u.pan)}get pan(){return this._pan}})(Pe,Ke,Zn,$n,Ae,De),Jn=((t,e,n)=>()=>{const i=new WeakMap;return{render(s,r){const o=i.get(r);return void 0!==o?Promise.resolve(o):(async(s,r)=>{let o=e(s);if(!O(o,r)){const e={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,curve:o.curve,oversample:o.oversample};o=t(r,e)}return i.set(r,o),Z(o)?await n(s,r,o.inputs[0]):await n(s,r,o),o})(s,r)}}})(Ln,et,Me),Kn=((t,e,n,i,s,r,o)=>class extends t{constructor(t,e){const a=s(t),c={...ee,...e},u=n(a,c);super(t,!0,u,r(a)?i():null),this._isCurveNullified=!1,this._nativeWaveShaperNode=u,o(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(t){if(null===t)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(t.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=t}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(t){this._nativeWaveShaperNode.oversample=t}})(Pe,kt,Ln,Jn,Ae,De,rn),ti=(t=>null!==t&&t.isSecureContext)(xe),ei=(t=>(e,n,i)=>{Object.defineProperties(t,{currentFrame:{configurable:!0,get:()=>Math.round(e*n)},currentTime:{configurable:!0,get:()=>e}});try{return i()}finally{null!==t&&(delete t.currentFrame,delete t.currentTime)}})(xe),ni=new WeakMap,ii=((t,e)=>n=>{let i=t.get(n);if(void 0!==i)return i;if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");return i=new e(1,1,44100),t.set(n,i),i})(ni,Ce),si=ti?((t,e,n,i,s,r,o,a,c,u,l,h,f)=>{let d=0;return(p,m,g={credentials:"omit"})=>{const v=l.get(p);if(void 0!==v&&v.has(m))return Promise.resolve();const w=u.get(p);if(void 0!==w){const t=w.get(m);if(void 0!==t)return t}const T=r(p),M=void 0===T.audioWorklet?s(m).then((([t,e])=>{const[i,s]=y(t,e);return n(`${i};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${s}\n})})(window,'_AWGS')`)})).then((()=>{const t=f._AWGS.pop();if(void 0===t)throw new SyntaxError;i(T.currentTime,T.sampleRate,(()=>t(class{},void 0,((t,n)=>{if(""===t.trim())throw e();const i=_.get(T);if(void 0!==i){if(i.has(t))throw e();x(n),b(n.parameterDescriptors),i.set(t,n)}else x(n),b(n.parameterDescriptors),_.set(T,new Map([[t,n]]))}),T.sampleRate,void 0,void 0)))})):Promise.all([s(m),Promise.resolve(t(h,h))]).then((([[t,e],n])=>{const i=d+1;d=i;const[s,r]=y(t,e),u=new Blob([`${s};((AudioWorkletProcessor,registerProcessor)=>{${r}\n})(${n?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${n?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${n?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${i}',class extends AudioWorkletProcessor{process(){return !1}})`],{type:"application/javascript; charset=utf-8"}),l=URL.createObjectURL(u);return T.audioWorklet.addModule(l,g).then((()=>{if(a(T))return T;const t=o(T);return t.audioWorklet.addModule(l,g).then((()=>t))})).then((t=>{if(null===c)throw new SyntaxError;try{new c(t,`__sac${i}`)}catch{throw new SyntaxError}})).finally((()=>URL.revokeObjectURL(l)))}));return void 0===w?u.set(p,new Map([[m,M]])):w.set(m,M),M.then((()=>{const t=l.get(p);void 0===t?l.set(p,new Set([m])):t.add(m)})).finally((()=>{const t=u.get(p);void 0!==t&&t.delete(m)})),M}})(ve,Xt,(t=>e=>new Promise(((n,i)=>{if(null===t)return void i(new SyntaxError);const s=t.document.head;if(null===s)i(new SyntaxError);else{const r=t.document.createElement("script"),o=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(o),c=t.onerror,u=()=>{t.onerror=c,URL.revokeObjectURL(a)};t.onerror=(e,n,s,r,o)=>n===a||n===t.location.href&&1===s&&1===r?(u(),i(o),!1):null!==c?c(e,n,s,r,o):void 0,r.onerror=()=>{u(),i(new SyntaxError)},r.onload=()=>{u(),n()},r.src=a,r.type="module",s.appendChild(r)}})))(xe),ei,(async t=>{try{const e=await fetch(t);if(e.ok)return[await e.text(),e.url]}catch{}throw new DOMException("","AbortError")}),Ae,ii,De,Ie,new WeakMap,new WeakMap,((t,e)=>async()=>{if(null===t)return!0;if(null===e)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),i=new e(1,128,44100),s=URL.createObjectURL(n);let r=!1,o=!1;try{await i.audioWorklet.addModule(s);const e=new t(i,"a",{numberOfOutputs:0}),n=i.createOscillator();e.port.onmessage=()=>r=!0,e.onprocessorerror=()=>o=!0,n.connect(e),n.start(0),await i.startRendering()}catch{}finally{URL.revokeObjectURL(s)}return r&&!o})(Ie,Ce),xe):void 0,ri=((t,e)=>n=>t(n)||e(n))(qe,De),oi=((t,e,n,i,s,r,o,a,c,u,l)=>(n,i)=>{const h=o(n)?n:r(n);if(s.has(i)){const t=new DOMException("","DataCloneError");return Promise.reject(t)}try{s.add(i)}catch{}return e(c,(()=>c(h)))?h.decodeAudioData(i).then((n=>(wt(i).catch((()=>{})),e(a,(()=>a(n)))||l(n),t.add(n),n))):new Promise(((e,n)=>{const s=async()=>{try{await wt(i)}catch{}},r=t=>{n(t),s()};try{h.decodeAudioData(i,(n=>{"function"!=typeof n.copyFromChannel&&(u(n),N(n)),t.add(n),s().then((()=>e(n)))}),(t=>{r(null===t?new DOMException("","EncodingError"):t)}))}catch(t){r(t)}}))})(je,ve,0,0,new WeakSet,Ae,ri,R,Rt,We,Ge),ai=((t,e,n,i,s,r,o,a,c,u,l,h,f,d,p,_,m,g,v,y)=>class extends p{constructor(e,n){super(e,n),this._nativeContext=e,this._audioWorklet=void 0===t?void 0:{addModule:(e,n)=>t(this,e,n)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new s(this)}createBuffer(t,e,i){return new n({length:e,numberOfChannels:t,sampleRate:i})}createBufferSource(){return new i(this)}createChannelMerger(t=6){return new r(this,{numberOfInputs:t})}createChannelSplitter(t=6){return new o(this,{numberOfOutputs:t})}createConstantSource(){return new a(this)}createConvolver(){return new c(this)}createDelay(t=1){return new l(this,{maxDelayTime:t})}createDynamicsCompressor(){return new h(this)}createGain(){return new f(this)}createIIRFilter(t,e){return new d(this,{feedback:e,feedforward:t})}createOscillator(){return new _(this)}createPanner(){return new m(this)}createPeriodicWave(t,e,n={disableNormalization:!1}){return new g(this,{...n,imag:e,real:t})}createStereoPanner(){return new v(this)}createWaveShaper(){return new y(this)}decodeAudioData(t,e,n){return u(this._nativeContext,t).then((t=>("function"==typeof e&&e(t),t)),(t=>{throw"function"==typeof n&&n(t),t}))}})(si,ze,Ye,en,on,hn,dn,gn,bn,oi,wn,Sn,kn,Rn,Fn,Vn,Gn,Hn,Qn,Kn),ci=((t,e,n,i)=>class extends t{constructor(t,e){const s=n(t),r=((t,e)=>t.createMediaElementSource(e.mediaElement))(s,e);if(i(s))throw TypeError();super(t,!0,r,null),this._nativeMediaElementAudioSourceNode=r}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}})(Pe,0,Ae,De),ui=((t,e,n,i)=>class extends t{constructor(t,e){const s=n(t);if(i(s))throw new TypeError;const r=((t,e)=>{const n=t.createMediaStreamDestination();return Nt(n,e),1===n.numberOfOutputs&&Object.defineProperty(n,"numberOfOutputs",{get:()=>0}),n})(s,{...Ot,...e});super(t,!1,r,null),this._nativeMediaStreamAudioDestinationNode=r}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}})(Pe,0,Ae,De),li=((t,e,n,i)=>class extends t{constructor(t,e){const s=n(t),r=((t,{mediaStream:e})=>{const n=e.getAudioTracks();n.sort(((t,e)=>t.id<e.id?-1:t.id>e.id?1:0));const i=n.slice(0,1),s=t.createMediaStreamSource(new MediaStream(i));return Object.defineProperty(s,"mediaStream",{value:e}),s})(s,e);if(i(s))throw new TypeError;super(t,!0,r,null),this._nativeMediaStreamAudioSourceNode=r}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}})(Pe,0,Ae,De),hi=((t,e)=>(n,{mediaStreamTrack:i})=>{if("function"==typeof n.createMediaStreamTrackSource)return n.createMediaStreamTrackSource(i);const s=new MediaStream([i]),r=n.createMediaStreamSource(s);if("audio"!==i.kind)throw t();if(e(n))throw new TypeError;return r})(kt,De),fi=((t,e,n)=>class extends t{constructor(t,i){const s=n(t);super(t,!0,e(s,i),null)}})(Pe,hi,Ae),di=((t,e,n,i,s,r,o,a,c)=>class extends t{constructor(t={}){if(null===c)throw new Error("Missing the native AudioContext constructor.");let e;try{e=new c(t)}catch(t){if(12===t.code&&"sampleRate is not in range"===t.message)throw n();throw t}if(null===e)throw i();if(!(t=>void 0===t||"number"==typeof t||"string"==typeof t&&("balanced"===t||"interactive"===t||"playback"===t))(t.latencyHint))throw new TypeError(`The provided value '${t.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(void 0!==t.sampleRate&&e.sampleRate!==t.sampleRate)throw n();super(e,2);const{latencyHint:s}=t,{sampleRate:r}=e;if(this._baseLatency="number"==typeof e.baseLatency?e.baseLatency:"balanced"===s?512/r:"interactive"===s||void 0===s?256/r:"playback"===s?1024/r:128*Math.max(2,Math.min(128,Math.round(s*r/128)))/r,this._nativeAudioContext=e,"webkitAudioContext"===c.name?(this._nativeGainNode=e.createGain(),this._nativeOscillatorNode=e.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(e.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,"running"===e.state){this._state="suspended";const t=()=>{"suspended"===this._state&&(this._state=null),e.removeEventListener("statechange",t)};e.addEventListener("statechange",t)}}get baseLatency(){return this._baseLatency}get state(){return null!==this._state?this._state:this._nativeAudioContext.state}close(){return"closed"===this.state?this._nativeAudioContext.close().then((()=>{throw e()})):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then((()=>{null!==this._nativeGainNode&&null!==this._nativeOscillatorNode&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),U(this)})))}createMediaElementSource(t){return new s(this,{mediaElement:t})}createMediaStreamDestination(){return new r(this)}createMediaStreamSource(t){return new o(this,{mediaStream:t})}createMediaStreamTrackSource(t){return new a(this,{mediaStreamTrack:t})}resume(){return"suspended"===this._state?new Promise(((t,e)=>{const n=()=>{this._nativeAudioContext.removeEventListener("statechange",n),"running"===this._nativeAudioContext.state?t():this.resume().then(t,e)};this._nativeAudioContext.addEventListener("statechange",n)})):this._nativeAudioContext.resume().catch((t=>{if(void 0===t||15===t.code)throw e();throw t}))}suspend(){return this._nativeAudioContext.suspend().catch((t=>{if(void 0===t)throw e();throw t}))}})(ai,kt,Xt,te,ci,ui,li,fi,Re),pi=(t=>e=>{const n=t.get(e);if(void 0===n)throw new Error("The context has no set of AudioWorkletNodes.");return n})(Nn),_i=(t=>(e,n)=>{t(e).add(n)})(pi),mi=(t=>(e,n,i=0,s=0)=>{const r=e[i];if(void 0===r)throw t();return at(n)?r.connect(n,0,s):r.connect(n,0)})(q),gi=(t=>(e,n)=>{t(e).delete(n)})(pi),vi=(t=>(e,n,i,s=0)=>void 0===n?e.forEach((t=>t.disconnect())):"number"==typeof n?Mt(t,e,n).disconnect():at(n)?void 0===i?e.forEach((t=>t.disconnect(n))):void 0===s?Mt(t,e,i).disconnect(n,0):Mt(t,e,i).disconnect(n,0,s):void 0===i?e.forEach((t=>t.disconnect(n))):Mt(t,e,i).disconnect(n,0))(q),yi=new WeakMap,bi=((t,e)=>n=>e(t,n))(yi,w),xi=((t,e,n,i,s,r,o,a,c,u,l,h,f)=>(d,p,_,g)=>{if(0===g.numberOfInputs&&0===g.numberOfOutputs)throw c();const v=Array.isArray(g.outputChannelCount)?g.outputChannelCount:Array.from(g.outputChannelCount);if(v.some((t=>t<1)))throw c();if(v.length!==g.numberOfOutputs)throw e();if("explicit"!==g.channelCountMode)throw c();const y=g.channelCount*g.numberOfInputs,b=v.reduce(((t,e)=>t+e),0),x=void 0===_.parameterDescriptors?0:_.parameterDescriptors.length;if(y+x>6||b>6)throw c();const w=new MessageChannel,T=[],M=[];for(let t=0;t<g.numberOfInputs;t+=1)T.push(o(d,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})),M.push(s(d,{channelCount:g.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:g.channelCount}));const S=[];if(void 0!==_.parameterDescriptors)for(const{defaultValue:t,maxValue:e,minValue:n,name:i}of _.parameterDescriptors){const s=r(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:void 0!==g.parameterData[i]?g.parameterData[i]:void 0===t?0:t});Object.defineProperties(s.offset,{defaultValue:{get:()=>void 0===t?0:t},maxValue:{get:()=>void 0===e?P:e},minValue:{get:()=>void 0===n?I:n}}),S.push(s)}const A=i(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,y+x)}),k=zt(p,d.sampleRate),C=a(d,k,y+x,Math.max(1,b)),D=s(d,{channelCount:Math.max(1,b),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,b)}),E=[];for(let t=0;t<g.numberOfOutputs;t+=1)E.push(i(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:v[t]}));for(let t=0;t<g.numberOfInputs;t+=1){T[t].connect(M[t]);for(let e=0;e<g.channelCount;e+=1)M[t].connect(A,e,t*g.channelCount+e)}const O=new ht(void 0===_.parameterDescriptors?[]:_.parameterDescriptors.map((({name:t},e)=>{const n=S[e];return n.connect(A,0,y+e),n.start(0),[t,n.offset]})));A.connect(C);let R=g.channelInterpretation,q=null;const N=0===g.numberOfOutputs?[C]:E,F={get bufferSize(){return k},get channelCount(){return g.channelCount},set channelCount(t){throw n()},get channelCountMode(){return g.channelCountMode},set channelCountMode(t){throw n()},get channelInterpretation(){return R},set channelInterpretation(t){for(const e of T)e.channelInterpretation=t;R=t},get context(){return C.context},get inputs(){return T},get numberOfInputs(){return g.numberOfInputs},get numberOfOutputs(){return g.numberOfOutputs},get onprocessorerror(){return q},set onprocessorerror(t){"function"==typeof q&&F.removeEventListener("processorerror",q),q="function"==typeof t?t:null,"function"==typeof q&&F.addEventListener("processorerror",q)},get parameters(){return O},get port(){return w.port2},addEventListener:(...t)=>C.addEventListener(t[0],t[1],t[2]),connect:t.bind(null,N),disconnect:u.bind(null,N),dispatchEvent:(...t)=>C.dispatchEvent(t[0]),removeEventListener:(...t)=>C.removeEventListener(t[0],t[1],t[2])},V=new Map;var z,j;w.port1.addEventListener=(z=w.port1.addEventListener,(...t)=>{if("message"===t[0]){const e="function"==typeof t[1]?t[1]:"object"==typeof t[1]&&null!==t[1]&&"function"==typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==e){const n=V.get(t[1]);void 0!==n?t[1]=n:(t[1]=t=>{l(d.currentTime,d.sampleRate,(()=>e(t)))},V.set(e,t[1]))}}return z.call(w.port1,t[0],t[1],t[2])}),w.port1.removeEventListener=(j=w.port1.removeEventListener,(...t)=>{if("message"===t[0]){const e=V.get(t[1]);void 0!==e&&(V.delete(t[1]),t[1]=e)}return j.call(w.port1,t[0],t[1],t[2])});let L=null;Object.defineProperty(w.port1,"onmessage",{get:()=>L,set:t=>{"function"==typeof L&&w.port1.removeEventListener("message",L),L="function"==typeof t?t:null,"function"==typeof L&&(w.port1.addEventListener("message",L),w.port1.start())}}),_.prototype.port=w.port1;let B=null;const U=((t,e,n,i)=>{let s=m.get(t);void 0===s&&(s=new WeakMap,m.set(t,s));const r=(async(t,e)=>{const n=await(t=>new Promise(((e,n)=>{const{port1:i,port2:s}=new MessageChannel;i.onmessage=({data:t})=>{i.close(),s.close(),e(t)},i.onmessageerror=({data:t})=>{i.close(),s.close(),n(t)},s.postMessage(t)})))(e);return new t(n)})(n,i);return s.set(e,r),r})(d,F,_,g);U.then((t=>B=t));const W=_t(g.numberOfInputs,g.channelCount),G=_t(g.numberOfOutputs,v),Y=void 0===_.parameterDescriptors?[]:_.parameterDescriptors.reduce(((t,{name:e})=>({...t,[e]:new Float32Array(128)})),{});let H=!0;const X=()=>{g.numberOfOutputs>0&&C.disconnect(D);for(let t=0,e=0;t<g.numberOfOutputs;t+=1){const n=E[t];for(let i=0;i<v[t];i+=1)D.disconnect(n,e+i,i);e+=v[t]}},Z=new Map;C.onaudioprocess=({inputBuffer:t,outputBuffer:e})=>{if(null!==B){const n=h(F);for(let i=0;i<k;i+=128){for(let e=0;e<g.numberOfInputs;e+=1)for(let n=0;n<g.channelCount;n+=1)dt(t,W[e],n,n,i);void 0!==_.parameterDescriptors&&_.parameterDescriptors.forEach((({name:e},n)=>{dt(t,Y,e,y+n,i)}));for(let t=0;t<g.numberOfInputs;t+=1)for(let e=0;e<v[t];e+=1)0===G[t][e].byteLength&&(G[t][e]=new Float32Array(128));try{const t=W.map(((t,e)=>{if(n[e].size>0)return Z.set(e,k/128),t;const i=Z.get(e);return void 0===i?[]:(t.every((t=>t.every((t=>0===t))))&&(1===i?Z.delete(e):Z.set(e,i-1)),t)})),s=l(d.currentTime+i/d.sampleRate,d.sampleRate,(()=>B.process(t,G,Y)));H=s;for(let t=0,n=0;t<g.numberOfOutputs;t+=1){for(let s=0;s<v[t];s+=1)pt(e,G[t],s,n+s,i);n+=v[t]}}catch(t){H=!1,F.dispatchEvent(new ErrorEvent("processorerror",{colno:t.colno,filename:t.filename,lineno:t.lineno,message:t.message}))}if(!H){for(let t=0;t<g.numberOfInputs;t+=1){T[t].disconnect(M[t]);for(let e=0;e<g.channelCount;e+=1)M[i].disconnect(A,e,t*g.channelCount+e)}if(void 0!==_.parameterDescriptors){const t=_.parameterDescriptors.length;for(let e=0;e<t;e+=1){const t=S[e];t.disconnect(A,0,y+e),t.stop()}}A.disconnect(C),C.onaudioprocess=null,$?X():K();break}}}};let $=!1;const Q=o(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),J=()=>C.connect(Q).connect(d.destination),K=()=>{C.disconnect(Q),Q.disconnect()};return J(),f(F,(()=>{if(H){K(),g.numberOfOutputs>0&&C.connect(D);for(let t=0,e=0;t<g.numberOfOutputs;t+=1){const n=E[t];for(let i=0;i<v[t];i+=1)D.connect(n,e+i,i);e+=v[t]}}$=!0}),(()=>{H&&(J(),X()),$=!1}))})(mi,q,kt,un,Lt,_n,Wt,Ht,Xt,vi,ei,bi,an),wi=((t,e,n,i,s)=>(r,o,a,c,u,l)=>{if(null!==a)try{const e=new a(r,c,l),i=new Map;let o=null;if(Object.defineProperties(e,{channelCount:{get:()=>l.channelCount,set:()=>{throw t()}},channelCountMode:{get:()=>"explicit",set:()=>{throw t()}},onprocessorerror:{get:()=>o,set:t=>{"function"==typeof o&&e.removeEventListener("processorerror",o),o="function"==typeof t?t:null,"function"==typeof o&&e.addEventListener("processorerror",o)}}}),e.addEventListener=(f=e.addEventListener,(...t)=>{if("processorerror"===t[0]){const e="function"==typeof t[1]?t[1]:"object"==typeof t[1]&&null!==t[1]&&"function"==typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==e){const n=i.get(t[1]);void 0!==n?t[1]=n:(t[1]=n=>{"error"===n.type?(Object.defineProperties(n,{type:{value:"processorerror"}}),e(n)):e(new ErrorEvent(t[0],{...n}))},i.set(e,t[1]))}}return f.call(e,"error",t[1],t[2]),f.call(e,...t)}),e.removeEventListener=(h=e.removeEventListener,(...t)=>{if("processorerror"===t[0]){const e=i.get(t[1]);void 0!==e&&(i.delete(t[1]),t[1]=e)}return h.call(e,"error",t[1],t[2]),h.call(e,t[0],t[1],t[2])}),0!==l.numberOfOutputs){const t=n(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return e.connect(t).connect(r.destination),s(e,(()=>t.disconnect()),(()=>t.connect(r.destination)))}return e}catch(t){if(11===t.code)throw i();throw t}var h,f;if(void 0===u)throw i();return(t=>{const{port1:e}=new MessageChannel;try{e.postMessage(t)}finally{e.close()}})(l),e(r,o,u,l)})(kt,xi,Wt,Xt,an),Ti=((t,e,n,i,s,r,o,a,c,u,l,h,f,d,p,_)=>(m,g,v)=>{const y=new WeakMap;let b=null;return{render(x,w){a(w,x);const T=y.get(w);return void 0!==T?Promise.resolve(T):(async(a,x)=>{let w=l(a),T=null;const M=O(w,x),S=Array.isArray(g.outputChannelCount)?g.outputChannelCount:Array.from(g.outputChannelCount);if(null===h){const t=S.reduce(((t,e)=>t+e),0),n=s(x,{channelCount:Math.max(1,t),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,t)}),r=[];for(let t=0;t<a.numberOfOutputs;t+=1)r.push(i(x,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:S[t]}));const u=o(x,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1});u.connect=e.bind(null,r),u.disconnect=c.bind(null,r),T=[n,r,u]}else M||(w=new h(x,m));if(y.set(x,null===T?w:T[2]),null!==T){if(null===b){if(void 0===v)throw new Error("Missing the processor constructor.");if(null===f)throw new Error("Missing the native OfflineAudioContext constructor.");const t=a.channelCount*a.numberOfInputs,e=void 0===v.parameterDescriptors?0:v.parameterDescriptors.length,n=t+e,c=async()=>{const c=new f(n,128*Math.ceil(a.context.length/128),x.sampleRate),u=[],l=[];for(let t=0;t<g.numberOfInputs;t+=1)u.push(o(c,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})),l.push(s(c,{channelCount:g.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:g.channelCount}));const h=await Promise.all(Array.from(a.parameters.values()).map((async t=>{const e=r(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:t.value});return await d(c,t,e.offset),e}))),m=i(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,t+e)});for(let t=0;t<g.numberOfInputs;t+=1){u[t].connect(l[t]);for(let e=0;e<g.channelCount;e+=1)l[t].connect(m,e,t*g.channelCount+e)}for(const[e,n]of h.entries())n.connect(m,0,t+e),n.start(0);return m.connect(c.destination),await Promise.all(u.map((t=>p(a,c,t)))),_(c)};b=mt(a,0===n?null:await c(),x,g,S,v,u)}const t=await b,e=n(x,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[c,l,h]=T;null!==t&&(e.buffer=t,e.start(0)),e.connect(c);for(let t=0,e=0;t<a.numberOfOutputs;t+=1){const n=l[t];for(let i=0;i<S[t];i+=1)c.connect(n,e+i,i);e+=S[t]}return h}if(M)for(const[e,n]of a.parameters.entries())await t(x,n,w.parameters.get(e));else for(const[t,e]of a.parameters.entries())await d(x,e,w.parameters.get(t));return await p(a,x,w),w})(x,w)}}})(Ze,mi,$e,un,Lt,_n,Wt,gi,vi,ei,et,Ie,Ce,Qe,Me,Dn),Mi=(t=>e=>t.get(e))(ni),Si=(t=>(e,n)=>{t.set(e,n)})(yi),Ai=ti?((t,e,n,i,s,r,o,a,c,u,l,h,f,d)=>class extends e{constructor(e,l,f){var d;const p=a(e),m=c(p),g=(t=>({...t,outputChannelCount:void 0!==t.outputChannelCount?t.outputChannelCount:1===t.numberOfInputs&&1===t.numberOfOutputs?[t.channelCount]:Array.from({length:t.numberOfOutputs},(()=>1))}))({...ft,...f});(t=>{const{port1:e,port2:n}=new MessageChannel;try{e.postMessage(t)}finally{e.close(),n.close()}})(g);const v=_.get(p),y=null==v?void 0:v.get(l),b=m||"closed"!==p.state?p:null!==(d=o(p))&&void 0!==d?d:p,x=s(b,m?null:e.baseLatency,u,l,y,g);super(e,!0,x,m?i(l,g,y):null);const w=[];x.parameters.forEach(((t,e)=>{const i=n(this,m,t);w.push([e,i])})),this._nativeAudioWorkletNode=x,this._onprocessorerror=null,this._parameters=new ht(w),m&&t(p,this);const{activeInputs:T}=r(this);h(x,T)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(t){const e="function"==typeof t?d(this,t):null;this._nativeAudioWorkletNode.onprocessorerror=e;const n=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=null!==n&&n===e?t:n}get parameters(){return null===this._parameters?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}})(_i,Pe,Ke,Ti,wi,j,Mi,Ae,De,Ie,0,Si,0,fe):void 0,ki=((t,e)=>(n,i,s)=>{if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(n,i,s)}catch(e){if("SyntaxError"===e.name)throw t();throw e}})(Xt,Ce),Ci=((t,e,n,i,s,r,o,a)=>(c,u)=>n(c).render(c,u).then((()=>Promise.all(Array.from(i(u)).map((t=>n(t).render(t,u)))))).then((()=>s(u))).then((n=>("function"!=typeof n.copyFromChannel?(o(n),N(n)):e(r,(()=>r(n)))||a(n),t.add(n),n))))(je,ve,Te,pi,Dn,R,We,Ge),Di=((t,e,n,i,s)=>class extends t{constructor(t,n,s){let r;if("number"==typeof t&&void 0!==n&&void 0!==s)r={length:n,numberOfChannels:t,sampleRate:s};else{if("object"!=typeof t)throw new Error("The given parameters are not valid.");r=t}const{length:o,numberOfChannels:a,sampleRate:c}={...Zt,...r},u=i(a,o,c);e(Rt,(()=>Rt(u)))||u.addEventListener("statechange",(()=>{let t=0;const e=n=>{"running"===this._state&&(t>0?(u.removeEventListener("statechange",e),n.stopImmediatePropagation(),this._waitForThePromiseToSettle(n)):t+=1)};return e})()),super(u,a),this._length=o,this._nativeOfflineAudioContext=u,this._state=null}get length(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}get state(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}startRendering(){return"running"===this._state?Promise.reject(n()):(this._state="running",s(this.destination,this._nativeOfflineAudioContext).finally((()=>{this._state=null,U(this)})))}_waitForThePromiseToSettle(t){null===this._state?this._nativeOfflineAudioContext.dispatchEvent(t):setTimeout((()=>this._waitForThePromiseToSettle(t)))}})(ai,ve,kt,ki,Ci),Ei=((t,e)=>n=>{const i=t.get(n);return e(i)||e(n)})(f,qe),Oi=((t,e)=>n=>t.has(n)||e(n))(u,Ne),Ri=((t,e)=>n=>t.has(n)||e(n))(h,Fe),qi=((t,e)=>n=>{const i=t.get(n);return e(i)||e(n)})(f,De),Ni=()=>(async(t,e,n,i,s,r,o,a,c,u,l,h,f,d,p,_)=>!!(t(e,e)&&t(n,n)&&t(s,s)&&t(r,r)&&t(a,a)&&t(c,c)&&t(u,u)&&t(l,l)&&t(h,h)&&t(f,f)&&t(d,d))&&(await Promise.all([t(i,i),t(o,o),t(p,p),t(_,_)])).every((t=>t)))(ve,(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100).createBuffer(1,1,44100);if(void 0===e.copyToChannel)return!0;const n=new Float32Array(2);try{e.copyFromChannel(n,0,0)}catch{return!1}return!0})(Ce),(t=>()=>{if(null===t)return!1;if(void 0!==t.prototype&&void 0!==t.prototype.close)return!0;const e=new t,n=void 0!==e.close;try{e.close()}catch{}return n})(Re),(t=>()=>{if(null===t)return Promise.resolve(!1);const e=new t(1,1,44100);return new Promise((t=>{let n=!0;const i=i=>{n&&(n=!1,e.startRendering(),t(i instanceof TypeError))};let s;try{s=e.decodeAudioData(null,(()=>{}),i)}catch(t){i(t)}void 0!==s&&s.catch(i)}))})(Ce),(t=>()=>{if(null===t)return!1;let e;try{e=new t({latencyHint:"balanced"})}catch{return!1}return e.close(),!0})(Re),(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100).createGain(),n=e.connect(e)===e;return e.disconnect(e),n})(Ce),((t,e)=>async()=>{if(null===t)return!0;if(null===e)return!1;const n=new Blob(['let c,p;class A extends AudioWorkletProcessor{constructor(){super();this.port.onmessage=(e)=>{p=e.data;p.onmessage=()=>{p.postMessage(c);p.close()};this.port.postMessage(0)}}process(){c=1}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),i=new MessageChannel,s=new e(1,128,44100),r=URL.createObjectURL(n);let o=!1;try{await s.audioWorklet.addModule(r);const e=new t(s,"a",{numberOfOutputs:0}),n=s.createOscillator();await new Promise((t=>{e.port.onmessage=()=>t(),e.port.postMessage(i.port2,[i.port2])})),e.port.onmessage=()=>o=!0,n.connect(e),n.start(0),await s.startRendering(),o=await new Promise((t=>{i.port1.onmessage=({data:e})=>t(1===e),i.port1.postMessage(0)}))}catch{}finally{i.port1.close(),URL.revokeObjectURL(r)}return o})(Ie,Ce),(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100).createChannelMerger();if("max"===e.channelCountMode)return!0;try{e.channelCount=2}catch{return!0}return!1})(Ce),(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100);return void 0===e.createConstantSource||e.createConstantSource().offset.maxValue!==Number.POSITIVE_INFINITY})(Ce),(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100),n=e.createConvolver();n.buffer=e.createBuffer(1,1,e.sampleRate);try{n.buffer=e.createBuffer(1,1,e.sampleRate)}catch{return!1}return!0})(Ce),(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100).createConvolver();try{e.channelCount=1}catch{return!1}return!0})(Ce),ue,(t=>()=>null!==t&&t.hasOwnProperty("isSecureContext"))(xe),(t=>()=>{if(null===t)return!1;const e=new t;try{return e.createMediaStreamSource(new MediaStream),!1}catch(t){return!0}finally{e.close()}})(Re),(t=>()=>{if(null===t)return Promise.resolve(!1);const e=new t(1,1,44100);if(void 0===e.createStereoPanner)return Promise.resolve(!0);if(void 0===e.createConstantSource)return Promise.resolve(!0);const n=e.createConstantSource(),i=e.createStereoPanner();return n.channelCount=1,n.offset.value=1,i.channelCount=1,n.start(),n.connect(i).connect(e.destination),e.startRendering().then((t=>1!==t.getChannelData(0)[0]))})(Ce),le);function Fi(t,e){if(!t)throw new Error(e)}function Ii(t,e,n=1/0){if(!(e<=t&&t<=n))throw new RangeError(`Value must be within [${e}, ${n}], got: ${t}`)}function Pi(t){t.isOffline||"running"===t.state||Li('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let Vi=console;function zi(t){Vi=t}function ji(...t){Vi.log(...t)}function Li(...t){Vi.warn(...t)}function Bi(t){return void 0===t}function Ui(t){return!Bi(t)}function Wi(t){return"function"==typeof t}function Gi(t){return"number"==typeof t}function Yi(t){return"[object Object]"===Object.prototype.toString.call(t)&&t.constructor===Object}function Hi(t){return"boolean"==typeof t}function Xi(t){return Array.isArray(t)}function Zi(t){return"string"==typeof t}function $i(t){return Zi(t)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(t)}const Qi="object"==typeof self?self:null,Ji=Qi&&(Qi.hasOwnProperty("AudioContext")||Qi.hasOwnProperty("webkitAudioContext"));function Ki(t,e,n,i){var s,r=arguments.length,o=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,n,o):s(e,n))||o);return r>3&&o&&Object.defineProperty(e,n,o),o}function ts(t,e,n,i){return new(n||(n=Promise))((function(s,r){function o(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))}Object.create,Object.create;class es{constructor(t,e,n){this._callback=t,this._type=e,this._updateInterval=n,this._createClock()}_createWorker(){const t=new Blob([`\n\t\t\t// the initial timeout time\n\t\t\tlet timeoutTime =  ${(1e3*this._updateInterval).toFixed(1)};\n\t\t\t// onmessage callback\n\t\t\tself.onmessage = function(msg){\n\t\t\t\ttimeoutTime = parseInt(msg.data);\n\t\t\t};\n\t\t\t// the tick function which posts a message\n\t\t\t// and schedules a new tick\n\t\t\tfunction tick(){\n\t\t\t\tsetTimeout(tick, timeoutTime);\n\t\t\t\tself.postMessage('tick');\n\t\t\t}\n\t\t\t// call tick initially\n\t\t\ttick();\n\t\t\t`],{type:"text/javascript"}),e=URL.createObjectURL(t),n=new Worker(e);n.onmessage=this._callback.bind(this),this._worker=n}_createTimeout(){this._timeout=setTimeout((()=>{this._createTimeout(),this._callback()}),1e3*this._updateInterval)}_createClock(){if("worker"===this._type)try{this._createWorker()}catch(t){this._type="timeout",this._createClock()}else"timeout"===this._type&&this._createTimeout()}_disposeClock(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(t){this._updateInterval=Math.max(t,128/44100),"worker"===this._type&&this._worker.postMessage(Math.max(1e3*t,1))}get type(){return this._type}set type(t){this._disposeClock(),this._type=t,this._createClock()}dispose(){this._disposeClock()}}function ns(t){return Ri(t)}function is(t){return Oi(t)}function ss(t){return qi(t)}function rs(t){return Ei(t)}function os(t){return t instanceof AudioBuffer}function as(t,e){return"value"===t||ns(e)||is(e)||os(e)}function cs(t,...e){if(!e.length)return t;const n=e.shift();if(Yi(t)&&Yi(n))for(const e in n)as(e,n[e])?t[e]=n[e]:Yi(n[e])?(t[e]||Object.assign(t,{[e]:{}}),cs(t[e],n[e])):Object.assign(t,{[e]:n[e]});return cs(t,...e)}function us(t,e,n=[],i){const s={},r=Array.from(e);if(Yi(r[0])&&i&&!Reflect.has(r[0],i)&&(Object.keys(r[0]).some((e=>Reflect.has(t,e)))||(cs(s,{[i]:r[0]}),n.splice(n.indexOf(i),1),r.shift())),1===r.length&&Yi(r[0]))cs(s,r[0]);else for(let t=0;t<n.length;t++)Ui(r[t])&&(s[n[t]]=r[t]);return cs(t,s)}function ls(t,e){return Bi(t)?e:t}function hs(t,e){return e.forEach((e=>{Reflect.has(t,e)&&delete t[e]})),t}class fs{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...t){(this.debug||Qi&&this.toString()===Qi.TONE_DEBUG_CLASS)&&ji(this,...t)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}fs.version=r;const ds=1e-6;function ps(t,e){return t>e+ds}function _s(t,e){return ps(t,e)||gs(t,e)}function ms(t,e){return t+ds<e}function gs(t,e){return Math.abs(t-e)<ds}function vs(t,e,n){return Math.max(Math.min(t,n),e)}class ys extends fs{constructor(){super(),this.name="Timeline",this._timeline=[];const t=us(ys.getDefaults(),arguments,["memory"]);this.memory=t.memory,this.increasing=t.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(t){if(Fi(Reflect.has(t,"time"),"Timeline: events must have a time attribute"),t.time=t.time.valueOf(),this.increasing&&this.length){const e=this._timeline[this.length-1];Fi(_s(t.time,e.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(t)}else{const e=this._search(t.time);this._timeline.splice(e+1,0,t)}if(this.length>this.memory){const t=this.length-this.memory;this._timeline.splice(0,t)}return this}remove(t){const e=this._timeline.indexOf(t);return-1!==e&&this._timeline.splice(e,1),this}get(t,e="time"){const n=this._search(t,e);return-1!==n?this._timeline[n]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(t,e="time"){const n=this._search(t,e);return n+1<this._timeline.length?this._timeline[n+1]:null}getBefore(t){const e=this._timeline.length;if(e>0&&this._timeline[e-1].time<t)return this._timeline[e-1];const n=this._search(t);return n-1>=0?this._timeline[n-1]:null}cancel(t){if(this._timeline.length>1){let e=this._search(t);if(e>=0)if(gs(this._timeline[e].time,t)){for(let n=e;n>=0&&gs(this._timeline[n].time,t);n--)e=n;this._timeline=this._timeline.slice(0,e)}else this._timeline=this._timeline.slice(0,e+1);else this._timeline=[]}else 1===this._timeline.length&&_s(this._timeline[0].time,t)&&(this._timeline=[]);return this}cancelBefore(t){const e=this._search(t);return e>=0&&(this._timeline=this._timeline.slice(e+1)),this}previousEvent(t){const e=this._timeline.indexOf(t);return e>0?this._timeline[e-1]:null}_search(t,e="time"){if(0===this._timeline.length)return-1;let n=0;const i=this._timeline.length;let s=i;if(i>0&&this._timeline[i-1][e]<=t)return i-1;for(;n<s;){let i=Math.floor(n+(s-n)/2);const r=this._timeline[i],o=this._timeline[i+1];if(gs(r[e],t)){for(let n=i;n<this._timeline.length&&gs(this._timeline[n][e],t);n++)i=n;return i}if(ms(r[e],t)&&ps(o[e],t))return i;ps(r[e],t)?s=i:n=i+1}return-1}_iterate(t,e=0,n=this._timeline.length-1){this._timeline.slice(e,n+1).forEach(t)}forEach(t){return this._iterate(t),this}forEachBefore(t,e){const n=this._search(t);return-1!==n&&this._iterate(e,0,n),this}forEachAfter(t,e){const n=this._search(t);return this._iterate(e,n+1),this}forEachBetween(t,e,n){let i=this._search(t),s=this._search(e);return-1!==i&&-1!==s?(this._timeline[i].time!==t&&(i+=1),this._timeline[s].time===e&&(s-=1),this._iterate(n,i,s)):-1===i&&this._iterate(n,0,s),this}forEachFrom(t,e){let n=this._search(t);for(;n>=0&&this._timeline[n].time>=t;)n--;return this._iterate(e,n+1),this}forEachAtTime(t,e){const n=this._search(t);if(-1!==n&&gs(this._timeline[n].time,t)){let i=n;for(let e=n;e>=0&&gs(this._timeline[e].time,t);e--)i=e;this._iterate((t=>{e(t)}),i,n)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const bs=[];function xs(t){bs.push(t)}const ws=[];function Ts(t){ws.push(t)}class Ms extends fs{constructor(){super(...arguments),this.name="Emitter"}on(t,e){return t.split(/\W+/).forEach((t=>{Bi(this._events)&&(this._events={}),this._events.hasOwnProperty(t)||(this._events[t]=[]),this._events[t].push(e)})),this}once(t,e){const n=(...i)=>{e(...i),this.off(t,n)};return this.on(t,n),this}off(t,e){return t.split(/\W+/).forEach((n=>{if(Bi(this._events)&&(this._events={}),this._events.hasOwnProperty(t))if(Bi(e))this._events[t]=[];else{const n=this._events[t];for(let t=n.length-1;t>=0;t--)n[t]===e&&n.splice(t,1)}})),this}emit(t,...e){if(this._events&&this._events.hasOwnProperty(t)){const n=this._events[t].slice(0);for(let t=0,i=n.length;t<i;t++)n[t].apply(this,e)}return this}static mixin(t){["on","once","off","emit"].forEach((e=>{const n=Object.getOwnPropertyDescriptor(Ms.prototype,e);Object.defineProperty(t.prototype,e,n)}))}dispose(){return super.dispose(),this._events=void 0,this}}class Ss extends Ms{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}class As extends Ss{constructor(){super(),this.name="Context",this._constants=new Map,this._timeouts=new ys,this._timeoutIds=0,this._initialized=!1,this.isOffline=!1,this._workletModules=new Map;const t=us(As.getDefaults(),arguments,["context"]);t.context?this._context=t.context:this._context=function(t){return new di(t)}({latencyHint:t.latencyHint}),this._ticker=new es(this.emit.bind(this,"tick"),t.clockSource,t.updateInterval),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this._setLatencyHint(t.latencyHint),this.lookAhead=t.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){var t;return this._initialized||(t=this,bs.forEach((e=>e(t))),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(t,e,n){return this._context.createBuffer(t,e,n)}createChannelMerger(t){return this._context.createChannelMerger(t)}createChannelSplitter(t){return this._context.createChannelSplitter(t)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(t){return this._context.createDelay(t)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(t,e){return this._context.createIIRFilter(t,e)}createPanner(){return this._context.createPanner()}createPeriodicWave(t,e,n){return this._context.createPeriodicWave(t,e,n)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(t){return Fi(rs(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(t)}createMediaElementSource(t){return Fi(rs(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(t)}createMediaStreamDestination(){return Fi(rs(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}decodeAudioData(t){return this._context.decodeAudioData(t)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(t){Fi(!this._initialized,"The listener cannot be set after initialization."),this._listener=t}get transport(){return this.initialize(),this._transport}set transport(t){Fi(!this._initialized,"The transport cannot be set after initialization."),this._transport=t}get draw(){return this.initialize(),this._draw}set draw(t){Fi(!this._initialized,"Draw cannot be set after initialization."),this._draw=t}get destination(){return this.initialize(),this._destination}set destination(t){Fi(!this._initialized,"The destination cannot be set after initialization."),this._destination=t}createAudioWorkletNode(t,e){return function(t,e,n){return Fi(Ui(Ai),"This node only works in a secure context (https or localhost)"),new Ai(t,e,n)}(this.rawContext,t,e)}addAudioWorkletModule(t,e){return ts(this,void 0,void 0,(function*(){Fi(Ui(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletModules.has(e)||this._workletModules.set(e,this.rawContext.audioWorklet.addModule(t)),yield this._workletModules.get(e)}))}workletsAreReady(){return ts(this,void 0,void 0,(function*(){const t=[];this._workletModules.forEach((e=>t.push(e))),yield Promise.all(t)}))}get updateInterval(){return this._ticker.updateInterval}set updateInterval(t){this._ticker.updateInterval=t}get clockSource(){return this._ticker.type}set clockSource(t){this._ticker.type=t}get latencyHint(){return this._latencyHint}_setLatencyHint(t){let e=0;if(this._latencyHint=t,Zi(t))switch(t){case"interactive":e=.1;break;case"playback":e=.5;break;case"balanced":e=.25}this.lookAhead=e,this.updateInterval=e/2}get rawContext(){return this._context}now(){return this._context.currentTime+this.lookAhead}immediate(){return this._context.currentTime}resume(){return rs(this._context)?this._context.resume():Promise.resolve()}close(){return ts(this,void 0,void 0,(function*(){var t;rs(this._context)&&(yield this._context.close()),this._initialized&&(t=this,ws.forEach((e=>e(t))))}))}getConstant(t){if(this._constants.has(t))return this._constants.get(t);{const e=this._context.createBuffer(1,128,this._context.sampleRate),n=e.getChannelData(0);for(let e=0;e<n.length;e++)n[e]=t;const i=this._context.createBufferSource();return i.channelCount=1,i.channelCountMode="explicit",i.buffer=e,i.loop=!0,i.start(0),this._constants.set(t,i),i}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map((t=>this._constants[t].disconnect())),this}_timeoutLoop(){const t=this.now();let e=this._timeouts.peek();for(;this._timeouts.length&&e&&e.time<=t;)e.callback(),this._timeouts.shift(),e=this._timeouts.peek()}setTimeout(t,e){this._timeoutIds++;const n=this.now();return this._timeouts.add({callback:t,id:this._timeoutIds,time:n+e}),this._timeoutIds}clearTimeout(t){return this._timeouts.forEach((e=>{e.id===t&&this._timeouts.remove(e)})),this}clearInterval(t){return this.clearTimeout(t)}setInterval(t,e){const n=++this._timeoutIds,i=()=>{const s=this.now();this._timeouts.add({callback:()=>{t(),i()},id:n,time:s+e})};return i(),n}}function ks(t,e){Xi(e)?e.forEach((e=>ks(t,e))):Object.defineProperty(t,e,{enumerable:!0,writable:!1})}function Cs(t,e){Xi(e)?e.forEach((e=>Cs(t,e))):Object.defineProperty(t,e,{writable:!0})}const Ds=()=>{};class Es extends fs{constructor(){super(),this.name="ToneAudioBuffer",this.onload=Ds;const t=us(Es.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=t.reverse,this.onload=t.onload,t.url&&os(t.url)||t.url instanceof Es?this.set(t.url):Zi(t.url)&&this.load(t.url).catch(t.onerror)}static getDefaults(){return{onerror:Ds,onload:Ds,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:Ns().sampleRate}set(t){return t instanceof Es?t.loaded?this._buffer=t.get():t.onload=()=>{this.set(t),this.onload(this)}:this._buffer=t,this._reversed&&this._reverse(),this}get(){return this._buffer}load(t){return ts(this,void 0,void 0,(function*(){const e=Es.load(t).then((t=>{this.set(t),this.onload(this)}));Es.downloads.push(e);try{yield e}finally{const t=Es.downloads.indexOf(e);Es.downloads.splice(t,1)}return this}))}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(t){const e=Xi(t)&&t[0].length>0,n=e?t.length:1,i=e?t[0].length:t.length,s=Ns(),r=s.createBuffer(n,i,s.sampleRate),o=e||1!==n?t:[t];for(let t=0;t<n;t++)r.copyToChannel(o[t],t);return this._buffer=r,this}toMono(t){if(Gi(t))this.fromArray(this.toArray(t));else{let t=new Float32Array(this.length);const e=this.numberOfChannels;for(let n=0;n<e;n++){const e=this.toArray(n);for(let n=0;n<e.length;n++)t[n]+=e[n]}t=t.map((t=>t/e)),this.fromArray(t)}return this}toArray(t){if(Gi(t))return this.getChannelData(t);if(1===this.numberOfChannels)return this.toArray(0);{const t=[];for(let e=0;e<this.numberOfChannels;e++)t[e]=this.getChannelData(e);return t}}getChannelData(t){return this._buffer?this._buffer.getChannelData(t):new Float32Array(0)}slice(t,e=this.duration){const n=Math.floor(t*this.sampleRate),i=Math.floor(e*this.sampleRate);Fi(n<i,"The start time must be less than the end time");const s=i-n,r=Ns().createBuffer(this.numberOfChannels,s,this.sampleRate);for(let t=0;t<this.numberOfChannels;t++)r.copyToChannel(this.getChannelData(t).subarray(n,i),t);return new Es(r)}_reverse(){if(this.loaded)for(let t=0;t<this.numberOfChannels;t++)this.getChannelData(t).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(t){this._reversed!==t&&(this._reversed=t,this._reverse())}static fromArray(t){return(new Es).fromArray(t)}static fromUrl(t){return ts(this,void 0,void 0,(function*(){const e=new Es;return yield e.load(t)}))}static load(t){return ts(this,void 0,void 0,(function*(){const e=t.match(/\[([^\]\[]+\|.+)\]$/);if(e){const n=e[1].split("|");let i=n[0];for(const t of n)if(Es.supportsType(t)){i=t;break}t=t.replace(e[0],i)}const n=""===Es.baseUrl||Es.baseUrl.endsWith("/")?Es.baseUrl:Es.baseUrl+"/",i=yield fetch(n+t);if(!i.ok)throw new Error(`could not load url: ${t}`);const s=yield i.arrayBuffer();return yield Ns().decodeAudioData(s)}))}static supportsType(t){const e=t.split("."),n=e[e.length-1];return""!==document.createElement("audio").canPlayType("audio/"+n)}static loaded(){return ts(this,void 0,void 0,(function*(){for(yield Promise.resolve();Es.downloads.length;)yield Es.downloads[0]}))}}Es.baseUrl="",Es.downloads=[];class Os extends As{constructor(){var t,e,n;super({clockSource:"offline",context:ss(arguments[0])?arguments[0]:(t=arguments[0],e=arguments[1]*arguments[2],n=arguments[2],new Di(t,e,n)),lookAhead:0,updateInterval:ss(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=ss(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(t){return ts(this,void 0,void 0,(function*(){let e=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,e++;const n=Math.floor(this.sampleRate/128);t&&e%n==0&&(yield new Promise((t=>setTimeout(t,1))))}}))}render(t=!0){return ts(this,void 0,void 0,(function*(){yield this.workletsAreReady(),yield this._renderClock(t);const e=yield this._context.startRendering();return new Es(e)}))}close(){return Promise.resolve()}}const Rs=new class extends Ss{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(t,e,n){return{}}createChannelMerger(t){return{}}createChannelSplitter(t){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(t){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(t,e){return{}}createPanner(){return{}}createPeriodicWave(t,e,n){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(t){return{}}createMediaElementSource(t){return{}}createMediaStreamDestination(){return{}}decodeAudioData(t){return Promise.resolve({})}createAudioWorkletNode(t,e){return{}}get rawContext(){return{}}addAudioWorkletModule(t,e){return ts(this,void 0,void 0,(function*(){return Promise.resolve()}))}resume(){return Promise.resolve()}setTimeout(t,e){return 0}clearTimeout(t){return this}setInterval(t,e){return 0}clearInterval(t){return this}getConstant(t){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(t){}get destination(){return{}}set destination(t){}now(){return 0}immediate(){return 0}};let qs=Rs;function Ns(){return qs===Rs&&Ji&&Fs(new As),qs}function Fs(t){qs=rs(t)?new As(t):ss(t)?new Os(t):t}function Is(){return qs.resume()}if(Qi&&!Qi.TONE_SILENCE_LOGGING){let t="v";"dev"===r&&(t="");const e=` * Tone.js ${t}${r} * `;console.log(`%c${e}`,"background: #000; color: #fff")}function Ps(t){return Math.pow(10,t/20)}function Vs(t){return Math.log(t)/Math.LN10*20}function zs(t){return Math.pow(2,t/12)}let js=440;function Ls(t){return Math.round(Bs(t))}function Bs(t){return 69+12*Math.log2(t/js)}function Us(t){return js*Math.pow(2,(t-69)/12)}class Ws extends fs{constructor(t,e,n){super(),this.defaultUnits="s",this._val=e,this._units=n,this.context=t,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:t=>this._frequencyToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:t=>this._ticksToUnits(parseInt(t,10)),regexp:/^(\d+)i$/i},m:{method:t=>this._beatsToUnits(parseInt(t,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(t,e)=>{const n=parseInt(t,10),i="."===e?1.5:1;return 1===n?this._beatsToUnits(this._getTimeSignature())*i:this._beatsToUnits(4/n)*i},regexp:/^(\d+)n(\.?)$/i},number:{method:t=>this._expressions[this.defaultUnits].method.call(this,t),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:t=>this._secondsToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:t=>parseInt(t,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:t=>{const e=parseInt(t,10);return this._beatsToUnits(8/(3*Math.floor(e)))},regexp:/^(\d+)t$/i},tr:{method:(t,e,n)=>{let i=0;return t&&"0"!==t&&(i+=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(i+=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(i+=this._beatsToUnits(parseFloat(n)/4)),i},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof Ws&&this.fromType(this._val),Bi(this._val))return this._noArg();if(Zi(this._val)&&Bi(this._units)){for(const t in this._expressions)if(this._expressions[t].regexp.test(this._val.trim())){this._units=t;break}}else if(Yi(this._val)){let t=0;for(const e in this._val)if(Ui(this._val[e])){const n=this._val[e];t+=new this.constructor(this.context,e).valueOf()*n}return t}if(Ui(this._units)){const t=this._expressions[this._units],e=this._val.toString().trim().match(t.regexp);return e?t.method.apply(this,e.slice(1)):t.method.call(this,this._val)}return Zi(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(t){return 1/t}_beatsToUnits(t){return 60/this._getBpm()*t}_secondsToUnits(t){return t}_ticksToUnits(t){return t*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(t){switch(this._units=void 0,this.defaultUnits){case"s":this._val=t.toSeconds();break;case"i":this._val=t.toTicks();break;case"hz":this._val=t.toFrequency();break;case"midi":this._val=t.toMidi()}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return 1e3*this.toSeconds()}}class Gs extends Ws{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:t=>this._now()+new this.constructor(this.context,t).valueOf(),regexp:/^\+(.+)/},quantize:{method:t=>{const e=new Gs(this.context,t).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(e))},regexp:/^@(.+)/}})}quantize(t,e=1){const n=new this.constructor(this.context,t).valueOf(),i=this.valueOf();return i+(Math.round(i/n)*n-i)*e}toNotation(){const t=this.toSeconds(),e=["1m"];for(let t=1;t<9;t++){const n=Math.pow(2,t);e.push(n+"n."),e.push(n+"n"),e.push(n+"t")}e.push("0");let n=e[0],i=new Gs(this.context,e[0]).toSeconds();return e.forEach((e=>{const s=new Gs(this.context,e).toSeconds();Math.abs(s-t)<Math.abs(i-t)&&(n=e,i=s)})),n}toBarsBeatsSixteenths(){const t=this._beatsToUnits(1);let e=this.valueOf()/t;e=parseFloat(e.toFixed(4));const n=Math.floor(e/this._getTimeSignature());let i=e%1*4;e=Math.floor(e)%this._getTimeSignature();const s=i.toString();return s.length>3&&(i=parseFloat(parseFloat(s).toFixed(3))),[n,e,i].join(":")}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.round(e*this._getPPQ())}toSeconds(){return this.valueOf()}toMidi(){return Ls(this.toFrequency())}_now(){return this.context.now()}}function Ys(t,e){return new Gs(Ns(),t,e)}class Hs extends Gs{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return js}static set A4(t){!function(t){js=t}(t)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(t){return"midi"===this.defaultUnits?t:Hs.mtof(t)}},note:{regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method(t,e){const n=Xs[t.toLowerCase()]+12*(parseInt(e,10)+1);return"midi"===this.defaultUnits?n:Hs.mtof(n)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(t,e,n){let i=1;return t&&"0"!==t&&(i*=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(i*=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(i*=this._beatsToUnits(parseFloat(n)/4)),i}}})}transpose(t){return new Hs(this.context,this.valueOf()*zs(t))}harmonize(t){return t.map((t=>this.transpose(t)))}toMidi(){return Ls(this.valueOf())}toNote(){const t=this.toFrequency(),e=Math.log2(t/Hs.A4);let n=Math.round(12*e)+57;const i=Math.floor(n/12);return i<0&&(n+=-12*i),Zs[n%12]+i.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.floor(e*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(t){return t}_ticksToUnits(t){return 1/(60*t/(this._getBpm()*this._getPPQ()))}_beatsToUnits(t){return 1/super._beatsToUnits(t)}_secondsToUnits(t){return 1/t}static mtof(t){return Us(t)}static ftom(t){return Ls(t)}}const Xs={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},Zs=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function $s(t,e){return new Hs(Ns(),t,e)}class Qs extends Gs{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}function Js(t,e){return new Qs(Ns(),t,e)}class Ks extends fs{constructor(){super();const t=us(Ks.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=t.context}static getDefaults(){return{context:Ns()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(t){return new Gs(this.context,t).toSeconds()}toFrequency(t){return new Hs(this.context,t).toFrequency()}toTicks(t){return new Qs(this.context,t).toTicks()}_getPartialProperties(t){const e=this.get();return Object.keys(e).forEach((n=>{Bi(t[n])&&delete e[n]})),e}get(){const t=this.constructor.getDefaults();return Object.keys(t).forEach((e=>{if(Reflect.has(this,e)){const n=this[e];Ui(n)&&Ui(n.value)&&Ui(n.setValueAtTime)?t[e]=n.value:n instanceof Ks?t[e]=n._getPartialProperties(t[e]):Xi(n)||Gi(n)||Zi(n)||Hi(n)?t[e]=n:delete t[e]}})),t}set(t){return Object.keys(t).forEach((e=>{Reflect.has(this,e)&&Ui(this[e])&&(this[e]&&Ui(this[e].value)&&Ui(this[e].setValueAtTime)?this[e].value!==t[e]&&(this[e].value=t[e]):this[e]instanceof Ks?this[e].set(t[e]):this[e]=t[e])})),this}}class tr extends ys{constructor(t="stopped"){super(),this.name="StateTimeline",this._initial=t,this.setStateAtTime(this._initial,0)}getValueAtTime(t){const e=this.get(t);return null!==e?e.state:this._initial}setStateAtTime(t,e,n){return Ii(e,0),this.add(Object.assign({},n,{state:t,time:e})),this}getLastState(t,e){for(let n=this._search(e);n>=0;n--){const e=this._timeline[n];if(e.state===t)return e}}getNextState(t,e){const n=this._search(e);if(-1!==n)for(let e=n;e<this._timeline.length;e++){const n=this._timeline[e];if(n.state===t)return n}}}class er extends Ks{constructor(){super(us(er.getDefaults(),arguments,["param","units","convert"])),this.name="Param",this.overridden=!1,this._minOutput=1e-7;const t=us(er.getDefaults(),arguments,["param","units","convert"]);for(Fi(Ui(t.param)&&(ns(t.param)||t.param instanceof er),"param must be an AudioParam");!ns(t.param);)t.param=t.param._param;this._swappable=!!Ui(t.swappable)&&t.swappable,this._swappable?(this.input=this.context.createGain(),this._param=t.param,this.input.connect(this._param)):this._param=this.input=t.param,this._events=new ys(1e3),this._initialValue=this._param.defaultValue,this.units=t.units,this.convert=t.convert,this._minValue=t.minValue,this._maxValue=t.maxValue,Ui(t.value)&&t.value!==this._toType(this._initialValue)&&this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(Ks.getDefaults(),{convert:!0,units:"number"})}get value(){const t=this.now();return this.getValueAtTime(t)}set value(t){this.cancelScheduledValues(this.now()),this.setValueAtTime(t,this.now())}get minValue(){return Ui(this._minValue)?this._minValue:"time"===this.units||"frequency"===this.units||"normalRange"===this.units||"positive"===this.units||"transportTime"===this.units||"ticks"===this.units||"bpm"===this.units||"hertz"===this.units||"samples"===this.units?0:"audioRange"===this.units?-1:"decibels"===this.units?-1/0:this._param.minValue}get maxValue(){return Ui(this._maxValue)?this._maxValue:"normalRange"===this.units||"audioRange"===this.units?1:this._param.maxValue}_is(t,e){return this.units===e}_assertRange(t){return Ui(this.maxValue)&&Ui(this.minValue)&&Ii(t,this._fromType(this.minValue),this._fromType(this.maxValue)),t}_fromType(t){return this.convert&&!this.overridden?this._is(t,"time")?this.toSeconds(t):this._is(t,"decibels")?Ps(t):this._is(t,"frequency")?this.toFrequency(t):t:this.overridden?0:t}_toType(t){return this.convert&&"decibels"===this.units?Vs(t):t}setValueAtTime(t,e){const n=this.toSeconds(e),i=this._fromType(t);return Fi(isFinite(i)&&isFinite(n),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(i),this.log(this.units,"setValueAtTime",t,n),this._events.add({time:n,type:"setValueAtTime",value:i}),this._param.setValueAtTime(i,n),this}getValueAtTime(t){const e=Math.max(this.toSeconds(t),0),n=this._events.getAfter(e),i=this._events.get(e);let s=this._initialValue;if(null===i)s=this._initialValue;else if("setTargetAtTime"!==i.type||null!==n&&"setValueAtTime"!==n.type)if(null===n)s=i.value;else if("linearRampToValueAtTime"===n.type||"exponentialRampToValueAtTime"===n.type){let t=i.value;if("setTargetAtTime"===i.type){const e=this._events.getBefore(i.time);t=null===e?this._initialValue:e.value}s="linearRampToValueAtTime"===n.type?this._linearInterpolate(i.time,t,n.time,n.value,e):this._exponentialInterpolate(i.time,t,n.time,n.value,e)}else s=i.value;else{const t=this._events.getBefore(i.time);let n;n=null===t?this._initialValue:t.value,"setTargetAtTime"===i.type&&(s=this._exponentialApproach(i.time,n,i.value,i.constant,e))}return this._toType(s)}setRampPoint(t){t=this.toSeconds(t);let e=this.getValueAtTime(t);return this.cancelAndHoldAtTime(t),0===this._fromType(e)&&(e=this._toType(this._minOutput)),this.setValueAtTime(e,t),this}linearRampToValueAtTime(t,e){const n=this._fromType(t),i=this.toSeconds(e);return Fi(isFinite(n)&&isFinite(i),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(n),this._events.add({time:i,type:"linearRampToValueAtTime",value:n}),this.log(this.units,"linearRampToValueAtTime",t,i),this._param.linearRampToValueAtTime(n,i),this}exponentialRampToValueAtTime(t,e){let n=this._fromType(t);n=gs(n,0)?this._minOutput:n,this._assertRange(n);const i=this.toSeconds(e);return Fi(isFinite(n)&&isFinite(i),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({time:i,type:"exponentialRampToValueAtTime",value:n}),this.log(this.units,"exponentialRampToValueAtTime",t,i),this._param.exponentialRampToValueAtTime(n,i),this}exponentialRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialRampToValueAtTime(t,n+this.toSeconds(e)),this}linearRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.linearRampToValueAtTime(t,n+this.toSeconds(e)),this}targetRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialApproachValueAtTime(t,n,e),this}exponentialApproachValueAtTime(t,e,n){e=this.toSeconds(e),n=this.toSeconds(n);const i=Math.log(n+1)/Math.log(200);return this.setTargetAtTime(t,e,i),this.cancelAndHoldAtTime(e+.9*n),this.linearRampToValueAtTime(t,e+n),this}setTargetAtTime(t,e,n){const i=this._fromType(t);Fi(isFinite(n)&&n>0,"timeConstant must be a number greater than 0");const s=this.toSeconds(e);return this._assertRange(i),Fi(isFinite(i)&&isFinite(s),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({constant:n,time:s,type:"setTargetAtTime",value:i}),this.log(this.units,"setTargetAtTime",t,s,n),this._param.setTargetAtTime(i,s,n),this}setValueCurveAtTime(t,e,n,i=1){n=this.toSeconds(n),e=this.toSeconds(e);const s=this._fromType(t[0])*i;this.setValueAtTime(this._toType(s),e);const r=n/(t.length-1);for(let n=1;n<t.length;n++){const s=this._fromType(t[n])*i;this.linearRampToValueAtTime(this._toType(s),e+n*r)}return this}cancelScheduledValues(t){const e=this.toSeconds(t);return Fi(isFinite(e),`Invalid argument to cancelScheduledValues: ${JSON.stringify(t)}`),this._events.cancel(e),this._param.cancelScheduledValues(e),this.log(this.units,"cancelScheduledValues",e),this}cancelAndHoldAtTime(t){const e=this.toSeconds(t),n=this._fromType(this.getValueAtTime(e));Fi(isFinite(e),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(t)}`),this.log(this.units,"cancelAndHoldAtTime",e,"value="+n);const i=this._events.get(e),s=this._events.getAfter(e);return i&&gs(i.time,e)?s?(this._param.cancelScheduledValues(s.time),this._events.cancel(s.time)):(this._param.cancelAndHoldAtTime(e),this._events.cancel(e+this.sampleTime)):s&&(this._param.cancelScheduledValues(s.time),this._events.cancel(s.time),"linearRampToValueAtTime"===s.type?this.linearRampToValueAtTime(this._toType(n),e):"exponentialRampToValueAtTime"===s.type&&this.exponentialRampToValueAtTime(this._toType(n),e)),this._events.add({time:e,type:"setValueAtTime",value:n}),this._param.setValueAtTime(n,e),this}rampTo(t,e=.1,n){return"frequency"===this.units||"bpm"===this.units||"decibels"===this.units?this.exponentialRampTo(t,e,n):this.linearRampTo(t,e,n),this}apply(t){const e=this.context.currentTime;t.setValueAtTime(this.getValueAtTime(e),e);const n=this._events.get(e);if(n&&"setTargetAtTime"===n.type){const i=this._events.getAfter(n.time),s=i?i.time:e+2,r=(s-e)/10;for(let n=e;n<s;n+=r)t.linearRampToValueAtTime(this.getValueAtTime(n),n)}return this._events.forEachAfter(this.context.currentTime,(e=>{"cancelScheduledValues"===e.type?t.cancelScheduledValues(e.time):"setTargetAtTime"===e.type?t.setTargetAtTime(e.value,e.time,e.constant):t[e.type](e.value,e.time)})),this}setParam(t){Fi(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const e=this.input;return e.disconnect(this._param),this.apply(t),this._param=t,e.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(t,e,n,i,s){return n+(e-n)*Math.exp(-(s-t)/i)}_linearInterpolate(t,e,n,i,s){return e+(s-t)/(n-t)*(i-e)}_exponentialInterpolate(t,e,n,i,s){return e*Math.pow(i/e,(s-t)/(n-t))}}class nr extends Ks{constructor(){super(...arguments),this.name="ToneAudioNode",this._internalChannels=[]}get numberOfInputs(){return Ui(this.input)?ns(this.input)||this.input instanceof er?1:this.input.numberOfInputs:0}get numberOfOutputs(){return Ui(this.output)?this.output.numberOfOutputs:0}_isAudioNode(t){return Ui(t)&&(t instanceof nr||is(t))}_getInternalNodes(){const t=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&t.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&t.push(this.output),t}_setChannelProperties(t){this._getInternalNodes().forEach((e=>{e.channelCount=t.channelCount,e.channelCountMode=t.channelCountMode,e.channelInterpretation=t.channelInterpretation}))}_getChannelProperties(){const t=this._getInternalNodes();Fi(t.length>0,"ToneAudioNode does not have any internal nodes");const e=t[0];return{channelCount:e.channelCount,channelCountMode:e.channelCountMode,channelInterpretation:e.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCount:t}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCountMode:t}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelInterpretation:t}))}connect(t,e=0,n=0){return sr(this,t,e,n),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return Li("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(t,e=0,n=0){return rr(this,t,e,n),this}chain(...t){return ir(this,...t),this}fan(...t){return t.forEach((t=>this.connect(t))),this}dispose(){return super.dispose(),Ui(this.input)&&(this.input instanceof nr?this.input.dispose():is(this.input)&&this.input.disconnect()),Ui(this.output)&&(this.output instanceof nr?this.output.dispose():is(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function ir(...t){const e=t.shift();t.reduce(((t,e)=>(t instanceof nr?t.connect(e):is(t)&&sr(t,e),e)),e)}function sr(t,e,n=0,i=0){for(Fi(Ui(t),"Cannot connect from undefined node"),Fi(Ui(e),"Cannot connect to undefined node"),(e instanceof nr||is(e))&&Fi(e.numberOfInputs>0,"Cannot connect to node with no inputs"),Fi(t.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof nr||e instanceof er;)Ui(e.input)&&(e=e.input);for(;t instanceof nr;)Ui(t.output)&&(t=t.output);ns(e)?t.connect(e,n):t.connect(e,n,i)}function rr(t,e,n=0,i=0){if(Ui(e))for(;e instanceof nr;)e=e.input;for(;!is(t);)Ui(t.output)&&(t=t.output);ns(e)?t.disconnect(e,n):is(e)?t.disconnect(e,n,i):t.disconnect()}class or extends nr{constructor(){super(us(or.getDefaults(),arguments,["gain","units"])),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;const t=us(or.getDefaults(),arguments,["gain","units"]);this.gain=new er({context:this.context,convert:t.convert,param:this._gainNode.gain,units:t.units,value:t.gain,minValue:t.minValue,maxValue:t.maxValue}),ks(this,"gain")}static getDefaults(){return Object.assign(nr.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class ar extends nr{constructor(t){super(t),this.onended=Ds,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new or({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(t){const e=this.toSeconds(t);return-1!==this._startTime&&e>=this._startTime&&(-1===this._stopTime||e<=this._stopTime)?"started":"stopped"},this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut,this._curve=t.curve,this.onended=t.onended}static getDefaults(){return Object.assign(nr.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:Ds})}_startGain(t,e=1){Fi(-1===this._startTime,"Source cannot be started more than once");const n=this.toSeconds(this._fadeIn);return this._startTime=t+n,this._startTime=Math.max(this._startTime,this.context.currentTime),n>0?(this._gainNode.gain.setValueAtTime(0,t),"linear"===this._curve?this._gainNode.gain.linearRampToValueAtTime(e,t+n):this._gainNode.gain.exponentialApproachValueAtTime(e,t,n)):this._gainNode.gain.setValueAtTime(e,t),this}stop(t){return this.log("stop",t),this._stopGain(this.toSeconds(t)),this}_stopGain(t){Fi(-1!==this._startTime,"'start' must be called before 'stop'"),this.cancelStop();const e=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(t)+e,this._stopTime=Math.max(this._stopTime,this.context.currentTime),e>0?"linear"===this._curve?this._gainNode.gain.linearRampTo(0,e,t):this._gainNode.gain.targetRampTo(0,e,t):(this._gainNode.gain.cancelAndHoldAtTime(t),this._gainNode.gain.setValueAtTime(0,t)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout((()=>{const t="exponential"===this._curve?2*e:0;this._stopSource(this.now()+t),this._onended()}),this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==Ds&&(this.onended(this),this.onended=Ds,!this.context.isOffline)){const t=()=>this.dispose();void 0!==window.requestIdleCallback?window.requestIdleCallback(t):setTimeout(t,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),Fi(-1!==this._startTime,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.disconnect(),this}}class cr extends ar{constructor(){super(us(cr.getDefaults(),arguments,["offset"])),this.name="ToneConstantSource",this._source=this.context.createConstantSource();const t=us(cr.getDefaults(),arguments,["offset"]);sr(this._source,this._gainNode),this.offset=new er({context:this.context,convert:t.convert,param:this._source.offset,units:t.units,value:t.offset,minValue:t.minValue,maxValue:t.maxValue})}static getDefaults(){return Object.assign(ar.getDefaults(),{convert:!0,offset:1,units:"number"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._source.start(e),this}_stopSource(t){this._source.stop(t)}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class ur extends nr{constructor(){super(us(ur.getDefaults(),arguments,["value","units"])),this.name="Signal",this.override=!0;const t=us(ur.getDefaults(),arguments,["value","units"]);this.output=this._constantSource=new cr({context:this.context,convert:t.convert,offset:t.value,units:t.units,minValue:t.minValue,maxValue:t.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(nr.getDefaults(),{convert:!0,units:"number",value:0})}connect(t,e=0,n=0){return lr(this,t,e,n),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(t,e){return this._param.setValueAtTime(t,e),this}getValueAtTime(t){return this._param.getValueAtTime(t)}setRampPoint(t){return this._param.setRampPoint(t),this}linearRampToValueAtTime(t,e){return this._param.linearRampToValueAtTime(t,e),this}exponentialRampToValueAtTime(t,e){return this._param.exponentialRampToValueAtTime(t,e),this}exponentialRampTo(t,e,n){return this._param.exponentialRampTo(t,e,n),this}linearRampTo(t,e,n){return this._param.linearRampTo(t,e,n),this}targetRampTo(t,e,n){return this._param.targetRampTo(t,e,n),this}exponentialApproachValueAtTime(t,e,n){return this._param.exponentialApproachValueAtTime(t,e,n),this}setTargetAtTime(t,e,n){return this._param.setTargetAtTime(t,e,n),this}setValueCurveAtTime(t,e,n,i){return this._param.setValueCurveAtTime(t,e,n,i),this}cancelScheduledValues(t){return this._param.cancelScheduledValues(t),this}cancelAndHoldAtTime(t){return this._param.cancelAndHoldAtTime(t),this}rampTo(t,e,n){return this._param.rampTo(t,e,n),this}get value(){return this._param.value}set value(t){this._param.value=t}get convert(){return this._param.convert}set convert(t){this._param.convert=t}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(t){this._param.overridden=t}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(t){return this._param.apply(t),this}}function lr(t,e,n,i){(e instanceof er||ns(e)||e instanceof ur&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof ur&&(e.overridden=!0)),sr(t,e,n,i)}class hr extends er{constructor(){super(us(hr.getDefaults(),arguments,["value"])),this.name="TickParam",this._events=new ys(1/0),this._multiplier=1;const t=us(hr.getDefaults(),arguments,["value"]);this._multiplier=t.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(t.value)}),this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(er.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(t,e,n){e=this.toSeconds(e),this.setRampPoint(e);const i=this._fromType(t),s=this._events.get(e),r=Math.round(Math.max(1/n,1));for(let t=0;t<=r;t++){const r=n*t+e,o=this._exponentialApproach(s.time,s.value,i,n,r);this.linearRampToValueAtTime(this._toType(o),r)}return this}setValueAtTime(t,e){const n=this.toSeconds(e);super.setValueAtTime(t,e);const i=this._events.get(n),s=this._events.previousEvent(i),r=this._getTicksUntilEvent(s,n);return i.ticks=Math.max(r,0),this}linearRampToValueAtTime(t,e){const n=this.toSeconds(e);super.linearRampToValueAtTime(t,e);const i=this._events.get(n),s=this._events.previousEvent(i),r=this._getTicksUntilEvent(s,n);return i.ticks=Math.max(r,0),this}exponentialRampToValueAtTime(t,e){e=this.toSeconds(e);const n=this._fromType(t),i=this._events.get(e),s=Math.round(Math.max(10*(e-i.time),1)),r=(e-i.time)/s;for(let t=0;t<=s;t++){const s=r*t+i.time,o=this._exponentialInterpolate(i.time,i.value,e,n,s);this.linearRampToValueAtTime(this._toType(o),s)}return this}_getTicksUntilEvent(t,e){if(null===t)t={ticks:0,time:0,type:"setValueAtTime",value:0};else if(Bi(t.ticks)){const e=this._events.previousEvent(t);t.ticks=this._getTicksUntilEvent(e,t.time)}const n=this._fromType(this.getValueAtTime(t.time));let i=this._fromType(this.getValueAtTime(e));const s=this._events.get(e);return s&&s.time===e&&"setValueAtTime"===s.type&&(i=this._fromType(this.getValueAtTime(e-this.sampleTime))),.5*(e-t.time)*(n+i)+t.ticks}getTicksAtTime(t){const e=this.toSeconds(t),n=this._events.get(e);return Math.max(this._getTicksUntilEvent(n,e),0)}getDurationOfTicks(t,e){const n=this.toSeconds(e),i=this.getTicksAtTime(e);return this.getTimeOfTick(i+t)-n}getTimeOfTick(t){const e=this._events.get(t,"ticks"),n=this._events.getAfter(t,"ticks");if(e&&e.ticks===t)return e.time;if(e&&n&&"linearRampToValueAtTime"===n.type&&e.value!==n.value){const i=this._fromType(this.getValueAtTime(e.time)),s=(this._fromType(this.getValueAtTime(n.time))-i)/(n.time-e.time),r=Math.sqrt(Math.pow(i,2)-2*s*(e.ticks-t)),o=(-i+r)/s,a=(-i-r)/s;return(o>0?o:a)+e.time}return e?0===e.value?1/0:e.time+(t-e.ticks)/e.value:t/this._initialValue}ticksToTime(t,e){return this.getDurationOfTicks(t,e)}timeToTicks(t,e){const n=this.toSeconds(e),i=this.toSeconds(t),s=this.getTicksAtTime(n);return this.getTicksAtTime(n+i)-s}_fromType(t){return"bpm"===this.units&&this.multiplier?1/(60/t/this.multiplier):super._fromType(t)}_toType(t){return"bpm"===this.units&&this.multiplier?t/this.multiplier*60:super._toType(t)}get multiplier(){return this._multiplier}set multiplier(t){const e=this.value;this._multiplier=t,this.cancelScheduledValues(0),this.setValueAtTime(e,0)}}class fr extends ur{constructor(){super(us(fr.getDefaults(),arguments,["value"])),this.name="TickSignal";const t=us(fr.getDefaults(),arguments,["value"]);this.input=this._param=new hr({context:this.context,convert:t.convert,multiplier:t.multiplier,param:this._constantSource.offset,units:t.units,value:t.value})}static getDefaults(){return Object.assign(ur.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(t,e){return this._param.ticksToTime(t,e)}timeToTicks(t,e){return this._param.timeToTicks(t,e)}getTimeOfTick(t){return this._param.getTimeOfTick(t)}getDurationOfTicks(t,e){return this._param.getDurationOfTicks(t,e)}getTicksAtTime(t){return this._param.getTicksAtTime(t)}get multiplier(){return this._param.multiplier}set multiplier(t){this._param.multiplier=t}dispose(){return super.dispose(),this._param.dispose(),this}}class dr extends Ks{constructor(){super(us(dr.getDefaults(),arguments,["frequency"])),this.name="TickSource",this._state=new tr,this._tickOffset=new ys;const t=us(dr.getDefaults(),arguments,["frequency"]);this.frequency=new fr({context:this.context,units:t.units,value:t.frequency}),ks(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},Ks.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(t,e){const n=this.toSeconds(t);return"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),Ui(e)&&this.setTicksAtTime(e,n)),this}stop(t){const e=this.toSeconds(t);if("stopped"===this._state.getValueAtTime(e)){const t=this._state.get(e);t&&t.time>0&&(this._tickOffset.cancel(t.time),this._state.cancel(t.time))}return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this.setTicksAtTime(0,e),this}pause(t){const e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&this._state.setStateAtTime("paused",e),this}cancel(t){return t=this.toSeconds(t),this._state.cancel(t),this._tickOffset.cancel(t),this}getTicksAtTime(t){const e=this.toSeconds(t),n=this._state.getLastState("stopped",e),i={state:"paused",time:e};this._state.add(i);let s=n,r=0;return this._state.forEachBetween(n.time,e+this.sampleTime,(t=>{let e=s.time;const n=this._tickOffset.get(t.time);n&&n.time>=s.time&&(r=n.ticks,e=n.time),"started"===s.state&&"started"!==t.state&&(r+=this.frequency.getTicksAtTime(t.time)-this.frequency.getTicksAtTime(e)),s=t})),this._state.remove(i),r}get ticks(){return this.getTicksAtTime(this.now())}set ticks(t){this.setTicksAtTime(t,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(t){const e=this.now(),n=this.frequency.timeToTicks(t,e);this.setTicksAtTime(n,e)}getSecondsAtTime(t){t=this.toSeconds(t);const e=this._state.getLastState("stopped",t),n={state:"paused",time:t};this._state.add(n);let i=e,s=0;return this._state.forEachBetween(e.time,t+this.sampleTime,(t=>{let e=i.time;const n=this._tickOffset.get(t.time);n&&n.time>=i.time&&(s=n.seconds,e=n.time),"started"===i.state&&"started"!==t.state&&(s+=t.time-e),i=t})),this._state.remove(n),s}setTicksAtTime(t,e){return e=this.toSeconds(e),this._tickOffset.cancel(e),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(t,e),ticks:t,time:e}),this}getStateAtTime(t){return t=this.toSeconds(t),this._state.getValueAtTime(t)}getTimeOfTick(t,e=this.now()){const n=this._tickOffset.get(e),i=this._state.get(e),s=Math.max(n.time,i.time),r=this.frequency.getTicksAtTime(s)+t-n.ticks;return this.frequency.getTimeOfTick(r)}forEachTickBetween(t,e,n){let i=this._state.get(t);this._state.forEachBetween(t,e,(e=>{i&&"started"===i.state&&"started"!==e.state&&this.forEachTickBetween(Math.max(i.time,t),e.time-this.sampleTime,n),i=e}));let s=null;if(i&&"started"===i.state){const r=Math.max(i.time,t),o=this.frequency.getTicksAtTime(r),a=o-this.frequency.getTicksAtTime(i.time);let c=Math.ceil(a)-a;c=gs(c,1)?0:c;let u=this.frequency.getTimeOfTick(o+c);for(;u<e;){try{n(u,Math.round(this.getTicksAtTime(u)))}catch(t){s=t;break}u+=this.frequency.getDurationOfTicks(1,u)}}if(s)throw s;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this.frequency.dispose(),this}}class pr extends Ks{constructor(){super(us(pr.getDefaults(),arguments,["callback","frequency"])),this.name="Clock",this.callback=Ds,this._lastUpdate=0,this._state=new tr("stopped"),this._boundLoop=this._loop.bind(this);const t=us(pr.getDefaults(),arguments,["callback","frequency"]);this.callback=t.callback,this._tickSource=new dr({context:this.context,frequency:t.frequency,units:t.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,ks(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(Ks.getDefaults(),{callback:Ds,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(t,e){Pi(this.context);const n=this.toSeconds(t);return this.log("start",n),"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),this._tickSource.start(n,e),n<this._lastUpdate&&this.emit("start",n,e)),this}stop(t){const e=this.toSeconds(t);return this.log("stop",e),this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._tickSource.stop(e),e<this._lastUpdate&&this.emit("stop",e),this}pause(t){const e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&(this._state.setStateAtTime("paused",e),this._tickSource.pause(e),e<this._lastUpdate&&this.emit("pause",e)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(t){this._tickSource.ticks=t}get seconds(){return this._tickSource.seconds}set seconds(t){this._tickSource.seconds=t}getSecondsAtTime(t){return this._tickSource.getSecondsAtTime(t)}setTicksAtTime(t,e){return this._tickSource.setTicksAtTime(t,e),this}getTimeOfTick(t,e=this.now()){return this._tickSource.getTimeOfTick(t,e)}getTicksAtTime(t){return this._tickSource.getTicksAtTime(t)}nextTickTime(t,e){const n=this.toSeconds(e),i=this.getTicksAtTime(n);return this._tickSource.getTimeOfTick(i+t,n)}_loop(){const t=this._lastUpdate,e=this.now();this._lastUpdate=e,this.log("loop",t,e),t!==e&&(this._state.forEachBetween(t,e,(t=>{switch(t.state){case"started":const e=this._tickSource.getTicksAtTime(t.time);this.emit("start",t.time,e);break;case"stopped":0!==t.time&&this.emit("stop",t.time);break;case"paused":this.emit("pause",t.time)}})),this._tickSource.forEachTickBetween(t,e,((t,e)=>{this.callback(t,e)})))}getStateAtTime(t){const e=this.toSeconds(t);return this._state.getValueAtTime(e)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}Ms.mixin(pr);class _r extends nr{constructor(){super(us(_r.getDefaults(),arguments,["delayTime","maxDelay"])),this.name="Delay";const t=us(_r.getDefaults(),arguments,["delayTime","maxDelay"]),e=this.toSeconds(t.maxDelay);this._maxDelay=Math.max(e,this.toSeconds(t.delayTime)),this._delayNode=this.input=this.output=this.context.createDelay(e),this.delayTime=new er({context:this.context,param:this._delayNode.delayTime,units:"time",value:t.delayTime,minValue:0,maxValue:this.maxDelay}),ks(this,"delayTime")}static getDefaults(){return Object.assign(nr.getDefaults(),{delayTime:0,maxDelay:1})}get maxDelay(){return this._maxDelay}dispose(){return super.dispose(),this._delayNode.disconnect(),this.delayTime.dispose(),this}}function mr(t,e,n=2,i=Ns().sampleRate){return ts(this,void 0,void 0,(function*(){const s=Ns(),r=new Os(n,e,i);Fs(r),yield t(r);const o=r.render();Fs(s);const a=yield o;return new Es(a)}))}class gr extends fs{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const t=us(gr.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=t.baseUrl,Object.keys(t.urls).forEach((e=>{this._loadingCount++;const n=t.urls[e];this.add(e,n,this._bufferLoaded.bind(this,t.onload),t.onerror)}))}static getDefaults(){return{baseUrl:"",onerror:Ds,onload:Ds,urls:{}}}has(t){return this._buffers.has(t.toString())}get(t){return Fi(this.has(t),`ToneAudioBuffers has no buffer named: ${t}`),this._buffers.get(t.toString())}_bufferLoaded(t){this._loadingCount--,0===this._loadingCount&&t&&t()}get loaded(){return Array.from(this._buffers).every((([t,e])=>e.loaded))}add(t,e,n=Ds,i=Ds){return Zi(e)?this._buffers.set(t.toString(),new Es(this.baseUrl+e,n,i)):this._buffers.set(t.toString(),new Es(e,n,i)),this}dispose(){return super.dispose(),this._buffers.forEach((t=>t.dispose())),this._buffers.clear(),this}}class vr extends Hs{constructor(){super(...arguments),this.name="MidiClass",this.defaultUnits="midi"}_frequencyToUnits(t){return Ls(super._frequencyToUnits(t))}_ticksToUnits(t){return Ls(super._ticksToUnits(t))}_beatsToUnits(t){return Ls(super._beatsToUnits(t))}_secondsToUnits(t){return Ls(super._secondsToUnits(t))}toMidi(){return this.valueOf()}toFrequency(){return Us(this.toMidi())}transpose(t){return new vr(this.context,this.toMidi()+t)}}function yr(t,e){return new vr(Ns(),t,e)}class br extends Qs{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(t){return this._getPPQ()*t}_secondsToUnits(t){return Math.floor(t/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(t){return t}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}function xr(t,e){return new br(Ns(),t,e)}class wr extends Ks{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new ys,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(t,e){return this._events.add({callback:t,time:this.toSeconds(e)}),1===this._events.length&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(t){return this._events.cancel(this.toSeconds(t)),this}_drawLoop(){const t=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=t;){const e=this._events.shift();e&&t-e.time<=this.expiration&&e.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}xs((t=>{t.draw=new wr({context:t})})),Ts((t=>{t.draw.dispose()}));class Tr extends fs{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(t){Fi(Ui(t.time),"Events must have a time property"),Fi(Ui(t.duration),"Events must have a duration parameter"),t.time=t.time.valueOf();let e=new Mr(t.time,t.time+t.duration,t);for(null===this._root?this._root=e:this._root.insert(e),this._length++;null!==e;)e.updateHeight(),e.updateMax(),this._rebalance(e),e=e.parent;return this}remove(t){if(null!==this._root){const e=[];this._root.search(t.time,e);for(const n of e)if(n.event===t){this._removeNode(n),this._length--;break}}return this}get length(){return this._length}cancel(t){return this.forEachFrom(t,(t=>this.remove(t))),this}_setRoot(t){this._root=t,null!==this._root&&(this._root.parent=null)}_replaceNodeInParent(t,e){null!==t.parent?(t.isLeftChild()?t.parent.left=e:t.parent.right=e,this._rebalance(t.parent)):this._setRoot(e)}_removeNode(t){if(null===t.left&&null===t.right)this._replaceNodeInParent(t,null);else if(null===t.right)this._replaceNodeInParent(t,t.left);else if(null===t.left)this._replaceNodeInParent(t,t.right);else{let e,n=null;if(t.getBalance()>0)if(null===t.left.right)e=t.left,e.right=t.right,n=e;else{for(e=t.left.right;null!==e.right;)e=e.right;e.parent&&(e.parent.right=e.left,n=e.parent,e.left=t.left,e.right=t.right)}else if(null===t.right.left)e=t.right,e.left=t.left,n=e;else{for(e=t.right.left;null!==e.left;)e=e.left;e.parent&&(e.parent.left=e.right,n=e.parent,e.left=t.left,e.right=t.right)}null!==t.parent?t.isLeftChild()?t.parent.left=e:t.parent.right=e:this._setRoot(e),n&&this._rebalance(n)}t.dispose()}_rotateLeft(t){const e=t.parent,n=t.isLeftChild(),i=t.right;i&&(t.right=i.left,i.left=t),null!==e?n?e.left=i:e.right=i:this._setRoot(i)}_rotateRight(t){const e=t.parent,n=t.isLeftChild(),i=t.left;i&&(t.left=i.right,i.right=t),null!==e?n?e.left=i:e.right=i:this._setRoot(i)}_rebalance(t){const e=t.getBalance();e>1&&t.left?t.left.getBalance()<0?this._rotateLeft(t.left):this._rotateRight(t):e<-1&&t.right&&(t.right.getBalance()>0?this._rotateRight(t.right):this._rotateLeft(t))}get(t){if(null!==this._root){const e=[];if(this._root.search(t,e),e.length>0){let t=e[0];for(let n=1;n<e.length;n++)e[n].low>t.low&&(t=e[n]);return t.event}}return null}forEach(t){if(null!==this._root){const e=[];this._root.traverse((t=>e.push(t))),e.forEach((e=>{e.event&&t(e.event)}))}return this}forEachAtTime(t,e){if(null!==this._root){const n=[];this._root.search(t,n),n.forEach((t=>{t.event&&e(t.event)}))}return this}forEachFrom(t,e){if(null!==this._root){const n=[];this._root.searchAfter(t,n),n.forEach((t=>{t.event&&e(t.event)}))}return this}dispose(){return super.dispose(),null!==this._root&&this._root.traverse((t=>t.dispose())),this._root=null,this}}class Mr{constructor(t,e,n){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=n,this.low=t,this.high=e,this.max=this.high}insert(t){t.low<=this.low?null===this.left?this.left=t:this.left.insert(t):null===this.right?this.right=t:this.right.insert(t)}search(t,e){t>this.max||(null!==this.left&&this.left.search(t,e),this.low<=t&&this.high>t&&e.push(this),this.low>t||null!==this.right&&this.right.search(t,e))}searchAfter(t,e){this.low>=t&&(e.push(this),null!==this.left&&this.left.searchAfter(t,e)),null!==this.right&&this.right.searchAfter(t,e)}traverse(t){t(this),null!==this.left&&this.left.traverse(t),null!==this.right&&this.right.traverse(t)}updateHeight(){null!==this.left&&null!==this.right?this.height=Math.max(this.left.height,this.right.height)+1:null!==this.right?this.height=this.right.height+1:null!==this.left?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,null!==this.left&&(this.max=Math.max(this.max,this.left.max)),null!==this.right&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let t=0;return null!==this.left&&null!==this.right?t=this.left.height-this.right.height:null!==this.left?t=this.left.height+1:null!==this.right&&(t=-(this.right.height+1)),t}isLeftChild(){return null!==this.parent&&this.parent.left===this}get left(){return this._left}set left(t){this._left=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(t){this._right=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class Sr extends nr{constructor(){super(us(Sr.getDefaults(),arguments,["volume"])),this.name="Volume";const t=us(Sr.getDefaults(),arguments,["volume"]);this.input=this.output=new or({context:this.context,gain:t.volume,units:"decibels"}),this.volume=this.output.gain,ks(this,"volume"),this._unmutedVolume=t.volume,this.mute=t.mute}static getDefaults(){return Object.assign(nr.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(t){!this.mute&&t?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!t&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class Ar extends nr{constructor(){super(us(Ar.getDefaults(),arguments)),this.name="Destination",this.input=new Sr({context:this.context}),this.output=new or({context:this.context}),this.volume=this.input.volume;const t=us(Ar.getDefaults(),arguments);ir(this.input,this.output,this.context.rawContext.destination),this.mute=t.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(nr.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(t){this.input.mute=t}chain(...t){return this.input.disconnect(),t.unshift(this.input),t.push(this.output),ir(...t),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}xs((t=>{t.destination=new Ar({context:t})})),Ts((t=>{t.destination.dispose()}));class kr extends fs{constructor(t){super(),this.name="TimelineValue",this._timeline=new ys({memory:10}),this._initialValue=t}set(t,e){return this._timeline.add({value:t,time:e}),this}get(t){const e=this._timeline.get(t);return e?e.value:this._initialValue}}class Cr{constructor(t,e){this.id=Cr._eventId++;const n=Object.assign(Cr.getDefaults(),e);this.transport=t,this.callback=n.callback,this._once=n.once,this.time=n.time}static getDefaults(){return{callback:Ds,once:!1,time:0}}invoke(t){this.callback&&(this.callback(t),this._once&&this.transport.clear(this.id))}dispose(){return this.callback=void 0,this}}Cr._eventId=0;class Dr extends Cr{constructor(t,e){super(t,e),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const n=Object.assign(Dr.getDefaults(),e);this.duration=new br(t.context,n.duration).valueOf(),this._interval=new br(t.context,n.interval).valueOf(),this._nextTick=n.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},Cr.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(t){this._createEvents(t),super.invoke(t)}_createEvents(t){const e=this.transport.getTicksAtTime(t);e>=this.time&&e>=this._nextTick&&this._nextTick+this._interval<this.time+this.duration&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new br(this.context,this._nextTick).toSeconds()))}_restart(t){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.time;const e=this.transport.getTicksAtTime(t);e>this.time&&(this._nextTick=this.time+Math.ceil((e-this.time)/this._interval)*this._interval),this._currentId=this.transport.scheduleOnce(this.invoke.bind(this),new br(this.context,this._nextTick).toSeconds()),this._nextTick+=this._interval,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new br(this.context,this._nextTick).toSeconds())}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this}}class Er extends Ks{constructor(){super(us(Er.getDefaults(),arguments)),this.name="Transport",this._loop=new kr(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new ys,this._repeatedEvents=new Tr,this._syncedSignals=[],this._swingAmount=0;const t=us(Er.getDefaults(),arguments);this._ppq=t.ppq,this._clock=new pr({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=t.ppq,this.bpm.setValueAtTime(t.bpm,0),ks(this,"bpm"),this._timeSignature=t.timeSignature,this._swingTicks=t.ppq/2}static getDefaults(){return Object.assign(Ks.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(t,e){if(this._loop.get(t)&&e>=this._loopEnd&&(this.emit("loopEnd",t),this._clock.setTicksAtTime(this._loopStart,t),e=this._loopStart,this.emit("loopStart",t,this._clock.getSecondsAtTime(t)),this.emit("loop",t)),this._swingAmount>0&&e%this._ppq!=0&&e%(2*this._swingTicks)!=0){const n=e%(2*this._swingTicks)/(2*this._swingTicks),i=Math.sin(n*Math.PI)*this._swingAmount;t+=new br(this.context,2*this._swingTicks/3).toSeconds()*i}this._timeline.forEachAtTime(e,(e=>e.invoke(t)))}schedule(t,e){const n=new Cr(this,{callback:t,time:new Qs(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}scheduleRepeat(t,e,n,i=1/0){const s=new Dr(this,{callback:t,duration:new Gs(this.context,i).toTicks(),interval:new Gs(this.context,e).toTicks(),time:new Qs(this.context,n).toTicks()});return this._addEvent(s,this._repeatedEvents)}scheduleOnce(t,e){const n=new Cr(this,{callback:t,once:!0,time:new Qs(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}clear(t){if(this._scheduledEvents.hasOwnProperty(t)){const e=this._scheduledEvents[t.toString()];e.timeline.remove(e.event),e.event.dispose(),delete this._scheduledEvents[t.toString()]}return this}_addEvent(t,e){return this._scheduledEvents[t.id.toString()]={event:t,timeline:e},e.add(t),t.id}cancel(t=0){const e=this.toTicks(t);return this._timeline.forEachFrom(e,(t=>this.clear(t.id))),this._repeatedEvents.forEachFrom(e,(t=>this.clear(t.id))),this}_bindClockEvents(){this._clock.on("start",((t,e)=>{e=new br(this.context,e).toSeconds(),this.emit("start",t,e)})),this._clock.on("stop",(t=>{this.emit("stop",t)})),this._clock.on("pause",(t=>{this.emit("pause",t)}))}get state(){return this._clock.getStateAtTime(this.now())}start(t,e){let n;return Ui(e)&&(n=this.toTicks(e)),this._clock.start(t,n),this}stop(t){return this._clock.stop(t),this}pause(t){return this._clock.pause(t),this}toggle(t){return t=this.toSeconds(t),"started"!==this._clock.getStateAtTime(t)?this.start(t):this.stop(t),this}get timeSignature(){return this._timeSignature}set timeSignature(t){Xi(t)&&(t=t[0]/t[1]*4),this._timeSignature=t}get loopStart(){return new Gs(this.context,this._loopStart,"i").toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t)}get loopEnd(){return new Gs(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t)}get loop(){return this._loop.get(this.now())}set loop(t){this._loop.set(t,this.now())}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get swing(){return this._swingAmount}set swing(t){this._swingAmount=t}get swingSubdivision(){return new br(this.context,this._swingTicks).toNotation()}set swingSubdivision(t){this._swingTicks=this.toTicks(t)}get position(){const t=this.now(),e=this._clock.getTicksAtTime(t);return new br(this.context,e).toBarsBeatsSixteenths()}set position(t){const e=this.toTicks(t);this.ticks=e}get seconds(){return this._clock.seconds}set seconds(t){const e=this.now(),n=this._clock.frequency.timeToTicks(t,e);this.ticks=n}get progress(){if(this.loop){const t=this.now();return(this._clock.getTicksAtTime(t)-this._loopStart)/(this._loopEnd-this._loopStart)}return 0}get ticks(){return this._clock.ticks}set ticks(t){if(this._clock.ticks!==t){const e=this.now();if("started"===this.state){const n=this._clock.getTicksAtTime(e),i=e+this._clock.frequency.getDurationOfTicks(Math.ceil(n)-n,e);this.emit("stop",i),this._clock.setTicksAtTime(t,i),this.emit("start",i,this._clock.getSecondsAtTime(i))}else this._clock.setTicksAtTime(t,e)}}getTicksAtTime(t){return Math.round(this._clock.getTicksAtTime(t))}getSecondsAtTime(t){return this._clock.getSecondsAtTime(t)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(t){this._clock.frequency.multiplier=t}nextSubdivision(t){if(t=this.toTicks(t),"started"!==this.state)return 0;{const e=this.now(),n=t-this.getTicksAtTime(e)%t;return this._clock.nextTickTime(n,e)}}syncSignal(t,e){if(!e){const n=this.now();if(0!==t.getValueAtTime(n)){const i=1/(60/this.bpm.getValueAtTime(n)/this.PPQ);e=t.getValueAtTime(n)/i}else e=0}const n=new or(e);return this.bpm.connect(n),n.connect(t._param),this._syncedSignals.push({initial:t.value,ratio:n,signal:t}),t.value=0,this}unsyncSignal(t){for(let e=this._syncedSignals.length-1;e>=0;e--){const n=this._syncedSignals[e];n.signal===t&&(n.ratio.dispose(),n.signal.value=n.initial,this._syncedSignals.splice(e,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),Cs(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}Ms.mixin(Er),xs((t=>{t.transport=new Er({context:t})})),Ts((t=>{t.transport.dispose()}));class Or extends nr{constructor(t){super(t),this.input=void 0,this._state=new tr("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=Ds,this._syncedStop=Ds,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new Sr({context:this.context,mute:t.mute,volume:t.volume}),this.volume=this._volume.volume,ks(this,"volume"),this.onstop=t.onstop}static getDefaults(){return Object.assign(nr.getDefaults(),{mute:!1,onstop:Ds,volume:0})}get state(){return this._synced?"started"===this.context.transport.state?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}_clampToCurrentTime(t){return this._synced?t:Math.max(t,this.context.currentTime)}start(t,e,n){let i=Bi(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(i=this._clampToCurrentTime(i),this._synced||"started"!==this._state.getValueAtTime(i))if(this.log("start",i),this._state.setStateAtTime("started",i),this._synced){const t=this._state.get(i);t&&(t.offset=this.toSeconds(ls(e,0)),t.duration=n?this.toSeconds(n):void 0);const s=this.context.transport.schedule((t=>{this._start(t,e,n)}),i);this._scheduled.push(s),"started"===this.context.transport.state&&this.context.transport.getSecondsAtTime(this.immediate())>i&&this._syncedStart(this.now(),this.context.transport.seconds)}else Pi(this.context),this._start(i,e,n);else Fi(ps(i,this._state.get(i).time),"Start time must be strictly greater than previous start time"),this._state.cancel(i),this._state.setStateAtTime("started",i),this.log("restart",i),this.restart(i,e,n);return this}stop(t){let e=Bi(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(e=this._clampToCurrentTime(e),"started"===this._state.getValueAtTime(e)||Ui(this._state.getNextState("started",e))){if(this.log("stop",e),this._synced){const t=this.context.transport.schedule(this._stop.bind(this),e);this._scheduled.push(t)}else this._stop(e);this._state.cancel(e),this._state.setStateAtTime("stopped",e)}return this}restart(t,e,n){return t=this.toSeconds(t),"started"===this._state.getValueAtTime(t)&&(this._state.cancel(t),this._restart(t,e,n)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(t,e)=>{if(e>0){const n=this._state.get(e);if(n&&"started"===n.state&&n.time!==e){const i=e-this.toSeconds(n.time);let s;n.duration&&(s=this.toSeconds(n.duration)-i),this._start(t,this.toSeconds(n.offset)+i,s)}}},this._syncedStop=t=>{const e=this.context.transport.getSecondsAtTime(Math.max(t-this.sampleTime,0));"started"===this._state.getValueAtTime(e)&&this._stop(t)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach((t=>this.context.transport.clear(t))),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=Ds,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class Rr extends ar{constructor(){super(us(Rr.getDefaults(),arguments,["url","onload"])),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;const t=us(Rr.getDefaults(),arguments,["url","onload"]);sr(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new er({context:this.context,param:this._source.playbackRate,units:"positive",value:t.playbackRate}),this.loop=t.loop,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this._buffer=new Es(t.url,t.onload,t.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(ar.getDefaults(),{url:new Es,loop:!1,loopEnd:0,loopStart:0,onload:Ds,onerror:Ds,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t}get curve(){return this._curve}set curve(t){this._curve=t}start(t,e,n,i=1){Fi(this.buffer.loaded,"buffer is either not set or not loaded");const s=this.toSeconds(t);this._startGain(s,i),e=this.loop?ls(e,this.loopStart):ls(e,0);let r=Math.max(this.toSeconds(e),0);if(this.loop){const t=this.toSeconds(this.loopEnd)||this.buffer.duration,e=this.toSeconds(this.loopStart),n=t-e;_s(r,t)&&(r=(r-e)%n+e),gs(r,this.buffer.duration)&&(r=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,ms(r,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(s,r)),Ui(n)){let t=this.toSeconds(n);t=Math.max(t,0),this.stop(s+t)}return this}_stopSource(t){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(t)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(t){this._source.loopStart=this.toSeconds(t)}get loopEnd(){return this._source.loopEnd}set loopEnd(t){this._source.loopEnd=this.toSeconds(t)}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._source.loop}set loop(t){this._source.loop=t,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}class qr extends Or{constructor(){super(us(qr.getDefaults(),arguments,["type"])),this.name="Noise",this._source=null;const t=us(qr.getDefaults(),arguments,["type"]);this._playbackRate=t.playbackRate,this.type=t.type,this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut}static getDefaults(){return Object.assign(Or.getDefaults(),{fadeIn:0,fadeOut:0,playbackRate:1,type:"white"})}get type(){return this._type}set type(t){if(Fi(t in Ir,"Noise: invalid type: "+t),this._type!==t&&(this._type=t,"started"===this.state)){const t=this.now();this._stop(t),this._start(t)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._source&&(this._source.playbackRate.value=t)}_start(t){const e=Ir[this._type];this._source=new Rr({url:e,context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,loop:!0,onended:()=>this.onstop(this),playbackRate:this._playbackRate}).connect(this.output),this._source.start(this.toSeconds(t),Math.random()*(e.duration-.001))}_stop(t){this._source&&(this._source.stop(this.toSeconds(t)),this._source=null)}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t,this._source&&(this._source.fadeIn=this._fadeIn)}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t,this._source&&(this._source.fadeOut=this._fadeOut)}_restart(t){this._stop(t),this._start(t)}dispose(){return super.dispose(),this._source&&this._source.disconnect(),this}}const Nr=220500,Fr={brown:null,pink:null,white:null},Ir={get brown(){if(!Fr.brown){const t=[];for(let e=0;e<2;e++){const n=new Float32Array(Nr);t[e]=n;let i=0;for(let t=0;t<Nr;t++){const e=2*Math.random()-1;n[t]=(i+.02*e)/1.02,i=n[t],n[t]*=3.5}}Fr.brown=(new Es).fromArray(t)}return Fr.brown},get pink(){if(!Fr.pink){const t=[];for(let e=0;e<2;e++){const n=new Float32Array(Nr);let i,s,r,o,a,c,u;t[e]=n,i=s=r=o=a=c=u=0;for(let t=0;t<Nr;t++){const e=2*Math.random()-1;i=.99886*i+.0555179*e,s=.99332*s+.0750759*e,r=.969*r+.153852*e,o=.8665*o+.3104856*e,a=.55*a+.5329522*e,c=-.7616*c-.016898*e,n[t]=i+s+r+o+a+c+u+.5362*e,n[t]*=.11,u=.115926*e}}Fr.pink=(new Es).fromArray(t)}return Fr.pink},get white(){if(!Fr.white){const t=[];for(let e=0;e<2;e++){const n=new Float32Array(Nr);t[e]=n;for(let t=0;t<Nr;t++)n[t]=2*Math.random()-1}Fr.white=(new Es).fromArray(t)}return Fr.white}};class Pr extends nr{constructor(){super(us(Pr.getDefaults(),arguments,["volume"])),this.name="UserMedia";const t=us(Pr.getDefaults(),arguments,["volume"]);this._volume=this.output=new Sr({context:this.context,volume:t.volume}),this.volume=this._volume.volume,ks(this,"volume"),this.mute=t.mute}static getDefaults(){return Object.assign(nr.getDefaults(),{mute:!1,volume:0})}open(t){return ts(this,void 0,void 0,(function*(){Fi(Pr.supported,"UserMedia is not supported"),"started"===this.state&&this.close();const e=yield Pr.enumerateDevices();Gi(t)?this._device=e[t]:(this._device=e.find((e=>e.label===t||e.deviceId===t)),!this._device&&e.length>0&&(this._device=e[0]),Fi(Ui(this._device),`No matching device ${t}`));const n={audio:{echoCancellation:!1,sampleRate:this.context.sampleRate,noiseSuppression:!1,mozNoiseSuppression:!1}};this._device&&(n.audio.deviceId=this._device.deviceId);const i=yield navigator.mediaDevices.getUserMedia(n);if(!this._stream){this._stream=i;const t=this.context.createMediaStreamSource(i);sr(t,this.output),this._mediaStream=t}return this}))}close(){return this._stream&&this._mediaStream&&(this._stream.getAudioTracks().forEach((t=>{t.stop()})),this._stream=void 0,this._mediaStream.disconnect(),this._mediaStream=void 0),this._device=void 0,this}static enumerateDevices(){return ts(this,void 0,void 0,(function*(){return(yield navigator.mediaDevices.enumerateDevices()).filter((t=>"audioinput"===t.kind))}))}get state(){return this._stream&&this._stream.active?"started":"stopped"}get deviceId(){return this._device?this._device.deviceId:void 0}get groupId(){return this._device?this._device.groupId:void 0}get label(){return this._device?this._device.label:void 0}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}dispose(){return super.dispose(),this.close(),this._volume.dispose(),this.volume.dispose(),this}static get supported(){return Ui(navigator.mediaDevices)&&Ui(navigator.mediaDevices.getUserMedia)}}function Vr(t,e){return ts(this,void 0,void 0,(function*(){const n=e/t.context.sampleRate,i=new Os(1,n,t.context.sampleRate);return new t.constructor(Object.assign(t.get(),{frequency:2/n,detune:0,context:i})).toDestination().start(0),(yield i.render()).getChannelData(0)}))}class zr extends ar{constructor(){super(us(zr.getDefaults(),arguments,["frequency","type"])),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];const t=us(zr.getDefaults(),arguments,["frequency","type"]);sr(this._oscillator,this._gainNode),this.type=t.type,this.frequency=new er({context:this.context,param:this._oscillator.frequency,units:"frequency",value:t.frequency}),this.detune=new er({context:this.context,param:this._oscillator.detune,units:"cents",value:t.detune}),ks(this,["frequency","detune"])}static getDefaults(){return Object.assign(ar.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._oscillator.start(e),this}_stopSource(t){this._oscillator.stop(t)}setPeriodicWave(t){return this._oscillator.setPeriodicWave(t),this}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class jr extends Or{constructor(){super(us(jr.getDefaults(),arguments,["frequency","type"])),this.name="Oscillator",this._oscillator=null;const t=us(jr.getDefaults(),arguments,["frequency","type"]);this.frequency=new ur({context:this.context,units:"frequency",value:t.frequency}),ks(this,"frequency"),this.detune=new ur({context:this.context,units:"cents",value:t.detune}),ks(this,"detune"),this._partials=t.partials,this._partialCount=t.partialCount,this._type=t.type,t.partialCount&&"custom"!==t.type&&(this._type=this.baseType+t.partialCount.toString()),this.phase=t.phase}static getDefaults(){return Object.assign(Or.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(t){const e=this.toSeconds(t),n=new zr({context:this.context,onended:()=>this.onstop(this)});this._oscillator=n,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(e)}_stop(t){const e=this.toSeconds(t);this._oscillator&&this._oscillator.stop(e)}_restart(t){const e=this.toSeconds(t);return this.log("restart",e),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(e),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if("custom"===this._type)return jr._periodicWaveCache.find((t=>{return t.phase===this._phase&&(e=t.partials,n=this._partials,e.length===n.length&&e.every(((t,e)=>n[e]===t)));var e,n}));{const t=jr._periodicWaveCache.find((t=>t.type===this._type&&t.phase===this._phase));return this._partialCount=t?t.partialCount:this._partialCount,t}}get type(){return this._type}set type(t){this._type=t;const e=-1!==["sine","square","sawtooth","triangle"].indexOf(t);if(0===this._phase&&e)this._wave=void 0,this._partialCount=0,null!==this._oscillator&&(this._oscillator.type=t);else{const e=this._getCachedPeriodicWave();if(Ui(e)){const{partials:t,wave:n}=e;this._wave=n,this._partials=t,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave)}else{const[e,n]=this._getRealImaginary(t,this._phase),i=this.context.createPeriodicWave(e,n);this._wave=i,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave),jr._periodicWaveCache.push({imag:n,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:e,type:this._type,wave:this._wave}),jr._periodicWaveCache.length>100&&jr._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(t){this.partialCount&&"custom"!==this._type&&"custom"!==t?this.type=t+this.partialCount:this.type=t}get partialCount(){return this._partialCount}set partialCount(t){Ii(t,0);let e=this._type;const n=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(n&&(e=n[1]),"custom"!==this._type)this.type=0===t?e:e+t.toString();else{const e=new Float32Array(t);this._partials.forEach(((t,n)=>e[n]=t)),this._partials=Array.from(e),this.type=this._type}}_getRealImaginary(t,e){let n=2048;const i=new Float32Array(n),s=new Float32Array(n);let r=1;if("custom"===t){if(r=this._partials.length+1,this._partialCount=this._partials.length,n=r,0===this._partials.length)return[i,s]}else{const e=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(t);e?(r=parseInt(e[2],10)+1,this._partialCount=parseInt(e[2],10),t=e[1],r=Math.max(r,2),n=r):this._partialCount=0,this._partials=[]}for(let o=1;o<n;++o){const n=2/(o*Math.PI);let a;switch(t){case"sine":a=o<=r?1:0,this._partials[o-1]=a;break;case"square":a=1&o?2*n:0,this._partials[o-1]=a;break;case"sawtooth":a=n*(1&o?1:-1),this._partials[o-1]=a;break;case"triangle":a=1&o?n*n*2*(o-1>>1&1?-1:1):0,this._partials[o-1]=a;break;case"custom":a=this._partials[o-1];break;default:throw new TypeError("Oscillator: invalid type: "+t)}0!==a?(i[o]=-a*Math.sin(e*o),s[o]=a*Math.cos(e*o)):(i[o]=0,s[o]=0)}return[i,s]}_inverseFFT(t,e,n){let i=0;const s=t.length;for(let r=0;r<s;r++)i+=t[r]*Math.cos(r*n)+e[r]*Math.sin(r*n);return i}getInitialValue(){const[t,e]=this._getRealImaginary(this._type,0);let n=0;const i=2*Math.PI;for(let s=0;s<32;s++)n=Math.max(this._inverseFFT(t,e,s/32*i),n);return vs(-this._inverseFFT(t,e,this._phase)/n,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(t){this._phase=t*Math.PI/180,this.type=this._type}asArray(t=1024){return ts(this,void 0,void 0,(function*(){return Vr(this,t)}))}dispose(){return super.dispose(),null!==this._oscillator&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}jr._periodicWaveCache=[];class Lr extends nr{constructor(){super(Object.assign(us(Lr.getDefaults(),arguments,["context"])))}connect(t,e=0,n=0){return lr(this,t,e,n),this}}class Br extends Lr{constructor(){super(Object.assign(us(Br.getDefaults(),arguments,["mapping","length"]))),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;const t=us(Br.getDefaults(),arguments,["mapping","length"]);Xi(t.mapping)||t.mapping instanceof Float32Array?this.curve=Float32Array.from(t.mapping):Wi(t.mapping)&&this.setMap(t.mapping,t.length)}static getDefaults(){return Object.assign(ur.getDefaults(),{length:1024})}setMap(t,e=1024){const n=new Float32Array(e);for(let i=0,s=e;i<s;i++){const e=i/(s-1)*2-1;n[i]=t(e,i)}return this.curve=n,this}get curve(){return this._shaper.curve}set curve(t){this._shaper.curve=t}get oversample(){return this._shaper.oversample}set oversample(t){Fi(["none","2x","4x"].some((e=>e.includes(t))),"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class Ur extends Lr{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new Br({context:this.context,mapping:t=>(t+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class Wr extends ur{constructor(){super(Object.assign(us(Wr.getDefaults(),arguments,["value"]))),this.name="Multiply",this.override=!1;const t=us(Wr.getDefaults(),arguments,["value"]);this._mult=this.input=this.output=new or({context:this.context,minValue:t.minValue,maxValue:t.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(ur.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class Gr extends Or{constructor(){super(us(Gr.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="AMOscillator",this._modulationScale=new Ur({context:this.context}),this._modulationNode=new or({context:this.context});const t=us(Gr.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new jr({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new jr({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new Wr({context:this.context,units:"positive",value:t.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),ks(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(jr.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){this._modulator.restart(t),this._carrier.restart(t)}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return ts(this,void 0,void 0,(function*(){return Vr(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class Yr extends Or{constructor(){super(us(Yr.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="FMOscillator",this._modulationNode=new or({context:this.context,gain:0});const t=us(Yr.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new jr({context:this.context,detune:t.detune,frequency:0,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.detune=this._carrier.detune,this.frequency=new ur({context:this.context,units:"frequency",value:t.frequency}),this._modulator=new jr({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new Wr({context:this.context,units:"positive",value:t.harmonicity}),this.modulationIndex=new Wr({context:this.context,units:"positive",value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),ks(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(jr.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){return this._modulator.restart(t),this._carrier.restart(t),this}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return ts(this,void 0,void 0,(function*(){return Vr(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class Hr extends Or{constructor(){super(us(Hr.getDefaults(),arguments,["frequency","width"])),this.name="PulseOscillator",this._widthGate=new or({context:this.context,gain:0}),this._thresh=new Br({context:this.context,mapping:t=>t<=0?-1:1});const t=us(Hr.getDefaults(),arguments,["frequency","width"]);this.width=new ur({context:this.context,units:"audioRange",value:t.width}),this._triangle=new jr({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),ks(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(Or.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(t){t=this.toSeconds(t),this._triangle.start(t),this._widthGate.gain.setValueAtTime(1,t)}_stop(t){t=this.toSeconds(t),this._triangle.stop(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(0,t)}_restart(t){this._triangle.restart(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(1,t)}get phase(){return this._triangle.phase}set phase(t){this._triangle.phase=t}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(t){this._triangle.type=t}asArray(t=1024){return ts(this,void 0,void 0,(function*(){return Vr(this,t)}))}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class Xr extends Or{constructor(){super(us(Xr.getDefaults(),arguments,["frequency","type","spread"])),this.name="FatOscillator",this._oscillators=[];const t=us(Xr.getDefaults(),arguments,["frequency","type","spread"]);this.frequency=new ur({context:this.context,units:"frequency",value:t.frequency}),this.detune=new ur({context:this.context,units:"cents",value:t.detune}),this._spread=t.spread,this._type=t.type,this._phase=t.phase,this._partials=t.partials,this._partialCount=t.partialCount,this.count=t.count,ks(this,["frequency","detune"])}static getDefaults(){return Object.assign(jr.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(t){t=this.toSeconds(t),this._forEach((e=>e.start(t)))}_stop(t){t=this.toSeconds(t),this._forEach((e=>e.stop(t)))}_restart(t){this._forEach((e=>e.restart(t)))}_forEach(t){for(let e=0;e<this._oscillators.length;e++)t(this._oscillators[e],e)}get type(){return this._type}set type(t){this._type=t,this._forEach((e=>e.type=t))}get spread(){return this._spread}set spread(t){if(this._spread=t,this._oscillators.length>1){const e=-t/2,n=t/(this._oscillators.length-1);this._forEach(((t,i)=>t.detune.value=e+n*i))}}get count(){return this._oscillators.length}set count(t){if(Ii(t,1),this._oscillators.length!==t){this._forEach((t=>t.dispose())),this._oscillators=[];for(let e=0;e<t;e++){const n=new jr({context:this.context,volume:-6-1.1*t,type:this._type,phase:this._phase+e/t*360,partialCount:this._partialCount,onstop:0===e?()=>this.onstop(this):Ds});"custom"===this.type&&(n.partials=this._partials),this.frequency.connect(n.frequency),this.detune.connect(n.detune),n.detune.overridden=!1,n.connect(this.output),this._oscillators[e]=n}this.spread=this._spread,"started"===this.state&&this._forEach((t=>t.start()))}}get phase(){return this._phase}set phase(t){this._phase=t,this._forEach(((t,e)=>t.phase=this._phase+e/this.count*360))}get baseType(){return this._oscillators[0].baseType}set baseType(t){this._forEach((e=>e.baseType=t)),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this._type="custom",this._forEach((e=>e.partials=t)))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(t){this._partialCount=t,this._forEach((e=>e.partialCount=t)),this._type=this._oscillators[0].type}asArray(t=1024){return ts(this,void 0,void 0,(function*(){return Vr(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach((t=>t.dispose())),this}}class Zr extends Or{constructor(){super(us(Zr.getDefaults(),arguments,["frequency","modulationFrequency"])),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new Wr({context:this.context,value:2});const t=us(Zr.getDefaults(),arguments,["frequency","modulationFrequency"]);this._pulse=new Hr({context:this.context,frequency:t.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new jr({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),ks(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(Or.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(t){t=this.toSeconds(t),this._modulator.start(t),this._pulse.start(t)}_stop(t){t=this.toSeconds(t),this._modulator.stop(t),this._pulse.stop(t)}_restart(t){this._modulator.restart(t),this._pulse.restart(t)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(t){this._modulator.phase=t}asArray(t=1024){return ts(this,void 0,void 0,(function*(){return Vr(this,t)}))}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const $r={am:Gr,fat:Xr,fm:Yr,oscillator:jr,pulse:Hr,pwm:Zr};class Qr extends Or{constructor(){super(us(Qr.getDefaults(),arguments,["frequency","type"])),this.name="OmniOscillator";const t=us(Qr.getDefaults(),arguments,["frequency","type"]);this.frequency=new ur({context:this.context,units:"frequency",value:t.frequency}),this.detune=new ur({context:this.context,units:"cents",value:t.detune}),ks(this,["frequency","detune"]),this.set(t)}static getDefaults(){return Object.assign(jr.getDefaults(),Yr.getDefaults(),Gr.getDefaults(),Xr.getDefaults(),Hr.getDefaults(),Zr.getDefaults())}_start(t){this._oscillator.start(t)}_stop(t){this._oscillator.stop(t)}_restart(t){return this._oscillator.restart(t),this}get type(){let t="";return["am","fm","fat"].some((t=>this._sourceType===t))&&(t=this._sourceType),t+this._oscillator.type}set type(t){"fm"===t.substr(0,2)?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"am"===t.substr(0,2)?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"fat"===t.substr(0,3)?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(3)):"pwm"===t?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):"pulse"===t?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=t)}get partials(){return this._oscillator.partials}set partials(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partials=t)}get partialCount(){return this._oscillator.partialCount}set partialCount(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partialCount=t)}set(t){return Reflect.has(t,"type")&&t.type&&(this.type=t.type),super.set(t),this}_createNewOscillator(t){if(t!==this._sourceType){this._sourceType=t;const e=$r[t],n=this.now();if(this._oscillator){const t=this._oscillator;t.stop(n),this.context.setTimeout((()=>t.dispose()),this.blockTime)}this._oscillator=new e({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),"started"===this.state&&this._oscillator.start(n)}}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t}get sourceType(){return this._sourceType}set sourceType(t){let e="sine";"pwm"!==this._oscillator.type&&"pulse"!==this._oscillator.type&&(e=this._oscillator.type),"fm"===t?this.type="fm"+e:"am"===t?this.type="am"+e:"fat"===t?this.type="fat"+e:"oscillator"===t?this.type=e:"pulse"===t?this.type="pulse":"pwm"===t&&(this.type="pwm")}_getOscType(t,e){return t instanceof $r[e]}get baseType(){return this._oscillator.baseType}set baseType(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||"pulse"===t||"pwm"===t||(this._oscillator.baseType=t)}get width(){return this._getOscType(this._oscillator,"pulse")?this._oscillator.width:void 0}get count(){return this._getOscType(this._oscillator,"fat")?this._oscillator.count:void 0}set count(t){this._getOscType(this._oscillator,"fat")&&Gi(t)&&(this._oscillator.count=t)}get spread(){return this._getOscType(this._oscillator,"fat")?this._oscillator.spread:void 0}set spread(t){this._getOscType(this._oscillator,"fat")&&Gi(t)&&(this._oscillator.spread=t)}get modulationType(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.modulationType:void 0}set modulationType(t){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&Zi(t)&&(this._oscillator.modulationType=t)}get modulationIndex(){return this._getOscType(this._oscillator,"fm")?this._oscillator.modulationIndex:void 0}get harmonicity(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.harmonicity:void 0}get modulationFrequency(){return this._getOscType(this._oscillator,"pwm")?this._oscillator.modulationFrequency:void 0}asArray(t=1024){return ts(this,void 0,void 0,(function*(){return Vr(this,t)}))}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}class Jr extends ur{constructor(){super(Object.assign(us(Jr.getDefaults(),arguments,["value"]))),this.override=!1,this.name="Add",this._sum=new or({context:this.context}),this.input=this._sum,this.output=this._sum,this.addend=this._param,ir(this._constantSource,this._sum)}static getDefaults(){return Object.assign(ur.getDefaults(),{value:0})}dispose(){return super.dispose(),this._sum.dispose(),this}}class Kr extends Lr{constructor(){super(Object.assign(us(Kr.getDefaults(),arguments,["min","max"]))),this.name="Scale";const t=us(Kr.getDefaults(),arguments,["min","max"]);this._mult=this.input=new Wr({context:this.context,value:t.max-t.min}),this._add=this.output=new Jr({context:this.context,value:t.min}),this._min=t.min,this._max=t.max,this.input.connect(this.output)}static getDefaults(){return Object.assign(Lr.getDefaults(),{max:1,min:0})}get min(){return this._min}set min(t){this._min=t,this._setRange()}get max(){return this._max}set max(t){this._max=t,this._setRange()}_setRange(){this._add.value=this._min,this._mult.value=this._max-this._min}dispose(){return super.dispose(),this._add.dispose(),this._mult.dispose(),this}}class to extends Lr{constructor(){super(Object.assign(us(to.getDefaults(),arguments))),this.name="Zero",this._gain=new or({context:this.context}),this.output=this._gain,this.input=void 0,sr(this.context.getConstant(0),this._gain)}dispose(){return super.dispose(),rr(this.context.getConstant(0),this._gain),this}}class eo extends nr{constructor(){super(us(eo.getDefaults(),arguments,["frequency","min","max"])),this.name="LFO",this._stoppedValue=0,this._units="number",this.convert=!0,this._fromType=er.prototype._fromType,this._toType=er.prototype._toType,this._is=er.prototype._is,this._clampValue=er.prototype._clampValue;const t=us(eo.getDefaults(),arguments,["frequency","min","max"]);this._oscillator=new jr(t),this.frequency=this._oscillator.frequency,this._amplitudeGain=new or({context:this.context,gain:t.amplitude,units:"normalRange"}),this.amplitude=this._amplitudeGain.gain,this._stoppedSignal=new ur({context:this.context,units:"audioRange",value:0}),this._zeros=new to({context:this.context}),this._a2g=new Ur({context:this.context}),this._scaler=this.output=new Kr({context:this.context,max:t.max,min:t.min}),this.units=t.units,this.min=t.min,this.max=t.max,this._oscillator.chain(this._amplitudeGain,this._a2g,this._scaler),this._zeros.connect(this._a2g),this._stoppedSignal.connect(this._a2g),ks(this,["amplitude","frequency"]),this.phase=t.phase}static getDefaults(){return Object.assign(jr.getDefaults(),{amplitude:1,frequency:"4n",max:1,min:0,type:"sine",units:"number"})}start(t){return t=this.toSeconds(t),this._stoppedSignal.setValueAtTime(0,t),this._oscillator.start(t),this}stop(t){return t=this.toSeconds(t),this._stoppedSignal.setValueAtTime(this._stoppedValue,t),this._oscillator.stop(t),this}sync(){return this._oscillator.sync(),this._oscillator.syncFrequency(),this}unsync(){return this._oscillator.unsync(),this._oscillator.unsyncFrequency(),this}_setStoppedValue(){this._stoppedValue=this._oscillator.getInitialValue(),this._stoppedSignal.value=this._stoppedValue}get min(){return this._toType(this._scaler.min)}set min(t){t=this._fromType(t),this._scaler.min=t}get max(){return this._toType(this._scaler.max)}set max(t){t=this._fromType(t),this._scaler.max=t}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t,this._setStoppedValue()}get partials(){return this._oscillator.partials}set partials(t){this._oscillator.partials=t,this._setStoppedValue()}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t,this._setStoppedValue()}get units(){return this._units}set units(t){const e=this.min,n=this.max;this._units=t,this.min=e,this.max=n}get state(){return this._oscillator.state}connect(t,e,n){return(t instanceof er||t instanceof ur)&&(this.convert=t.convert,this.units=t.units),lr(this,t,e,n),this}dispose(){return super.dispose(),this._oscillator.dispose(),this._stoppedSignal.dispose(),this._zeros.dispose(),this._scaler.dispose(),this._a2g.dispose(),this._amplitudeGain.dispose(),this.amplitude.dispose(),this}}function no(t,e=1/0){const n=new WeakMap;return function(i,s){Reflect.defineProperty(i,s,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(i){Ii(i,t,e),n.set(this,i)}})}}function io(t,e=1/0){const n=new WeakMap;return function(i,s){Reflect.defineProperty(i,s,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(i){Ii(this.toSeconds(i),t,e),n.set(this,i)}})}}class so extends Or{constructor(){super(us(so.getDefaults(),arguments,["url","onload"])),this.name="Player",this._activeSources=new Set;const t=us(so.getDefaults(),arguments,["url","onload"]);this._buffer=new Es({onload:this._onload.bind(this,t.onload),onerror:t.onerror,reverse:t.reverse,url:t.url}),this.autostart=t.autostart,this._loop=t.loop,this._loopStart=t.loopStart,this._loopEnd=t.loopEnd,this._playbackRate=t.playbackRate,this.fadeIn=t.fadeIn,this.fadeOut=t.fadeOut}static getDefaults(){return Object.assign(Or.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:Ds,onerror:Ds,playbackRate:1,reverse:!1})}load(t){return ts(this,void 0,void 0,(function*(){return yield this._buffer.load(t),this._onload(),this}))}_onload(t=Ds){t(),this.autostart&&this.start()}_onSourceEnd(t){this.onstop(this),this._activeSources.delete(t),0!==this._activeSources.size||this._synced||"started"!==this._state.getValueAtTime(this.now())||(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(t,e,n){return super.start(t,e,n),this}_start(t,e,n){e=this._loop?ls(e,this._loopStart):ls(e,0);const i=this.toSeconds(e),s=n;n=ls(n,Math.max(this._buffer.duration-i,0));let r=this.toSeconds(n);r/=this._playbackRate,t=this.toSeconds(t);const o=new Rr({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);this._loop||this._synced||(this._state.cancel(t+r),this._state.setStateAtTime("stopped",t+r,{implicitEnd:!0})),this._activeSources.add(o),this._loop&&Bi(s)?o.start(t,i):o.start(t,i,r-this.toSeconds(this.fadeOut))}_stop(t){const e=this.toSeconds(t);this._activeSources.forEach((t=>t.stop(e)))}restart(t,e,n){return super.restart(t,e,n),this}_restart(t,e,n){this._stop(t),this._start(t,e,n)}seek(t,e){const n=this.toSeconds(e);if("started"===this._state.getValueAtTime(n)){const e=this.toSeconds(t);this._stop(n),this._start(n,e)}return this}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get loopStart(){return this._loopStart}set loopStart(t){this._loopStart=t,this.buffer.loaded&&Ii(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach((e=>{e.loopStart=t}))}get loopEnd(){return this._loopEnd}set loopEnd(t){this._loopEnd=t,this.buffer.loaded&&Ii(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach((e=>{e.loopEnd=t}))}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._loop}set loop(t){if(this._loop!==t&&(this._loop=t,this._activeSources.forEach((e=>{e.loop=t})),t)){const t=this._state.getNextState("stopped",this.now());t&&this._state.cancel(t.time)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t;const e=this.now(),n=this._state.getNextState("stopped",e);n&&n.implicitEnd&&(this._state.cancel(n.time),this._activeSources.forEach((t=>t.cancelStop()))),this._activeSources.forEach((n=>{n.playbackRate.setValueAtTime(t,e)}))}get reverse(){return this._buffer.reverse}set reverse(t){this._buffer.reverse=t}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach((t=>t.dispose())),this._activeSources.clear(),this._buffer.dispose(),this}}Ki([io(0)],so.prototype,"fadeIn",void 0),Ki([io(0)],so.prototype,"fadeOut",void 0);class ro extends nr{constructor(){super(us(ro.getDefaults(),arguments,["urls","onload"],"urls")),this.name="Players",this.input=void 0,this._players=new Map;const t=us(ro.getDefaults(),arguments,["urls","onload"],"urls");this._volume=this.output=new Sr({context:this.context,volume:t.volume}),this.volume=this._volume.volume,ks(this,"volume"),this._buffers=new gr({urls:t.urls,onload:t.onload,baseUrl:t.baseUrl,onerror:t.onerror}),this.mute=t.mute,this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut}static getDefaults(){return Object.assign(Or.getDefaults(),{baseUrl:"",fadeIn:0,fadeOut:0,mute:!1,onload:Ds,onerror:Ds,urls:{},volume:0})}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t,this._players.forEach((e=>{e.fadeIn=t}))}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t,this._players.forEach((e=>{e.fadeOut=t}))}get state(){return Array.from(this._players).some((([t,e])=>"started"===e.state))?"started":"stopped"}has(t){return this._buffers.has(t)}player(t){if(Fi(this.has(t),`No Player with the name ${t} exists on this object`),!this._players.has(t)){const e=new so({context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,url:this._buffers.get(t)}).connect(this.output);this._players.set(t,e)}return this._players.get(t)}get loaded(){return this._buffers.loaded}add(t,e,n){return Fi(!this._buffers.has(t),"A buffer with that name already exists on this object"),this._buffers.add(t,e,n),this}stopAll(t){return this._players.forEach((e=>e.stop(t))),this}dispose(){return super.dispose(),this._volume.dispose(),this.volume.dispose(),this._players.forEach((t=>t.dispose())),this._buffers.dispose(),this}}class oo extends Or{constructor(){super(us(oo.getDefaults(),arguments,["url","onload"])),this.name="GrainPlayer",this._loopStart=0,this._loopEnd=0,this._activeSources=[];const t=us(oo.getDefaults(),arguments,["url","onload"]);this.buffer=new Es({onload:t.onload,onerror:t.onerror,reverse:t.reverse,url:t.url}),this._clock=new pr({context:this.context,callback:this._tick.bind(this),frequency:1/t.grainSize}),this._playbackRate=t.playbackRate,this._grainSize=t.grainSize,this._overlap=t.overlap,this.detune=t.detune,this.overlap=t.overlap,this.loop=t.loop,this.playbackRate=t.playbackRate,this.grainSize=t.grainSize,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this.reverse=t.reverse,this._clock.on("stop",this._onstop.bind(this))}static getDefaults(){return Object.assign(Or.getDefaults(),{onload:Ds,onerror:Ds,overlap:.1,grainSize:.2,playbackRate:1,detune:0,loop:!1,loopStart:0,loopEnd:0,reverse:!1})}_start(t,e,n){e=ls(e,0),e=this.toSeconds(e),t=this.toSeconds(t);const i=1/this._clock.frequency.getValueAtTime(t);this._clock.start(t,e/i),n&&this.stop(t+this.toSeconds(n))}restart(t,e,n){return super.restart(t,e,n),this}_restart(t,e,n){this._stop(t),this._start(t,e,n)}_stop(t){this._clock.stop(t)}_onstop(t){this._activeSources.forEach((e=>{e.fadeOut=0,e.stop(t)})),this.onstop(this)}_tick(t){const e=this._clock.getTicksAtTime(t),n=e*this._grainSize;if(this.log("offset",n),!this.loop&&n>this.buffer.duration)return void this.stop(t);const i=n<this._overlap?0:this._overlap,s=new Rr({context:this.context,url:this.buffer,fadeIn:i,fadeOut:this._overlap,loop:this.loop,loopStart:this._loopStart,loopEnd:this._loopEnd,playbackRate:zs(this.detune/100)}).connect(this.output);s.start(t,this._grainSize*e),s.stop(t+this._grainSize/this.playbackRate),this._activeSources.push(s),s.onended=()=>{const t=this._activeSources.indexOf(s);-1!==t&&this._activeSources.splice(t,1)}}get playbackRate(){return this._playbackRate}set playbackRate(t){Ii(t,.001),this._playbackRate=t,this.grainSize=this._grainSize}get loopStart(){return this._loopStart}set loopStart(t){this.buffer.loaded&&Ii(this.toSeconds(t),0,this.buffer.duration),this._loopStart=this.toSeconds(t)}get loopEnd(){return this._loopEnd}set loopEnd(t){this.buffer.loaded&&Ii(this.toSeconds(t),0,this.buffer.duration),this._loopEnd=this.toSeconds(t)}get reverse(){return this.buffer.reverse}set reverse(t){this.buffer.reverse=t}get grainSize(){return this._grainSize}set grainSize(t){this._grainSize=this.toSeconds(t),this._clock.frequency.setValueAtTime(this._playbackRate/this._grainSize,this.now())}get overlap(){return this._overlap}set overlap(t){const e=this.toSeconds(t);Ii(e,0),this._overlap=e}get loaded(){return this.buffer.loaded}dispose(){return super.dispose(),this.buffer.dispose(),this._clock.dispose(),this._activeSources.forEach((t=>t.dispose())),this}}class ao extends Lr{constructor(){super(...arguments),this.name="Abs",this._abs=new Br({context:this.context,mapping:t=>Math.abs(t)<.001?0:Math.abs(t)}),this.input=this._abs,this.output=this._abs}dispose(){return super.dispose(),this._abs.dispose(),this}}class co extends Lr{constructor(){super(...arguments),this.name="GainToAudio",this._norm=new Br({context:this.context,mapping:t=>2*Math.abs(t)-1}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class uo extends Lr{constructor(){super(...arguments),this.name="Negate",this._multiply=new Wr({context:this.context,value:-1}),this.input=this._multiply,this.output=this._multiply}dispose(){return super.dispose(),this._multiply.dispose(),this}}class lo extends ur{constructor(){super(Object.assign(us(lo.getDefaults(),arguments,["value"]))),this.override=!1,this.name="Subtract",this._sum=new or({context:this.context}),this.input=this._sum,this.output=this._sum,this._neg=new uo({context:this.context}),this.subtrahend=this._param,ir(this._constantSource,this._neg,this._sum)}static getDefaults(){return Object.assign(ur.getDefaults(),{value:0})}dispose(){return super.dispose(),this._neg.dispose(),this._sum.dispose(),this}}class ho extends Lr{constructor(){super(Object.assign(us(ho.getDefaults(),arguments))),this.name="GreaterThanZero",this._thresh=this.output=new Br({context:this.context,length:127,mapping:t=>t<=0?0:1}),this._scale=this.input=new Wr({context:this.context,value:1e4}),this._scale.connect(this._thresh)}dispose(){return super.dispose(),this._scale.dispose(),this._thresh.dispose(),this}}class fo extends ur{constructor(){super(Object.assign(us(fo.getDefaults(),arguments,["value"]))),this.name="GreaterThan",this.override=!1;const t=us(fo.getDefaults(),arguments,["value"]);this._subtract=this.input=new lo({context:this.context,value:t.value}),this._gtz=this.output=new ho({context:this.context}),this.comparator=this._param=this._subtract.subtrahend,ks(this,"comparator"),this._subtract.connect(this._gtz)}static getDefaults(){return Object.assign(ur.getDefaults(),{value:0})}dispose(){return super.dispose(),this._gtz.dispose(),this._subtract.dispose(),this.comparator.dispose(),this}}class po extends Lr{constructor(){super(Object.assign(us(po.getDefaults(),arguments,["value"]))),this.name="Pow";const t=us(po.getDefaults(),arguments,["value"]);this._exponentScaler=this.input=this.output=new Br({context:this.context,mapping:this._expFunc(t.value),length:8192}),this._exponent=t.value}static getDefaults(){return Object.assign(Lr.getDefaults(),{value:1})}_expFunc(t){return e=>Math.pow(Math.abs(e),t)}get value(){return this._exponent}set value(t){this._exponent=t,this._exponentScaler.setMap(this._expFunc(this._exponent))}dispose(){return super.dispose(),this._exponentScaler.dispose(),this}}class _o extends Kr{constructor(){super(Object.assign(us(_o.getDefaults(),arguments,["min","max","exponent"]))),this.name="ScaleExp";const t=us(_o.getDefaults(),arguments,["min","max","exponent"]);this.input=this._exp=new po({context:this.context,value:t.exponent}),this._exp.connect(this._mult)}static getDefaults(){return Object.assign(Kr.getDefaults(),{exponent:1})}get exponent(){return this._exp.value}set exponent(t){this._exp.value=t}dispose(){return super.dispose(),this._exp.dispose(),this}}class mo extends ur{constructor(){super(us(ur.getDefaults(),arguments,["value","units"])),this.name="SyncedSignal",this.override=!1;const t=us(ur.getDefaults(),arguments,["value","units"]);this._lastVal=t.value,this._synced=this.context.transport.scheduleRepeat(this._onTick.bind(this),"1i"),this._syncedCallback=this._anchorValue.bind(this),this.context.transport.on("start",this._syncedCallback),this.context.transport.on("pause",this._syncedCallback),this.context.transport.on("stop",this._syncedCallback),this._constantSource.disconnect(),this._constantSource.stop(0),this._constantSource=this.output=new cr({context:this.context,offset:t.value,units:t.units}).start(0),this.setValueAtTime(t.value,0)}_onTick(t){const e=super.getValueAtTime(this.context.transport.seconds);this._lastVal!==e&&(this._lastVal=e,this._constantSource.offset.setValueAtTime(e,t))}_anchorValue(t){const e=super.getValueAtTime(this.context.transport.seconds);this._lastVal=e,this._constantSource.offset.cancelAndHoldAtTime(t),this._constantSource.offset.setValueAtTime(e,t)}getValueAtTime(t){const e=new Qs(this.context,t).toSeconds();return super.getValueAtTime(e)}setValueAtTime(t,e){const n=new Qs(this.context,e).toSeconds();return super.setValueAtTime(t,n),this}linearRampToValueAtTime(t,e){const n=new Qs(this.context,e).toSeconds();return super.linearRampToValueAtTime(t,n),this}exponentialRampToValueAtTime(t,e){const n=new Qs(this.context,e).toSeconds();return super.exponentialRampToValueAtTime(t,n),this}setTargetAtTime(t,e,n){const i=new Qs(this.context,e).toSeconds();return super.setTargetAtTime(t,i,n),this}cancelScheduledValues(t){const e=new Qs(this.context,t).toSeconds();return super.cancelScheduledValues(e),this}setValueCurveAtTime(t,e,n,i){const s=new Qs(this.context,e).toSeconds();return n=this.toSeconds(n),super.setValueCurveAtTime(t,s,n,i),this}cancelAndHoldAtTime(t){const e=new Qs(this.context,t).toSeconds();return super.cancelAndHoldAtTime(e),this}setRampPoint(t){const e=new Qs(this.context,t).toSeconds();return super.setRampPoint(e),this}exponentialRampTo(t,e,n){const i=new Qs(this.context,n).toSeconds();return super.exponentialRampTo(t,e,i),this}linearRampTo(t,e,n){const i=new Qs(this.context,n).toSeconds();return super.linearRampTo(t,e,i),this}targetRampTo(t,e,n){const i=new Qs(this.context,n).toSeconds();return super.targetRampTo(t,e,i),this}dispose(){return super.dispose(),this.context.transport.clear(this._synced),this.context.transport.off("start",this._syncedCallback),this.context.transport.off("pause",this._syncedCallback),this.context.transport.off("stop",this._syncedCallback),this._constantSource.dispose(),this}}class go extends nr{constructor(){super(us(go.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="Envelope",this._sig=new ur({context:this.context,value:0}),this.output=this._sig,this.input=void 0;const t=us(go.getDefaults(),arguments,["attack","decay","sustain","release"]);this.attack=t.attack,this.decay=t.decay,this.sustain=t.sustain,this.release=t.release,this.attackCurve=t.attackCurve,this.releaseCurve=t.releaseCurve,this.decayCurve=t.decayCurve}static getDefaults(){return Object.assign(nr.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(t,e){if(Zi(t))return t;{let n;for(n in vo)if(vo[n][e]===t)return n;return t}}_setCurve(t,e,n){if(Zi(n)&&Reflect.has(vo,n)){const i=vo[n];Yi(i)?"_decayCurve"!==t&&(this[t]=i[e]):this[t]=i}else{if(!Xi(n)||"_decayCurve"===t)throw new Error("Envelope: invalid curve: "+n);this[t]=n}}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(t){this._setCurve("_attackCurve","In",t)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(t){this._setCurve("_releaseCurve","Out",t)}get decayCurve(){return this._decayCurve}set decayCurve(t){Fi(["linear","exponential"].some((e=>e===t)),`Invalid envelope curve: ${t}`),this._decayCurve=t}triggerAttack(t,e=1){this.log("triggerAttack",t,e),t=this.toSeconds(t);let n=this.toSeconds(this.attack);const i=this.toSeconds(this.decay),s=this.getValueAtTime(t);if(s>0&&(n=(1-s)/(1/n)),n<this.sampleTime)this._sig.cancelScheduledValues(t),this._sig.setValueAtTime(e,t);else if("linear"===this._attackCurve)this._sig.linearRampTo(e,n,t);else if("exponential"===this._attackCurve)this._sig.targetRampTo(e,n,t);else{this._sig.cancelAndHoldAtTime(t);let i=this._attackCurve;for(let t=1;t<i.length;t++)if(i[t-1]<=s&&s<=i[t]){i=this._attackCurve.slice(t),i[0]=s;break}this._sig.setValueCurveAtTime(i,t,n,e)}if(i&&this.sustain<1){const s=e*this.sustain,r=t+n;this.log("decay",r),"linear"===this._decayCurve?this._sig.linearRampToValueAtTime(s,i+r):this._sig.exponentialApproachValueAtTime(s,r,i)}return this}triggerRelease(t){this.log("triggerRelease",t),t=this.toSeconds(t);const e=this.getValueAtTime(t);if(e>0){const n=this.toSeconds(this.release);n<this.sampleTime?this._sig.setValueAtTime(0,t):"linear"===this._releaseCurve?this._sig.linearRampTo(0,n,t):"exponential"===this._releaseCurve?this._sig.targetRampTo(0,n,t):(Fi(Xi(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(t),this._sig.setValueCurveAtTime(this._releaseCurve,t,n,e))}return this}getValueAtTime(t){return this._sig.getValueAtTime(t)}triggerAttackRelease(t,e,n=1){return e=this.toSeconds(e),this.triggerAttack(e,n),this.triggerRelease(e+this.toSeconds(t)),this}cancel(t){return this._sig.cancelScheduledValues(this.toSeconds(t)),this}connect(t,e=0,n=0){return lr(this,t,e,n),this}asArray(t=1024){return ts(this,void 0,void 0,(function*(){const e=t/this.context.sampleRate,n=new Os(1,e,this.context.sampleRate),i=this.toSeconds(this.attack)+this.toSeconds(this.decay),s=i+this.toSeconds(this.release),r=.1*s,o=s+r,a=new this.constructor(Object.assign(this.get(),{attack:e*this.toSeconds(this.attack)/o,decay:e*this.toSeconds(this.decay)/o,release:e*this.toSeconds(this.release)/o,context:n}));return a._sig.toDestination(),a.triggerAttackRelease(e*(i+r)/o,0),(yield n.render()).getChannelData(0)}))}dispose(){return super.dispose(),this._sig.dispose(),this}}Ki([io(0)],go.prototype,"attack",void 0),Ki([io(0)],go.prototype,"decay",void 0),Ki([no(0,1)],go.prototype,"sustain",void 0),Ki([io(0)],go.prototype,"release",void 0);const vo=(()=>{const t=128;let e,n;const i=[];for(e=0;e<t;e++)i[e]=Math.sin(e/127*(Math.PI/2));const s=[];for(e=0;e<127;e++){n=e/127;const t=Math.sin(n*(2*Math.PI)*6.4-Math.PI/2)+1;s[e]=t/10+.83*n}s[127]=1;const r=[];for(e=0;e<t;e++)r[e]=Math.ceil(e/127*5)/5;const o=[];for(e=0;e<t;e++)n=e/127,o[e]=.5*(1-Math.cos(Math.PI*n));const a=[];for(e=0;e<t;e++){n=e/127;const t=4*Math.pow(n,3)+.2,i=Math.cos(t*Math.PI*2*n);a[e]=Math.abs(i*(1-n))}function c(t){const e=new Array(t.length);for(let n=0;n<t.length;n++)e[n]=1-t[n];return e}return{bounce:{In:c(a),Out:a},cosine:{In:i,Out:(u=i,u.slice(0).reverse())},exponential:"exponential",linear:"linear",ripple:{In:s,Out:c(s)},sine:{In:o,Out:c(o)},step:{In:r,Out:c(r)}};var u})();class yo extends nr{constructor(){super(us(yo.getDefaults(),arguments)),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease;const t=us(yo.getDefaults(),arguments);this._volume=this.output=new Sr({context:this.context,volume:t.volume}),this.volume=this._volume.volume,ks(this,"volume")}static getDefaults(){return Object.assign(nr.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0)),this}_syncState(){let t=!1;return this._synced||(this._synced=!0,t=!0),t}_syncMethod(t,e){const n=this["_original_"+t]=this[t];this[t]=(...t)=>{const i=t[e],s=this.context.transport.schedule((i=>{t[e]=i,n.apply(this,t)}),i);this._scheduledEvents.push(s)}}unsync(){return this._scheduledEvents.forEach((t=>this.context.transport.clear(t))),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease),this}triggerAttackRelease(t,e,n,i){const s=this.toSeconds(n),r=this.toSeconds(e);return this.triggerAttack(t,s,i),this.triggerRelease(s+r),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class bo extends yo{constructor(){super(us(bo.getDefaults(),arguments));const t=us(bo.getDefaults(),arguments);this.portamento=t.portamento,this.onsilence=t.onsilence}static getDefaults(){return Object.assign(yo.getDefaults(),{detune:0,onsilence:Ds,portamento:0})}triggerAttack(t,e,n=1){this.log("triggerAttack",t,e,n);const i=this.toSeconds(e);return this._triggerEnvelopeAttack(i,n),this.setNote(t,i),this}triggerRelease(t){this.log("triggerRelease",t);const e=this.toSeconds(t);return this._triggerEnvelopeRelease(e),this}setNote(t,e){const n=this.toSeconds(e),i=t instanceof Hs?t.toFrequency():t;if(this.portamento>0&&this.getLevelAtTime(n)>.05){const t=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(i,t,n)}else this.frequency.setValueAtTime(i,n);return this}}Ki([io(0)],bo.prototype,"portamento",void 0);class xo extends go{constructor(){super(us(xo.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new or({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class wo extends bo{constructor(){super(us(wo.getDefaults(),arguments)),this.name="Synth";const t=us(wo.getDefaults(),arguments);this.oscillator=new Qr(Object.assign({context:this.context,detune:t.detune,onstop:()=>this.onsilence(this)},t.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new xo(Object.assign({context:this.context},t.envelope)),this.oscillator.chain(this.envelope,this.output),ks(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(bo.getDefaults(),{envelope:Object.assign(hs(go.getDefaults(),Object.keys(nr.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(hs(Qr.getDefaults(),[...Object.keys(Or.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(t,e){if(this.envelope.triggerAttack(t,e),this.oscillator.start(t),0===this.envelope.sustain){const e=this.toSeconds(this.envelope.attack),n=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+e+n)}}_triggerEnvelopeRelease(t){this.envelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class To extends bo{constructor(){super(us(To.getDefaults(),arguments)),this.name="ModulationSynth";const t=us(To.getDefaults(),arguments);this._carrier=new wo({context:this.context,oscillator:t.oscillator,envelope:t.envelope,onsilence:()=>this.onsilence(this),volume:-10}),this._modulator=new wo({context:this.context,oscillator:t.modulation,envelope:t.modulationEnvelope,volume:-10}),this.oscillator=this._carrier.oscillator,this.envelope=this._carrier.envelope,this.modulation=this._modulator.oscillator,this.modulationEnvelope=this._modulator.envelope,this.frequency=new ur({context:this.context,units:"frequency"}),this.detune=new ur({context:this.context,value:t.detune,units:"cents"}),this.harmonicity=new Wr({context:this.context,value:t.harmonicity,minValue:0}),this._modulationNode=new or({context:this.context,gain:0}),ks(this,["frequency","harmonicity","oscillator","envelope","modulation","modulationEnvelope","detune"])}static getDefaults(){return Object.assign(bo.getDefaults(),{harmonicity:3,oscillator:Object.assign(hs(Qr.getDefaults(),[...Object.keys(Or.getDefaults()),"frequency","detune"]),{type:"sine"}),envelope:Object.assign(hs(go.getDefaults(),Object.keys(nr.getDefaults())),{attack:.01,decay:.01,sustain:1,release:.5}),modulation:Object.assign(hs(Qr.getDefaults(),[...Object.keys(Or.getDefaults()),"frequency","detune"]),{type:"square"}),modulationEnvelope:Object.assign(hs(go.getDefaults(),Object.keys(nr.getDefaults())),{attack:.5,decay:0,sustain:1,release:.5})})}_triggerEnvelopeAttack(t,e){this._carrier._triggerEnvelopeAttack(t,e),this._modulator._triggerEnvelopeAttack(t,e)}_triggerEnvelopeRelease(t){return this._carrier._triggerEnvelopeRelease(t),this._modulator._triggerEnvelopeRelease(t),this}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this._carrier.dispose(),this._modulator.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._modulationNode.dispose(),this}}class Mo extends To{constructor(){super(us(Mo.getDefaults(),arguments)),this.name="AMSynth",this._modulationScale=new Ur({context:this.context}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output)}dispose(){return super.dispose(),this._modulationScale.dispose(),this}}class So extends nr{constructor(){super(us(So.getDefaults(),arguments,["frequency","type"])),this.name="BiquadFilter";const t=us(So.getDefaults(),arguments,["frequency","type"]);this._filter=this.context.createBiquadFilter(),this.input=this.output=this._filter,this.Q=new er({context:this.context,units:"number",value:t.Q,param:this._filter.Q}),this.frequency=new er({context:this.context,units:"frequency",value:t.frequency,param:this._filter.frequency}),this.detune=new er({context:this.context,units:"cents",value:t.detune,param:this._filter.detune}),this.gain=new er({context:this.context,units:"decibels",convert:!1,value:t.gain,param:this._filter.gain}),this.type=t.type}static getDefaults(){return Object.assign(nr.getDefaults(),{Q:1,type:"lowpass",frequency:350,detune:0,gain:0})}get type(){return this._filter.type}set type(t){Fi(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(t),`Invalid filter type: ${t}`),this._filter.type=t}getFrequencyResponse(t=128){const e=new Float32Array(t);for(let n=0;n<t;n++){const i=19980*Math.pow(n/t,2)+20;e[n]=i}const n=new Float32Array(t),i=new Float32Array(t),s=this.context.createBiquadFilter();return s.type=this.type,s.Q.value=this.Q.value,s.frequency.value=this.frequency.value,s.gain.value=this.gain.value,s.getFrequencyResponse(e,n,i),n}dispose(){return super.dispose(),this._filter.disconnect(),this.Q.dispose(),this.frequency.dispose(),this.gain.dispose(),this.detune.dispose(),this}}class Ao extends nr{constructor(){super(us(Ao.getDefaults(),arguments,["frequency","type","rolloff"])),this.name="Filter",this.input=new or({context:this.context}),this.output=new or({context:this.context}),this._filters=[];const t=us(Ao.getDefaults(),arguments,["frequency","type","rolloff"]);this._filters=[],this.Q=new ur({context:this.context,units:"positive",value:t.Q}),this.frequency=new ur({context:this.context,units:"frequency",value:t.frequency}),this.detune=new ur({context:this.context,units:"cents",value:t.detune}),this.gain=new ur({context:this.context,units:"decibels",convert:!1,value:t.gain}),this._type=t.type,this.rolloff=t.rolloff,ks(this,["detune","frequency","gain","Q"])}static getDefaults(){return Object.assign(nr.getDefaults(),{Q:1,detune:0,frequency:350,gain:0,rolloff:-12,type:"lowpass"})}get type(){return this._type}set type(t){Fi(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(t),`Invalid filter type: ${t}`),this._type=t,this._filters.forEach((e=>e.type=t))}get rolloff(){return this._rolloff}set rolloff(t){const e=Gi(t)?t:parseInt(t,10),n=[-12,-24,-48,-96];let i=n.indexOf(e);Fi(-1!==i,`rolloff can only be ${n.join(", ")}`),i+=1,this._rolloff=e,this.input.disconnect(),this._filters.forEach((t=>t.disconnect())),this._filters=new Array(i);for(let t=0;t<i;t++){const e=new So({context:this.context});e.type=this._type,this.frequency.connect(e.frequency),this.detune.connect(e.detune),this.Q.connect(e.Q),this.gain.connect(e.gain),this._filters[t]=e}this._internalChannels=this._filters,ir(this.input,...this._internalChannels,this.output)}getFrequencyResponse(t=128){const e=new So({frequency:this.frequency.value,gain:this.gain.value,Q:this.Q.value,type:this._type,detune:this.detune.value}),n=new Float32Array(t).map((()=>1));return this._filters.forEach((()=>{e.getFrequencyResponse(t).forEach(((t,e)=>n[e]*=t))})),e.dispose(),n}dispose(){return super.dispose(),this._filters.forEach((t=>{t.dispose()})),Cs(this,["detune","frequency","gain","Q"]),this.frequency.dispose(),this.Q.dispose(),this.detune.dispose(),this.gain.dispose(),this}}class ko extends go{constructor(){super(us(ko.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="FrequencyEnvelope";const t=us(ko.getDefaults(),arguments,["attack","decay","sustain","release"]);this._octaves=t.octaves,this._baseFrequency=this.toFrequency(t.baseFrequency),this._exponent=this.input=new po({context:this.context,value:t.exponent}),this._scale=this.output=new Kr({context:this.context,min:this._baseFrequency,max:this._baseFrequency*Math.pow(2,this._octaves)}),this._sig.chain(this._exponent,this._scale)}static getDefaults(){return Object.assign(go.getDefaults(),{baseFrequency:200,exponent:1,octaves:4})}get baseFrequency(){return this._baseFrequency}set baseFrequency(t){const e=this.toFrequency(t);Ii(e,0),this._baseFrequency=e,this._scale.min=this._baseFrequency,this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(t){this._octaves=t,this._scale.max=this._baseFrequency*Math.pow(2,t)}get exponent(){return this._exponent.value}set exponent(t){this._exponent.value=t}dispose(){return super.dispose(),this._exponent.dispose(),this._scale.dispose(),this}}class Co extends bo{constructor(){super(us(Co.getDefaults(),arguments)),this.name="MonoSynth";const t=us(Co.getDefaults(),arguments);this.oscillator=new Qr(Object.assign(t.oscillator,{context:this.context,detune:t.detune,onstop:()=>this.onsilence(this)})),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.filter=new Ao(Object.assign(t.filter,{context:this.context})),this.filterEnvelope=new ko(Object.assign(t.filterEnvelope,{context:this.context})),this.envelope=new xo(Object.assign(t.envelope,{context:this.context})),this.oscillator.chain(this.filter,this.envelope,this.output),this.filterEnvelope.connect(this.filter.frequency),ks(this,["oscillator","frequency","detune","filter","filterEnvelope","envelope"])}static getDefaults(){return Object.assign(bo.getDefaults(),{envelope:Object.assign(hs(go.getDefaults(),Object.keys(nr.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.9}),filter:Object.assign(hs(Ao.getDefaults(),Object.keys(nr.getDefaults())),{Q:1,rolloff:-12,type:"lowpass"}),filterEnvelope:Object.assign(hs(ko.getDefaults(),Object.keys(nr.getDefaults())),{attack:.6,baseFrequency:200,decay:.2,exponent:2,octaves:3,release:2,sustain:.5}),oscillator:Object.assign(hs(Qr.getDefaults(),Object.keys(Or.getDefaults())),{type:"sawtooth"})})}_triggerEnvelopeAttack(t,e=1){if(this.envelope.triggerAttack(t,e),this.filterEnvelope.triggerAttack(t),this.oscillator.start(t),0===this.envelope.sustain){const e=this.toSeconds(this.envelope.attack),n=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+e+n)}}_triggerEnvelopeRelease(t){this.envelope.triggerRelease(t),this.filterEnvelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this.filterEnvelope.dispose(),this.filter.dispose(),this}}class Do extends bo{constructor(){super(us(Do.getDefaults(),arguments)),this.name="DuoSynth";const t=us(Do.getDefaults(),arguments);this.voice0=new Co(Object.assign(t.voice0,{context:this.context,onsilence:()=>this.onsilence(this)})),this.voice1=new Co(Object.assign(t.voice1,{context:this.context})),this.harmonicity=new Wr({context:this.context,units:"positive",value:t.harmonicity}),this._vibrato=new eo({frequency:t.vibratoRate,context:this.context,min:-50,max:50}),this._vibrato.start(),this.vibratoRate=this._vibrato.frequency,this._vibratoGain=new or({context:this.context,units:"normalRange",gain:t.vibratoAmount}),this.vibratoAmount=this._vibratoGain.gain,this.frequency=new ur({context:this.context,units:"frequency",value:440}),this.detune=new ur({context:this.context,units:"cents",value:t.detune}),this.frequency.connect(this.voice0.frequency),this.frequency.chain(this.harmonicity,this.voice1.frequency),this._vibrato.connect(this._vibratoGain),this._vibratoGain.fan(this.voice0.detune,this.voice1.detune),this.detune.fan(this.voice0.detune,this.voice1.detune),this.voice0.connect(this.output),this.voice1.connect(this.output),ks(this,["voice0","voice1","frequency","vibratoAmount","vibratoRate"])}getLevelAtTime(t){return t=this.toSeconds(t),this.voice0.envelope.getValueAtTime(t)+this.voice1.envelope.getValueAtTime(t)}static getDefaults(){return cs(bo.getDefaults(),{vibratoAmount:.5,vibratoRate:5,harmonicity:1.5,voice0:cs(hs(Co.getDefaults(),Object.keys(bo.getDefaults())),{filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}}),voice1:cs(hs(Co.getDefaults(),Object.keys(bo.getDefaults())),{filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}})})}_triggerEnvelopeAttack(t,e){this.voice0._triggerEnvelopeAttack(t,e),this.voice1._triggerEnvelopeAttack(t,e)}_triggerEnvelopeRelease(t){return this.voice0._triggerEnvelopeRelease(t),this.voice1._triggerEnvelopeRelease(t),this}dispose(){return super.dispose(),this.voice0.dispose(),this.voice1.dispose(),this.frequency.dispose(),this.detune.dispose(),this._vibrato.dispose(),this.vibratoRate.dispose(),this._vibratoGain.dispose(),this.harmonicity.dispose(),this}}class Eo extends To{constructor(){super(us(Eo.getDefaults(),arguments)),this.name="FMSynth";const t=us(Eo.getDefaults(),arguments);this.modulationIndex=new Wr({context:this.context,value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output)}static getDefaults(){return Object.assign(To.getDefaults(),{modulationIndex:10})}dispose(){return super.dispose(),this.modulationIndex.dispose(),this}}const Oo=[1,1.483,1.932,2.546,2.63,3.897];class Ro extends bo{constructor(){super(us(Ro.getDefaults(),arguments)),this.name="MetalSynth",this._oscillators=[],this._freqMultipliers=[];const t=us(Ro.getDefaults(),arguments);this.detune=new ur({context:this.context,units:"cents",value:t.detune}),this.frequency=new ur({context:this.context,units:"frequency"}),this._amplitude=new or({context:this.context,gain:0}).connect(this.output),this._highpass=new Ao({Q:0,context:this.context,type:"highpass"}).connect(this._amplitude);for(let e=0;e<Oo.length;e++){const n=new Yr({context:this.context,harmonicity:t.harmonicity,modulationIndex:t.modulationIndex,modulationType:"square",onstop:0===e?()=>this.onsilence(this):Ds,type:"square"});n.connect(this._highpass),this._oscillators[e]=n;const i=new Wr({context:this.context,value:Oo[e]});this._freqMultipliers[e]=i,this.frequency.chain(i,n.frequency),this.detune.connect(n.detune)}this._filterFreqScaler=new Kr({context:this.context,max:7e3,min:this.toFrequency(t.resonance)}),this.envelope=new go({attack:t.envelope.attack,attackCurve:"linear",context:this.context,decay:t.envelope.decay,release:t.envelope.release,sustain:0}),this.envelope.chain(this._filterFreqScaler,this._highpass.frequency),this.envelope.connect(this._amplitude.gain),this._octaves=t.octaves,this.octaves=t.octaves}static getDefaults(){return cs(bo.getDefaults(),{envelope:Object.assign(hs(go.getDefaults(),Object.keys(nr.getDefaults())),{attack:.001,decay:1.4,release:.2}),harmonicity:5.1,modulationIndex:32,octaves:1.5,resonance:4e3})}_triggerEnvelopeAttack(t,e=1){return this.envelope.triggerAttack(t,e),this._oscillators.forEach((e=>e.start(t))),0===this.envelope.sustain&&this._oscillators.forEach((e=>{e.stop(t+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay))})),this}_triggerEnvelopeRelease(t){return this.envelope.triggerRelease(t),this._oscillators.forEach((e=>e.stop(t+this.toSeconds(this.envelope.release)))),this}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}get modulationIndex(){return this._oscillators[0].modulationIndex.value}set modulationIndex(t){this._oscillators.forEach((e=>e.modulationIndex.value=t))}get harmonicity(){return this._oscillators[0].harmonicity.value}set harmonicity(t){this._oscillators.forEach((e=>e.harmonicity.value=t))}get resonance(){return this._filterFreqScaler.min}set resonance(t){this._filterFreqScaler.min=this.toFrequency(t),this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(t){this._octaves=t,this._filterFreqScaler.max=this._filterFreqScaler.min*Math.pow(2,t)}dispose(){return super.dispose(),this._oscillators.forEach((t=>t.dispose())),this._freqMultipliers.forEach((t=>t.dispose())),this.frequency.dispose(),this.detune.dispose(),this._filterFreqScaler.dispose(),this._amplitude.dispose(),this.envelope.dispose(),this._highpass.dispose(),this}}class qo extends wo{constructor(){super(us(qo.getDefaults(),arguments)),this.name="MembraneSynth",this.portamento=0;const t=us(qo.getDefaults(),arguments);this.pitchDecay=t.pitchDecay,this.octaves=t.octaves,ks(this,["oscillator","envelope"])}static getDefaults(){return cs(bo.getDefaults(),wo.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(t,e){const n=this.toSeconds(e),i=this.toFrequency(t instanceof Hs?t.toFrequency():t),s=i*this.octaves;return this.oscillator.frequency.setValueAtTime(s,n),this.oscillator.frequency.exponentialRampToValueAtTime(i,n+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}Ki([no(0)],qo.prototype,"octaves",void 0),Ki([io(0)],qo.prototype,"pitchDecay",void 0);class No extends yo{constructor(){super(us(No.getDefaults(),arguments)),this.name="NoiseSynth";const t=us(No.getDefaults(),arguments);this.noise=new qr(Object.assign({context:this.context},t.noise)),this.envelope=new xo(Object.assign({context:this.context},t.envelope)),this.noise.chain(this.envelope,this.output)}static getDefaults(){return Object.assign(yo.getDefaults(),{envelope:Object.assign(hs(go.getDefaults(),Object.keys(nr.getDefaults())),{decay:.1,sustain:0}),noise:Object.assign(hs(qr.getDefaults(),Object.keys(Or.getDefaults())),{type:"white"})})}triggerAttack(t,e=1){return t=this.toSeconds(t),this.envelope.triggerAttack(t,e),this.noise.start(t),0===this.envelope.sustain&&this.noise.stop(t+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay)),this}triggerRelease(t){return t=this.toSeconds(t),this.envelope.triggerRelease(t),this.noise.stop(t+this.toSeconds(this.envelope.release)),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",0),this._syncMethod("triggerRelease",0)),this}triggerAttackRelease(t,e,n=1){return e=this.toSeconds(e),t=this.toSeconds(t),this.triggerAttack(e,n),this.triggerRelease(e+t),this}dispose(){return super.dispose(),this.noise.dispose(),this.envelope.dispose(),this}}const Fo=new Set;function Io(t){Fo.add(t)}function Po(t,e){const n=`registerProcessor("${t}", ${e})`;Fo.add(n)}class Vo extends nr{constructor(t){super(t),this.name="ToneAudioWorklet",this.workletOptions={},this.onprocessorerror=Ds;const e=URL.createObjectURL(new Blob([Array.from(Fo).join("\n")],{type:"text/javascript"})),n=this._audioWorkletName();this._dummyGain=this.context.createGain(),this._dummyParam=this._dummyGain.gain,this.context.addAudioWorkletModule(e,n).then((()=>{this.disposed||(this._worklet=this.context.createAudioWorkletNode(n,this.workletOptions),this._worklet.onprocessorerror=this.onprocessorerror.bind(this),this.onReady(this._worklet))}))}dispose(){return super.dispose(),this._dummyGain.disconnect(),this._worklet&&(this._worklet.port.postMessage("dispose"),this._worklet.disconnect()),this}}Io('\n\t/**\n\t * The base AudioWorkletProcessor for use in Tone.js. Works with the [[ToneAudioWorklet]]. \n\t */\n\tclass ToneAudioWorkletProcessor extends AudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\t\n\t\t\tsuper(options);\n\t\t\t/**\n\t\t\t * If the processor was disposed or not. Keep alive until it\'s disposed.\n\t\t\t */\n\t\t\tthis.disposed = false;\n\t\t   \t/** \n\t\t\t * The number of samples in the processing block\n\t\t\t */\n\t\t\tthis.blockSize = 128;\n\t\t\t/**\n\t\t\t * the sample rate\n\t\t\t */\n\t\t\tthis.sampleRate = sampleRate;\n\n\t\t\tthis.port.onmessage = (event) => {\n\t\t\t\t// when it receives a dispose \n\t\t\t\tif (event.data === "dispose") {\n\t\t\t\t\tthis.disposed = true;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t}\n'),Io("\n\t/**\n\t * Abstract class for a single input/output processor. \n\t * has a 'generate' function which processes one sample at a time\n\t */\n\tclass SingleIOProcessor extends ToneAudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(Object.assign(options, {\n\t\t\t\tnumberOfInputs: 1,\n\t\t\t\tnumberOfOutputs: 1\n\t\t\t}));\n\t\t\t/**\n\t\t\t * Holds the name of the parameter and a single value of that\n\t\t\t * parameter at the current sample\n\t\t\t * @type { [name: string]: number }\n\t\t\t */\n\t\t\tthis.params = {}\n\t\t}\n\n\t\t/**\n\t\t * Generate an output sample from the input sample and parameters\n\t\t * @abstract\n\t\t * @param input number\n\t\t * @param channel number\n\t\t * @param parameters { [name: string]: number }\n\t\t * @returns number\n\t\t */\n\t\tgenerate(){}\n\n\t\t/**\n\t\t * Update the private params object with the \n\t\t * values of the parameters at the given index\n\t\t * @param parameters { [name: string]: Float32Array },\n\t\t * @param index number\n\t\t */\n\t\tupdateParams(parameters, index) {\n\t\t\tfor (const paramName in parameters) {\n\t\t\t\tconst param = parameters[paramName];\n\t\t\t\tif (param.length > 1) {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][index];\n\t\t\t\t} else {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][0];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Process a single frame of the audio\n\t\t * @param inputs Float32Array[][]\n\t\t * @param outputs Float32Array[][]\n\t\t */\n\t\tprocess(inputs, outputs, parameters) {\n\t\t\tconst input = inputs[0];\n\t\t\tconst output = outputs[0];\n\t\t\t// get the parameter values\n\t\t\tconst channelCount = Math.max(input && input.length || 0, output.length);\n\t\t\tfor (let sample = 0; sample < this.blockSize; sample++) {\n\t\t\t\tthis.updateParams(parameters, sample);\n\t\t\t\tfor (let channel = 0; channel < channelCount; channel++) {\n\t\t\t\t\tconst inputSample = input && input.length ? input[channel][sample] : 0;\n\t\t\t\t\toutput[channel][sample] = this.generate(inputSample, channel, this.params);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn !this.disposed;\n\t\t}\n\t};\n"),Io("\n\t/**\n\t * A multichannel buffer for use within an AudioWorkletProcessor as a delay line\n\t */\n\tclass DelayLine {\n\t\t\n\t\tconstructor(size, channels) {\n\t\t\tthis.buffer = [];\n\t\t\tthis.writeHead = []\n\t\t\tthis.size = size;\n\n\t\t\t// create the empty channels\n\t\t\tfor (let i = 0; i < channels; i++) {\n\t\t\t\tthis.buffer[i] = new Float32Array(this.size);\n\t\t\t\tthis.writeHead[i] = 0;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Push a value onto the end\n\t\t * @param channel number\n\t\t * @param value number\n\t\t */\n\t\tpush(channel, value) {\n\t\t\tthis.writeHead[channel] += 1;\n\t\t\tif (this.writeHead[channel] > this.size) {\n\t\t\t\tthis.writeHead[channel] = 0;\n\t\t\t}\n\t\t\tthis.buffer[channel][this.writeHead[channel]] = value;\n\t\t}\n\n\t\t/**\n\t\t * Get the recorded value of the channel given the delay\n\t\t * @param channel number\n\t\t * @param delay number delay samples\n\t\t */\n\t\tget(channel, delay) {\n\t\t\tlet readHead = this.writeHead[channel] - Math.floor(delay);\n\t\t\tif (readHead < 0) {\n\t\t\t\treadHead += this.size;\n\t\t\t}\n\t\t\treturn this.buffer[channel][readHead];\n\t\t}\n\t}\n");const zo="feedback-comb-filter";Po(zo,'\n\tclass FeedbackCombFilterWorklet extends SingleIOProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(options);\n\t\t\tthis.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);\n\t\t}\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: "delayTime",\n\t\t\t\tdefaultValue: 0.1,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 1,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}, {\n\t\t\t\tname: "feedback",\n\t\t\t\tdefaultValue: 0.5,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 0.9999,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, channel, parameters) {\n\t\t\tconst delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);\n\t\t\tthis.delayLine.push(channel, input + delayedSample * parameters.feedback);\n\t\t\treturn delayedSample;\n\t\t}\n\t}\n');class jo extends Vo{constructor(){super(us(jo.getDefaults(),arguments,["delayTime","resonance"])),this.name="FeedbackCombFilter";const t=us(jo.getDefaults(),arguments,["delayTime","resonance"]);this.input=new or({context:this.context}),this.output=new or({context:this.context}),this.delayTime=new er({context:this.context,value:t.delayTime,units:"time",minValue:0,maxValue:1,param:this._dummyParam,swappable:!0}),this.resonance=new er({context:this.context,value:t.resonance,units:"normalRange",param:this._dummyParam,swappable:!0}),ks(this,["resonance","delayTime"])}_audioWorkletName(){return zo}static getDefaults(){return Object.assign(nr.getDefaults(),{delayTime:.1,resonance:.5})}onReady(t){ir(this.input,t,this.output);const e=t.parameters.get("delayTime");this.delayTime.setParam(e);const n=t.parameters.get("feedback");this.resonance.setParam(n)}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.delayTime.dispose(),this.resonance.dispose(),this}}class Lo extends nr{constructor(){super(us(Lo.getDefaults(),arguments,["frequency","type"])),this.name="OnePoleFilter";const t=us(Lo.getDefaults(),arguments,["frequency","type"]);this._frequency=t.frequency,this._type=t.type,this.input=new or({context:this.context}),this.output=new or({context:this.context}),this._createFilter()}static getDefaults(){return Object.assign(nr.getDefaults(),{frequency:880,type:"lowpass"})}_createFilter(){const t=this._filter,e=this.toFrequency(this._frequency),n=1/(2*Math.PI*e);if("lowpass"===this._type){const t=1/(n*this.context.sampleRate),e=t-1;this._filter=this.context.createIIRFilter([t,0],[1,e])}else{const t=1/(n*this.context.sampleRate)-1;this._filter=this.context.createIIRFilter([1,-1],[1,t])}this.input.chain(this._filter,this.output),t&&this.context.setTimeout((()=>{this.disposed||(this.input.disconnect(t),t.disconnect())}),this.blockTime)}get frequency(){return this._frequency}set frequency(t){this._frequency=t,this._createFilter()}get type(){return this._type}set type(t){this._type=t,this._createFilter()}getFrequencyResponse(t=128){const e=new Float32Array(t);for(let n=0;n<t;n++){const i=19980*Math.pow(n/t,2)+20;e[n]=i}const n=new Float32Array(t),i=new Float32Array(t);return this._filter.getFrequencyResponse(e,n,i),n}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this._filter.disconnect(),this}}class Bo extends nr{constructor(){super(us(Bo.getDefaults(),arguments,["delayTime","resonance","dampening"])),this.name="LowpassCombFilter";const t=us(Bo.getDefaults(),arguments,["delayTime","resonance","dampening"]);this._combFilter=this.output=new jo({context:this.context,delayTime:t.delayTime,resonance:t.resonance}),this.delayTime=this._combFilter.delayTime,this.resonance=this._combFilter.resonance,this._lowpass=this.input=new Lo({context:this.context,frequency:t.dampening,type:"lowpass"}),this._lowpass.connect(this._combFilter)}static getDefaults(){return Object.assign(nr.getDefaults(),{dampening:3e3,delayTime:.1,resonance:.5})}get dampening(){return this._lowpass.frequency}set dampening(t){this._lowpass.frequency=t}dispose(){return super.dispose(),this._combFilter.dispose(),this._lowpass.dispose(),this}}class Uo extends yo{constructor(){super(us(Uo.getDefaults(),arguments)),this.name="PluckSynth";const t=us(Uo.getDefaults(),arguments);this._noise=new qr({context:this.context,type:"pink"}),this.attackNoise=t.attackNoise,this._lfcf=new Bo({context:this.context,dampening:t.dampening,resonance:t.resonance}),this.resonance=t.resonance,this.release=t.release,this._noise.connect(this._lfcf),this._lfcf.connect(this.output)}static getDefaults(){return cs(yo.getDefaults(),{attackNoise:1,dampening:4e3,resonance:.7,release:1})}get dampening(){return this._lfcf.dampening}set dampening(t){this._lfcf.dampening=t}triggerAttack(t,e){const n=this.toFrequency(t);e=this.toSeconds(e);const i=1/n;return this._lfcf.delayTime.setValueAtTime(i,e),this._noise.start(e),this._noise.stop(e+i*this.attackNoise),this._lfcf.resonance.cancelScheduledValues(e),this._lfcf.resonance.setValueAtTime(this.resonance,e),this}triggerRelease(t){return this._lfcf.resonance.linearRampTo(0,this.release,t),this}dispose(){return super.dispose(),this._noise.dispose(),this._lfcf.dispose(),this}}class Wo extends yo{constructor(){super(us(Wo.getDefaults(),arguments,["voice","options"])),this.name="PolySynth",this._availableVoices=[],this._activeVoices=[],this._voices=[],this._gcTimeout=-1,this._averageActiveVoices=0;const t=us(Wo.getDefaults(),arguments,["voice","options"]);Fi(!Gi(t.voice),"DEPRECATED: The polyphony count is no longer the first argument.");const e=t.voice.getDefaults();this.options=Object.assign(e,t.options),this.voice=t.voice,this.maxPolyphony=t.maxPolyphony,this._dummyVoice=this._getNextAvailableVoice();const n=this._voices.indexOf(this._dummyVoice);this._voices.splice(n,1),this._gcTimeout=this.context.setInterval(this._collectGarbage.bind(this),1)}static getDefaults(){return Object.assign(yo.getDefaults(),{maxPolyphony:32,options:{},voice:wo})}get activeVoices(){return this._activeVoices.length}_makeVoiceAvailable(t){this._availableVoices.push(t);const e=this._activeVoices.findIndex((e=>e.voice===t));this._activeVoices.splice(e,1)}_getNextAvailableVoice(){if(this._availableVoices.length)return this._availableVoices.shift();if(this._voices.length<this.maxPolyphony){const t=new this.voice(Object.assign(this.options,{context:this.context,onsilence:this._makeVoiceAvailable.bind(this)}));return t.connect(this.output),this._voices.push(t),t}Li("Max polyphony exceeded. Note dropped.")}_collectGarbage(){if(this._averageActiveVoices=Math.max(.95*this._averageActiveVoices,this.activeVoices),this._availableVoices.length&&this._voices.length>Math.ceil(this._averageActiveVoices+1)){const t=this._availableVoices.shift(),e=this._voices.indexOf(t);this._voices.splice(e,1),this.context.isOffline||t.dispose()}}_triggerAttack(t,e,n){t.forEach((t=>{const i=new vr(this.context,t).toMidi(),s=this._getNextAvailableVoice();s&&(s.triggerAttack(t,e,n),this._activeVoices.push({midi:i,voice:s,released:!1}),this.log("triggerAttack",t,e))}))}_triggerRelease(t,e){t.forEach((t=>{const n=new vr(this.context,t).toMidi(),i=this._activeVoices.find((({midi:t,released:e})=>t===n&&!e));i&&(i.voice.triggerRelease(e),i.released=!0,this.log("triggerRelease",t,e))}))}_scheduleEvent(t,e,n,i){Fi(!this.disposed,"Synth was already disposed"),n<=this.now()?"attack"===t?this._triggerAttack(e,n,i):this._triggerRelease(e,n):this.context.setTimeout((()=>{this._scheduleEvent(t,e,n,i)}),n-this.now())}triggerAttack(t,e,n){Array.isArray(t)||(t=[t]);const i=this.toSeconds(e);return this._scheduleEvent("attack",t,i,n),this}triggerRelease(t,e){Array.isArray(t)||(t=[t]);const n=this.toSeconds(e);return this._scheduleEvent("release",t,n),this}triggerAttackRelease(t,e,n,i){const s=this.toSeconds(n);if(this.triggerAttack(t,s,i),Xi(e)){Fi(Xi(t),"If the duration is an array, the notes must also be an array"),t=t;for(let n=0;n<t.length;n++){const i=e[Math.min(n,e.length-1)],r=this.toSeconds(i);Fi(r>0,"The duration must be greater than 0"),this.triggerRelease(t[n],s+r)}}else{const n=this.toSeconds(e);Fi(n>0,"The duration must be greater than 0"),this.triggerRelease(t,s+n)}return this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}set(t){const e=hs(t,["onsilence","context"]);return this.options=cs(this.options,e),this._voices.forEach((t=>t.set(e))),this._dummyVoice.set(e),this}get(){return this._dummyVoice.get()}releaseAll(t){const e=this.toSeconds(t);return this._activeVoices.forEach((({voice:t})=>{t.triggerRelease(e)})),this}dispose(){return super.dispose(),this._dummyVoice.dispose(),this._voices.forEach((t=>t.dispose())),this._activeVoices=[],this._availableVoices=[],this.context.clearInterval(this._gcTimeout),this}}class Go extends yo{constructor(){super(us(Go.getDefaults(),arguments,["urls","onload","baseUrl"],"urls")),this.name="Sampler",this._activeSources=new Map;const t=us(Go.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),e={};Object.keys(t.urls).forEach((n=>{const i=parseInt(n,10);if(Fi($i(n)||Gi(i)&&isFinite(i),`url key is neither a note or midi pitch: ${n}`),$i(n)){const i=new Hs(this.context,n).toMidi();e[i]=t.urls[n]}else Gi(i)&&isFinite(i)&&(e[i]=t.urls[i])})),this._buffers=new gr({urls:e,onload:t.onload,baseUrl:t.baseUrl,onerror:t.onerror}),this.attack=t.attack,this.release=t.release,this.curve=t.curve,this._buffers.loaded&&Promise.resolve().then(t.onload)}static getDefaults(){return Object.assign(yo.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:Ds,onerror:Ds,release:.1,urls:{}})}_findClosest(t){let e=0;for(;e<96;){if(this._buffers.has(t+e))return-e;if(this._buffers.has(t-e))return e;e++}throw new Error(`No available buffers for note: ${t}`)}triggerAttack(t,e,n=1){return this.log("triggerAttack",t,e,n),Array.isArray(t)||(t=[t]),t.forEach((t=>{const i=Bs(new Hs(this.context,t).toFrequency()),s=Math.round(i),r=i-s,o=this._findClosest(s),a=s-o,c=this._buffers.get(a),u=zs(o+r),l=new Rr({url:c,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:u}).connect(this.output);l.start(e,0,c.duration/u,n),Xi(this._activeSources.get(s))||this._activeSources.set(s,[]),this._activeSources.get(s).push(l),l.onended=()=>{if(this._activeSources&&this._activeSources.has(s)){const t=this._activeSources.get(s),e=t.indexOf(l);-1!==e&&t.splice(e,1)}}})),this}triggerRelease(t,e){return this.log("triggerRelease",t,e),Array.isArray(t)||(t=[t]),t.forEach((t=>{const n=new Hs(this.context,t).toMidi();if(this._activeSources.has(n)&&this._activeSources.get(n).length){const t=this._activeSources.get(n);e=this.toSeconds(e),t.forEach((t=>{t.stop(e)})),this._activeSources.set(n,[])}})),this}releaseAll(t){const e=this.toSeconds(t);return this._activeSources.forEach((t=>{for(;t.length;)t.shift().stop(e)})),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(t,e,n,i=1){const s=this.toSeconds(n);return this.triggerAttack(t,s,i),Xi(e)?(Fi(Xi(t),"notes must be an array when duration is array"),t.forEach(((t,n)=>{const i=e[Math.min(n,e.length-1)];this.triggerRelease(t,s+this.toSeconds(i))}))):this.triggerRelease(t,s+this.toSeconds(e)),this}add(t,e,n){if(Fi($i(t)||isFinite(t),`note must be a pitch or midi: ${t}`),$i(t)){const i=new Hs(this.context,t).toMidi();this._buffers.add(i,e,n)}else this._buffers.add(t,e,n);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach((t=>{t.forEach((t=>t.dispose()))})),this._activeSources.clear(),this}}Ki([io(0)],Go.prototype,"attack",void 0),Ki([io(0)],Go.prototype,"release",void 0);class Yo extends Ks{constructor(){super(us(Yo.getDefaults(),arguments,["callback","value"])),this.name="ToneEvent",this._state=new tr("stopped"),this._startOffset=0;const t=us(Yo.getDefaults(),arguments,["callback","value"]);this._loop=t.loop,this.callback=t.callback,this.value=t.value,this._loopStart=this.toTicks(t.loopStart),this._loopEnd=this.toTicks(t.loopEnd),this._playbackRate=t.playbackRate,this._probability=t.probability,this._humanize=t.humanize,this.mute=t.mute,this._playbackRate=t.playbackRate,this._state.increasing=!0,this._rescheduleEvents()}static getDefaults(){return Object.assign(Ks.getDefaults(),{callback:Ds,humanize:!1,loop:!1,loopEnd:"1m",loopStart:0,mute:!1,playbackRate:1,probability:1,value:null})}_rescheduleEvents(t=-1){this._state.forEachFrom(t,(t=>{let e;if("started"===t.state){-1!==t.id&&this.context.transport.clear(t.id);const n=t.time+Math.round(this.startOffset/this._playbackRate);if(!0===this._loop||Gi(this._loop)&&this._loop>1){e=1/0,Gi(this._loop)&&(e=this._loop*this._getLoopDuration());const i=this._state.getAfter(n);null!==i&&(e=Math.min(e,i.time-n)),e!==1/0&&(this._state.setStateAtTime("stopped",n+e+1,{id:-1}),e=new br(this.context,e));const s=new br(this.context,this._getLoopDuration());t.id=this.context.transport.scheduleRepeat(this._tick.bind(this),s,new br(this.context,n),e)}else t.id=this.context.transport.schedule(this._tick.bind(this),new br(this.context,n))}}))}get state(){return this._state.getValueAtTime(this.context.transport.ticks)}get startOffset(){return this._startOffset}set startOffset(t){this._startOffset=t}get probability(){return this._probability}set probability(t){this._probability=t}get humanize(){return this._humanize}set humanize(t){this._humanize=t}start(t){const e=this.toTicks(t);return"stopped"===this._state.getValueAtTime(e)&&(this._state.add({id:-1,state:"started",time:e}),this._rescheduleEvents(e)),this}stop(t){this.cancel(t);const e=this.toTicks(t);if("started"===this._state.getValueAtTime(e)){this._state.setStateAtTime("stopped",e,{id:-1});const t=this._state.getBefore(e);let n=e;null!==t&&(n=t.time),this._rescheduleEvents(n)}return this}cancel(t){t=ls(t,-1/0);const e=this.toTicks(t);return this._state.forEachFrom(e,(t=>{this.context.transport.clear(t.id)})),this._state.cancel(e),this}_tick(t){const e=this.context.transport.getTicksAtTime(t);if(!this.mute&&"started"===this._state.getValueAtTime(e)){if(this.probability<1&&Math.random()>this.probability)return;if(this.humanize){let e=.02;Hi(this.humanize)||(e=this.toSeconds(this.humanize)),t+=(2*Math.random()-1)*e}this.callback(t,this.value)}}_getLoopDuration(){return Math.round((this._loopEnd-this._loopStart)/this._playbackRate)}get loop(){return this._loop}set loop(t){this._loop=t,this._rescheduleEvents()}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._rescheduleEvents()}get loopEnd(){return new br(this.context,this._loopEnd).toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t),this._loop&&this._rescheduleEvents()}get loopStart(){return new br(this.context,this._loopStart).toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t),this._loop&&this._rescheduleEvents()}get progress(){if(this._loop){const t=this.context.transport.ticks,e=this._state.get(t);if(null!==e&&"started"===e.state){const n=this._getLoopDuration();return(t-e.time)%n/n}return 0}return 0}dispose(){return super.dispose(),this.cancel(),this._state.dispose(),this}}class Ho extends Ks{constructor(){super(us(Ho.getDefaults(),arguments,["callback","interval"])),this.name="Loop";const t=us(Ho.getDefaults(),arguments,["callback","interval"]);this._event=new Yo({context:this.context,callback:this._tick.bind(this),loop:!0,loopEnd:t.interval,playbackRate:t.playbackRate,probability:t.probability}),this.callback=t.callback,this.iterations=t.iterations}static getDefaults(){return Object.assign(Ks.getDefaults(),{interval:"4n",callback:Ds,playbackRate:1,iterations:1/0,probability:1,mute:!1,humanize:!1})}start(t){return this._event.start(t),this}stop(t){return this._event.stop(t),this}cancel(t){return this._event.cancel(t),this}_tick(t){this.callback(t)}get state(){return this._event.state}get progress(){return this._event.progress}get interval(){return this._event.loopEnd}set interval(t){this._event.loopEnd=t}get playbackRate(){return this._event.playbackRate}set playbackRate(t){this._event.playbackRate=t}get humanize(){return this._event.humanize}set humanize(t){this._event.humanize=t}get probability(){return this._event.probability}set probability(t){this._event.probability=t}get mute(){return this._event.mute}set mute(t){this._event.mute=t}get iterations(){return!0===this._event.loop?1/0:this._event.loop}set iterations(t){this._event.loop=t===1/0||t}dispose(){return super.dispose(),this._event.dispose(),this}}class Xo extends Yo{constructor(){super(us(Xo.getDefaults(),arguments,["callback","events"])),this.name="Part",this._state=new tr("stopped"),this._events=new Set;const t=us(Xo.getDefaults(),arguments,["callback","events"]);this._state.increasing=!0,t.events.forEach((t=>{Xi(t)?this.add(t[0],t[1]):this.add(t)}))}static getDefaults(){return Object.assign(Yo.getDefaults(),{events:[]})}start(t,e){const n=this.toTicks(t);if("started"!==this._state.getValueAtTime(n)){e=ls(e,this._loop?this._loopStart:0),e=this._loop?ls(e,this._loopStart):ls(e,0);const t=this.toTicks(e);this._state.add({id:-1,offset:t,state:"started",time:n}),this._forEach((e=>{this._startNote(e,n,t)}))}return this}_startNote(t,e,n){e-=n,this._loop?t.startOffset>=this._loopStart&&t.startOffset<this._loopEnd?(t.startOffset<n&&(e+=this._getLoopDuration()),t.start(new br(this.context,e))):t.startOffset<this._loopStart&&t.startOffset>=n&&(t.loop=!1,t.start(new br(this.context,e))):t.startOffset>=n&&t.start(new br(this.context,e))}get startOffset(){return this._startOffset}set startOffset(t){this._startOffset=t,this._forEach((t=>{t.startOffset+=this._startOffset}))}stop(t){const e=this.toTicks(t);return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._forEach((e=>{e.stop(t)})),this}at(t,e){const n=new Qs(this.context,t).toTicks(),i=new br(this.context,1).toSeconds(),s=this._events.values();let r=s.next();for(;!r.done;){const t=r.value;if(Math.abs(n-t.startOffset)<i)return Ui(e)&&(t.value=e),t;r=s.next()}return Ui(e)?(this.add(t,e),this.at(t)):null}add(t,e){t instanceof Object&&Reflect.has(t,"time")&&(t=(e=t).time);const n=this.toTicks(t);let i;return e instanceof Yo?(i=e,i.callback=this._tick.bind(this)):i=new Yo({callback:this._tick.bind(this),context:this.context,value:e}),i.startOffset=n,i.set({humanize:this.humanize,loop:this.loop,loopEnd:this.loopEnd,loopStart:this.loopStart,playbackRate:this.playbackRate,probability:this.probability}),this._events.add(i),this._restartEvent(i),this}_restartEvent(t){this._state.forEach((e=>{"started"===e.state?this._startNote(t,e.time,e.offset):t.stop(new br(this.context,e.time))}))}remove(t,e){return Yi(t)&&t.hasOwnProperty("time")&&(t=(e=t).time),t=this.toTicks(t),this._events.forEach((n=>{n.startOffset===t&&(Bi(e)||Ui(e)&&n.value===e)&&(this._events.delete(n),n.dispose())})),this}clear(){return this._forEach((t=>t.dispose())),this._events.clear(),this}cancel(t){return this._forEach((e=>e.cancel(t))),this._state.cancel(this.toTicks(t)),this}_forEach(t){return this._events&&this._events.forEach((e=>{e instanceof Xo?e._forEach(t):t(e)})),this}_setAll(t,e){this._forEach((n=>{n[t]=e}))}_tick(t,e){this.mute||this.callback(t,e)}_testLoopBoundries(t){this._loop&&(t.startOffset<this._loopStart||t.startOffset>=this._loopEnd)?t.cancel(0):"stopped"===t.state&&this._restartEvent(t)}get probability(){return this._probability}set probability(t){this._probability=t,this._setAll("probability",t)}get humanize(){return this._humanize}set humanize(t){this._humanize=t,this._setAll("humanize",t)}get loop(){return this._loop}set loop(t){this._loop=t,this._forEach((e=>{e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.loop=t,this._testLoopBoundries(e)}))}get loopEnd(){return new br(this.context,this._loopEnd).toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t),this._loop&&this._forEach((e=>{e.loopEnd=t,this._testLoopBoundries(e)}))}get loopStart(){return new br(this.context,this._loopStart).toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t),this._loop&&this._forEach((t=>{t.loopStart=this.loopStart,this._testLoopBoundries(t)}))}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._setAll("playbackRate",t)}get length(){return this._events.size}dispose(){return super.dispose(),this.clear(),this}}function*Zo(t){let e=0;for(;e<t.length;)e=Jo(e,t),yield t[e],e++}function*$o(t){let e=t.length-1;for(;e>=0;)e=Jo(e,t),yield t[e],e--}function*Qo(t,e){for(;;)yield*e(t)}function Jo(t,e){return vs(t,0,e.length-1)}function*Ko(t,e){let n=e?0:t.length-1;for(;;)n=Jo(n,t),yield t[n],e?(n++,n>=t.length-1&&(e=!1)):(n--,n<=0&&(e=!0))}function*ta(t){let e=0,n=0;for(;e<t.length;)e=Jo(e,t),yield t[e],n++,e+=n%2?2:-1}function*ea(t){let e=t.length-1,n=0;for(;e>=0;)e=Jo(e,t),yield t[e],n++,e+=n%2?-2:1}function*na(t){const e=[];for(let n=0;n<t.length;n++)e.push(n);for(;e.length>0;){const n=Jo(e.splice(Math.floor(e.length*Math.random()),1)[0],t);yield t[n]}}function*ia(t,e="up",n=0){switch(Fi(t.length>0,"The array must have more than one value in it"),e){case"up":yield*Qo(t,Zo);case"down":yield*Qo(t,$o);case"upDown":yield*Ko(t,!0);case"downUp":yield*Ko(t,!1);case"alternateUp":yield*Qo(t,ta);case"alternateDown":yield*Qo(t,ea);case"random":yield*function*(t){for(;;){const e=Math.floor(Math.random()*t.length);yield t[e]}}(t);case"randomOnce":yield*Qo(t,na);case"randomWalk":yield*function*(t){let e=Math.floor(Math.random()*t.length);for(;;)0===e?e++:e===t.length-1||Math.random()<.5?e--:e++,yield t[e]}(t)}}class sa extends Ho{constructor(){super(us(sa.getDefaults(),arguments,["callback","values","pattern"])),this.name="Pattern";const t=us(sa.getDefaults(),arguments,["callback","values","pattern"]);this.callback=t.callback,this._values=t.values,this._pattern=ia(t.values,t.pattern),this._type=t.pattern}static getDefaults(){return Object.assign(Ho.getDefaults(),{pattern:"up",values:[],callback:Ds})}_tick(t){const e=this._pattern.next();this._value=e.value,this.callback(t,this._value)}get values(){return this._values}set values(t){this._values=t,this.pattern=this._type}get value(){return this._value}get pattern(){return this._type}set pattern(t){this._type=t,this._pattern=ia(this._values,this._type)}}class ra extends Yo{constructor(){super(us(ra.getDefaults(),arguments,["callback","events","subdivision"])),this.name="Sequence",this._part=new Xo({callback:this._seqCallback.bind(this),context:this.context}),this._events=[],this._eventsArray=[];const t=us(ra.getDefaults(),arguments,["callback","events","subdivision"]);this._subdivision=this.toTicks(t.subdivision),this.events=t.events,this.loop=t.loop,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this.playbackRate=t.playbackRate,this.probability=t.probability,this.humanize=t.humanize,this.mute=t.mute,this.playbackRate=t.playbackRate}static getDefaults(){return Object.assign(hs(Yo.getDefaults(),["value"]),{events:[],loop:!0,loopEnd:0,loopStart:0,subdivision:"8n"})}_seqCallback(t,e){null!==e&&this.callback(t,e)}get events(){return this._events}set events(t){this.clear(),this._eventsArray=t,this._events=this._createSequence(this._eventsArray),this._eventsUpdated()}start(t,e){return this._part.start(t,e?this._indexTime(e):e),this}stop(t){return this._part.stop(t),this}get subdivision(){return new br(this.context,this._subdivision).toSeconds()}_createSequence(t){return new Proxy(t,{get:(t,e)=>t[e],set:(t,e,n)=>(Zi(e)&&isFinite(parseInt(e,10))&&Xi(n)?t[e]=this._createSequence(n):t[e]=n,this._eventsUpdated(),!0)})}_eventsUpdated(){this._part.clear(),this._rescheduleSequence(this._eventsArray,this._subdivision,this.startOffset),this.loopEnd=this.loopEnd}_rescheduleSequence(t,e,n){t.forEach(((t,i)=>{const s=i*e+n;if(Xi(t))this._rescheduleSequence(t,e/t.length,s);else{const e=new br(this.context,s,"i").toSeconds();this._part.add(e,t)}}))}_indexTime(t){return new br(this.context,t*this._subdivision+this.startOffset).toSeconds()}clear(){return this._part.clear(),this}dispose(){return super.dispose(),this._part.dispose(),this}get loop(){return this._part.loop}set loop(t){this._part.loop=t}get loopStart(){return this._loopStart}set loopStart(t){this._loopStart=t,this._part.loopStart=this._indexTime(t)}get loopEnd(){return this._loopEnd}set loopEnd(t){this._loopEnd=t,this._part.loopEnd=0===t?this._indexTime(this._eventsArray.length):this._indexTime(t)}get startOffset(){return this._part.startOffset}set startOffset(t){this._part.startOffset=t}get playbackRate(){return this._part.playbackRate}set playbackRate(t){this._part.playbackRate=t}get probability(){return this._part.probability}set probability(t){this._part.probability=t}get progress(){return this._part.progress}get humanize(){return this._part.humanize}set humanize(t){this._part.humanize=t}get length(){return this._part.length}}class oa extends nr{constructor(){super(Object.assign(us(oa.getDefaults(),arguments,["fade"]))),this.name="CrossFade",this._panner=this.context.createStereoPanner(),this._split=this.context.createChannelSplitter(2),this._g2a=new co({context:this.context}),this.a=new or({context:this.context,gain:0}),this.b=new or({context:this.context,gain:0}),this.output=new or({context:this.context}),this._internalChannels=[this.a,this.b];const t=us(oa.getDefaults(),arguments,["fade"]);this.fade=new ur({context:this.context,units:"normalRange",value:t.fade}),ks(this,"fade"),this.context.getConstant(1).connect(this._panner),this._panner.connect(this._split),this._panner.channelCount=1,this._panner.channelCountMode="explicit",sr(this._split,this.a.gain,0),sr(this._split,this.b.gain,1),this.fade.chain(this._g2a,this._panner.pan),this.a.connect(this.output),this.b.connect(this.output)}static getDefaults(){return Object.assign(nr.getDefaults(),{fade:.5})}dispose(){return super.dispose(),this.a.dispose(),this.b.dispose(),this.output.dispose(),this.fade.dispose(),this._g2a.dispose(),this._panner.disconnect(),this._split.disconnect(),this}}class aa extends nr{constructor(t){super(t),this.name="Effect",this._dryWet=new oa({context:this.context}),this.wet=this._dryWet.fade,this.effectSend=new or({context:this.context}),this.effectReturn=new or({context:this.context}),this.input=new or({context:this.context}),this.output=this._dryWet,this.input.fan(this._dryWet.a,this.effectSend),this.effectReturn.connect(this._dryWet.b),this.wet.setValueAtTime(t.wet,0),this._internalChannels=[this.effectReturn,this.effectSend],ks(this,"wet")}static getDefaults(){return Object.assign(nr.getDefaults(),{wet:1})}connectEffect(t){return this._internalChannels.push(t),this.effectSend.chain(t,this.effectReturn),this}dispose(){return super.dispose(),this._dryWet.dispose(),this.effectSend.dispose(),this.effectReturn.dispose(),this.wet.dispose(),this}}class ca extends aa{constructor(t){super(t),this.name="LFOEffect",this._lfo=new eo({context:this.context,frequency:t.frequency,amplitude:t.depth}),this.depth=this._lfo.amplitude,this.frequency=this._lfo.frequency,this.type=t.type,ks(this,["frequency","depth"])}static getDefaults(){return Object.assign(aa.getDefaults(),{frequency:1,type:"sine",depth:1})}start(t){return this._lfo.start(t),this}stop(t){return this._lfo.stop(t),this}sync(){return this._lfo.sync(),this}unsync(){return this._lfo.unsync(),this}get type(){return this._lfo.type}set type(t){this._lfo.type=t}dispose(){return super.dispose(),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class ua extends ca{constructor(){super(us(ua.getDefaults(),arguments,["frequency","baseFrequency","octaves"])),this.name="AutoFilter";const t=us(ua.getDefaults(),arguments,["frequency","baseFrequency","octaves"]);this.filter=new Ao(Object.assign(t.filter,{context:this.context})),this.connectEffect(this.filter),this._lfo.connect(this.filter.frequency),this.octaves=t.octaves,this.baseFrequency=t.baseFrequency}static getDefaults(){return Object.assign(ca.getDefaults(),{baseFrequency:200,octaves:2.6,filter:{type:"lowpass",rolloff:-12,Q:1}})}get baseFrequency(){return this._lfo.min}set baseFrequency(t){this._lfo.min=this.toFrequency(t),this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(t){this._octaves=t,this._lfo.max=this._lfo.min*Math.pow(2,t)}dispose(){return super.dispose(),this.filter.dispose(),this}}class la extends nr{constructor(){super(Object.assign(us(la.getDefaults(),arguments,["pan"]))),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner;const t=us(la.getDefaults(),arguments,["pan"]);this.pan=new er({context:this.context,param:this._panner.pan,value:t.pan,minValue:-1,maxValue:1}),this._panner.channelCount=t.channelCount,this._panner.channelCountMode="explicit",ks(this,"pan")}static getDefaults(){return Object.assign(nr.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}class ha extends ca{constructor(){super(us(ha.getDefaults(),arguments,["frequency"])),this.name="AutoPanner";const t=us(ha.getDefaults(),arguments,["frequency"]);this._panner=new la({context:this.context,channelCount:t.channelCount}),this.connectEffect(this._panner),this._lfo.connect(this._panner.pan),this._lfo.min=-1,this._lfo.max=1}static getDefaults(){return Object.assign(ca.getDefaults(),{channelCount:1})}dispose(){return super.dispose(),this._panner.dispose(),this}}class fa extends nr{constructor(){super(us(fa.getDefaults(),arguments,["smoothing"])),this.name="Follower";const t=us(fa.getDefaults(),arguments,["smoothing"]);this._abs=this.input=new ao({context:this.context}),this._lowpass=this.output=new Lo({context:this.context,frequency:1/this.toSeconds(t.smoothing),type:"lowpass"}),this._abs.connect(this._lowpass),this._smoothing=t.smoothing}static getDefaults(){return Object.assign(nr.getDefaults(),{smoothing:.05})}get smoothing(){return this._smoothing}set smoothing(t){this._smoothing=t,this._lowpass.frequency=1/this.toSeconds(this.smoothing)}dispose(){return super.dispose(),this._abs.dispose(),this._lowpass.dispose(),this}}class da extends aa{constructor(){super(us(da.getDefaults(),arguments,["baseFrequency","octaves","sensitivity"])),this.name="AutoWah";const t=us(da.getDefaults(),arguments,["baseFrequency","octaves","sensitivity"]);this._follower=new fa({context:this.context,smoothing:t.follower}),this._sweepRange=new _o({context:this.context,min:0,max:1,exponent:.5}),this._baseFrequency=this.toFrequency(t.baseFrequency),this._octaves=t.octaves,this._inputBoost=new or({context:this.context}),this._bandpass=new Ao({context:this.context,rolloff:-48,frequency:0,Q:t.Q}),this._peaking=new Ao({context:this.context,type:"peaking"}),this._peaking.gain.value=t.gain,this.gain=this._peaking.gain,this.Q=this._bandpass.Q,this.effectSend.chain(this._inputBoost,this._follower,this._sweepRange),this._sweepRange.connect(this._bandpass.frequency),this._sweepRange.connect(this._peaking.frequency),this.effectSend.chain(this._bandpass,this._peaking,this.effectReturn),this._setSweepRange(),this.sensitivity=t.sensitivity,ks(this,["gain","Q"])}static getDefaults(){return Object.assign(aa.getDefaults(),{baseFrequency:100,octaves:6,sensitivity:0,Q:2,gain:2,follower:.2})}get octaves(){return this._octaves}set octaves(t){this._octaves=t,this._setSweepRange()}get follower(){return this._follower.smoothing}set follower(t){this._follower.smoothing=t}get baseFrequency(){return this._baseFrequency}set baseFrequency(t){this._baseFrequency=this.toFrequency(t),this._setSweepRange()}get sensitivity(){return Vs(1/this._inputBoost.gain.value)}set sensitivity(t){this._inputBoost.gain.value=1/Ps(t)}_setSweepRange(){this._sweepRange.min=this._baseFrequency,this._sweepRange.max=Math.min(this._baseFrequency*Math.pow(2,this._octaves),this.context.sampleRate/2)}dispose(){return super.dispose(),this._follower.dispose(),this._sweepRange.dispose(),this._bandpass.dispose(),this._peaking.dispose(),this._inputBoost.dispose(),this}}const pa="bit-crusher";Po(pa,"\n\tclass BitCrusherWorklet extends SingleIOProcessor {\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: \"bits\",\n\t\t\t\tdefaultValue: 12,\n\t\t\t\tminValue: 1,\n\t\t\t\tmaxValue: 16,\n\t\t\t\tautomationRate: 'k-rate'\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, _channel, parameters) {\n\t\t\tconst step = Math.pow(0.5, parameters.bits - 1);\n\t\t\tconst val = step * Math.floor(input / step + 0.5);\n\t\t\treturn val;\n\t\t}\n\t}\n");class _a extends aa{constructor(){super(us(_a.getDefaults(),arguments,["bits"])),this.name="BitCrusher";const t=us(_a.getDefaults(),arguments,["bits"]);this._bitCrusherWorklet=new ma({context:this.context,bits:t.bits}),this.connectEffect(this._bitCrusherWorklet),this.bits=this._bitCrusherWorklet.bits}static getDefaults(){return Object.assign(aa.getDefaults(),{bits:4})}dispose(){return super.dispose(),this._bitCrusherWorklet.dispose(),this}}class ma extends Vo{constructor(){super(us(ma.getDefaults(),arguments)),this.name="BitCrusherWorklet";const t=us(ma.getDefaults(),arguments);this.input=new or({context:this.context}),this.output=new or({context:this.context}),this.bits=new er({context:this.context,value:t.bits,units:"positive",minValue:1,maxValue:16,param:this._dummyParam,swappable:!0})}static getDefaults(){return Object.assign(Vo.getDefaults(),{bits:12})}_audioWorkletName(){return pa}onReady(t){ir(this.input,t,this.output);const e=t.parameters.get("bits");this.bits.setParam(e)}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.bits.dispose(),this}}class ga extends aa{constructor(){super(us(ga.getDefaults(),arguments,["order"])),this.name="Chebyshev";const t=us(ga.getDefaults(),arguments,["order"]);this._shaper=new Br({context:this.context,length:4096}),this._order=t.order,this.connectEffect(this._shaper),this.order=t.order,this.oversample=t.oversample}static getDefaults(){return Object.assign(aa.getDefaults(),{order:1,oversample:"none"})}_getCoefficient(t,e,n){return n.has(e)||(0===e?n.set(e,0):1===e?n.set(e,t):n.set(e,2*t*this._getCoefficient(t,e-1,n)-this._getCoefficient(t,e-2,n))),n.get(e)}get order(){return this._order}set order(t){this._order=t,this._shaper.setMap((e=>this._getCoefficient(e,t,new Map)))}get oversample(){return this._shaper.oversample}set oversample(t){this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.dispose(),this}}class va extends nr{constructor(){super(us(va.getDefaults(),arguments,["channels"])),this.name="Split";const t=us(va.getDefaults(),arguments,["channels"]);this._splitter=this.input=this.output=this.context.createChannelSplitter(t.channels),this._internalChannels=[this._splitter]}static getDefaults(){return Object.assign(nr.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._splitter.disconnect(),this}}class ya extends nr{constructor(){super(us(ya.getDefaults(),arguments,["channels"])),this.name="Merge";const t=us(ya.getDefaults(),arguments,["channels"]);this._merger=this.output=this.input=this.context.createChannelMerger(t.channels)}static getDefaults(){return Object.assign(nr.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._merger.disconnect(),this}}class ba extends nr{constructor(t){super(t),this.name="StereoEffect",this.input=new or({context:this.context}),this.input.channelCount=2,this.input.channelCountMode="explicit",this._dryWet=this.output=new oa({context:this.context,fade:t.wet}),this.wet=this._dryWet.fade,this._split=new va({context:this.context,channels:2}),this._merge=new ya({context:this.context,channels:2}),this.input.connect(this._split),this.input.connect(this._dryWet.a),this._merge.connect(this._dryWet.b),ks(this,["wet"])}connectEffectLeft(...t){this._split.connect(t[0],0,0),ir(...t),sr(t[t.length-1],this._merge,0,0)}connectEffectRight(...t){this._split.connect(t[0],1,0),ir(...t),sr(t[t.length-1],this._merge,0,1)}static getDefaults(){return Object.assign(nr.getDefaults(),{wet:1})}dispose(){return super.dispose(),this._dryWet.dispose(),this._split.dispose(),this._merge.dispose(),this}}class xa extends ba{constructor(t){super(t),this.feedback=new ur({context:this.context,value:t.feedback,units:"normalRange"}),this._feedbackL=new or({context:this.context}),this._feedbackR=new or({context:this.context}),this._feedbackSplit=new va({context:this.context,channels:2}),this._feedbackMerge=new ya({context:this.context,channels:2}),this._merge.connect(this._feedbackSplit),this._feedbackMerge.connect(this._split),this._feedbackSplit.connect(this._feedbackL,0,0),this._feedbackL.connect(this._feedbackMerge,0,0),this._feedbackSplit.connect(this._feedbackR,1,0),this._feedbackR.connect(this._feedbackMerge,0,1),this.feedback.fan(this._feedbackL.gain,this._feedbackR.gain),ks(this,["feedback"])}static getDefaults(){return Object.assign(ba.getDefaults(),{feedback:.5})}dispose(){return super.dispose(),this.feedback.dispose(),this._feedbackL.dispose(),this._feedbackR.dispose(),this._feedbackSplit.dispose(),this._feedbackMerge.dispose(),this}}class wa extends xa{constructor(){super(us(wa.getDefaults(),arguments,["frequency","delayTime","depth"])),this.name="Chorus";const t=us(wa.getDefaults(),arguments,["frequency","delayTime","depth"]);this._depth=t.depth,this._delayTime=t.delayTime/1e3,this._lfoL=new eo({context:this.context,frequency:t.frequency,min:0,max:1}),this._lfoR=new eo({context:this.context,frequency:t.frequency,min:0,max:1,phase:180}),this._delayNodeL=new _r({context:this.context}),this._delayNodeR=new _r({context:this.context}),this.frequency=this._lfoL.frequency,ks(this,["frequency"]),this._lfoL.frequency.connect(this._lfoR.frequency),this.connectEffectLeft(this._delayNodeL),this.connectEffectRight(this._delayNodeR),this._lfoL.connect(this._delayNodeL.delayTime),this._lfoR.connect(this._delayNodeR.delayTime),this.depth=this._depth,this.type=t.type,this.spread=t.spread}static getDefaults(){return Object.assign(xa.getDefaults(),{frequency:1.5,delayTime:3.5,depth:.7,type:"sine",spread:180,feedback:0,wet:.5})}get depth(){return this._depth}set depth(t){this._depth=t;const e=this._delayTime*t;this._lfoL.min=Math.max(this._delayTime-e,0),this._lfoL.max=this._delayTime+e,this._lfoR.min=Math.max(this._delayTime-e,0),this._lfoR.max=this._delayTime+e}get delayTime(){return 1e3*this._delayTime}set delayTime(t){this._delayTime=t/1e3,this.depth=this._depth}get type(){return this._lfoL.type}set type(t){this._lfoL.type=t,this._lfoR.type=t}get spread(){return this._lfoR.phase-this._lfoL.phase}set spread(t){this._lfoL.phase=90-t/2,this._lfoR.phase=t/2+90}start(t){return this._lfoL.start(t),this._lfoR.start(t),this}stop(t){return this._lfoL.stop(t),this._lfoR.stop(t),this}sync(){return this._lfoL.sync(),this._lfoR.sync(),this}unsync(){return this._lfoL.unsync(),this._lfoR.unsync(),this}dispose(){return super.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._delayNodeL.dispose(),this._delayNodeR.dispose(),this.frequency.dispose(),this}}class Ta extends aa{constructor(){super(us(Ta.getDefaults(),arguments,["distortion"])),this.name="Distortion";const t=us(Ta.getDefaults(),arguments,["distortion"]);this._shaper=new Br({context:this.context,length:4096}),this._distortion=t.distortion,this.connectEffect(this._shaper),this.distortion=t.distortion,this.oversample=t.oversample}static getDefaults(){return Object.assign(aa.getDefaults(),{distortion:.4,oversample:"none"})}get distortion(){return this._distortion}set distortion(t){this._distortion=t;const e=100*t,n=Math.PI/180;this._shaper.setMap((t=>Math.abs(t)<.001?0:(3+e)*t*20*n/(Math.PI+e*Math.abs(t))))}get oversample(){return this._shaper.oversample}set oversample(t){this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.dispose(),this}}class Ma extends aa{constructor(t){super(t),this.name="FeedbackEffect",this._feedbackGain=new or({context:this.context,gain:t.feedback,units:"normalRange"}),this.feedback=this._feedbackGain.gain,ks(this,"feedback"),this.effectReturn.chain(this._feedbackGain,this.effectSend)}static getDefaults(){return Object.assign(aa.getDefaults(),{feedback:.125})}dispose(){return super.dispose(),this._feedbackGain.dispose(),this.feedback.dispose(),this}}class Sa extends Ma{constructor(){super(us(Sa.getDefaults(),arguments,["delayTime","feedback"])),this.name="FeedbackDelay";const t=us(Sa.getDefaults(),arguments,["delayTime","feedback"]);this._delayNode=new _r({context:this.context,delayTime:t.delayTime,maxDelay:t.maxDelay}),this.delayTime=this._delayNode.delayTime,this.connectEffect(this._delayNode),ks(this,"delayTime")}static getDefaults(){return Object.assign(Ma.getDefaults(),{delayTime:.25,maxDelay:1})}dispose(){return super.dispose(),this._delayNode.dispose(),this.delayTime.dispose(),this}}class Aa extends nr{constructor(t){super(t),this.name="PhaseShiftAllpass",this.input=new or({context:this.context}),this.output=new or({context:this.context}),this.offset90=new or({context:this.context}),this._bank0=this._createAllPassFilterBank([.6923878,.9360654322959,.988229522686,.9987488452737]),this._bank1=this._createAllPassFilterBank([.4021921162426,.856171088242,.9722909545651,.9952884791278]),this._oneSampleDelay=this.context.createIIRFilter([0,1],[1,0]),ir(this.input,...this._bank0,this._oneSampleDelay,this.output),ir(this.input,...this._bank1,this.offset90)}_createAllPassFilterBank(t){return t.map((t=>{const e=[[t*t,0,-1],[1,0,-t*t]];return this.context.createIIRFilter(e[0],e[1])}))}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.offset90.dispose(),this._bank0.forEach((t=>t.disconnect())),this._bank1.forEach((t=>t.disconnect())),this._oneSampleDelay.disconnect(),this}}class ka extends aa{constructor(){super(us(ka.getDefaults(),arguments,["frequency"])),this.name="FrequencyShifter";const t=us(ka.getDefaults(),arguments,["frequency"]);this.frequency=new ur({context:this.context,units:"frequency",value:t.frequency,minValue:-this.context.sampleRate/2,maxValue:this.context.sampleRate/2}),this._sine=new zr({context:this.context,type:"sine"}),this._cosine=new jr({context:this.context,phase:-90,type:"sine"}),this._sineMultiply=new Wr({context:this.context}),this._cosineMultiply=new Wr({context:this.context}),this._negate=new uo({context:this.context}),this._add=new Jr({context:this.context}),this._phaseShifter=new Aa({context:this.context}),this.effectSend.connect(this._phaseShifter),this.frequency.fan(this._sine.frequency,this._cosine.frequency),this._phaseShifter.offset90.connect(this._cosineMultiply),this._cosine.connect(this._cosineMultiply.factor),this._phaseShifter.connect(this._sineMultiply),this._sine.connect(this._sineMultiply.factor),this._sineMultiply.connect(this._negate),this._cosineMultiply.connect(this._add),this._negate.connect(this._add.addend),this._add.connect(this.effectReturn);const e=this.immediate();this._sine.start(e),this._cosine.start(e)}static getDefaults(){return Object.assign(aa.getDefaults(),{frequency:0})}dispose(){return super.dispose(),this.frequency.dispose(),this._add.dispose(),this._cosine.dispose(),this._cosineMultiply.dispose(),this._negate.dispose(),this._phaseShifter.dispose(),this._sine.dispose(),this._sineMultiply.dispose(),this}}const Ca=[1557/44100,1617/44100,1491/44100,1422/44100,1277/44100,1356/44100,1188/44100,1116/44100],Da=[225,556,441,341];class Ea extends ba{constructor(){super(us(Ea.getDefaults(),arguments,["roomSize","dampening"])),this.name="Freeverb",this._combFilters=[],this._allpassFiltersL=[],this._allpassFiltersR=[];const t=us(Ea.getDefaults(),arguments,["roomSize","dampening"]);this.roomSize=new ur({context:this.context,value:t.roomSize,units:"normalRange"}),this._allpassFiltersL=Da.map((t=>{const e=this.context.createBiquadFilter();return e.type="allpass",e.frequency.value=t,e})),this._allpassFiltersR=Da.map((t=>{const e=this.context.createBiquadFilter();return e.type="allpass",e.frequency.value=t,e})),this._combFilters=Ca.map(((e,n)=>{const i=new Bo({context:this.context,dampening:t.dampening,delayTime:e});return n<Ca.length/2?this.connectEffectLeft(i,...this._allpassFiltersL):this.connectEffectRight(i,...this._allpassFiltersR),this.roomSize.connect(i.resonance),i})),ks(this,["roomSize"])}static getDefaults(){return Object.assign(ba.getDefaults(),{roomSize:.7,dampening:3e3})}get dampening(){return this._combFilters[0].dampening}set dampening(t){this._combFilters.forEach((e=>e.dampening=t))}dispose(){return super.dispose(),this._allpassFiltersL.forEach((t=>t.disconnect())),this._allpassFiltersR.forEach((t=>t.disconnect())),this._combFilters.forEach((t=>t.dispose())),this.roomSize.dispose(),this}}const Oa=[.06748,.06404,.08212,.09004],Ra=[.773,.802,.753,.733],qa=[347,113,37];class Na extends ba{constructor(){super(us(Na.getDefaults(),arguments,["roomSize"])),this.name="JCReverb",this._allpassFilters=[],this._feedbackCombFilters=[];const t=us(Na.getDefaults(),arguments,["roomSize"]);this.roomSize=new ur({context:this.context,value:t.roomSize,units:"normalRange"}),this._scaleRoomSize=new Kr({context:this.context,min:-.733,max:.197}),this._allpassFilters=qa.map((t=>{const e=this.context.createBiquadFilter();return e.type="allpass",e.frequency.value=t,e})),this._feedbackCombFilters=Oa.map(((t,e)=>{const n=new jo({context:this.context,delayTime:t});return this._scaleRoomSize.connect(n.resonance),n.resonance.value=Ra[e],e<Oa.length/2?this.connectEffectLeft(...this._allpassFilters,n):this.connectEffectRight(...this._allpassFilters,n),n})),this.roomSize.connect(this._scaleRoomSize),ks(this,["roomSize"])}static getDefaults(){return Object.assign(ba.getDefaults(),{roomSize:.5})}dispose(){return super.dispose(),this._allpassFilters.forEach((t=>t.disconnect())),this._feedbackCombFilters.forEach((t=>t.dispose())),this.roomSize.dispose(),this._scaleRoomSize.dispose(),this}}class Fa extends xa{constructor(t){super(t),this._feedbackL.disconnect(),this._feedbackL.connect(this._feedbackMerge,0,1),this._feedbackR.disconnect(),this._feedbackR.connect(this._feedbackMerge,0,0),ks(this,["feedback"])}}class Ia extends Fa{constructor(){super(us(Ia.getDefaults(),arguments,["delayTime","feedback"])),this.name="PingPongDelay";const t=us(Ia.getDefaults(),arguments,["delayTime","feedback"]);this._leftDelay=new _r({context:this.context,maxDelay:t.maxDelay}),this._rightDelay=new _r({context:this.context,maxDelay:t.maxDelay}),this._rightPreDelay=new _r({context:this.context,maxDelay:t.maxDelay}),this.delayTime=new ur({context:this.context,units:"time",value:t.delayTime}),this.connectEffectLeft(this._leftDelay),this.connectEffectRight(this._rightPreDelay,this._rightDelay),this.delayTime.fan(this._leftDelay.delayTime,this._rightDelay.delayTime,this._rightPreDelay.delayTime),this._feedbackL.disconnect(),this._feedbackL.connect(this._rightDelay),ks(this,["delayTime"])}static getDefaults(){return Object.assign(Fa.getDefaults(),{delayTime:.25,maxDelay:1})}dispose(){return super.dispose(),this._leftDelay.dispose(),this._rightDelay.dispose(),this._rightPreDelay.dispose(),this.delayTime.dispose(),this}}class Pa extends Ma{constructor(){super(us(Pa.getDefaults(),arguments,["pitch"])),this.name="PitchShift";const t=us(Pa.getDefaults(),arguments,["pitch"]);this._frequency=new ur({context:this.context}),this._delayA=new _r({maxDelay:1,context:this.context}),this._lfoA=new eo({context:this.context,min:0,max:.1,type:"sawtooth"}).connect(this._delayA.delayTime),this._delayB=new _r({maxDelay:1,context:this.context}),this._lfoB=new eo({context:this.context,min:0,max:.1,type:"sawtooth",phase:180}).connect(this._delayB.delayTime),this._crossFade=new oa({context:this.context}),this._crossFadeLFO=new eo({context:this.context,min:0,max:1,type:"triangle",phase:90}).connect(this._crossFade.fade),this._feedbackDelay=new _r({delayTime:t.delayTime,context:this.context}),this.delayTime=this._feedbackDelay.delayTime,ks(this,"delayTime"),this._pitch=t.pitch,this._windowSize=t.windowSize,this._delayA.connect(this._crossFade.a),this._delayB.connect(this._crossFade.b),this._frequency.fan(this._lfoA.frequency,this._lfoB.frequency,this._crossFadeLFO.frequency),this.effectSend.fan(this._delayA,this._delayB),this._crossFade.chain(this._feedbackDelay,this.effectReturn);const e=this.now();this._lfoA.start(e),this._lfoB.start(e),this._crossFadeLFO.start(e),this.windowSize=this._windowSize}static getDefaults(){return Object.assign(Ma.getDefaults(),{pitch:0,windowSize:.1,delayTime:0,feedback:0})}get pitch(){return this._pitch}set pitch(t){this._pitch=t;let e=0;t<0?(this._lfoA.min=0,this._lfoA.max=this._windowSize,this._lfoB.min=0,this._lfoB.max=this._windowSize,e=zs(t-1)+1):(this._lfoA.min=this._windowSize,this._lfoA.max=0,this._lfoB.min=this._windowSize,this._lfoB.max=0,e=zs(t)-1),this._frequency.value=e*(1.2/this._windowSize)}get windowSize(){return this._windowSize}set windowSize(t){this._windowSize=this.toSeconds(t),this.pitch=this._pitch}dispose(){return super.dispose(),this._frequency.dispose(),this._delayA.dispose(),this._delayB.dispose(),this._lfoA.dispose(),this._lfoB.dispose(),this._crossFade.dispose(),this._crossFadeLFO.dispose(),this._feedbackDelay.dispose(),this}}class Va extends ba{constructor(){super(us(Va.getDefaults(),arguments,["frequency","octaves","baseFrequency"])),this.name="Phaser";const t=us(Va.getDefaults(),arguments,["frequency","octaves","baseFrequency"]);this._lfoL=new eo({context:this.context,frequency:t.frequency,min:0,max:1}),this._lfoR=new eo({context:this.context,frequency:t.frequency,min:0,max:1,phase:180}),this._baseFrequency=this.toFrequency(t.baseFrequency),this._octaves=t.octaves,this.Q=new ur({context:this.context,value:t.Q,units:"positive"}),this._filtersL=this._makeFilters(t.stages,this._lfoL),this._filtersR=this._makeFilters(t.stages,this._lfoR),this.frequency=this._lfoL.frequency,this.frequency.value=t.frequency,this.connectEffectLeft(...this._filtersL),this.connectEffectRight(...this._filtersR),this._lfoL.frequency.connect(this._lfoR.frequency),this.baseFrequency=t.baseFrequency,this.octaves=t.octaves,this._lfoL.start(),this._lfoR.start(),ks(this,["frequency","Q"])}static getDefaults(){return Object.assign(ba.getDefaults(),{frequency:.5,octaves:3,stages:10,Q:10,baseFrequency:350})}_makeFilters(t,e){const n=[];for(let i=0;i<t;i++){const t=this.context.createBiquadFilter();t.type="allpass",this.Q.connect(t.Q),e.connect(t.frequency),n.push(t)}return n}get octaves(){return this._octaves}set octaves(t){this._octaves=t;const e=this._baseFrequency*Math.pow(2,t);this._lfoL.max=e,this._lfoR.max=e}get baseFrequency(){return this._baseFrequency}set baseFrequency(t){this._baseFrequency=this.toFrequency(t),this._lfoL.min=this._baseFrequency,this._lfoR.min=this._baseFrequency,this.octaves=this._octaves}dispose(){return super.dispose(),this.Q.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._filtersL.forEach((t=>t.disconnect())),this._filtersR.forEach((t=>t.disconnect())),this.frequency.dispose(),this}}class za extends aa{constructor(){super(us(za.getDefaults(),arguments,["decay"])),this.name="Reverb",this._convolver=this.context.createConvolver(),this.ready=Promise.resolve();const t=us(za.getDefaults(),arguments,["decay"]);this._decay=t.decay,this._preDelay=t.preDelay,this.generate(),this.connectEffect(this._convolver)}static getDefaults(){return Object.assign(aa.getDefaults(),{decay:1.5,preDelay:.01})}get decay(){return this._decay}set decay(t){Ii(t=this.toSeconds(t),.001),this._decay=t,this.generate()}get preDelay(){return this._preDelay}set preDelay(t){Ii(t=this.toSeconds(t),0),this._preDelay=t,this.generate()}generate(){return ts(this,void 0,void 0,(function*(){const t=this.ready,e=new Os(2,this._decay+this._preDelay,this.context.sampleRate),n=new qr({context:e}),i=new qr({context:e}),s=new ya({context:e});n.connect(s,0,0),i.connect(s,0,1);const r=new or({context:e}).toDestination();s.connect(r),n.start(0),i.start(0),r.gain.setValueAtTime(0,0),r.gain.setValueAtTime(1,this._preDelay),r.gain.exponentialApproachValueAtTime(0,this._preDelay,this.decay);const o=e.render();return this.ready=o.then(Ds),yield t,this._convolver.buffer=(yield o).get(),this}))}dispose(){return super.dispose(),this._convolver.disconnect(),this}}class ja extends nr{constructor(){super(us(ja.getDefaults(),arguments)),this.name="MidSideSplit",this._split=this.input=new va({channels:2,context:this.context}),this._midAdd=new Jr({context:this.context}),this.mid=new Wr({context:this.context,value:Math.SQRT1_2}),this._sideSubtract=new lo({context:this.context}),this.side=new Wr({context:this.context,value:Math.SQRT1_2}),this._split.connect(this._midAdd,0),this._split.connect(this._midAdd.addend,1),this._split.connect(this._sideSubtract,0),this._split.connect(this._sideSubtract.subtrahend,1),this._midAdd.connect(this.mid),this._sideSubtract.connect(this.side)}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._midAdd.dispose(),this._sideSubtract.dispose(),this._split.dispose(),this}}class La extends nr{constructor(){super(us(La.getDefaults(),arguments)),this.name="MidSideMerge",this.mid=new or({context:this.context}),this.side=new or({context:this.context}),this._left=new Jr({context:this.context}),this._leftMult=new Wr({context:this.context,value:Math.SQRT1_2}),this._right=new lo({context:this.context}),this._rightMult=new Wr({context:this.context,value:Math.SQRT1_2}),this._merge=this.output=new ya({context:this.context}),this.mid.fan(this._left),this.side.connect(this._left.addend),this.mid.connect(this._right),this.side.connect(this._right.subtrahend),this._left.connect(this._leftMult),this._right.connect(this._rightMult),this._leftMult.connect(this._merge,0,0),this._rightMult.connect(this._merge,0,1)}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._leftMult.dispose(),this._rightMult.dispose(),this._left.dispose(),this._right.dispose(),this}}class Ba extends aa{constructor(t){super(t),this.name="MidSideEffect",this._midSideMerge=new La({context:this.context}),this._midSideSplit=new ja({context:this.context}),this._midSend=this._midSideSplit.mid,this._sideSend=this._midSideSplit.side,this._midReturn=this._midSideMerge.mid,this._sideReturn=this._midSideMerge.side,this.effectSend.connect(this._midSideSplit),this._midSideMerge.connect(this.effectReturn)}connectEffectMid(...t){this._midSend.chain(...t,this._midReturn)}connectEffectSide(...t){this._sideSend.chain(...t,this._sideReturn)}dispose(){return super.dispose(),this._midSideSplit.dispose(),this._midSideMerge.dispose(),this._midSend.dispose(),this._sideSend.dispose(),this._midReturn.dispose(),this._sideReturn.dispose(),this}}class Ua extends Ba{constructor(){super(us(Ua.getDefaults(),arguments,["width"])),this.name="StereoWidener";const t=us(Ua.getDefaults(),arguments,["width"]);this.width=new ur({context:this.context,value:t.width,units:"normalRange"}),ks(this,["width"]),this._twoTimesWidthMid=new Wr({context:this.context,value:2}),this._twoTimesWidthSide=new Wr({context:this.context,value:2}),this._midMult=new Wr({context:this.context}),this._twoTimesWidthMid.connect(this._midMult.factor),this.connectEffectMid(this._midMult),this._oneMinusWidth=new lo({context:this.context}),this._oneMinusWidth.connect(this._twoTimesWidthMid),sr(this.context.getConstant(1),this._oneMinusWidth),this.width.connect(this._oneMinusWidth.subtrahend),this._sideMult=new Wr({context:this.context}),this.width.connect(this._twoTimesWidthSide),this._twoTimesWidthSide.connect(this._sideMult.factor),this.connectEffectSide(this._sideMult)}static getDefaults(){return Object.assign(Ba.getDefaults(),{width:.5})}dispose(){return super.dispose(),this.width.dispose(),this._midMult.dispose(),this._sideMult.dispose(),this._twoTimesWidthMid.dispose(),this._twoTimesWidthSide.dispose(),this._oneMinusWidth.dispose(),this}}class Wa extends ba{constructor(){super(us(Wa.getDefaults(),arguments,["frequency","depth"])),this.name="Tremolo";const t=us(Wa.getDefaults(),arguments,["frequency","depth"]);this._lfoL=new eo({context:this.context,type:t.type,min:1,max:0}),this._lfoR=new eo({context:this.context,type:t.type,min:1,max:0}),this._amplitudeL=new or({context:this.context}),this._amplitudeR=new or({context:this.context}),this.frequency=new ur({context:this.context,value:t.frequency,units:"frequency"}),this.depth=new ur({context:this.context,value:t.depth,units:"normalRange"}),ks(this,["frequency","depth"]),this.connectEffectLeft(this._amplitudeL),this.connectEffectRight(this._amplitudeR),this._lfoL.connect(this._amplitudeL.gain),this._lfoR.connect(this._amplitudeR.gain),this.frequency.fan(this._lfoL.frequency,this._lfoR.frequency),this.depth.fan(this._lfoR.amplitude,this._lfoL.amplitude),this.spread=t.spread}static getDefaults(){return Object.assign(ba.getDefaults(),{frequency:10,type:"sine",depth:.5,spread:180})}start(t){return this._lfoL.start(t),this._lfoR.start(t),this}stop(t){return this._lfoL.stop(t),this._lfoR.stop(t),this}sync(){return this._lfoL.sync(),this._lfoR.sync(),this.context.transport.syncSignal(this.frequency),this}unsync(){return this._lfoL.unsync(),this._lfoR.unsync(),this.context.transport.unsyncSignal(this.frequency),this}get type(){return this._lfoL.type}set type(t){this._lfoL.type=t,this._lfoR.type=t}get spread(){return this._lfoR.phase-this._lfoL.phase}set spread(t){this._lfoL.phase=90-t/2,this._lfoR.phase=t/2+90}dispose(){return super.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._amplitudeL.dispose(),this._amplitudeR.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class Ga extends aa{constructor(){super(us(Ga.getDefaults(),arguments,["frequency","depth"])),this.name="Vibrato";const t=us(Ga.getDefaults(),arguments,["frequency","depth"]);this._delayNode=new _r({context:this.context,delayTime:0,maxDelay:t.maxDelay}),this._lfo=new eo({context:this.context,type:t.type,min:0,max:t.maxDelay,frequency:t.frequency,phase:-90}).start().connect(this._delayNode.delayTime),this.frequency=this._lfo.frequency,this.depth=this._lfo.amplitude,this.depth.value=t.depth,ks(this,["frequency","depth"]),this.effectSend.chain(this._delayNode,this.effectReturn)}static getDefaults(){return Object.assign(aa.getDefaults(),{maxDelay:.005,frequency:5,depth:.1,type:"sine"})}get type(){return this._lfo.type}set type(t){this._lfo.type=t}dispose(){return super.dispose(),this._delayNode.dispose(),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class Ya extends nr{constructor(){super(us(Ya.getDefaults(),arguments,["type","size"])),this.name="Analyser",this._analysers=[],this._buffers=[];const t=us(Ya.getDefaults(),arguments,["type","size"]);this.input=this.output=this._gain=new or({context:this.context}),this._split=new va({context:this.context,channels:t.channels}),this.input.connect(this._split),Ii(t.channels,1);for(let e=0;e<t.channels;e++)this._analysers[e]=this.context.createAnalyser(),this._split.connect(this._analysers[e],e,0);this.size=t.size,this.type=t.type}static getDefaults(){return Object.assign(nr.getDefaults(),{size:1024,smoothing:.8,type:"fft",channels:1})}getValue(){return this._analysers.forEach(((t,e)=>{const n=this._buffers[e];"fft"===this._type?t.getFloatFrequencyData(n):"waveform"===this._type&&t.getFloatTimeDomainData(n)})),1===this.channels?this._buffers[0]:this._buffers}get size(){return this._analysers[0].frequencyBinCount}set size(t){this._analysers.forEach(((e,n)=>{e.fftSize=2*t,this._buffers[n]=new Float32Array(t)}))}get channels(){return this._analysers.length}get type(){return this._type}set type(t){Fi("waveform"===t||"fft"===t,`Analyser: invalid type: ${t}`),this._type=t}get smoothing(){return this._analysers[0].smoothingTimeConstant}set smoothing(t){this._analysers.forEach((e=>e.smoothingTimeConstant=t))}dispose(){return super.dispose(),this._analysers.forEach((t=>t.disconnect())),this._split.dispose(),this._gain.dispose(),this}}class Ha extends nr{constructor(){super(us(Ha.getDefaults(),arguments)),this.name="MeterBase",this.input=this.output=this._analyser=new Ya({context:this.context,size:256,type:"waveform"})}dispose(){return super.dispose(),this._analyser.dispose(),this}}class Xa extends Ha{constructor(){super(us(Xa.getDefaults(),arguments,["smoothing"])),this.name="Meter",this._rms=0;const t=us(Xa.getDefaults(),arguments,["smoothing"]);this.input=this.output=this._analyser=new Ya({context:this.context,size:256,type:"waveform",channels:t.channels}),this.smoothing=t.smoothing,this.normalRange=t.normalRange}static getDefaults(){return Object.assign(Ha.getDefaults(),{smoothing:.8,normalRange:!1,channels:1})}getLevel(){return Li("'getLevel' has been changed to 'getValue'"),this.getValue()}getValue(){const t=this._analyser.getValue(),e=(1===this.channels?[t]:t).map((t=>{const e=t.reduce(((t,e)=>t+e*e),0),n=Math.sqrt(e/t.length);return this._rms=Math.max(n,this._rms*this.smoothing),this.normalRange?this._rms:Vs(this._rms)}));return 1===this.channels?e[0]:e}get channels(){return this._analyser.channels}dispose(){return super.dispose(),this._analyser.dispose(),this}}class Za extends Ha{constructor(){super(us(Za.getDefaults(),arguments,["size"])),this.name="FFT";const t=us(Za.getDefaults(),arguments,["size"]);this.normalRange=t.normalRange,this._analyser.type="fft",this.size=t.size}static getDefaults(){return Object.assign(nr.getDefaults(),{normalRange:!1,size:1024,smoothing:.8})}getValue(){return this._analyser.getValue().map((t=>this.normalRange?Ps(t):t))}get size(){return this._analyser.size}set size(t){this._analyser.size=t}get smoothing(){return this._analyser.smoothing}set smoothing(t){this._analyser.smoothing=t}getFrequencyOfIndex(t){return Fi(0<=t&&t<this.size,`index must be greater than or equal to 0 and less than ${this.size}`),t*this.context.sampleRate/(2*this.size)}}class $a extends Ha{constructor(){super(us($a.getDefaults(),arguments)),this.name="DCMeter",this._analyser.type="waveform",this._analyser.size=256}getValue(){return this._analyser.getValue()[0]}}class Qa extends Ha{constructor(){super(us(Qa.getDefaults(),arguments,["size"])),this.name="Waveform";const t=us(Qa.getDefaults(),arguments,["size"]);this._analyser.type="waveform",this.size=t.size}static getDefaults(){return Object.assign(Ha.getDefaults(),{size:1024})}getValue(){return this._analyser.getValue()}get size(){return this._analyser.size}set size(t){this._analyser.size=t}}class Ja extends nr{constructor(){super(us(Ja.getDefaults(),arguments,["solo"])),this.name="Solo";const t=us(Ja.getDefaults(),arguments,["solo"]);this.input=this.output=new or({context:this.context}),Ja._allSolos.has(this.context)||Ja._allSolos.set(this.context,new Set),Ja._allSolos.get(this.context).add(this),this.solo=t.solo}static getDefaults(){return Object.assign(nr.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(t){t?this._addSolo():this._removeSolo(),Ja._allSolos.get(this.context).forEach((t=>t._updateSolo()))}get muted(){return 0===this.input.gain.value}_addSolo(){Ja._soloed.has(this.context)||Ja._soloed.set(this.context,new Set),Ja._soloed.get(this.context).add(this)}_removeSolo(){Ja._soloed.has(this.context)&&Ja._soloed.get(this.context).delete(this)}_isSoloed(){return Ja._soloed.has(this.context)&&Ja._soloed.get(this.context).has(this)}_noSolos(){return!Ja._soloed.has(this.context)||Ja._soloed.has(this.context)&&0===Ja._soloed.get(this.context).size}_updateSolo(){this._isSoloed()||this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),Ja._allSolos.get(this.context).delete(this),this._removeSolo(),this}}Ja._allSolos=new Map,Ja._soloed=new Map;class Ka extends nr{constructor(){super(us(Ka.getDefaults(),arguments,["pan","volume"])),this.name="PanVol";const t=us(Ka.getDefaults(),arguments,["pan","volume"]);this._panner=this.input=new la({context:this.context,pan:t.pan,channelCount:t.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new Sr({context:this.context,volume:t.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=t.mute,ks(this,["pan","volume"])}static getDefaults(){return Object.assign(nr.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class tc extends nr{constructor(){super(us(tc.getDefaults(),arguments,["volume","pan"])),this.name="Channel";const t=us(tc.getDefaults(),arguments,["volume","pan"]);this._solo=this.input=new Ja({solo:t.solo,context:this.context}),this._panVol=this.output=new Ka({context:this.context,pan:t.pan,volume:t.volume,mute:t.mute,channelCount:t.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),ks(this,["pan","volume"])}static getDefaults(){return Object.assign(nr.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(t){this._solo.solo=t}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(t){this._panVol.mute=t}_getBus(t){return tc.buses.has(t)||tc.buses.set(t,new or({context:this.context})),tc.buses.get(t)}send(t,e=0){const n=this._getBus(t),i=new or({context:this.context,units:"decibels",gain:e});return this.connect(i),i.connect(n),i}receive(t){return this._getBus(t).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}tc.buses=new Map;class ec extends nr{constructor(){super(us(ec.getDefaults(),arguments)),this.name="Mono",this.input=new or({context:this.context}),this._merge=this.output=new ya({channels:2,context:this.context}),this.input.connect(this._merge,0,0),this.input.connect(this._merge,0,1)}dispose(){return super.dispose(),this._merge.dispose(),this.input.dispose(),this}}class nc extends nr{constructor(){super(us(nc.getDefaults(),arguments,["lowFrequency","highFrequency"])),this.name="MultibandSplit",this.input=new or({context:this.context}),this.output=void 0,this.low=new Ao({context:this.context,frequency:0,type:"lowpass"}),this._lowMidFilter=new Ao({context:this.context,frequency:0,type:"highpass"}),this.mid=new Ao({context:this.context,frequency:0,type:"lowpass"}),this.high=new Ao({context:this.context,frequency:0,type:"highpass"}),this._internalChannels=[this.low,this.mid,this.high];const t=us(nc.getDefaults(),arguments,["lowFrequency","highFrequency"]);this.lowFrequency=new ur({context:this.context,units:"frequency",value:t.lowFrequency}),this.highFrequency=new ur({context:this.context,units:"frequency",value:t.highFrequency}),this.Q=new ur({context:this.context,units:"positive",value:t.Q}),this.input.fan(this.low,this.high),this.input.chain(this._lowMidFilter,this.mid),this.lowFrequency.fan(this.low.frequency,this._lowMidFilter.frequency),this.highFrequency.fan(this.mid.frequency,this.high.frequency),this.Q.connect(this.low.Q),this.Q.connect(this._lowMidFilter.Q),this.Q.connect(this.mid.Q),this.Q.connect(this.high.Q),ks(this,["high","mid","low","highFrequency","lowFrequency"])}static getDefaults(){return Object.assign(nr.getDefaults(),{Q:1,highFrequency:2500,lowFrequency:400})}dispose(){return super.dispose(),Cs(this,["high","mid","low","highFrequency","lowFrequency"]),this.low.dispose(),this._lowMidFilter.dispose(),this.mid.dispose(),this.high.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this.Q.dispose(),this}}class ic extends nr{constructor(){super(...arguments),this.name="Listener",this.positionX=new er({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new er({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new er({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new er({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new er({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new er({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new er({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new er({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new er({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(nr.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}xs((t=>{t.listener=new ic({context:t})})),Ts((t=>{t.listener.dispose()}));class sc extends nr{constructor(){super(us(sc.getDefaults(),arguments,["positionX","positionY","positionZ"])),this.name="Panner3D";const t=us(sc.getDefaults(),arguments,["positionX","positionY","positionZ"]);this._panner=this.input=this.output=this.context.createPanner(),this.panningModel=t.panningModel,this.maxDistance=t.maxDistance,this.distanceModel=t.distanceModel,this.coneOuterGain=t.coneOuterGain,this.coneOuterAngle=t.coneOuterAngle,this.coneInnerAngle=t.coneInnerAngle,this.refDistance=t.refDistance,this.rolloffFactor=t.rolloffFactor,this.positionX=new er({context:this.context,param:this._panner.positionX,value:t.positionX}),this.positionY=new er({context:this.context,param:this._panner.positionY,value:t.positionY}),this.positionZ=new er({context:this.context,param:this._panner.positionZ,value:t.positionZ}),this.orientationX=new er({context:this.context,param:this._panner.orientationX,value:t.orientationX}),this.orientationY=new er({context:this.context,param:this._panner.orientationY,value:t.orientationY}),this.orientationZ=new er({context:this.context,param:this._panner.orientationZ,value:t.orientationZ})}static getDefaults(){return Object.assign(nr.getDefaults(),{coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:0,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1})}setPosition(t,e,n){return this.positionX.value=t,this.positionY.value=e,this.positionZ.value=n,this}setOrientation(t,e,n){return this.orientationX.value=t,this.orientationY.value=e,this.orientationZ.value=n,this}get panningModel(){return this._panner.panningModel}set panningModel(t){this._panner.panningModel=t}get refDistance(){return this._panner.refDistance}set refDistance(t){this._panner.refDistance=t}get rolloffFactor(){return this._panner.rolloffFactor}set rolloffFactor(t){this._panner.rolloffFactor=t}get distanceModel(){return this._panner.distanceModel}set distanceModel(t){this._panner.distanceModel=t}get coneInnerAngle(){return this._panner.coneInnerAngle}set coneInnerAngle(t){this._panner.coneInnerAngle=t}get coneOuterAngle(){return this._panner.coneOuterAngle}set coneOuterAngle(t){this._panner.coneOuterAngle=t}get coneOuterGain(){return this._panner.coneOuterGain}set coneOuterGain(t){this._panner.coneOuterGain=t}get maxDistance(){return this._panner.maxDistance}set maxDistance(t){this._panner.maxDistance=t}dispose(){return super.dispose(),this._panner.disconnect(),this.orientationX.dispose(),this.orientationY.dispose(),this.orientationZ.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this}}class rc extends nr{constructor(){super(us(rc.getDefaults(),arguments)),this.name="Recorder";const t=us(rc.getDefaults(),arguments);this.input=new or({context:this.context}),Fi(rc.supported,"Media Recorder API is not available"),this._stream=this.context.createMediaStreamDestination(),this.input.connect(this._stream),this._recorder=new MediaRecorder(this._stream.stream,{mimeType:t.mimeType})}static getDefaults(){return nr.getDefaults()}get mimeType(){return this._recorder.mimeType}static get supported(){return null!==Qi&&Reflect.has(Qi,"MediaRecorder")}get state(){return"inactive"===this._recorder.state?"stopped":"paused"===this._recorder.state?"paused":"started"}start(){return ts(this,void 0,void 0,(function*(){Fi("started"!==this.state,"Recorder is already started");const t=new Promise((t=>{const e=()=>{this._recorder.removeEventListener("start",e,!1),t()};this._recorder.addEventListener("start",e,!1)}));return this._recorder.start(),yield t}))}stop(){return ts(this,void 0,void 0,(function*(){Fi("stopped"!==this.state,"Recorder is not started");const t=new Promise((t=>{const e=n=>{this._recorder.removeEventListener("dataavailable",e,!1),t(n.data)};this._recorder.addEventListener("dataavailable",e,!1)}));return this._recorder.stop(),yield t}))}pause(){return Fi("started"===this.state,"Recorder must be started"),this._recorder.pause(),this}dispose(){return super.dispose(),this.input.dispose(),this._stream.disconnect(),this}}class oc extends nr{constructor(){super(us(oc.getDefaults(),arguments,["threshold","ratio"])),this.name="Compressor",this._compressor=this.context.createDynamicsCompressor(),this.input=this._compressor,this.output=this._compressor;const t=us(oc.getDefaults(),arguments,["threshold","ratio"]);this.threshold=new er({minValue:this._compressor.threshold.minValue,maxValue:this._compressor.threshold.maxValue,context:this.context,convert:!1,param:this._compressor.threshold,units:"decibels",value:t.threshold}),this.attack=new er({minValue:this._compressor.attack.minValue,maxValue:this._compressor.attack.maxValue,context:this.context,param:this._compressor.attack,units:"time",value:t.attack}),this.release=new er({minValue:this._compressor.release.minValue,maxValue:this._compressor.release.maxValue,context:this.context,param:this._compressor.release,units:"time",value:t.release}),this.knee=new er({minValue:this._compressor.knee.minValue,maxValue:this._compressor.knee.maxValue,context:this.context,convert:!1,param:this._compressor.knee,units:"decibels",value:t.knee}),this.ratio=new er({minValue:this._compressor.ratio.minValue,maxValue:this._compressor.ratio.maxValue,context:this.context,convert:!1,param:this._compressor.ratio,units:"positive",value:t.ratio}),ks(this,["knee","release","attack","ratio","threshold"])}static getDefaults(){return Object.assign(nr.getDefaults(),{attack:.003,knee:30,ratio:12,release:.25,threshold:-24})}get reduction(){return this._compressor.reduction}dispose(){return super.dispose(),this._compressor.disconnect(),this.attack.dispose(),this.release.dispose(),this.threshold.dispose(),this.ratio.dispose(),this.knee.dispose(),this}}class ac extends nr{constructor(){super(Object.assign(us(ac.getDefaults(),arguments,["threshold","smoothing"]))),this.name="Gate";const t=us(ac.getDefaults(),arguments,["threshold","smoothing"]);this._follower=new fa({context:this.context,smoothing:t.smoothing}),this._gt=new fo({context:this.context,value:Ps(t.threshold)}),this.input=new or({context:this.context}),this._gate=this.output=new or({context:this.context}),this.input.connect(this._gate),this.input.chain(this._follower,this._gt,this._gate.gain)}static getDefaults(){return Object.assign(nr.getDefaults(),{smoothing:.1,threshold:-40})}get threshold(){return Vs(this._gt.value)}set threshold(t){this._gt.value=Ps(t)}get smoothing(){return this._follower.smoothing}set smoothing(t){this._follower.smoothing=t}dispose(){return super.dispose(),this.input.dispose(),this._follower.dispose(),this._gt.dispose(),this._gate.dispose(),this}}class cc extends nr{constructor(){super(Object.assign(us(cc.getDefaults(),arguments,["threshold"]))),this.name="Limiter";const t=us(cc.getDefaults(),arguments,["threshold"]);this._compressor=this.input=this.output=new oc({context:this.context,ratio:20,attack:.003,release:.01,threshold:t.threshold}),this.threshold=this._compressor.threshold,ks(this,"threshold")}static getDefaults(){return Object.assign(nr.getDefaults(),{threshold:-12})}get reduction(){return this._compressor.reduction}dispose(){return super.dispose(),this._compressor.dispose(),this.threshold.dispose(),this}}class uc extends nr{constructor(){super(Object.assign(us(uc.getDefaults(),arguments))),this.name="MidSideCompressor";const t=us(uc.getDefaults(),arguments);this._midSideSplit=this.input=new ja({context:this.context}),this._midSideMerge=this.output=new La({context:this.context}),this.mid=new oc(Object.assign(t.mid,{context:this.context})),this.side=new oc(Object.assign(t.side,{context:this.context})),this._midSideSplit.mid.chain(this.mid,this._midSideMerge.mid),this._midSideSplit.side.chain(this.side,this._midSideMerge.side),ks(this,["mid","side"])}static getDefaults(){return Object.assign(nr.getDefaults(),{mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},side:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10}})}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._midSideSplit.dispose(),this._midSideMerge.dispose(),this}}class lc extends nr{constructor(){super(Object.assign(us(lc.getDefaults(),arguments))),this.name="MultibandCompressor";const t=us(lc.getDefaults(),arguments);this._splitter=this.input=new nc({context:this.context,lowFrequency:t.lowFrequency,highFrequency:t.highFrequency}),this.lowFrequency=this._splitter.lowFrequency,this.highFrequency=this._splitter.highFrequency,this.output=new or({context:this.context}),this.low=new oc(Object.assign(t.low,{context:this.context})),this.mid=new oc(Object.assign(t.mid,{context:this.context})),this.high=new oc(Object.assign(t.high,{context:this.context})),this._splitter.low.chain(this.low,this.output),this._splitter.mid.chain(this.mid,this.output),this._splitter.high.chain(this.high,this.output),ks(this,["high","mid","low","highFrequency","lowFrequency"])}static getDefaults(){return Object.assign(nr.getDefaults(),{lowFrequency:250,highFrequency:2e3,low:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10},mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},high:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16}})}dispose(){return super.dispose(),this._splitter.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.output.dispose(),this}}class hc extends nr{constructor(){super(us(hc.getDefaults(),arguments,["low","mid","high"])),this.name="EQ3",this.output=new or({context:this.context}),this._internalChannels=[];const t=us(hc.getDefaults(),arguments,["low","mid","high"]);this.input=this._multibandSplit=new nc({context:this.context,highFrequency:t.highFrequency,lowFrequency:t.lowFrequency}),this._lowGain=new or({context:this.context,gain:t.low,units:"decibels"}),this._midGain=new or({context:this.context,gain:t.mid,units:"decibels"}),this._highGain=new or({context:this.context,gain:t.high,units:"decibels"}),this.low=this._lowGain.gain,this.mid=this._midGain.gain,this.high=this._highGain.gain,this.Q=this._multibandSplit.Q,this.lowFrequency=this._multibandSplit.lowFrequency,this.highFrequency=this._multibandSplit.highFrequency,this._multibandSplit.low.chain(this._lowGain,this.output),this._multibandSplit.mid.chain(this._midGain,this.output),this._multibandSplit.high.chain(this._highGain,this.output),ks(this,["low","mid","high","lowFrequency","highFrequency"]),this._internalChannels=[this._multibandSplit]}static getDefaults(){return Object.assign(nr.getDefaults(),{high:0,highFrequency:2500,low:0,lowFrequency:400,mid:0})}dispose(){return super.dispose(),Cs(this,["low","mid","high","lowFrequency","highFrequency"]),this._multibandSplit.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this._lowGain.dispose(),this._midGain.dispose(),this._highGain.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.Q.dispose(),this}}class fc extends nr{constructor(){super(us(fc.getDefaults(),arguments,["url","onload"])),this.name="Convolver",this._convolver=this.context.createConvolver();const t=us(fc.getDefaults(),arguments,["url","onload"]);this._buffer=new Es(t.url,(e=>{this.buffer=e,t.onload()})),this.input=new or({context:this.context}),this.output=new or({context:this.context}),this._buffer.loaded&&(this.buffer=this._buffer),this.normalize=t.normalize,this.input.chain(this._convolver,this.output)}static getDefaults(){return Object.assign(nr.getDefaults(),{normalize:!0,onload:Ds})}load(t){return ts(this,void 0,void 0,(function*(){this.buffer=yield this._buffer.load(t)}))}get buffer(){return this._buffer.length?this._buffer:null}set buffer(t){t&&this._buffer.set(t),this._convolver.buffer&&(this.input.disconnect(),this._convolver.disconnect(),this._convolver=this.context.createConvolver(),this.input.chain(this._convolver,this.output));const e=this._buffer.get();this._convolver.buffer=e||null}get normalize(){return this._convolver.normalize}set normalize(t){this._convolver.normalize=t}dispose(){return super.dispose(),this._buffer.dispose(),this._convolver.disconnect(),this}}function dc(){return Ns().now()}function pc(){return Ns().immediate()}const _c=Ns().transport;function mc(){return Ns().transport}const gc=Ns().destination,vc=Ns().destination;function yc(){return Ns().destination}const bc=Ns().listener;function xc(){return Ns().listener}const wc=Ns().draw;function Tc(){return Ns().draw}const Mc=Ns();function Sc(){return Es.loaded()}const Ac=Es,kc=gr,Cc=Rr},663:(t,e,n)=>{const i=n(543);class s{static steps=16;static drumHits=["Transport","Kick","Snare","Hat"];constructor(t){this.wrapper=i.select(t)}render(t){[""].push(...s.drumHits),this.wrapper.append("div").attr("id","drum-labels").selectAll(".drum-label").data(s.drumHits).enter().append("div").attr("class","drum-label").text((t=>"Transport"==t?"":t)),this.wrapper.selectAll(".drum-step").data([...Array(s.steps).keys()]).enter().append("div").attr("class","drum-step").attr("id",(t=>`drum-step-${t}`)).selectAll(".hit").data((t=>s.drumHits.map((e=>({step:t,hit:e}))))).enter().append("button").attr("class",(t=>"Transport"==t.hit?"transport":"hit")).attr("id",(t=>`drum-transport-${t.step}`)).property("disabled",(t=>"Transport"==t.hit)).on("click",((e,n)=>t(e,n.step,n.hit)))}}t.exports=s},503:(t,e,n)=>{const i=n(785);t.exports=class{constructor(){this.noise=new i.NoiseSynth({noise:{type:"pink"},envelope:{attack:.002,decay:.05,sustain:.03}}),new i.FeedbackDelay({delayTime:"32n",feedback:.15});let t=new i.Gate(-25),e=new i.MidSideCompressor,n=new i.Gain(.3);this.noise.chain(t,e,n),n.chain(i.Destination)}hit(t){this.noise.triggerAttackRelease("32n",t)}}},92:t=>{t.exports=(t,e)=>{null==t&&(t=16),null==e&&(e=1);let n=[0,e],i=0;for(;n.length<t;)germinalInterval=n.slice(i,i+2),germinalIntDistance=germinalInterval[1]-germinalInterval[0],n=n.concat([n[n.length-2]+-1*germinalIntDistance,n[n.length-1]+germinalIntDistance]),i+=1;return n}},440:(t,e,n)=>{const i=n(785);t.exports=class{constructor(){this.kick=new i.MembraneSynth;let t=new i.Gate(-50),e=new i.MidSideCompressor,n=new i.Gain;this.kick.chain(t,e,n),n.chain(i.Destination)}hit(t){this.kick.triggerAttackRelease("C1","16n",t)}}},214:t=>{t.exports=[{octave:-2,note:"C",note_full:"C-2",midi:0},{octave:-2,note:"C#",note_full:"C#-2",midi:1},{octave:-2,note:"D",note_full:"D-2",midi:2},{octave:-2,note:"D#",note_full:"D#-2",midi:3},{octave:-2,note:"E",note_full:"E-2",midi:4},{octave:-2,note:"F",note_full:"F-2",midi:5},{octave:-2,note:"F#",note_full:"F#-2",midi:6},{octave:-2,note:"G",note_full:"G-2",midi:7},{octave:-2,note:"G#",note_full:"G#-2",midi:8},{octave:-2,note:"A",note_full:"A-2",midi:9},{octave:-2,note:"A#",note_full:"A#-2",midi:10},{octave:-2,note:"B",note_full:"B-2",midi:11},{octave:-1,note:"C",note_full:"C-1",midi:12},{octave:-1,note:"C#",note_full:"C#-1",midi:13},{octave:-1,note:"D",note_full:"D-1",midi:14},{octave:-1,note:"D#",note_full:"D#-1",midi:15},{octave:-1,note:"E",note_full:"E-1",midi:16},{octave:-1,note:"F",note_full:"F-1",midi:17},{octave:-1,note:"F#",note_full:"F#-1",midi:18},{octave:-1,note:"G",note_full:"G-1",midi:19},{octave:-1,note:"G#",note_full:"G#-1",midi:20},{octave:-1,note:"A",note_full:"A-1",midi:21},{octave:-1,note:"A#",note_full:"A#-1",midi:22},{octave:-1,note:"B",note_full:"B-1",midi:23},{octave:0,note:"C",note_full:"C0",midi:24},{octave:0,note:"C#",note_full:"C#0",midi:25},{octave:0,note:"D",note_full:"D0",midi:26},{octave:0,note:"D#",note_full:"D#0",midi:27},{octave:0,note:"E",note_full:"E0",midi:28},{octave:0,note:"F",note_full:"F0",midi:29},{octave:0,note:"F#",note_full:"F#0",midi:30},{octave:0,note:"G",note_full:"G0",midi:31},{octave:0,note:"G#",note_full:"G#0",midi:32},{octave:0,note:"A",note_full:"A0",midi:33},{octave:0,note:"A#",note_full:"A#0",midi:34},{octave:0,note:"B",note_full:"B0",midi:35},{octave:1,note:"C",note_full:"C1",midi:36},{octave:1,note:"C#",note_full:"C#1",midi:37},{octave:1,note:"D",note_full:"D1",midi:38},{octave:1,note:"D#",note_full:"D#1",midi:39},{octave:1,note:"E",note_full:"E1",midi:40},{octave:1,note:"F",note_full:"F1",midi:41},{octave:1,note:"F#",note_full:"F#1",midi:42},{octave:1,note:"G",note_full:"G1",midi:43},{octave:1,note:"G#",note_full:"G#1",midi:44},{octave:1,note:"A",note_full:"A1",midi:45},{octave:1,note:"A#",note_full:"A#1",midi:46},{octave:1,note:"B",note_full:"B1",midi:47},{octave:2,note:"C",note_full:"C2",midi:48},{octave:2,note:"C#",note_full:"C#2",midi:49},{octave:2,note:"D",note_full:"D2",midi:50},{octave:2,note:"D#",note_full:"D#2",midi:51},{octave:2,note:"E",note_full:"E2",midi:52},{octave:2,note:"F",note_full:"F2",midi:53},{octave:2,note:"F#",note_full:"F#2",midi:54},{octave:2,note:"G",note_full:"G2",midi:55},{octave:2,note:"G#",note_full:"G#2",midi:56},{octave:2,note:"A",note_full:"A2",midi:57},{octave:2,note:"A#",note_full:"A#2",midi:58},{octave:2,note:"B",note_full:"B2",midi:59},{octave:3,note:"C",note_full:"C3",midi:60},{octave:3,note:"C#",note_full:"C#3",midi:61},{octave:3,note:"D",note_full:"D3",midi:62},{octave:3,note:"D#",note_full:"D#3",midi:63},{octave:3,note:"E",note_full:"E3",midi:64},{octave:3,note:"F",note_full:"F3",midi:65},{octave:3,note:"F#",note_full:"F#3",midi:66},{octave:3,note:"G",note_full:"G3",midi:67},{octave:3,note:"G#",note_full:"G#3",midi:68},{octave:3,note:"A",note_full:"A3",midi:69},{octave:3,note:"A#",note_full:"A#3",midi:70},{octave:3,note:"B",note_full:"B3",midi:71},{octave:4,note:"C",note_full:"C4",midi:72},{octave:4,note:"C#",note_full:"C#4",midi:73},{octave:4,note:"D",note_full:"D4",midi:74},{octave:4,note:"D#",note_full:"D#4",midi:75},{octave:4,note:"E",note_full:"E4",midi:76},{octave:4,note:"F",note_full:"F4",midi:77},{octave:4,note:"F#",note_full:"F#4",midi:78},{octave:4,note:"G",note_full:"G4",midi:79},{octave:4,note:"G#",note_full:"G#4",midi:80},{octave:4,note:"A",note_full:"A4",midi:81},{octave:4,note:"A#",note_full:"A#4",midi:82},{octave:4,note:"B",note_full:"B4",midi:83},{octave:5,note:"C",note_full:"C5",midi:84},{octave:5,note:"C#",note_full:"C#5",midi:85},{octave:5,note:"D",note_full:"D5",midi:86},{octave:5,note:"D#",note_full:"D#5",midi:87},{octave:5,note:"E",note_full:"E5",midi:88},{octave:5,note:"F",note_full:"F5",midi:89},{octave:5,note:"F#",note_full:"F#5",midi:90},{octave:5,note:"G",note_full:"G5",midi:91},{octave:5,note:"G#",note_full:"G#5",midi:92},{octave:5,note:"A",note_full:"A5",midi:93},{octave:5,note:"A#",note_full:"A#5",midi:94},{octave:5,note:"B",note_full:"B5",midi:95},{octave:6,note:"C",note_full:"C6",midi:96},{octave:6,note:"C#",note_full:"C#6",midi:97},{octave:6,note:"D",note_full:"D6",midi:98},{octave:6,note:"D#",note_full:"D#6",midi:99},{octave:6,note:"E",note_full:"E6",midi:100},{octave:6,note:"F",note_full:"F6",midi:101},{octave:6,note:"F#",note_full:"F#6",midi:102},{octave:6,note:"G",note_full:"G6",midi:103},{octave:6,note:"G#",note_full:"G#6",midi:104},{octave:6,note:"A",note_full:"A6",midi:105},{octave:6,note:"A#",note_full:"A#6",midi:106},{octave:6,note:"B",note_full:"B6",midi:107},{octave:7,note:"C",note_full:"C7",midi:108},{octave:7,note:"C#",note_full:"C#7",midi:109},{octave:7,note:"D",note_full:"D7",midi:110},{octave:7,note:"D#",note_full:"D#7",midi:111},{octave:7,note:"E",note_full:"E7",midi:112},{octave:7,note:"F",note_full:"F7",midi:113},{octave:7,note:"F#",note_full:"F#7",midi:114},{octave:7,note:"G",note_full:"G7",midi:115},{octave:7,note:"G#",note_full:"G#7",midi:116},{octave:7,note:"A",note_full:"A7",midi:117},{octave:7,note:"A#",note_full:"A#7",midi:118},{octave:7,note:"B",note_full:"B7",midi:119},{octave:8,note:"C",note_full:"C8",midi:120},{octave:8,note:"C#",note_full:"C#8",midi:121},{octave:8,note:"D",note_full:"D8",midi:122},{octave:8,note:"D#",note_full:"D#8",midi:123},{octave:8,note:"E",note_full:"E8",midi:124},{octave:8,note:"F",note_full:"F8",midi:125},{octave:8,note:"F#",note_full:"F#8",midi:126},{octave:8,note:"G",note_full:"G8",midi:127}]},504:(t,e,n)=>{const i=n(543),s=n(214);class r{static width=1080;static octaveHeight=180;static notesPerOctave=12;static pianoRollPadding=80;static transportPadding=15;constructor(t,e,n,o){this.svg=i.select(t),this._sequence=[],this._tonicIndex=s.findIndex((t=>t.note_full==e)),this.extent=o,this.steps=n,this.activeNotes=[],this.keyHeight=r.octaveHeight/r.notesPerOctave}get sequence(){return this._sequence}set sequence(t){this._sequence=t}get tonicIndex(){return this._tonicIndex}set tonicIndex(t){this._tonicIndex=t}setNotes(t,e){this._sequence=t;let n=i.scaleLinear().domain([0,this._sequence.length]).range([r.pianoRollPadding,r.width]),s=i.scaleLinear().domain([this.extent[1]+this._tonicIndex+1,this.extent[0]+this._tonicIndex]).range([0,this.keyHeight*this.activeNotes.length]),o=(r.width-r.pianoRollPadding)/this._sequence.length;this.roll.selectAll(".sequence-note").data((()=>this._sequence.reduce(((t,e,n,i)=>(null!=e&&t.push({step:n,note:e}),t)),[]))).enter().append("rect").attr("class","sequence-note").attr("width",o).attr("height",this.keyHeight).attr("x",(t=>n(t.step))).attr("y",(t=>s(t.note)-this.keyHeight)).attr("fill","red").on("click",((t,n)=>e(n.note)))}render(){let t=(r.width-r.pianoRollPadding)/this.steps;this.activeNotes=s.slice(this._tonicIndex+this.extent[0],this._tonicIndex+this.extent[1]+1).reverse();let e=this.activeNotes.map((t=>t.octave)).filter(o);i.selectAll("svg .transport").remove(),i.selectAll(".keys").remove(),this.svg.attr("height",this.keyHeight*this.activeNotes.length+r.transportPadding),this.transport=this.svg.append("g").attr("class","transport").attr("width",r.width).attr("height",r.transportPadding),this.transport.selectAll(".step").data([...Array(this.steps).keys()]).enter().append("rect").attr("class",(t=>`step step-${t}`)).attr("width",t).attr("height",r.transportPadding).attr("x",(e=>e*t+r.pianoRollPadding)).attr("y",0).attr("fill","#999").attr("stroke","#bbb"),this.roll=this.svg.append("g").attr("transform",`translate(0, ${r.transportPadding})`).attr("class","keys").attr("width",r.width).attr("height",this.keyHeight*this.activeNotes.length).attr("stroke","#aaa"),this.roll.selectAll(".key").data(this.activeNotes).enter().append("rect").attr("class","key").attr("width",r.width-r.pianoRollPadding).attr("height",this.keyHeight).attr("x",r.pianoRollPadding).attr("y",((t,e)=>e*this.keyHeight)).attr("fill",(t=>"#"==t.note.charAt(t.note.length-1)?"#ccc":"#fff")),this.roll.selectAll(".note-label").data(this.activeNotes).enter().append("text").text((t=>t.note)).attr("fill","black").attr("font-size",12).attr("x",r.pianoRollPadding/2).attr("y",((t,e)=>e*this.keyHeight+this.keyHeight-this.keyHeight/3));let n=this.activeNotes.reduce(((t,e,n,i)=>("C"==e.note&&t.push({octave:e.octave,index:n}),t)),[]);this.roll.selectAll(".octave-label").data(n).enter().append("text").text((t=>t.octave)).attr("fill","black").attr("font-size",12).attr("x",20).attr("y",(t=>t.index*this.keyHeight+this.keyHeight-this.keyHeight/3)),this.roll.selectAll(".key-division").data(n).enter().append("line").attr("class","key-division").attr("x1",0).attr("y1",(t=>t.index*this.keyHeight+this.keyHeight)).attr("x2",r.width).attr("y2",(t=>t.index*this.keyHeight+this.keyHeight)).attr("stroke","#333"),this.roll.selectAll(".step-division").data(new Array(this.steps).fill(0)).enter().append("line").attr("class","step-division").attr("x1",((e,n)=>n*t+r.pianoRollPadding)).attr("y1",0).attr("x2",((e,n)=>n*t+r.pianoRollPadding)).attr("y2",r.octaveHeight*e.length).attr("stroke",((t,e)=>e%4==0?"#333":"#aaa"))}}const o=(t,e,n)=>n.indexOf(t)===e;t.exports=r},290:(t,e,n)=>{const i=n(785);t.exports=class{constructor(){this.tom=new i.MembraneSynth,this.snare=new i.NoiseSynth({noise:{type:"brown"},envelope:{attack:.005,decay:.1,sustain:.02}}),new i.FeedbackDelay({delayTime:"32n",feedback:.25});let t=new i.Gate(-33),e=new i.MidSideCompressor,n=new i.Gain;this.snare.chain(t,e,n),this.tom.chain(t,e,n),n.chain(i.Destination)}hit(t){this.snare.triggerAttackRelease("16n",t),this.tom.triggerAttackRelease("C2","16n",t)}}},634:t=>{t.exports=class{constructor(t){this._sequence=t}get sequence(){return this._sequence}set sequence(t){this._sequence=t}rhythm(t,e){let n=new Array,i=this.calculateLength(t),s=0;for(let r=0;r<i;r++)0==t[r%t.length]||s>=this._sequence.length&&"silence"==e?n.push(null):(n.push(this._sequence[s%this._sequence.length]),s++);return n}calculateLength(t){let e=t.filter((t=>0!=t)).length;if(0==e)return 0;{let n=Math.ceil(this._sequence.length/e);return t.length*n}}}},543:(t,e,n)=>{"use strict";function i(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function s(t){let e=t,n=t,s=t;function r(t,e,i=0,r=t.length){if(i<r){if(0!==n(e,e))return r;do{const n=i+r>>>1;s(t[n],e)<0?i=n+1:r=n}while(i<r)}return i}return 2!==t.length&&(e=(e,n)=>t(e)-n,n=i,s=(e,n)=>i(t(e),n)),{left:r,center:function(t,n,i=0,s=t.length){const o=r(t,n,i,s-1);return o>i&&e(t[o-1],n)>-e(t[o],n)?o-1:o},right:function(t,e,i=0,r=t.length){if(i<r){if(0!==n(e,e))return r;do{const n=i+r>>>1;s(t[n],e)<=0?i=n+1:r=n}while(i<r)}return i}}}function r(t){return null===t?NaN:+t}n.r(e),n.d(e,{Adder:()=>x,Delaunay:()=>qa,FormatSpecifier:()=>Iu,InternMap:()=>M,InternSet:()=>S,Node:()=>n_,Voronoi:()=>ka,ZoomTransform:()=>oS,active:()=>tr,arc:()=>Jw,area:()=>oT,areaRadial:()=>_T,ascending:()=>i,autoType:()=>uc,axisBottom:()=>se,axisLeft:()=>re,axisRight:()=>ie,axisTop:()=>ne,bin:()=>st,bisect:()=>l,bisectCenter:()=>u,bisectLeft:()=>c,bisectRight:()=>a,bisector:()=>s,blob:()=>Uc,brush:()=>Or,brushSelection:()=>Cr,brushX:()=>Dr,brushY:()=>Er,buffer:()=>Gc,chord:()=>Ur,chordDirected:()=>Gr,chordTranspose:()=>Wr,cluster:()=>Zp,color:()=>ti,contourDensity:()=>sa,contours:()=>Jo,count:()=>h,create:()=>Sw,creator:()=>pn,cross:()=>_,csv:()=>$c,csvFormat:()=>$a,csvFormatBody:()=>Qa,csvFormatRow:()=>Ka,csvFormatRows:()=>Ja,csvFormatValue:()=>tc,csvParse:()=>Xa,csvParseRows:()=>Za,cubehelix:()=>Bo,cumsum:()=>m,curveBasis:()=>XT,curveBasisClosed:()=>$T,curveBasisOpen:()=>JT,curveBumpX:()=>tM,curveBumpY:()=>eM,curveBundle:()=>iM,curveCardinal:()=>oM,curveCardinalClosed:()=>cM,curveCardinalOpen:()=>lM,curveCatmullRom:()=>dM,curveCatmullRomClosed:()=>_M,curveCatmullRomOpen:()=>gM,curveLinear:()=>nT,curveLinearClosed:()=>yM,curveMonotoneX:()=>kM,curveMonotoneY:()=>CM,curveNatural:()=>OM,curveStep:()=>qM,curveStepAfter:()=>FM,curveStepBefore:()=>NM,descending:()=>g,deviation:()=>y,difference:()=>jt,disjoint:()=>Lt,dispatch:()=>fe,drag:()=>ja,dragDisable:()=>Nn,dragEnable:()=>Fn,dsv:()=>Zc,dsvFormat:()=>Ya,easeBack:()=>Pc,easeBackIn:()=>Fc,easeBackInOut:()=>Pc,easeBackOut:()=>Ic,easeBounce:()=>Rc,easeBounceIn:()=>Oc,easeBounceInOut:()=>qc,easeBounceOut:()=>Rc,easeCircle:()=>Dc,easeCircleIn:()=>kc,easeCircleInOut:()=>Dc,easeCircleOut:()=>Cc,easeCubic:()=>$s,easeCubicIn:()=>Xs,easeCubicInOut:()=>$s,easeCubicOut:()=>Zs,easeElastic:()=>jc,easeElasticIn:()=>zc,easeElasticInOut:()=>Lc,easeElasticOut:()=>jc,easeExp:()=>Ac,easeExpIn:()=>Mc,easeExpInOut:()=>Ac,easeExpOut:()=>Sc,easeLinear:()=>hc,easePoly:()=>gc,easePolyIn:()=>_c,easePolyInOut:()=>gc,easePolyOut:()=>mc,easeQuad:()=>pc,easeQuadIn:()=>fc,easeQuadInOut:()=>pc,easeQuadOut:()=>dc,easeSin:()=>wc,easeSinIn:()=>bc,easeSinInOut:()=>wc,easeSinOut:()=>xc,every:()=>Nt,extent:()=>b,fcumsum:()=>T,filter:()=>It,flatGroup:()=>N,flatRollup:()=>F,forceCenter:()=>ru,forceCollide:()=>vu,forceLink:()=>xu,forceManyBody:()=>ku,forceRadial:()=>Cu,forceSimulation:()=>Au,forceX:()=>Du,forceY:()=>Eu,format:()=>Lu,formatDefaultLocale:()=>Yu,formatLocale:()=>Gu,formatPrefix:()=>Bu,formatSpecifier:()=>Fu,fsum:()=>w,geoAlbers:()=>lp,geoAlbersUsa:()=>hp,geoArea:()=>$l,geoAzimuthalEqualArea:()=>_p,geoAzimuthalEqualAreaRaw:()=>pp,geoAzimuthalEquidistant:()=>gp,geoAzimuthalEquidistantRaw:()=>mp,geoBounds:()=>Oh,geoCentroid:()=>Uh,geoCircle:()=>tf,geoClipAntimeridian:()=>ff,geoClipCircle:()=>df,geoClipExtent:()=>xf,geoClipRectangle:()=>bf,geoConicConformal:()=>Tp,geoConicConformalRaw:()=>wp,geoConicEqualArea:()=>up,geoConicEqualAreaRaw:()=>cp,geoConicEquidistant:()=>kp,geoConicEquidistantRaw:()=>Ap,geoContains:()=>Vf,geoDistance:()=>Df,geoEqualEarth:()=>Np,geoEqualEarthRaw:()=>qp,geoEquirectangular:()=>Sp,geoEquirectangularRaw:()=>Mp,geoGnomonic:()=>Ip,geoGnomonicRaw:()=>Fp,geoGraticule:()=>Lf,geoGraticule10:()=>Bf,geoIdentity:()=>Pp,geoInterpolate:()=>Uf,geoLength:()=>Af,geoMercator:()=>yp,geoMercatorRaw:()=>vp,geoNaturalEarth1:()=>zp,geoNaturalEarth1Raw:()=>Vp,geoOrthographic:()=>Lp,geoOrthographicRaw:()=>jp,geoPath:()=>Yd,geoProjection:()=>rp,geoProjectionMutator:()=>op,geoRotation:()=>Qh,geoStereographic:()=>Up,geoStereographicRaw:()=>Bp,geoStream:()=>Al,geoTransform:()=>Hd,geoTransverseMercator:()=>Gp,geoTransverseMercatorRaw:()=>Wp,gray:()=>xo,greatest:()=>St,greatestIndex:()=>At,group:()=>O,groupSort:()=>Y,groups:()=>R,hcl:()=>Eo,hierarchy:()=>Qp,histogram:()=>st,hsl:()=>hi,html:()=>iu,image:()=>Jc,index:()=>V,indexes:()=>z,interpolate:()=>Fi,interpolateArray:()=>ki,interpolateBasis:()=>_i,interpolateBasisClosed:()=>mi,interpolateBlues:()=>Jx,interpolateBrBG:()=>lx,interpolateBuGn:()=>Cx,interpolateBuPu:()=>Ex,interpolateCividis:()=>uw,interpolateCool:()=>fw,interpolateCubehelix:()=>hm,interpolateCubehelixDefault:()=>lw,interpolateCubehelixLong:()=>fm,interpolateDate:()=>Di,interpolateDiscrete:()=>J_,interpolateGnBu:()=>Rx,interpolateGreens:()=>tw,interpolateGreys:()=>nw,interpolateHcl:()=>cm,interpolateHclLong:()=>um,interpolateHsl:()=>sm,interpolateHslLong:()=>rm,interpolateHue:()=>K_,interpolateInferno:()=>Tw,interpolateLab:()=>om,interpolateMagma:()=>ww,interpolateNumber:()=>Ei,interpolateNumberArray:()=>Si,interpolateObject:()=>Oi,interpolateOrRd:()=>Nx,interpolateOranges:()=>cw,interpolatePRGn:()=>fx,interpolatePiYG:()=>px,interpolatePlasma:()=>Mw,interpolatePuBu:()=>Vx,interpolatePuBuGn:()=>Ix,interpolatePuOr:()=>mx,interpolatePuRd:()=>jx,interpolatePurples:()=>sw,interpolateRainbow:()=>pw,interpolateRdBu:()=>vx,interpolateRdGy:()=>bx,interpolateRdPu:()=>Bx,interpolateRdYlBu:()=>wx,interpolateRdYlGn:()=>Mx,interpolateReds:()=>ow,interpolateRgb:()=>xi,interpolateRgbBasis:()=>Ti,interpolateRgbBasisClosed:()=>Mi,interpolateRound:()=>tm,interpolateSinebow:()=>vw,interpolateSpectral:()=>Ax,interpolateString:()=>Ni,interpolateTransformCss:()=>_s,interpolateTransformSvg:()=>ms,interpolateTurbo:()=>yw,interpolateViridis:()=>xw,interpolateWarm:()=>hw,interpolateYlGn:()=>Yx,interpolateYlGnBu:()=>Wx,interpolateYlOrBr:()=>Xx,interpolateYlOrRd:()=>$x,interpolateZoom:()=>nm,interrupt:()=>us,intersection:()=>Bt,interval:()=>iS,isoFormat:()=>tS,isoParse:()=>nS,json:()=>tu,lab:()=>wo,lch:()=>Do,least:()=>Tt,leastIndex:()=>Mt,line:()=>rT,lineRadial:()=>pT,linkHorizontal:()=>TT,linkRadial:()=>ST,linkVertical:()=>MT,local:()=>kw,map:()=>Pt,matcher:()=>ve,max:()=>rt,maxIndex:()=>dt,mean:()=>pt,median:()=>_t,merge:()=>mt,min:()=>ot,minIndex:()=>gt,mode:()=>vt,namespace:()=>Ne,namespaces:()=>qe,nice:()=>nt,now:()=>Xi,pack:()=>w_,packEnclose:()=>i_,packSiblings:()=>m_,pairs:()=>yt,partition:()=>C_,path:()=>Kr,permute:()=>B,pie:()=>uT,piecewise:()=>dm,pointRadial:()=>mT,pointer:()=>Pi,pointers:()=>Dw,polygonArea:()=>_m,polygonCentroid:()=>mm,polygonContains:()=>bm,polygonHull:()=>ym,polygonLength:()=>xm,precisionFixed:()=>Hu,precisionPrefix:()=>Xu,precisionRound:()=>Zu,quadtree:()=>lu,quantile:()=>ut,quantileSorted:()=>lt,quantize:()=>pm,quickselect:()=>at,radialArea:()=>_T,radialLine:()=>pT,randomBates:()=>Cm,randomBernoulli:()=>Om,randomBeta:()=>Nm,randomBinomial:()=>Fm,randomCauchy:()=>Pm,randomExponential:()=>Dm,randomGamma:()=>qm,randomGeometric:()=>Rm,randomInt:()=>Mm,randomIrwinHall:()=>km,randomLcg:()=>Lm,randomLogNormal:()=>Am,randomLogistic:()=>Vm,randomNormal:()=>Sm,randomPareto:()=>Em,randomPoisson:()=>zm,randomUniform:()=>Tm,randomWeibull:()=>Im,range:()=>xt,rank:()=>wt,reduce:()=>Vt,reverse:()=>zt,rgb:()=>si,ribbon:()=>lo,ribbonArrow:()=>ho,rollup:()=>I,rollups:()=>P,scaleBand:()=>Ym,scaleDiverging:()=>Yb,scaleDivergingLog:()=>Hb,scaleDivergingPow:()=>Zb,scaleDivergingSqrt:()=>$b,scaleDivergingSymlog:()=>Xb,scaleIdentity:()=>ag,scaleImplicit:()=>Wm,scaleLinear:()=>og,scaleLog:()=>mg,scaleOrdinal:()=>Gm,scalePoint:()=>Xm,scalePow:()=>Sg,scaleQuantile:()=>Eg,scaleQuantize:()=>Og,scaleRadial:()=>Dg,scaleSequential:()=>zb,scaleSequentialLog:()=>jb,scaleSequentialPow:()=>Bb,scaleSequentialQuantile:()=>Wb,scaleSequentialSqrt:()=>Ub,scaleSequentialSymlog:()=>Lb,scaleSqrt:()=>Ag,scaleSymlog:()=>bg,scaleThreshold:()=>Rg,scaleTime:()=>Fb,scaleUtc:()=>Ib,scan:()=>kt,schemeAccent:()=>Kb,schemeBlues:()=>Qx,schemeBrBG:()=>ux,schemeBuGn:()=>kx,schemeBuPu:()=>Dx,schemeCategory10:()=>Jb,schemeDark2:()=>tx,schemeGnBu:()=>Ox,schemeGreens:()=>Kx,schemeGreys:()=>ew,schemeOrRd:()=>qx,schemeOranges:()=>aw,schemePRGn:()=>hx,schemePaired:()=>ex,schemePastel1:()=>nx,schemePastel2:()=>ix,schemePiYG:()=>dx,schemePuBu:()=>Px,schemePuBuGn:()=>Fx,schemePuOr:()=>_x,schemePuRd:()=>zx,schemePurples:()=>iw,schemeRdBu:()=>gx,schemeRdGy:()=>yx,schemeRdPu:()=>Lx,schemeRdYlBu:()=>xx,schemeRdYlGn:()=>Tx,schemeReds:()=>rw,schemeSet1:()=>sx,schemeSet2:()=>rx,schemeSet3:()=>ox,schemeSpectral:()=>Sx,schemeTableau10:()=>ax,schemeYlGn:()=>Gx,schemeYlGnBu:()=>Ux,schemeYlOrBr:()=>Hx,schemeYlOrRd:()=>Zx,select:()=>Dn,selectAll:()=>Ew,selection:()=>Cn,selector:()=>pe,selectorAll:()=>ge,shuffle:()=>Ct,shuffler:()=>Dt,some:()=>Ft,sort:()=>U,stack:()=>jM,stackOffsetDiverging:()=>BM,stackOffsetExpand:()=>LM,stackOffsetNone:()=>IM,stackOffsetSilhouette:()=>UM,stackOffsetWiggle:()=>WM,stackOrderAppearance:()=>GM,stackOrderAscending:()=>HM,stackOrderDescending:()=>ZM,stackOrderInsideOut:()=>$M,stackOrderNone:()=>PM,stackOrderReverse:()=>QM,stratify:()=>N_,style:()=>Ge,subset:()=>Yt,sum:()=>Et,superset:()=>Wt,svg:()=>su,symbol:()=>WT,symbolCircle:()=>AT,symbolCross:()=>kT,symbolDiamond:()=>ET,symbolSquare:()=>FT,symbolStar:()=>NT,symbolTriangle:()=>PT,symbolWye:()=>BT,symbols:()=>UT,text:()=>Hc,thresholdFreedmanDiaconis:()=>ht,thresholdScott:()=>ft,thresholdSturges:()=>it,tickFormat:()=>sg,tickIncrement:()=>tt,tickStep:()=>et,ticks:()=>K,timeDay:()=>ev,timeDays:()=>nv,timeFormat:()=>ly,timeFormatDefaultLocale:()=>Ob,timeFormatLocale:()=>cy,timeFriday:()=>uv,timeFridays:()=>mv,timeHour:()=>Jg,timeHours:()=>Kg,timeInterval:()=>Lg,timeMillisecond:()=>Ug,timeMilliseconds:()=>Wg,timeMinute:()=>Zg,timeMinutes:()=>$g,timeMonday:()=>rv,timeMondays:()=>fv,timeMonth:()=>yv,timeMonths:()=>bv,timeParse:()=>hy,timeSaturday:()=>lv,timeSaturdays:()=>gv,timeSecond:()=>Yg,timeSeconds:()=>Hg,timeSunday:()=>sv,timeSundays:()=>hv,timeThursday:()=>cv,timeThursdays:()=>_v,timeTickInterval:()=>sy,timeTicks:()=>iy,timeTuesday:()=>ov,timeTuesdays:()=>dv,timeWednesday:()=>av,timeWednesdays:()=>pv,timeWeek:()=>sv,timeWeeks:()=>hv,timeYear:()=>wv,timeYears:()=>Tv,timeout:()=>ns,timer:()=>Qi,timerFlush:()=>Ji,transition:()=>Gs,transpose:()=>Ot,tree:()=>U_,treemap:()=>X_,treemapBinary:()=>Z_,treemapDice:()=>k_,treemapResquarify:()=>Q_,treemapSlice:()=>W_,treemapSliceDice:()=>$_,treemapSquarify:()=>H_,tsv:()=>Qc,tsvFormat:()=>sc,tsvFormatBody:()=>rc,tsvFormatRow:()=>ac,tsvFormatRows:()=>oc,tsvFormatValue:()=>cc,tsvParse:()=>nc,tsvParseRows:()=>ic,union:()=>Ht,utcDay:()=>Ov,utcDays:()=>Rv,utcFormat:()=>fy,utcFriday:()=>zv,utcFridays:()=>Yv,utcHour:()=>Cv,utcHours:()=>Dv,utcMillisecond:()=>Ug,utcMilliseconds:()=>Wg,utcMinute:()=>Sv,utcMinutes:()=>Av,utcMonday:()=>Fv,utcMondays:()=>Bv,utcMonth:()=>Zv,utcMonths:()=>$v,utcParse:()=>dy,utcSaturday:()=>jv,utcSaturdays:()=>Hv,utcSecond:()=>Yg,utcSeconds:()=>Hg,utcSunday:()=>Nv,utcSundays:()=>Lv,utcThursday:()=>Vv,utcThursdays:()=>Gv,utcTickInterval:()=>ny,utcTicks:()=>ey,utcTuesday:()=>Iv,utcTuesdays:()=>Uv,utcWednesday:()=>Pv,utcWednesdays:()=>Wv,utcWeek:()=>Nv,utcWeeks:()=>Lv,utcYear:()=>Jv,utcYears:()=>Kv,variance:()=>v,window:()=>Le,xml:()=>nu,zip:()=>qt,zoom:()=>gS,zoomIdentity:()=>aS,zoomTransform:()=>cS});const o=s(i),a=o.right,c=o.left,u=s(r).center,l=a;function h(t,e){let n=0;if(void 0===e)for(let e of t)null!=e&&(e=+e)>=e&&++n;else{let i=-1;for(let s of t)null!=(s=e(s,++i,t))&&(s=+s)>=s&&++n}return n}function f(t){return 0|t.length}function d(t){return!(t>0)}function p(t){return"object"!=typeof t||"length"in t?t:Array.from(t)}function _(...t){const e="function"==typeof t[t.length-1]&&function(t){return e=>t(...e)}(t.pop()),n=(t=t.map(p)).map(f),i=t.length-1,s=new Array(i+1).fill(0),r=[];if(i<0||n.some(d))return r;for(;;){r.push(s.map(((e,n)=>t[n][e])));let o=i;for(;++s[o]===n[o];){if(0===o)return e?r.map(e):r;s[o--]=0}}}function m(t,e){var n=0,i=0;return Float64Array.from(t,void 0===e?t=>n+=+t||0:s=>n+=+e(s,i++,t)||0)}function g(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function v(t,e){let n,i=0,s=0,r=0;if(void 0===e)for(let e of t)null!=e&&(e=+e)>=e&&(n=e-s,s+=n/++i,r+=n*(e-s));else{let o=-1;for(let a of t)null!=(a=e(a,++o,t))&&(a=+a)>=a&&(n=a-s,s+=n/++i,r+=n*(a-s))}if(i>1)return r/(i-1)}function y(t,e){const n=v(t,e);return n?Math.sqrt(n):n}function b(t,e){let n,i;if(void 0===e)for(const e of t)null!=e&&(void 0===n?e>=e&&(n=i=e):(n>e&&(n=e),i<e&&(i=e)));else{let s=-1;for(let r of t)null!=(r=e(r,++s,t))&&(void 0===n?r>=r&&(n=i=r):(n>r&&(n=r),i<r&&(i=r)))}return[n,i]}class x{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let n=0;for(let i=0;i<this._n&&i<32;i++){const s=e[i],r=t+s,o=Math.abs(t)<Math.abs(s)?t-(r-s):s-(r-t);o&&(e[n++]=o),t=r}return e[n]=t,this._n=n+1,this}valueOf(){const t=this._partials;let e,n,i,s=this._n,r=0;if(s>0){for(r=t[--s];s>0&&(e=r,n=t[--s],r=e+n,i=n-(r-e),!i););s>0&&(i<0&&t[s-1]<0||i>0&&t[s-1]>0)&&(n=2*i,e=r+n,n==e-r&&(r=e))}return r}}function w(t,e){const n=new x;if(void 0===e)for(let e of t)(e=+e)&&n.add(e);else{let i=-1;for(let s of t)(s=+e(s,++i,t))&&n.add(s)}return+n}function T(t,e){const n=new x;let i=-1;return Float64Array.from(t,void 0===e?t=>n.add(+t||0):s=>n.add(+e(s,++i,t)||0))}class M extends Map{constructor(t,e=D){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const[e,n]of t)this.set(e,n)}get(t){return super.get(A(this,t))}has(t){return super.has(A(this,t))}set(t,e){return super.set(k(this,t),e)}delete(t){return super.delete(C(this,t))}}class S extends Set{constructor(t,e=D){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const e of t)this.add(e)}has(t){return super.has(A(this,t))}add(t){return super.add(k(this,t))}delete(t){return super.delete(C(this,t))}}function A({_intern:t,_key:e},n){const i=e(n);return t.has(i)?t.get(i):n}function k({_intern:t,_key:e},n){const i=e(n);return t.has(i)?t.get(i):(t.set(i,n),n)}function C({_intern:t,_key:e},n){const i=e(n);return t.has(i)&&(n=t.get(i),t.delete(i)),n}function D(t){return null!==t&&"object"==typeof t?t.valueOf():t}function E(t){return t}function O(t,...e){return L(t,E,E,e)}function R(t,...e){return L(t,Array.from,E,e)}function q(t,e){for(let n=1,i=e.length;n<i;++n)t=t.flatMap((t=>t.pop().map((([e,n])=>[...t,e,n]))));return t}function N(t,...e){return q(R(t,...e),e)}function F(t,e,...n){return q(P(t,e,...n),n)}function I(t,e,...n){return L(t,E,e,n)}function P(t,e,...n){return L(t,Array.from,e,n)}function V(t,...e){return L(t,E,j,e)}function z(t,...e){return L(t,Array.from,j,e)}function j(t){if(1!==t.length)throw new Error("duplicate key");return t[0]}function L(t,e,n,i){return function t(s,r){if(r>=i.length)return n(s);const o=new M,a=i[r++];let c=-1;for(const t of s){const e=a(t,++c,s),n=o.get(e);n?n.push(t):o.set(e,[t])}for(const[e,n]of o)o.set(e,t(n,r));return e(o)}(t,0)}function B(t,e){return Array.from(e,(e=>t[e]))}function U(t,...e){if("function"!=typeof t[Symbol.iterator])throw new TypeError("values is not iterable");t=Array.from(t);let[n]=e;if(n&&2!==n.length||e.length>1){const i=Uint32Array.from(t,((t,e)=>e));return e.length>1?(e=e.map((e=>t.map(e))),i.sort(((t,n)=>{for(const i of e){const e=G(i[t],i[n]);if(e)return e}}))):(n=t.map(n),i.sort(((t,e)=>G(n[t],n[e])))),B(t,i)}return t.sort(W(n))}function W(t=i){if(t===i)return G;if("function"!=typeof t)throw new TypeError("compare is not a function");return(e,n)=>{const i=t(e,n);return i||0===i?i:(0===t(n,n))-(0===t(e,e))}}function G(t,e){return(null==t||!(t>=t))-(null==e||!(e>=e))||(t<e?-1:t>e?1:0)}function Y(t,e,n){return(2!==e.length?U(I(t,e,n),(([t,e],[n,s])=>i(e,s)||i(t,n))):U(O(t,n),(([t,n],[s,r])=>e(n,r)||i(t,s)))).map((([t])=>t))}var H=Array.prototype,X=H.slice;function Z(t){return()=>t}H.map;var $=Math.sqrt(50),Q=Math.sqrt(10),J=Math.sqrt(2);function K(t,e,n){var i,s,r,o,a=-1;if(n=+n,(t=+t)==(e=+e)&&n>0)return[t];if((i=e<t)&&(s=t,t=e,e=s),0===(o=tt(t,e,n))||!isFinite(o))return[];if(o>0){let n=Math.round(t/o),i=Math.round(e/o);for(n*o<t&&++n,i*o>e&&--i,r=new Array(s=i-n+1);++a<s;)r[a]=(n+a)*o}else{o=-o;let n=Math.round(t*o),i=Math.round(e*o);for(n/o<t&&++n,i/o>e&&--i,r=new Array(s=i-n+1);++a<s;)r[a]=(n+a)/o}return i&&r.reverse(),r}function tt(t,e,n){var i=(e-t)/Math.max(0,n),s=Math.floor(Math.log(i)/Math.LN10),r=i/Math.pow(10,s);return s>=0?(r>=$?10:r>=Q?5:r>=J?2:1)*Math.pow(10,s):-Math.pow(10,-s)/(r>=$?10:r>=Q?5:r>=J?2:1)}function et(t,e,n){var i=Math.abs(e-t)/Math.max(0,n),s=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),r=i/s;return r>=$?s*=10:r>=Q?s*=5:r>=J&&(s*=2),e<t?-s:s}function nt(t,e,n){let i;for(;;){const s=tt(t,e,n);if(s===i||0===s||!isFinite(s))return[t,e];s>0?(t=Math.floor(t/s)*s,e=Math.ceil(e/s)*s):s<0&&(t=Math.ceil(t*s)/s,e=Math.floor(e*s)/s),i=s}}function it(t){return Math.ceil(Math.log(h(t))/Math.LN2)+1}function st(){var t=E,e=b,n=it;function i(i){Array.isArray(i)||(i=Array.from(i));var s,r,o=i.length,a=new Array(o);for(s=0;s<o;++s)a[s]=t(i[s],s,i);var c=e(a),u=c[0],h=c[1],f=n(a,u,h);if(!Array.isArray(f)){const t=h,n=+f;if(e===b&&([u,h]=nt(u,h,n)),(f=K(u,h,n))[f.length-1]>=h)if(t>=h&&e===b){const t=tt(u,h,n);isFinite(t)&&(t>0?h=(Math.floor(h/t)+1)*t:t<0&&(h=(Math.ceil(h*-t)+1)/-t))}else f.pop()}for(var d=f.length;f[0]<=u;)f.shift(),--d;for(;f[d-1]>h;)f.pop(),--d;var p,_=new Array(d+1);for(s=0;s<=d;++s)(p=_[s]=[]).x0=s>0?f[s-1]:u,p.x1=s<d?f[s]:h;for(s=0;s<o;++s)null!=(r=a[s])&&u<=r&&r<=h&&_[l(f,r,0,d)].push(i[s]);return _}return i.value=function(e){return arguments.length?(t="function"==typeof e?e:Z(e),i):t},i.domain=function(t){return arguments.length?(e="function"==typeof t?t:Z([t[0],t[1]]),i):e},i.thresholds=function(t){return arguments.length?(n="function"==typeof t?t:Array.isArray(t)?Z(X.call(t)):Z(t),i):n},i}function rt(t,e){let n;if(void 0===e)for(const e of t)null!=e&&(n<e||void 0===n&&e>=e)&&(n=e);else{let i=-1;for(let s of t)null!=(s=e(s,++i,t))&&(n<s||void 0===n&&s>=s)&&(n=s)}return n}function ot(t,e){let n;if(void 0===e)for(const e of t)null!=e&&(n>e||void 0===n&&e>=e)&&(n=e);else{let i=-1;for(let s of t)null!=(s=e(s,++i,t))&&(n>s||void 0===n&&s>=s)&&(n=s)}return n}function at(t,e,n=0,i=t.length-1,s){for(s=void 0===s?G:W(s);i>n;){if(i-n>600){const r=i-n+1,o=e-n+1,a=Math.log(r),c=.5*Math.exp(2*a/3),u=.5*Math.sqrt(a*c*(r-c)/r)*(o-r/2<0?-1:1);at(t,e,Math.max(n,Math.floor(e-o*c/r+u)),Math.min(i,Math.floor(e+(r-o)*c/r+u)),s)}const r=t[e];let o=n,a=i;for(ct(t,n,e),s(t[i],r)>0&&ct(t,n,i);o<a;){for(ct(t,o,a),++o,--a;s(t[o],r)<0;)++o;for(;s(t[a],r)>0;)--a}0===s(t[n],r)?ct(t,n,a):(++a,ct(t,a,i)),a<=e&&(n=a+1),e<=a&&(i=a-1)}return t}function ct(t,e,n){const i=t[e];t[e]=t[n],t[n]=i}function ut(t,e,n){if(t=Float64Array.from(function*(t,e){if(void 0===e)for(let e of t)null!=e&&(e=+e)>=e&&(yield e);else{let n=-1;for(let i of t)null!=(i=e(i,++n,t))&&(i=+i)>=i&&(yield i)}}(t,n)),i=t.length){if((e=+e)<=0||i<2)return ot(t);if(e>=1)return rt(t);var i,s=(i-1)*e,r=Math.floor(s),o=rt(at(t,r).subarray(0,r+1));return o+(ot(t.subarray(r+1))-o)*(s-r)}}function lt(t,e,n=r){if(i=t.length){if((e=+e)<=0||i<2)return+n(t[0],0,t);if(e>=1)return+n(t[i-1],i-1,t);var i,s=(i-1)*e,o=Math.floor(s),a=+n(t[o],o,t);return a+(+n(t[o+1],o+1,t)-a)*(s-o)}}function ht(t,e,n){return Math.ceil((n-e)/(2*(ut(t,.75)-ut(t,.25))*Math.pow(h(t),-1/3)))}function ft(t,e,n){return Math.ceil((n-e)/(3.5*y(t)*Math.pow(h(t),-1/3)))}function dt(t,e){let n,i=-1,s=-1;if(void 0===e)for(const e of t)++s,null!=e&&(n<e||void 0===n&&e>=e)&&(n=e,i=s);else for(let r of t)null!=(r=e(r,++s,t))&&(n<r||void 0===n&&r>=r)&&(n=r,i=s);return i}function pt(t,e){let n=0,i=0;if(void 0===e)for(let e of t)null!=e&&(e=+e)>=e&&(++n,i+=e);else{let s=-1;for(let r of t)null!=(r=e(r,++s,t))&&(r=+r)>=r&&(++n,i+=r)}if(n)return i/n}function _t(t,e){return ut(t,.5,e)}function mt(t){return Array.from(function*(t){for(const e of t)yield*e}(t))}function gt(t,e){let n,i=-1,s=-1;if(void 0===e)for(const e of t)++s,null!=e&&(n>e||void 0===n&&e>=e)&&(n=e,i=s);else for(let r of t)null!=(r=e(r,++s,t))&&(n>r||void 0===n&&r>=r)&&(n=r,i=s);return i}function vt(t,e){const n=new M;if(void 0===e)for(let e of t)null!=e&&e>=e&&n.set(e,(n.get(e)||0)+1);else{let i=-1;for(let s of t)null!=(s=e(s,++i,t))&&s>=s&&n.set(s,(n.get(s)||0)+1)}let i,s=0;for(const[t,e]of n)e>s&&(s=e,i=t);return i}function yt(t,e=bt){const n=[];let i,s=!1;for(const r of t)s&&n.push(e(i,r)),i=r,s=!0;return n}function bt(t,e){return[t,e]}function xt(t,e,n){t=+t,e=+e,n=(s=arguments.length)<2?(e=t,t=0,1):s<3?1:+n;for(var i=-1,s=0|Math.max(0,Math.ceil((e-t)/n)),r=new Array(s);++i<s;)r[i]=t+i*n;return r}function wt(t,e=i){if("function"!=typeof t[Symbol.iterator])throw new TypeError("values is not iterable");let n=Array.from(t);const s=new Float64Array(n.length);2!==e.length&&(n=n.map(e),e=i);const r=(t,i)=>e(n[t],n[i]);let o,a;return Uint32Array.from(n,((t,e)=>e)).sort(e===i?(t,e)=>G(n[t],n[e]):W(r)).forEach(((t,e)=>{const n=r(t,void 0===o?t:o);n>=0?((void 0===o||n>0)&&(o=t,a=e),s[t]=a):s[t]=NaN})),s}function Tt(t,e=i){let n,s=!1;if(1===e.length){let r;for(const o of t){const t=e(o);(s?i(t,r)<0:0===i(t,t))&&(n=o,r=t,s=!0)}}else for(const i of t)(s?e(i,n)<0:0===e(i,i))&&(n=i,s=!0);return n}function Mt(t,e=i){if(1===e.length)return gt(t,e);let n,s=-1,r=-1;for(const i of t)++r,(s<0?0===e(i,i):e(i,n)<0)&&(n=i,s=r);return s}function St(t,e=i){let n,s=!1;if(1===e.length){let r;for(const o of t){const t=e(o);(s?i(t,r)>0:0===i(t,t))&&(n=o,r=t,s=!0)}}else for(const i of t)(s?e(i,n)>0:0===e(i,i))&&(n=i,s=!0);return n}function At(t,e=i){if(1===e.length)return dt(t,e);let n,s=-1,r=-1;for(const i of t)++r,(s<0?0===e(i,i):e(i,n)>0)&&(n=i,s=r);return s}function kt(t,e){const n=Mt(t,e);return n<0?void 0:n}const Ct=Dt(Math.random);function Dt(t){return function(e,n=0,i=e.length){let s=i-(n=+n);for(;s;){const i=t()*s--|0,r=e[s+n];e[s+n]=e[i+n],e[i+n]=r}return e}}function Et(t,e){let n=0;if(void 0===e)for(let e of t)(e=+e)&&(n+=e);else{let i=-1;for(let s of t)(s=+e(s,++i,t))&&(n+=s)}return n}function Ot(t){if(!(s=t.length))return[];for(var e=-1,n=ot(t,Rt),i=new Array(n);++e<n;)for(var s,r=-1,o=i[e]=new Array(s);++r<s;)o[r]=t[r][e];return i}function Rt(t){return t.length}function qt(){return Ot(arguments)}function Nt(t,e){if("function"!=typeof e)throw new TypeError("test is not a function");let n=-1;for(const i of t)if(!e(i,++n,t))return!1;return!0}function Ft(t,e){if("function"!=typeof e)throw new TypeError("test is not a function");let n=-1;for(const i of t)if(e(i,++n,t))return!0;return!1}function It(t,e){if("function"!=typeof e)throw new TypeError("test is not a function");const n=[];let i=-1;for(const s of t)e(s,++i,t)&&n.push(s);return n}function Pt(t,e){if("function"!=typeof t[Symbol.iterator])throw new TypeError("values is not iterable");if("function"!=typeof e)throw new TypeError("mapper is not a function");return Array.from(t,((n,i)=>e(n,i,t)))}function Vt(t,e,n){if("function"!=typeof e)throw new TypeError("reducer is not a function");const i=t[Symbol.iterator]();let s,r,o=-1;if(arguments.length<3){if(({done:s,value:n}=i.next()),s)return;++o}for(;({done:s,value:r}=i.next()),!s;)n=e(n,r,++o,t);return n}function zt(t){if("function"!=typeof t[Symbol.iterator])throw new TypeError("values is not iterable");return Array.from(t).reverse()}function jt(t,...e){t=new S(t);for(const n of e)for(const e of n)t.delete(e);return t}function Lt(t,e){const n=e[Symbol.iterator](),i=new S;for(const e of t){if(i.has(e))return!1;let t,s;for(;({value:t,done:s}=n.next())&&!s;){if(Object.is(e,t))return!1;i.add(t)}}return!0}function Bt(t,...e){t=new S(t),e=e.map(Ut);t:for(const n of t)for(const i of e)if(!i.has(n)){t.delete(n);continue t}return t}function Ut(t){return t instanceof S?t:new S(t)}function Wt(t,e){const n=t[Symbol.iterator](),i=new Set;for(const t of e){const e=Gt(t);if(i.has(e))continue;let s,r;for(;({value:s,done:r}=n.next());){if(r)return!1;const t=Gt(s);if(i.add(t),Object.is(e,t))break}}return!0}function Gt(t){return null!==t&&"object"==typeof t?t.valueOf():t}function Yt(t,e){return Wt(e,t)}function Ht(...t){const e=new S;for(const n of t)for(const t of n)e.add(t);return e}function Xt(t){return t}var Zt=1e-6;function $t(t){return"translate("+t+",0)"}function Qt(t){return"translate(0,"+t+")"}function Jt(t){return e=>+t(e)}function Kt(t,e){return e=Math.max(0,t.bandwidth()-2*e)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function te(){return!this.__axis}function ee(t,e){var n=[],i=null,s=null,r=6,o=6,a=3,c="undefined"!=typeof window&&window.devicePixelRatio>1?0:.5,u=1===t||4===t?-1:1,l=4===t||2===t?"x":"y",h=1===t||3===t?$t:Qt;function f(f){var d=null==i?e.ticks?e.ticks.apply(e,n):e.domain():i,p=null==s?e.tickFormat?e.tickFormat.apply(e,n):Xt:s,_=Math.max(r,0)+a,m=e.range(),g=+m[0]+c,v=+m[m.length-1]+c,y=(e.bandwidth?Kt:Jt)(e.copy(),c),b=f.selection?f.selection():f,x=b.selectAll(".domain").data([null]),w=b.selectAll(".tick").data(d,e).order(),T=w.exit(),M=w.enter().append("g").attr("class","tick"),S=w.select("line"),A=w.select("text");x=x.merge(x.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),w=w.merge(M),S=S.merge(M.append("line").attr("stroke","currentColor").attr(l+"2",u*r)),A=A.merge(M.append("text").attr("fill","currentColor").attr(l,u*_).attr("dy",1===t?"0em":3===t?"0.71em":"0.32em")),f!==b&&(x=x.transition(f),w=w.transition(f),S=S.transition(f),A=A.transition(f),T=T.transition(f).attr("opacity",Zt).attr("transform",(function(t){return isFinite(t=y(t))?h(t+c):this.getAttribute("transform")})),M.attr("opacity",Zt).attr("transform",(function(t){var e=this.parentNode.__axis;return h((e&&isFinite(e=e(t))?e:y(t))+c)}))),T.remove(),x.attr("d",4===t||2===t?o?"M"+u*o+","+g+"H"+c+"V"+v+"H"+u*o:"M"+c+","+g+"V"+v:o?"M"+g+","+u*o+"V"+c+"H"+v+"V"+u*o:"M"+g+","+c+"H"+v),w.attr("opacity",1).attr("transform",(function(t){return h(y(t)+c)})),S.attr(l+"2",u*r),A.attr(l,u*_).text(p),b.filter(te).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===t?"start":4===t?"end":"middle"),b.each((function(){this.__axis=y}))}return f.scale=function(t){return arguments.length?(e=t,f):e},f.ticks=function(){return n=Array.from(arguments),f},f.tickArguments=function(t){return arguments.length?(n=null==t?[]:Array.from(t),f):n.slice()},f.tickValues=function(t){return arguments.length?(i=null==t?null:Array.from(t),f):i&&i.slice()},f.tickFormat=function(t){return arguments.length?(s=t,f):s},f.tickSize=function(t){return arguments.length?(r=o=+t,f):r},f.tickSizeInner=function(t){return arguments.length?(r=+t,f):r},f.tickSizeOuter=function(t){return arguments.length?(o=+t,f):o},f.tickPadding=function(t){return arguments.length?(a=+t,f):a},f.offset=function(t){return arguments.length?(c=+t,f):c},f}function ne(t){return ee(1,t)}function ie(t){return ee(2,t)}function se(t){return ee(3,t)}function re(t){return ee(4,t)}var oe={value:()=>{}};function ae(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+"")||t in i||/[\s.]/.test(t))throw new Error("illegal type: "+t);i[t]=[]}return new ce(i)}function ce(t){this._=t}function ue(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",i=t.indexOf(".");if(i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function le(t,e){for(var n,i=0,s=t.length;i<s;++i)if((n=t[i]).name===e)return n.value}function he(t,e,n){for(var i=0,s=t.length;i<s;++i)if(t[i].name===e){t[i]=oe,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}ce.prototype=ae.prototype={constructor:ce,on:function(t,e){var n,i=this._,s=ue(t+"",i),r=-1,o=s.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++r<o;)if(n=(t=s[r]).type)i[n]=he(i[n],t.name,e);else if(null==e)for(n in i)i[n]=he(i[n],t.name,null);return this}for(;++r<o;)if((n=(t=s[r]).type)&&(n=le(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new ce(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,i,s=new Array(n),r=0;r<n;++r)s[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(r=0,n=(i=this._[t]).length;r<n;++r)i[r].value.apply(e,s)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],s=0,r=i.length;s<r;++s)i[s].value.apply(e,n)}};const fe=ae;function de(){}function pe(t){return null==t?de:function(){return this.querySelector(t)}}function _e(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}function me(){return[]}function ge(t){return null==t?me:function(){return this.querySelectorAll(t)}}function ve(t){return function(){return this.matches(t)}}function ye(t){return function(e){return e.matches(t)}}var be=Array.prototype.find;function xe(){return this.firstElementChild}var we=Array.prototype.filter;function Te(){return Array.from(this.children)}function Me(t){return new Array(t.length)}function Se(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function Ae(t){return function(){return t}}function ke(t,e,n,i,s,r){for(var o,a=0,c=e.length,u=r.length;a<u;++a)(o=e[a])?(o.__data__=r[a],i[a]=o):n[a]=new Se(t,r[a]);for(;a<c;++a)(o=e[a])&&(s[a]=o)}function Ce(t,e,n,i,s,r,o){var a,c,u,l=new Map,h=e.length,f=r.length,d=new Array(h);for(a=0;a<h;++a)(c=e[a])&&(d[a]=u=o.call(c,c.__data__,a,e)+"",l.has(u)?s[a]=c:l.set(u,c));for(a=0;a<f;++a)u=o.call(t,r[a],a,r)+"",(c=l.get(u))?(i[a]=c,c.__data__=r[a],l.delete(u)):n[a]=new Se(t,r[a]);for(a=0;a<h;++a)(c=e[a])&&l.get(d[a])===c&&(s[a]=c)}function De(t){return t.__data__}function Ee(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function Oe(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}Se.prototype={constructor:Se,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var Re="http://www.w3.org/1999/xhtml";const qe={svg:"http://www.w3.org/2000/svg",xhtml:Re,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Ne(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),qe.hasOwnProperty(e)?{space:qe[e],local:t}:t}function Fe(t){return function(){this.removeAttribute(t)}}function Ie(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Pe(t,e){return function(){this.setAttribute(t,e)}}function Ve(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function ze(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function je(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Le(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Be(t){return function(){this.style.removeProperty(t)}}function Ue(t,e,n){return function(){this.style.setProperty(t,e,n)}}function We(t,e,n){return function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function Ge(t,e){return t.style.getPropertyValue(e)||Le(t).getComputedStyle(t,null).getPropertyValue(e)}function Ye(t){return function(){delete this[t]}}function He(t,e){return function(){this[t]=e}}function Xe(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function Ze(t){return t.trim().split(/^|\s+/)}function $e(t){return t.classList||new Qe(t)}function Qe(t){this._node=t,this._names=Ze(t.getAttribute("class")||"")}function Je(t,e){for(var n=$e(t),i=-1,s=e.length;++i<s;)n.add(e[i])}function Ke(t,e){for(var n=$e(t),i=-1,s=e.length;++i<s;)n.remove(e[i])}function tn(t){return function(){Je(this,t)}}function en(t){return function(){Ke(this,t)}}function nn(t,e){return function(){(e.apply(this,arguments)?Je:Ke)(this,t)}}function sn(){this.textContent=""}function rn(t){return function(){this.textContent=t}}function on(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function an(){this.innerHTML=""}function cn(t){return function(){this.innerHTML=t}}function un(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function ln(){this.nextSibling&&this.parentNode.appendChild(this)}function hn(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function fn(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Re&&e.documentElement.namespaceURI===Re?e.createElement(t):e.createElementNS(n,t)}}function dn(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function pn(t){var e=Ne(t);return(e.local?dn:fn)(e)}function _n(){return null}function mn(){var t=this.parentNode;t&&t.removeChild(this)}function gn(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function vn(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function yn(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function bn(t){return function(){var e=this.__on;if(e){for(var n,i=0,s=-1,r=e.length;i<r;++i)n=e[i],t.type&&n.type!==t.type||n.name!==t.name?e[++s]=n:this.removeEventListener(n.type,n.listener,n.options);++s?e.length=s:delete this.__on}}}function xn(t,e,n){return function(){var i,s=this.__on,r=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(s)for(var o=0,a=s.length;o<a;++o)if((i=s[o]).type===t.type&&i.name===t.name)return this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=r,i.options=n),void(i.value=e);this.addEventListener(t.type,r,n),i={type:t.type,name:t.name,value:e,listener:r,options:n},s?s.push(i):this.__on=[i]}}function wn(t,e,n){var i=Le(t),s=i.CustomEvent;"function"==typeof s?s=new s(e,n):(s=i.document.createEvent("Event"),n?(s.initEvent(e,n.bubbles,n.cancelable),s.detail=n.detail):s.initEvent(e,!1,!1)),t.dispatchEvent(s)}function Tn(t,e){return function(){return wn(this,t,e)}}function Mn(t,e){return function(){return wn(this,t,e.apply(this,arguments))}}Qe.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var Sn=[null];function An(t,e){this._groups=t,this._parents=e}function kn(){return new An([[document.documentElement]],Sn)}An.prototype=kn.prototype={constructor:An,select:function(t){"function"!=typeof t&&(t=pe(t));for(var e=this._groups,n=e.length,i=new Array(n),s=0;s<n;++s)for(var r,o,a=e[s],c=a.length,u=i[s]=new Array(c),l=0;l<c;++l)(r=a[l])&&(o=t.call(r,r.__data__,l,a))&&("__data__"in r&&(o.__data__=r.__data__),u[l]=o);return new An(i,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return _e(t.apply(this,arguments))}}(t):ge(t);for(var e=this._groups,n=e.length,i=[],s=[],r=0;r<n;++r)for(var o,a=e[r],c=a.length,u=0;u<c;++u)(o=a[u])&&(i.push(t.call(o,o.__data__,u,a)),s.push(o));return new An(i,s)},selectChild:function(t){return this.select(null==t?xe:function(t){return function(){return be.call(this.children,t)}}("function"==typeof t?t:ye(t)))},selectChildren:function(t){return this.selectAll(null==t?Te:function(t){return function(){return we.call(this.children,t)}}("function"==typeof t?t:ye(t)))},filter:function(t){"function"!=typeof t&&(t=ve(t));for(var e=this._groups,n=e.length,i=new Array(n),s=0;s<n;++s)for(var r,o=e[s],a=o.length,c=i[s]=[],u=0;u<a;++u)(r=o[u])&&t.call(r,r.__data__,u,o)&&c.push(r);return new An(i,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,De);var n=e?Ce:ke,i=this._parents,s=this._groups;"function"!=typeof t&&(t=Ae(t));for(var r=s.length,o=new Array(r),a=new Array(r),c=new Array(r),u=0;u<r;++u){var l=i[u],h=s[u],f=h.length,d=Ee(t.call(l,l&&l.__data__,u,i)),p=d.length,_=a[u]=new Array(p),m=o[u]=new Array(p),g=c[u]=new Array(f);n(l,h,_,m,g,d,e);for(var v,y,b=0,x=0;b<p;++b)if(v=_[b]){for(b>=x&&(x=b+1);!(y=m[x])&&++x<p;);v._next=y||null}}return(o=new An(o,i))._enter=a,o._exit=c,o},enter:function(){return new An(this._enter||this._groups.map(Me),this._parents)},exit:function(){return new An(this._exit||this._groups.map(Me),this._parents)},join:function(t,e,n){var i=this.enter(),s=this,r=this.exit();return"function"==typeof t?(i=t(i))&&(i=i.selection()):i=i.append(t+""),null!=e&&(s=e(s))&&(s=s.selection()),null==n?r.remove():n(r),i&&s?i.merge(s).order():s},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,i=e._groups,s=n.length,r=i.length,o=Math.min(s,r),a=new Array(s),c=0;c<o;++c)for(var u,l=n[c],h=i[c],f=l.length,d=a[c]=new Array(f),p=0;p<f;++p)(u=l[p]||h[p])&&(d[p]=u);for(;c<s;++c)a[c]=n[c];return new An(a,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i,s=t[e],r=s.length-1,o=s[r];--r>=0;)(i=s[r])&&(o&&4^i.compareDocumentPosition(o)&&o.parentNode.insertBefore(i,o),o=i);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=Oe);for(var n=this._groups,i=n.length,s=new Array(i),r=0;r<i;++r){for(var o,a=n[r],c=a.length,u=s[r]=new Array(c),l=0;l<c;++l)(o=a[l])&&(u[l]=o);u.sort(e)}return new An(s,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],s=0,r=i.length;s<r;++s){var o=i[s];if(o)return o}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var s,r=e[n],o=0,a=r.length;o<a;++o)(s=r[o])&&t.call(s,s.__data__,o,r);return this},attr:function(t,e){var n=Ne(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==e?n.local?Ie:Fe:"function"==typeof e?n.local?je:ze:n.local?Ve:Pe)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?Be:"function"==typeof e?We:Ue)(t,e,null==n?"":n)):Ge(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?Ye:"function"==typeof e?Xe:He)(t,e)):this.node()[t]},classed:function(t,e){var n=Ze(t+"");if(arguments.length<2){for(var i=$e(this.node()),s=-1,r=n.length;++s<r;)if(!i.contains(n[s]))return!1;return!0}return this.each(("function"==typeof e?nn:e?tn:en)(n,e))},text:function(t){return arguments.length?this.each(null==t?sn:("function"==typeof t?on:rn)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?an:("function"==typeof t?un:cn)(t)):this.node().innerHTML},raise:function(){return this.each(ln)},lower:function(){return this.each(hn)},append:function(t){var e="function"==typeof t?t:pn(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:pn(t),i=null==e?_n:"function"==typeof e?e:pe(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)}))},remove:function(){return this.each(mn)},clone:function(t){return this.select(t?vn:gn)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var i,s,r=yn(t+""),o=r.length;if(!(arguments.length<2)){for(a=e?xn:bn,i=0;i<o;++i)this.each(a(r[i],e,n));return this}var a=this.node().__on;if(a)for(var c,u=0,l=a.length;u<l;++u)for(i=0,c=a[u];i<o;++i)if((s=r[i]).type===c.type&&s.name===c.name)return c.value},dispatch:function(t,e){return this.each(("function"==typeof e?Mn:Tn)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i,s=t[e],r=0,o=s.length;r<o;++r)(i=s[r])&&(yield i)}};const Cn=kn;function Dn(t){return"string"==typeof t?new An([[document.querySelector(t)]],[document.documentElement]):new An([[t]],Sn)}const En={passive:!1},On={capture:!0,passive:!1};function Rn(t){t.stopImmediatePropagation()}function qn(t){t.preventDefault(),t.stopImmediatePropagation()}function Nn(t){var e=t.document.documentElement,n=Dn(t).on("dragstart.drag",qn,On);"onselectstart"in e?n.on("selectstart.drag",qn,On):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Fn(t,e){var n=t.document.documentElement,i=Dn(t).on("dragstart.drag",null);e&&(i.on("click.drag",qn,On),setTimeout((function(){i.on("click.drag",null)}),0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function In(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Pn(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function Vn(){}var zn=.7,jn=1/zn,Ln="\\s*([+-]?\\d+)\\s*",Bn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Un="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Wn=/^#([0-9a-f]{3,8})$/,Gn=new RegExp("^rgb\\("+[Ln,Ln,Ln]+"\\)$"),Yn=new RegExp("^rgb\\("+[Un,Un,Un]+"\\)$"),Hn=new RegExp("^rgba\\("+[Ln,Ln,Ln,Bn]+"\\)$"),Xn=new RegExp("^rgba\\("+[Un,Un,Un,Bn]+"\\)$"),Zn=new RegExp("^hsl\\("+[Bn,Un,Un]+"\\)$"),$n=new RegExp("^hsla\\("+[Bn,Un,Un,Bn]+"\\)$"),Qn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Jn(){return this.rgb().formatHex()}function Kn(){return this.rgb().formatRgb()}function ti(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Wn.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?ei(e):3===n?new ri(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?ni(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?ni(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Gn.exec(t))?new ri(e[1],e[2],e[3],1):(e=Yn.exec(t))?new ri(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Hn.exec(t))?ni(e[1],e[2],e[3],e[4]):(e=Xn.exec(t))?ni(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Zn.exec(t))?ui(e[1],e[2]/100,e[3]/100,1):(e=$n.exec(t))?ui(e[1],e[2]/100,e[3]/100,e[4]):Qn.hasOwnProperty(t)?ei(Qn[t]):"transparent"===t?new ri(NaN,NaN,NaN,0):null}function ei(t){return new ri(t>>16&255,t>>8&255,255&t,1)}function ni(t,e,n,i){return i<=0&&(t=e=n=NaN),new ri(t,e,n,i)}function ii(t){return t instanceof Vn||(t=ti(t)),t?new ri((t=t.rgb()).r,t.g,t.b,t.opacity):new ri}function si(t,e,n,i){return 1===arguments.length?ii(t):new ri(t,e,n,null==i?1:i)}function ri(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function oi(){return"#"+ci(this.r)+ci(this.g)+ci(this.b)}function ai(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function ci(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function ui(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new fi(t,e,n,i)}function li(t){if(t instanceof fi)return new fi(t.h,t.s,t.l,t.opacity);if(t instanceof Vn||(t=ti(t)),!t)return new fi;if(t instanceof fi)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,s=Math.min(e,n,i),r=Math.max(e,n,i),o=NaN,a=r-s,c=(r+s)/2;return a?(o=e===r?(n-i)/a+6*(n<i):n===r?(i-e)/a+2:(e-n)/a+4,a/=c<.5?r+s:2-r-s,o*=60):a=c>0&&c<1?0:o,new fi(o,a,c,t.opacity)}function hi(t,e,n,i){return 1===arguments.length?li(t):new fi(t,e,n,null==i?1:i)}function fi(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function di(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function pi(t,e,n,i,s){var r=t*t,o=r*t;return((1-3*t+3*r-o)*e+(4-6*r+3*o)*n+(1+3*t+3*r-3*o)*i+o*s)/6}function _i(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),s=t[i],r=t[i+1],o=i>0?t[i-1]:2*s-r,a=i<e-1?t[i+2]:2*r-s;return pi((n-i/e)*e,o,s,r,a)}}function mi(t){var e=t.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*e),s=t[(i+e-1)%e],r=t[i%e],o=t[(i+1)%e],a=t[(i+2)%e];return pi((n-i/e)*e,s,r,o,a)}}In(Vn,ti,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Jn,formatHex:Jn,formatHsl:function(){return li(this).formatHsl()},formatRgb:Kn,toString:Kn}),In(ri,si,Pn(Vn,{brighter:function(t){return t=null==t?jn:Math.pow(jn,t),new ri(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?zn:Math.pow(zn,t),new ri(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:oi,formatHex:oi,formatRgb:ai,toString:ai})),In(fi,hi,Pn(Vn,{brighter:function(t){return t=null==t?jn:Math.pow(jn,t),new fi(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?zn:Math.pow(zn,t),new fi(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,s=2*n-i;return new ri(di(t>=240?t-240:t+120,s,i),di(t,s,i),di(t<120?t+240:t-120,s,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));const gi=t=>()=>t;function vi(t,e){return function(n){return t+n*e}}function yi(t,e){var n=e-t;return n?vi(t,n>180||n<-180?n-360*Math.round(n/360):n):gi(isNaN(t)?e:t)}function bi(t,e){var n=e-t;return n?vi(t,n):gi(isNaN(t)?e:t)}const xi=function t(e){var n=function(t){return 1==(t=+t)?bi:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}(e,n,t):gi(isNaN(e)?n:e)}}(e);function i(t,e){var i=n((t=si(t)).r,(e=si(e)).r),s=n(t.g,e.g),r=n(t.b,e.b),o=bi(t.opacity,e.opacity);return function(e){return t.r=i(e),t.g=s(e),t.b=r(e),t.opacity=o(e),t+""}}return i.gamma=t,i}(1);function wi(t){return function(e){var n,i,s=e.length,r=new Array(s),o=new Array(s),a=new Array(s);for(n=0;n<s;++n)i=si(e[n]),r[n]=i.r||0,o[n]=i.g||0,a[n]=i.b||0;return r=t(r),o=t(o),a=t(a),i.opacity=1,function(t){return i.r=r(t),i.g=o(t),i.b=a(t),i+""}}}var Ti=wi(_i),Mi=wi(mi);function Si(t,e){e||(e=[]);var n,i=t?Math.min(e.length,t.length):0,s=e.slice();return function(r){for(n=0;n<i;++n)s[n]=t[n]*(1-r)+e[n]*r;return s}}function Ai(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function ki(t,e){return(Ai(e)?Si:Ci)(t,e)}function Ci(t,e){var n,i=e?e.length:0,s=t?Math.min(i,t.length):0,r=new Array(s),o=new Array(i);for(n=0;n<s;++n)r[n]=Fi(t[n],e[n]);for(;n<i;++n)o[n]=e[n];return function(t){for(n=0;n<s;++n)o[n]=r[n](t);return o}}function Di(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function Ei(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Oi(t,e){var n,i={},s={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?i[n]=Fi(t[n],e[n]):s[n]=e[n];return function(t){for(n in i)s[n]=i[n](t);return s}}var Ri=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,qi=new RegExp(Ri.source,"g");function Ni(t,e){var n,i,s,r=Ri.lastIndex=qi.lastIndex=0,o=-1,a=[],c=[];for(t+="",e+="";(n=Ri.exec(t))&&(i=qi.exec(e));)(s=i.index)>r&&(s=e.slice(r,s),a[o]?a[o]+=s:a[++o]=s),(n=n[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,c.push({i:o,x:Ei(n,i)})),r=qi.lastIndex;return r<e.length&&(s=e.slice(r),a[o]?a[o]+=s:a[++o]=s),a.length<2?c[0]?function(t){return function(e){return t(e)+""}}(c[0].x):function(t){return function(){return t}}(e):(e=c.length,function(t){for(var n,i=0;i<e;++i)a[(n=c[i]).i]=n.x(t);return a.join("")})}function Fi(t,e){var n,i=typeof e;return null==e||"boolean"===i?gi(e):("number"===i?Ei:"string"===i?(n=ti(e))?(e=n,xi):Ni:e instanceof ti?xi:e instanceof Date?Di:Ai(e)?Si:Array.isArray(e)?Ci:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?Oi:Ei)(t,e)}function Ii(t){let e;for(;e=t.sourceEvent;)t=e;return t}function Pi(t,e){if(t=Ii(t),void 0===e&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,[(i=i.matrixTransform(e.getScreenCTM().inverse())).x,i.y]}if(e.getBoundingClientRect){var s=e.getBoundingClientRect();return[t.clientX-s.left-e.clientLeft,t.clientY-s.top-e.clientTop]}}return[t.pageX,t.pageY]}var Vi,zi,ji=0,Li=0,Bi=0,Ui=0,Wi=0,Gi=0,Yi="object"==typeof performance&&performance.now?performance:Date,Hi="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Xi(){return Wi||(Hi(Zi),Wi=Yi.now()+Gi)}function Zi(){Wi=0}function $i(){this._call=this._time=this._next=null}function Qi(t,e,n){var i=new $i;return i.restart(t,e,n),i}function Ji(){Xi(),++ji;for(var t,e=Vi;e;)(t=Wi-e._time)>=0&&e._call.call(void 0,t),e=e._next;--ji}function Ki(){Wi=(Ui=Yi.now())+Gi,ji=Li=0;try{Ji()}finally{ji=0,function(){for(var t,e,n=Vi,i=1/0;n;)n._call?(i>n._time&&(i=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Vi=e);zi=t,es(i)}(),Wi=0}}function ts(){var t=Yi.now(),e=t-Ui;e>1e3&&(Gi-=e,Ui=t)}function es(t){ji||(Li&&(Li=clearTimeout(Li)),t-Wi>24?(t<1/0&&(Li=setTimeout(Ki,t-Yi.now()-Gi)),Bi&&(Bi=clearInterval(Bi))):(Bi||(Ui=Yi.now(),Bi=setInterval(ts,1e3)),ji=1,Hi(Ki)))}function ns(t,e,n){var i=new $i;return e=null==e?0:+e,i.restart((n=>{i.stop(),t(n+e)}),e,n),i}$i.prototype=Qi.prototype={constructor:$i,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Xi():+n)+(null==e?0:+e),this._next||zi===this||(zi?zi._next=this:Vi=this,zi=this),this._call=t,this._time=n,es()},stop:function(){this._call&&(this._call=null,this._time=1/0,es())}};var is=fe("start","end","cancel","interrupt"),ss=[];function rs(t,e,n,i,s,r){var o=t.__transition;if(o){if(n in o)return}else t.__transition={};!function(t,e,n){var i,s=t.__transition;function r(c){var u,l,h,f;if(1!==n.state)return a();for(u in s)if((f=s[u]).name===n.name){if(3===f.state)return ns(r);4===f.state?(f.state=6,f.timer.stop(),f.on.call("interrupt",t,t.__data__,f.index,f.group),delete s[u]):+u<e&&(f.state=6,f.timer.stop(),f.on.call("cancel",t,t.__data__,f.index,f.group),delete s[u])}if(ns((function(){3===n.state&&(n.state=4,n.timer.restart(o,n.delay,n.time),o(c))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,i=new Array(h=n.tween.length),u=0,l=-1;u<h;++u)(f=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(i[++l]=f);i.length=l+1}}function o(e){for(var s=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(a),n.state=5,1),r=-1,o=i.length;++r<o;)i[r].call(t,s);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),a())}function a(){for(var i in n.state=6,n.timer.stop(),delete s[e],s)return;delete t.__transition}s[e]=n,n.timer=Qi((function(t){n.state=1,n.timer.restart(r,n.delay,n.time),n.delay<=t&&r(t-n.delay)}),0,n.time)}(t,n,{name:e,index:i,group:s,on:is,tween:ss,time:r.time,delay:r.delay,duration:r.duration,ease:r.ease,timer:null,state:0})}function os(t,e){var n=cs(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function as(t,e){var n=cs(t,e);if(n.state>3)throw new Error("too late; already running");return n}function cs(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function us(t,e){var n,i,s,r=t.__transition,o=!0;if(r){for(s in e=null==e?null:e+"",r)(n=r[s]).name===e?(i=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(i?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete r[s]):o=!1;o&&delete t.__transition}}var ls,hs=180/Math.PI,fs={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ds(t,e,n,i,s,r){var o,a,c;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(c=t*n+e*i)&&(n-=t*c,i-=e*c),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,c/=a),t*i<e*n&&(t=-t,e=-e,c=-c,o=-o),{translateX:s,translateY:r,rotate:Math.atan2(e,t)*hs,skewX:Math.atan(c)*hs,scaleX:o,scaleY:a}}function ps(t,e,n,i){function s(t){return t.length?t.pop()+" ":""}return function(r,o){var a=[],c=[];return r=t(r),o=t(o),function(t,i,s,r,o,a){if(t!==s||i!==r){var c=o.push("translate(",null,e,null,n);a.push({i:c-4,x:Ei(t,s)},{i:c-2,x:Ei(i,r)})}else(s||r)&&o.push("translate("+s+e+r+n)}(r.translateX,r.translateY,o.translateX,o.translateY,a,c),function(t,e,n,r){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),r.push({i:n.push(s(n)+"rotate(",null,i)-2,x:Ei(t,e)})):e&&n.push(s(n)+"rotate("+e+i)}(r.rotate,o.rotate,a,c),function(t,e,n,r){t!==e?r.push({i:n.push(s(n)+"skewX(",null,i)-2,x:Ei(t,e)}):e&&n.push(s(n)+"skewX("+e+i)}(r.skewX,o.skewX,a,c),function(t,e,n,i,r,o){if(t!==n||e!==i){var a=r.push(s(r)+"scale(",null,",",null,")");o.push({i:a-4,x:Ei(t,n)},{i:a-2,x:Ei(e,i)})}else 1===n&&1===i||r.push(s(r)+"scale("+n+","+i+")")}(r.scaleX,r.scaleY,o.scaleX,o.scaleY,a,c),r=o=null,function(t){for(var e,n=-1,i=c.length;++n<i;)a[(e=c[n]).i]=e.x(t);return a.join("")}}}var _s=ps((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?fs:ds(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),ms=ps((function(t){return null==t?fs:(ls||(ls=document.createElementNS("http://www.w3.org/2000/svg","g")),ls.setAttribute("transform",t),(t=ls.transform.baseVal.consolidate())?ds((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):fs)}),", ",")",")");function gs(t,e){var n,i;return function(){var s=as(this,t),r=s.tween;if(r!==n)for(var o=0,a=(i=n=r).length;o<a;++o)if(i[o].name===e){(i=i.slice()).splice(o,1);break}s.tween=i}}function vs(t,e,n){var i,s;if("function"!=typeof n)throw new Error;return function(){var r=as(this,t),o=r.tween;if(o!==i){s=(i=o).slice();for(var a={name:e,value:n},c=0,u=s.length;c<u;++c)if(s[c].name===e){s[c]=a;break}c===u&&s.push(a)}r.tween=s}}function ys(t,e,n){var i=t._id;return t.each((function(){var t=as(this,i);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return cs(t,i).value[e]}}function bs(t,e){var n;return("number"==typeof e?Ei:e instanceof ti?xi:(n=ti(e))?(e=n,xi):Ni)(t,e)}function xs(t){return function(){this.removeAttribute(t)}}function ws(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ts(t,e,n){var i,s,r=n+"";return function(){var o=this.getAttribute(t);return o===r?null:o===i?s:s=e(i=o,n)}}function Ms(t,e,n){var i,s,r=n+"";return function(){var o=this.getAttributeNS(t.space,t.local);return o===r?null:o===i?s:s=e(i=o,n)}}function Ss(t,e,n){var i,s,r;return function(){var o,a,c=n(this);if(null!=c)return(o=this.getAttribute(t))===(a=c+"")?null:o===i&&a===s?r:(s=a,r=e(i=o,c));this.removeAttribute(t)}}function As(t,e,n){var i,s,r;return function(){var o,a,c=n(this);if(null!=c)return(o=this.getAttributeNS(t.space,t.local))===(a=c+"")?null:o===i&&a===s?r:(s=a,r=e(i=o,c));this.removeAttributeNS(t.space,t.local)}}function ks(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Cs(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Ds(t,e){var n,i;function s(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&Cs(t,s)),n}return s._value=e,s}function Es(t,e){var n,i;function s(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&ks(t,s)),n}return s._value=e,s}function Os(t,e){return function(){os(this,t).delay=+e.apply(this,arguments)}}function Rs(t,e){return e=+e,function(){os(this,t).delay=e}}function qs(t,e){return function(){as(this,t).duration=+e.apply(this,arguments)}}function Ns(t,e){return e=+e,function(){as(this,t).duration=e}}function Fs(t,e){if("function"!=typeof e)throw new Error;return function(){as(this,t).ease=e}}function Is(t,e,n){var i,s,r=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?os:as;return function(){var o=r(this,t),a=o.on;a!==i&&(s=(i=a).copy()).on(e,n),o.on=s}}var Ps=Cn.prototype.constructor;function Vs(t){return function(){this.style.removeProperty(t)}}function zs(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}function js(t,e,n){var i,s;function r(){var r=e.apply(this,arguments);return r!==s&&(i=(s=r)&&zs(t,r,n)),i}return r._value=e,r}function Ls(t){return function(e){this.textContent=t.call(this,e)}}function Bs(t){var e,n;function i(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&Ls(i)),e}return i._value=t,i}var Us=0;function Ws(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function Gs(t){return Cn().transition(t)}function Ys(){return++Us}var Hs=Cn.prototype;function Xs(t){return t*t*t}function Zs(t){return--t*t*t+1}function $s(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}Ws.prototype=Gs.prototype={constructor:Ws,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=pe(t));for(var i=this._groups,s=i.length,r=new Array(s),o=0;o<s;++o)for(var a,c,u=i[o],l=u.length,h=r[o]=new Array(l),f=0;f<l;++f)(a=u[f])&&(c=t.call(a,a.__data__,f,u))&&("__data__"in a&&(c.__data__=a.__data__),h[f]=c,rs(h[f],e,n,f,h,cs(a,n)));return new Ws(r,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=ge(t));for(var i=this._groups,s=i.length,r=[],o=[],a=0;a<s;++a)for(var c,u=i[a],l=u.length,h=0;h<l;++h)if(c=u[h]){for(var f,d=t.call(c,c.__data__,h,u),p=cs(c,n),_=0,m=d.length;_<m;++_)(f=d[_])&&rs(f,e,n,_,d,p);r.push(d),o.push(c)}return new Ws(r,o,e,n)},selectChild:Hs.selectChild,selectChildren:Hs.selectChildren,filter:function(t){"function"!=typeof t&&(t=ve(t));for(var e=this._groups,n=e.length,i=new Array(n),s=0;s<n;++s)for(var r,o=e[s],a=o.length,c=i[s]=[],u=0;u<a;++u)(r=o[u])&&t.call(r,r.__data__,u,o)&&c.push(r);return new Ws(i,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,s=n.length,r=Math.min(i,s),o=new Array(i),a=0;a<r;++a)for(var c,u=e[a],l=n[a],h=u.length,f=o[a]=new Array(h),d=0;d<h;++d)(c=u[d]||l[d])&&(f[d]=c);for(;a<i;++a)o[a]=e[a];return new Ws(o,this._parents,this._name,this._id)},selection:function(){return new Ps(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=Ys(),i=this._groups,s=i.length,r=0;r<s;++r)for(var o,a=i[r],c=a.length,u=0;u<c;++u)if(o=a[u]){var l=cs(o,e);rs(o,t,n,u,a,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new Ws(i,this._parents,t,n)},call:Hs.call,nodes:Hs.nodes,node:Hs.node,size:Hs.size,empty:Hs.empty,each:Hs.each,on:function(t,e){var n=this._id;return arguments.length<2?cs(this.node(),n).on.on(t):this.each(Is(n,t,e))},attr:function(t,e){var n=Ne(t),i="transform"===n?ms:bs;return this.attrTween(t,"function"==typeof e?(n.local?As:Ss)(n,i,ys(this,"attr."+t,e)):null==e?(n.local?ws:xs)(n):(n.local?Ms:Ts)(n,i,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var i=Ne(t);return this.tween(n,(i.local?Ds:Es)(i,e))},style:function(t,e,n){var i="transform"==(t+="")?_s:bs;return null==e?this.styleTween(t,function(t,e){var n,i,s;return function(){var r=Ge(this,t),o=(this.style.removeProperty(t),Ge(this,t));return r===o?null:r===n&&o===i?s:s=e(n=r,i=o)}}(t,i)).on("end.style."+t,Vs(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var i,s,r;return function(){var o=Ge(this,t),a=n(this),c=a+"";return null==a&&(this.style.removeProperty(t),c=a=Ge(this,t)),o===c?null:o===i&&c===s?r:(s=c,r=e(i=o,a))}}(t,i,ys(this,"style."+t,e))).each(function(t,e){var n,i,s,r,o="style."+e,a="end."+o;return function(){var c=as(this,t),u=c.on,l=null==c.value[o]?r||(r=Vs(e)):void 0;u===n&&s===l||(i=(n=u).copy()).on(a,s=l),c.on=i}}(this._id,t)):this.styleTween(t,function(t,e,n){var i,s,r=n+"";return function(){var o=Ge(this,t);return o===r?null:o===i?s:s=e(i=o,n)}}(t,i,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!=typeof e)throw new Error;return this.tween(i,js(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(ys(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,Bs(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i,s=cs(this.node(),n).tween,r=0,o=s.length;r<o;++r)if((i=s[r]).name===t)return i.value;return null}return this.each((null==e?gs:vs)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Os:Rs)(e,t)):cs(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?qs:Ns)(e,t)):cs(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(Fs(e,t)):cs(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;as(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,i=n._id,s=n.size();return new Promise((function(r,o){var a={value:o},c={value:function(){0==--s&&r()}};n.each((function(){var n=as(this,i),s=n.on;s!==t&&((e=(t=s).copy())._.cancel.push(a),e._.interrupt.push(a),e._.end.push(c)),n.on=e})),0===s&&r()}))},[Symbol.iterator]:Hs[Symbol.iterator]};var Qs={time:null,delay:0,duration:250,ease:$s};function Js(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}Cn.prototype.interrupt=function(t){return this.each((function(){us(this,t)}))},Cn.prototype.transition=function(t){var e,n;t instanceof Ws?(e=t._id,t=t._name):(e=Ys(),(n=Qs).time=Xi(),t=null==t?null:t+"");for(var i=this._groups,s=i.length,r=0;r<s;++r)for(var o,a=i[r],c=a.length,u=0;u<c;++u)(o=a[u])&&rs(o,t,e,u,a,n||Js(o,e));return new Ws(i,this._parents,t,e)};var Ks=[null];function tr(t,e){var n,i,s=t.__transition;if(s)for(i in e=null==e?null:e+"",s)if((n=s[i]).state>1&&n.name===e)return new Ws([[t]],Ks,e,+i);return null}const er=t=>()=>t;function nr(t,{sourceEvent:e,target:n,selection:i,mode:s,dispatch:r}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},selection:{value:i,enumerable:!0,configurable:!0},mode:{value:s,enumerable:!0,configurable:!0},_:{value:r}})}function ir(t){t.stopImmediatePropagation()}function sr(t){t.preventDefault(),t.stopImmediatePropagation()}var rr={name:"drag"},or={name:"space"},ar={name:"handle"},cr={name:"center"};const{abs:ur,max:lr,min:hr}=Math;function fr(t){return[+t[0],+t[1]]}function dr(t){return[fr(t[0]),fr(t[1])]}var pr={name:"x",handles:["w","e"].map(wr),input:function(t,e){return null==t?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},_r={name:"y",handles:["n","s"].map(wr),input:function(t,e){return null==t?null:[[e[0][0],+t[0]],[e[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},mr={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(wr),input:function(t){return null==t?null:dr(t)},output:function(t){return t}},gr={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},vr={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},yr={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},br={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},xr={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function wr(t){return{type:t}}function Tr(t){return!t.ctrlKey&&!t.button}function Mr(){var t=this.ownerSVGElement||this;return t.hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function Sr(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ar(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function kr(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function Cr(t){var e=t.__brush;return e?e.dim.output(e.selection):null}function Dr(){return Rr(pr)}function Er(){return Rr(_r)}function Or(){return Rr(mr)}function Rr(t){var e,n=Mr,i=Tr,s=Sr,r=!0,o=fe("start","brush","end"),a=6;function c(e){var n=e.property("__brush",_).selectAll(".overlay").data([wr("overlay")]);n.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",gr.overlay).merge(n).each((function(){var t=Ar(this).extent;Dn(this).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1])})),e.selectAll(".selection").data([wr("selection")]).enter().append("rect").attr("class","selection").attr("cursor",gr.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var i=e.selectAll(".handle").data(t.handles,(function(t){return t.type}));i.exit().remove(),i.enter().append("rect").attr("class",(function(t){return"handle handle--"+t.type})).attr("cursor",(function(t){return gr[t.type]})),e.each(u).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",f).filter(s).on("touchstart.brush",f).on("touchmove.brush",d).on("touchend.brush touchcancel.brush",p).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function u(){var t=Dn(this),e=Ar(this).selection;e?(t.selectAll(".selection").style("display",null).attr("x",e[0][0]).attr("y",e[0][1]).attr("width",e[1][0]-e[0][0]).attr("height",e[1][1]-e[0][1]),t.selectAll(".handle").style("display",null).attr("x",(function(t){return"e"===t.type[t.type.length-1]?e[1][0]-a/2:e[0][0]-a/2})).attr("y",(function(t){return"s"===t.type[0]?e[1][1]-a/2:e[0][1]-a/2})).attr("width",(function(t){return"n"===t.type||"s"===t.type?e[1][0]-e[0][0]+a:a})).attr("height",(function(t){return"e"===t.type||"w"===t.type?e[1][1]-e[0][1]+a:a}))):t.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function l(t,e,n){var i=t.__brush.emitter;return!i||n&&i.clean?new h(t,e,n):i}function h(t,e,n){this.that=t,this.args=e,this.state=t.__brush,this.active=0,this.clean=n}function f(n){if((!e||n.touches)&&i.apply(this,arguments)){var s,o,a,c,h,f,d,p,_,m,g,v=this,y=n.target.__data__.type,b="selection"===(r&&n.metaKey?y="overlay":y)?rr:r&&n.altKey?cr:ar,x=t===_r?null:br[y],w=t===pr?null:xr[y],T=Ar(v),M=T.extent,S=T.selection,A=M[0][0],k=M[0][1],C=M[1][0],D=M[1][1],E=0,O=0,R=x&&w&&r&&n.shiftKey,q=Array.from(n.touches||[n],(t=>{const e=t.identifier;return(t=Pi(t,v)).point0=t.slice(),t.identifier=e,t}));us(v);var N=l(v,arguments,!0).beforestart();if("overlay"===y){S&&(_=!0);const e=[q[0],q[1]||q[0]];T.selection=S=[[s=t===_r?A:hr(e[0][0],e[1][0]),a=t===pr?k:hr(e[0][1],e[1][1])],[h=t===_r?C:lr(e[0][0],e[1][0]),d=t===pr?D:lr(e[0][1],e[1][1])]],q.length>1&&z(n)}else s=S[0][0],a=S[0][1],h=S[1][0],d=S[1][1];o=s,c=a,f=h,p=d;var F=Dn(v).attr("pointer-events","none"),I=F.selectAll(".overlay").attr("cursor",gr[y]);if(n.touches)N.moved=V,N.ended=j;else{var P=Dn(n.view).on("mousemove.brush",V,!0).on("mouseup.brush",j,!0);r&&P.on("keydown.brush",L,!0).on("keyup.brush",B,!0),Nn(n.view)}u.call(v),N.start(n,b.name)}function V(t){for(const e of t.changedTouches||[t])for(const t of q)t.identifier===e.identifier&&(t.cur=Pi(e,v));if(R&&!m&&!g&&1===q.length){const t=q[0];ur(t.cur[0]-t[0])>ur(t.cur[1]-t[1])?g=!0:m=!0}for(const t of q)t.cur&&(t[0]=t.cur[0],t[1]=t.cur[1]);_=!0,sr(t),z(t)}function z(t){const e=q[0],n=e.point0;var i;switch(E=e[0]-n[0],O=e[1]-n[1],b){case or:case rr:x&&(E=lr(A-s,hr(C-h,E)),o=s+E,f=h+E),w&&(O=lr(k-a,hr(D-d,O)),c=a+O,p=d+O);break;case ar:q[1]?(x&&(o=lr(A,hr(C,q[0][0])),f=lr(A,hr(C,q[1][0])),x=1),w&&(c=lr(k,hr(D,q[0][1])),p=lr(k,hr(D,q[1][1])),w=1)):(x<0?(E=lr(A-s,hr(C-s,E)),o=s+E,f=h):x>0&&(E=lr(A-h,hr(C-h,E)),o=s,f=h+E),w<0?(O=lr(k-a,hr(D-a,O)),c=a+O,p=d):w>0&&(O=lr(k-d,hr(D-d,O)),c=a,p=d+O));break;case cr:x&&(o=lr(A,hr(C,s-E*x)),f=lr(A,hr(C,h+E*x))),w&&(c=lr(k,hr(D,a-O*w)),p=lr(k,hr(D,d+O*w)))}f<o&&(x*=-1,i=s,s=h,h=i,i=o,o=f,f=i,y in vr&&I.attr("cursor",gr[y=vr[y]])),p<c&&(w*=-1,i=a,a=d,d=i,i=c,c=p,p=i,y in yr&&I.attr("cursor",gr[y=yr[y]])),T.selection&&(S=T.selection),m&&(o=S[0][0],f=S[1][0]),g&&(c=S[0][1],p=S[1][1]),S[0][0]===o&&S[0][1]===c&&S[1][0]===f&&S[1][1]===p||(T.selection=[[o,c],[f,p]],u.call(v),N.brush(t,b.name))}function j(t){if(ir(t),t.touches){if(t.touches.length)return;e&&clearTimeout(e),e=setTimeout((function(){e=null}),500)}else Fn(t.view,_),P.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);F.attr("pointer-events","all"),I.attr("cursor",gr.overlay),T.selection&&(S=T.selection),kr(S)&&(T.selection=null,u.call(v)),N.end(t,b.name)}function L(t){switch(t.keyCode){case 16:R=x&&w;break;case 18:b===ar&&(x&&(h=f-E*x,s=o+E*x),w&&(d=p-O*w,a=c+O*w),b=cr,z(t));break;case 32:b!==ar&&b!==cr||(x<0?h=f-E:x>0&&(s=o-E),w<0?d=p-O:w>0&&(a=c-O),b=or,I.attr("cursor",gr.selection),z(t));break;default:return}sr(t)}function B(t){switch(t.keyCode){case 16:R&&(m=g=R=!1,z(t));break;case 18:b===cr&&(x<0?h=f:x>0&&(s=o),w<0?d=p:w>0&&(a=c),b=ar,z(t));break;case 32:b===or&&(t.altKey?(x&&(h=f-E*x,s=o+E*x),w&&(d=p-O*w,a=c+O*w),b=cr):(x<0?h=f:x>0&&(s=o),w<0?d=p:w>0&&(a=c),b=ar),I.attr("cursor",gr[y]),z(t));break;default:return}sr(t)}}function d(t){l(this,arguments).moved(t)}function p(t){l(this,arguments).ended(t)}function _(){var e=this.__brush||{selection:null};return e.extent=dr(n.apply(this,arguments)),e.dim=t,e}return c.move=function(e,n,i){e.tween?e.on("start.brush",(function(t){l(this,arguments).beforestart().start(t)})).on("interrupt.brush end.brush",(function(t){l(this,arguments).end(t)})).tween("brush",(function(){var e=this,i=e.__brush,s=l(e,arguments),r=i.selection,o=t.input("function"==typeof n?n.apply(this,arguments):n,i.extent),a=Fi(r,o);function c(t){i.selection=1===t&&null===o?null:a(t),u.call(e),s.brush()}return null!==r&&null!==o?c:c(1)})):e.each((function(){var e=this,s=arguments,r=e.__brush,o=t.input("function"==typeof n?n.apply(e,s):n,r.extent),a=l(e,s).beforestart();us(e),r.selection=null===o?null:o,u.call(e),a.start(i).brush(i).end(i)}))},c.clear=function(t,e){c.move(t,null,e)},h.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(t,e){return this.starting?(this.starting=!1,this.emit("start",t,e)):this.emit("brush",t),this},brush:function(t,e){return this.emit("brush",t,e),this},end:function(t,e){return 0==--this.active&&(delete this.state.emitter,this.emit("end",t,e)),this},emit:function(e,n,i){var s=Dn(this.that).datum();o.call(e,this.that,new nr(e,{sourceEvent:n,target:c,selection:t.output(this.state.selection),mode:i,dispatch:o}),s)}},c.extent=function(t){return arguments.length?(n="function"==typeof t?t:er(dr(t)),c):n},c.filter=function(t){return arguments.length?(i="function"==typeof t?t:er(!!t),c):i},c.touchable=function(t){return arguments.length?(s="function"==typeof t?t:er(!!t),c):s},c.handleSize=function(t){return arguments.length?(a=+t,c):a},c.keyModifiers=function(t){return arguments.length?(r=!!t,c):r},c.on=function(){var t=o.on.apply(o,arguments);return t===o?c:t},c}var qr=Math.abs,Nr=Math.cos,Fr=Math.sin,Ir=Math.PI,Pr=Ir/2,Vr=2*Ir,zr=Math.max,jr=1e-12;function Lr(t,e){return Array.from({length:e-t},((e,n)=>t+n))}function Br(t){return function(e,n){return t(e.source.value+e.target.value,n.source.value+n.target.value)}}function Ur(){return Yr(!1,!1)}function Wr(){return Yr(!1,!0)}function Gr(){return Yr(!0,!1)}function Yr(t,e){var n=0,i=null,s=null,r=null;function o(o){var a,c=o.length,u=new Array(c),l=Lr(0,c),h=new Array(c*c),f=new Array(c),d=0;o=Float64Array.from({length:c*c},e?(t,e)=>o[e%c][e/c|0]:(t,e)=>o[e/c|0][e%c]);for(let e=0;e<c;++e){let n=0;for(let i=0;i<c;++i)n+=o[e*c+i]+t*o[i*c+e];d+=u[e]=n}a=(d=zr(0,Vr-n*c)/d)?n:Vr/c;{let e=0;i&&l.sort(((t,e)=>i(u[t],u[e])));for(const n of l){const i=e;if(t){const t=Lr(1+~c,c).filter((t=>t<0?o[~t*c+n]:o[n*c+t]));s&&t.sort(((t,e)=>s(t<0?-o[~t*c+n]:o[n*c+t],e<0?-o[~e*c+n]:o[n*c+e])));for(const i of t)i<0?(h[~i*c+n]||(h[~i*c+n]={source:null,target:null})).target={index:n,startAngle:e,endAngle:e+=o[~i*c+n]*d,value:o[~i*c+n]}:(h[n*c+i]||(h[n*c+i]={source:null,target:null})).source={index:n,startAngle:e,endAngle:e+=o[n*c+i]*d,value:o[n*c+i]};f[n]={index:n,startAngle:i,endAngle:e,value:u[n]}}else{const t=Lr(0,c).filter((t=>o[n*c+t]||o[t*c+n]));s&&t.sort(((t,e)=>s(o[n*c+t],o[n*c+e])));for(const i of t){let t;if(n<i?(t=h[n*c+i]||(h[n*c+i]={source:null,target:null}),t.source={index:n,startAngle:e,endAngle:e+=o[n*c+i]*d,value:o[n*c+i]}):(t=h[i*c+n]||(h[i*c+n]={source:null,target:null}),t.target={index:n,startAngle:e,endAngle:e+=o[n*c+i]*d,value:o[n*c+i]},n===i&&(t.source=t.target)),t.source&&t.target&&t.source.value<t.target.value){const e=t.source;t.source=t.target,t.target=e}}f[n]={index:n,startAngle:i,endAngle:e,value:u[n]}}e+=a}}return(h=Object.values(h)).groups=f,r?h.sort(r):h}return o.padAngle=function(t){return arguments.length?(n=zr(0,t),o):n},o.sortGroups=function(t){return arguments.length?(i=t,o):i},o.sortSubgroups=function(t){return arguments.length?(s=t,o):s},o.sortChords=function(t){return arguments.length?(null==t?r=null:(r=Br(t))._=t,o):r&&r._},o}const Hr=Math.PI,Xr=2*Hr,Zr=1e-6,$r=Xr-Zr;function Qr(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Jr(){return new Qr}Qr.prototype=Jr.prototype={constructor:Qr,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,i){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(t,e,n,i,s,r){this._+="C"+ +t+","+ +e+","+ +n+","+ +i+","+(this._x1=+s)+","+(this._y1=+r)},arcTo:function(t,e,n,i,s){t=+t,e=+e,n=+n,i=+i,s=+s;var r=this._x1,o=this._y1,a=n-t,c=i-e,u=r-t,l=o-e,h=u*u+l*l;if(s<0)throw new Error("negative radius: "+s);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(h>Zr)if(Math.abs(l*a-c*u)>Zr&&s){var f=n-r,d=i-o,p=a*a+c*c,_=f*f+d*d,m=Math.sqrt(p),g=Math.sqrt(h),v=s*Math.tan((Hr-Math.acos((p+h-_)/(2*m*g)))/2),y=v/g,b=v/m;Math.abs(y-1)>Zr&&(this._+="L"+(t+y*u)+","+(e+y*l)),this._+="A"+s+","+s+",0,0,"+ +(l*f>u*d)+","+(this._x1=t+b*a)+","+(this._y1=e+b*c)}else this._+="L"+(this._x1=t)+","+(this._y1=e)},arc:function(t,e,n,i,s,r){t=+t,e=+e,r=!!r;var o=(n=+n)*Math.cos(i),a=n*Math.sin(i),c=t+o,u=e+a,l=1^r,h=r?i-s:s-i;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+c+","+u:(Math.abs(this._x1-c)>Zr||Math.abs(this._y1-u)>Zr)&&(this._+="L"+c+","+u),n&&(h<0&&(h=h%Xr+Xr),h>$r?this._+="A"+n+","+n+",0,1,"+l+","+(t-o)+","+(e-a)+"A"+n+","+n+",0,1,"+l+","+(this._x1=c)+","+(this._y1=u):h>Zr&&(this._+="A"+n+","+n+",0,"+ +(h>=Hr)+","+l+","+(this._x1=t+n*Math.cos(s))+","+(this._y1=e+n*Math.sin(s))))},rect:function(t,e,n,i){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};const Kr=Jr;var to=Array.prototype.slice;function eo(t){return function(){return t}}function no(t){return t.source}function io(t){return t.target}function so(t){return t.radius}function ro(t){return t.startAngle}function oo(t){return t.endAngle}function ao(){return 0}function co(){return 10}function uo(t){var e=no,n=io,i=so,s=so,r=ro,o=oo,a=ao,c=null;function u(){var u,l=e.apply(this,arguments),h=n.apply(this,arguments),f=a.apply(this,arguments)/2,d=to.call(arguments),p=+i.apply(this,(d[0]=l,d)),_=r.apply(this,d)-Pr,m=o.apply(this,d)-Pr,g=+s.apply(this,(d[0]=h,d)),v=r.apply(this,d)-Pr,y=o.apply(this,d)-Pr;if(c||(c=u=Kr()),f>jr&&(qr(m-_)>2*f+jr?m>_?(_+=f,m-=f):(_-=f,m+=f):_=m=(_+m)/2,qr(y-v)>2*f+jr?y>v?(v+=f,y-=f):(v-=f,y+=f):v=y=(v+y)/2),c.moveTo(p*Nr(_),p*Fr(_)),c.arc(0,0,p,_,m),_!==v||m!==y)if(t){var b=+t.apply(this,arguments),x=g-b,w=(v+y)/2;c.quadraticCurveTo(0,0,x*Nr(v),x*Fr(v)),c.lineTo(g*Nr(w),g*Fr(w)),c.lineTo(x*Nr(y),x*Fr(y))}else c.quadraticCurveTo(0,0,g*Nr(v),g*Fr(v)),c.arc(0,0,g,v,y);if(c.quadraticCurveTo(0,0,p*Nr(_),p*Fr(_)),c.closePath(),u)return c=null,u+""||null}return t&&(u.headRadius=function(e){return arguments.length?(t="function"==typeof e?e:eo(+e),u):t}),u.radius=function(t){return arguments.length?(i=s="function"==typeof t?t:eo(+t),u):i},u.sourceRadius=function(t){return arguments.length?(i="function"==typeof t?t:eo(+t),u):i},u.targetRadius=function(t){return arguments.length?(s="function"==typeof t?t:eo(+t),u):s},u.startAngle=function(t){return arguments.length?(r="function"==typeof t?t:eo(+t),u):r},u.endAngle=function(t){return arguments.length?(o="function"==typeof t?t:eo(+t),u):o},u.padAngle=function(t){return arguments.length?(a="function"==typeof t?t:eo(+t),u):a},u.source=function(t){return arguments.length?(e=t,u):e},u.target=function(t){return arguments.length?(n=t,u):n},u.context=function(t){return arguments.length?(c=null==t?null:t,u):c},u}function lo(){return uo()}function ho(){return uo(co)}const fo=Math.PI/180,po=180/Math.PI,_o=.96422,mo=.82521,go=4/29,vo=6/29,yo=3*vo*vo;function bo(t){if(t instanceof To)return new To(t.l,t.a,t.b,t.opacity);if(t instanceof Oo)return Ro(t);t instanceof ri||(t=ii(t));var e,n,i=ko(t.r),s=ko(t.g),r=ko(t.b),o=Mo((.2225045*i+.7168786*s+.0606169*r)/1);return i===s&&s===r?e=n=o:(e=Mo((.4360747*i+.3850649*s+.1430804*r)/_o),n=Mo((.0139322*i+.0971045*s+.7141733*r)/mo)),new To(116*o-16,500*(e-o),200*(o-n),t.opacity)}function xo(t,e){return new To(t,0,0,null==e?1:e)}function wo(t,e,n,i){return 1===arguments.length?bo(t):new To(t,e,n,null==i?1:i)}function To(t,e,n,i){this.l=+t,this.a=+e,this.b=+n,this.opacity=+i}function Mo(t){return t>.008856451679035631?Math.pow(t,1/3):t/yo+go}function So(t){return t>vo?t*t*t:yo*(t-go)}function Ao(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function ko(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Co(t){if(t instanceof Oo)return new Oo(t.h,t.c,t.l,t.opacity);if(t instanceof To||(t=bo(t)),0===t.a&&0===t.b)return new Oo(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*po;return new Oo(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function Do(t,e,n,i){return 1===arguments.length?Co(t):new Oo(n,e,t,null==i?1:i)}function Eo(t,e,n,i){return 1===arguments.length?Co(t):new Oo(t,e,n,null==i?1:i)}function Oo(t,e,n,i){this.h=+t,this.c=+e,this.l=+n,this.opacity=+i}function Ro(t){if(isNaN(t.h))return new To(t.l,0,0,t.opacity);var e=t.h*fo;return new To(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}In(To,wo,Pn(Vn,{brighter:function(t){return new To(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new To(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new ri(Ao(3.1338561*(e=_o*So(e))-1.6168667*(t=1*So(t))-.4906146*(n=mo*So(n))),Ao(-.9787684*e+1.9161415*t+.033454*n),Ao(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),In(Oo,Eo,Pn(Vn,{brighter:function(t){return new Oo(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new Oo(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return Ro(this).rgb()}}));var qo=-.14861,No=1.78277,Fo=-.29227,Io=-.90649,Po=1.97294,Vo=Po*Io,zo=Po*No,jo=No*Fo-Io*qo;function Lo(t){if(t instanceof Uo)return new Uo(t.h,t.s,t.l,t.opacity);t instanceof ri||(t=ii(t));var e=t.r/255,n=t.g/255,i=t.b/255,s=(jo*i+Vo*e-zo*n)/(jo+Vo-zo),r=i-s,o=(Po*(n-s)-Fo*r)/Io,a=Math.sqrt(o*o+r*r)/(Po*s*(1-s)),c=a?Math.atan2(o,r)*po-120:NaN;return new Uo(c<0?c+360:c,a,s,t.opacity)}function Bo(t,e,n,i){return 1===arguments.length?Lo(t):new Uo(t,e,n,null==i?1:i)}function Uo(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}In(Uo,Bo,Pn(Vn,{brighter:function(t){return t=null==t?jn:Math.pow(jn,t),new Uo(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?zn:Math.pow(zn,t),new Uo(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*fo,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),i=Math.cos(t),s=Math.sin(t);return new ri(255*(e+n*(qo*i+No*s)),255*(e+n*(Fo*i+Io*s)),255*(e+n*(Po*i)),this.opacity)}}));var Wo=Array.prototype.slice;function Go(t,e){return t-e}const Yo=t=>()=>t;function Ho(t,e){for(var n,i=-1,s=e.length;++i<s;)if(n=Xo(t,e[i]))return n;return 0}function Xo(t,e){for(var n=e[0],i=e[1],s=-1,r=0,o=t.length,a=o-1;r<o;a=r++){var c=t[r],u=c[0],l=c[1],h=t[a],f=h[0],d=h[1];if(Zo(c,h,e))return 0;l>i!=d>i&&n<(f-u)*(i-l)/(d-l)+u&&(s=-s)}return s}function Zo(t,e,n){var i,s,r,o;return function(t,e,n){return(e[0]-t[0])*(n[1]-t[1])==(n[0]-t[0])*(e[1]-t[1])}(t,e,n)&&(s=t[i=+(t[0]===e[0])],r=n[i],o=e[i],s<=r&&r<=o||o<=r&&r<=s)}function $o(){}var Qo=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function Jo(){var t=1,e=1,n=it,i=a;function s(t){var e=n(t);if(Array.isArray(e))e=e.slice().sort(Go);else{const n=b(t),i=et(n[0],n[1],e);e=K(Math.floor(n[0]/i)*i,Math.floor(n[1]/i-1)*i,e)}return e.map((e=>r(t,e)))}function r(n,s){var r=[],a=[];return function(n,i,s){var r,a,c,u,l,h,f=new Array,d=new Array;for(r=a=-1,u=n[0]>=i,Qo[u<<1].forEach(p);++r<t-1;)c=u,u=n[r+1]>=i,Qo[c|u<<1].forEach(p);for(Qo[u<<0].forEach(p);++a<e-1;){for(r=-1,u=n[a*t+t]>=i,l=n[a*t]>=i,Qo[u<<1|l<<2].forEach(p);++r<t-1;)c=u,u=n[a*t+t+r+1]>=i,h=l,l=n[a*t+r+1]>=i,Qo[c|u<<1|l<<2|h<<3].forEach(p);Qo[u|l<<3].forEach(p)}for(r=-1,l=n[a*t]>=i,Qo[l<<2].forEach(p);++r<t-1;)h=l,l=n[a*t+r+1]>=i,Qo[l<<2|h<<3].forEach(p);function p(t){var e,n,i=[t[0][0]+r,t[0][1]+a],c=[t[1][0]+r,t[1][1]+a],u=o(i),l=o(c);(e=d[u])?(n=f[l])?(delete d[e.end],delete f[n.start],e===n?(e.ring.push(c),s(e.ring)):f[e.start]=d[n.end]={start:e.start,end:n.end,ring:e.ring.concat(n.ring)}):(delete d[e.end],e.ring.push(c),d[e.end=l]=e):(e=f[l])?(n=d[u])?(delete f[e.start],delete d[n.end],e===n?(e.ring.push(c),s(e.ring)):f[n.start]=d[e.end]={start:n.start,end:e.end,ring:n.ring.concat(e.ring)}):(delete f[e.start],e.ring.unshift(i),f[e.start=u]=e):f[u]=d[l]={start:u,end:l,ring:[i,c]}}Qo[l<<3].forEach(p)}(n,s,(function(t){i(t,n,s),function(t){for(var e=0,n=t.length,i=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];++e<n;)i+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return i}(t)>0?r.push([t]):a.push(t)})),a.forEach((function(t){for(var e,n=0,i=r.length;n<i;++n)if(-1!==Ho((e=r[n])[0],t))return void e.push(t)})),{type:"MultiPolygon",value:s,coordinates:r}}function o(e){return 2*e[0]+e[1]*(t+1)*4}function a(n,i,s){n.forEach((function(n){var r,o=n[0],a=n[1],c=0|o,u=0|a,l=i[u*t+c];o>0&&o<t&&c===o&&(r=i[u*t+c-1],n[0]=o+(s-r)/(l-r)-.5),a>0&&a<e&&u===a&&(r=i[(u-1)*t+c],n[1]=a+(s-r)/(l-r)-.5)}))}return s.contour=r,s.size=function(n){if(!arguments.length)return[t,e];var i=Math.floor(n[0]),r=Math.floor(n[1]);if(!(i>=0&&r>=0))throw new Error("invalid size");return t=i,e=r,s},s.thresholds=function(t){return arguments.length?(n="function"==typeof t?t:Array.isArray(t)?Yo(Wo.call(t)):Yo(t),s):n},s.smooth=function(t){return arguments.length?(i=t?a:$o,s):i===a},s}function Ko(t,e,n){for(var i=t.width,s=t.height,r=1+(n<<1),o=0;o<s;++o)for(var a=0,c=0;a<i+n;++a)a<i&&(c+=t.data[a+o*i]),a>=n&&(a>=r&&(c-=t.data[a-r+o*i]),e.data[a-n+o*i]=c/Math.min(a+1,i-1+r-a,r))}function ta(t,e,n){for(var i=t.width,s=t.height,r=1+(n<<1),o=0;o<i;++o)for(var a=0,c=0;a<s+n;++a)a<s&&(c+=t.data[o+a*i]),a>=n&&(a>=r&&(c-=t.data[o+(a-r)*i]),e.data[o+(a-n)*i]=c/Math.min(a+1,s-1+r-a,r))}function ea(t){return t[0]}function na(t){return t[1]}function ia(){return 1}function sa(){var t=ea,e=na,n=ia,i=960,s=500,r=20,o=2,a=3*r,c=i+2*a>>o,u=s+2*a>>o,l=Yo(20);function h(i){var s=new Float32Array(c*u),h=new Float32Array(c*u),d=Math.pow(2,-o);i.forEach((function(i,r,o){var l=(t(i,r,o)+a)*d,h=(e(i,r,o)+a)*d,f=+n(i,r,o);if(l>=0&&l<c&&h>=0&&h<u){var p=Math.floor(l),_=Math.floor(h),m=l-p-.5,g=h-_-.5;s[p+_*c]+=(1-m)*(1-g)*f,s[p+1+_*c]+=m*(1-g)*f,s[p+1+(_+1)*c]+=m*g*f,s[p+(_+1)*c]+=(1-m)*g*f}})),Ko({width:c,height:u,data:s},{width:c,height:u,data:h},r>>o),ta({width:c,height:u,data:h},{width:c,height:u,data:s},r>>o),Ko({width:c,height:u,data:s},{width:c,height:u,data:h},r>>o),ta({width:c,height:u,data:h},{width:c,height:u,data:s},r>>o),Ko({width:c,height:u,data:s},{width:c,height:u,data:h},r>>o),ta({width:c,height:u,data:h},{width:c,height:u,data:s},r>>o);var p=l(s);if(!Array.isArray(p)){var _=rt(s);p=et(0,_,p),(p=xt(0,Math.floor(_/p)*p,p)).shift()}return Jo().thresholds(p).size([c,u])(s).map(f)}function f(t){return t.value*=Math.pow(2,-2*o),t.coordinates.forEach(d),t}function d(t){t.forEach(p)}function p(t){t.forEach(_)}function _(t){t[0]=t[0]*Math.pow(2,o)-a,t[1]=t[1]*Math.pow(2,o)-a}function m(){return c=i+2*(a=3*r)>>o,u=s+2*a>>o,h}return h.x=function(e){return arguments.length?(t="function"==typeof e?e:Yo(+e),h):t},h.y=function(t){return arguments.length?(e="function"==typeof t?t:Yo(+t),h):e},h.weight=function(t){return arguments.length?(n="function"==typeof t?t:Yo(+t),h):n},h.size=function(t){if(!arguments.length)return[i,s];var e=+t[0],n=+t[1];if(!(e>=0&&n>=0))throw new Error("invalid size");return i=e,s=n,m()},h.cellSize=function(t){if(!arguments.length)return 1<<o;if(!((t=+t)>=1))throw new Error("invalid cell size");return o=Math.floor(Math.log(t)/Math.LN2),m()},h.thresholds=function(t){return arguments.length?(l="function"==typeof t?t:Array.isArray(t)?Yo(Wo.call(t)):Yo(t),h):l},h.bandwidth=function(t){if(!arguments.length)return Math.sqrt(r*(r+1));if(!((t=+t)>=0))throw new Error("invalid bandwidth");return r=Math.round((Math.sqrt(4*t*t+1)-1)/2),m()},h}const ra=134217729;function oa(t,e,n,i,s){let r,o,a,c,u=e[0],l=i[0],h=0,f=0;l>u==l>-u?(r=u,u=e[++h]):(r=l,l=i[++f]);let d=0;if(h<t&&f<n)for(l>u==l>-u?(o=u+r,a=r-(o-u),u=e[++h]):(o=l+r,a=r-(o-l),l=i[++f]),r=o,0!==a&&(s[d++]=a);h<t&&f<n;)l>u==l>-u?(o=r+u,c=o-r,a=r-(o-c)+(u-c),u=e[++h]):(o=r+l,c=o-r,a=r-(o-c)+(l-c),l=i[++f]),r=o,0!==a&&(s[d++]=a);for(;h<t;)o=r+u,c=o-r,a=r-(o-c)+(u-c),u=e[++h],r=o,0!==a&&(s[d++]=a);for(;f<n;)o=r+l,c=o-r,a=r-(o-c)+(l-c),l=i[++f],r=o,0!==a&&(s[d++]=a);return 0===r&&0!==d||(s[d++]=r),d}function aa(t){return new Float64Array(t)}const ca=aa(4),ua=aa(8),la=aa(12),ha=aa(16),fa=aa(4);function da(t,e,n,i,s,r){const o=(e-r)*(n-s),a=(t-s)*(i-r),c=o-a;if(0===o||0===a||o>0!=a>0)return c;const u=Math.abs(o+a);return Math.abs(c)>=33306690738754716e-32*u?c:-function(t,e,n,i,s,r,o){let a,c,u,l,h,f,d,p,_,m,g,v,y,b,x,w,T,M;const S=t-s,A=n-s,k=e-r,C=i-r;b=S*C,f=ra*S,d=f-(f-S),p=S-d,f=ra*C,_=f-(f-C),m=C-_,x=p*m-(b-d*_-p*_-d*m),w=k*A,f=ra*k,d=f-(f-k),p=k-d,f=ra*A,_=f-(f-A),m=A-_,T=p*m-(w-d*_-p*_-d*m),g=x-T,h=x-g,ca[0]=x-(g+h)+(h-T),v=b+g,h=v-b,y=b-(v-h)+(g-h),g=y-w,h=y-g,ca[1]=y-(g+h)+(h-w),M=v+g,h=M-v,ca[2]=v-(M-h)+(g-h),ca[3]=M;let D=function(t,e){let n=e[0];for(let t=1;t<4;t++)n+=e[t];return n}(0,ca),E=22204460492503146e-32*o;if(D>=E||-D>=E)return D;if(h=t-S,a=t-(S+h)+(h-s),h=n-A,u=n-(A+h)+(h-s),h=e-k,c=e-(k+h)+(h-r),h=i-C,l=i-(C+h)+(h-r),0===a&&0===c&&0===u&&0===l)return D;if(E=11093356479670487e-47*o+33306690738754706e-32*Math.abs(D),D+=S*l+C*a-(k*u+A*c),D>=E||-D>=E)return D;b=a*C,f=ra*a,d=f-(f-a),p=a-d,f=ra*C,_=f-(f-C),m=C-_,x=p*m-(b-d*_-p*_-d*m),w=c*A,f=ra*c,d=f-(f-c),p=c-d,f=ra*A,_=f-(f-A),m=A-_,T=p*m-(w-d*_-p*_-d*m),g=x-T,h=x-g,fa[0]=x-(g+h)+(h-T),v=b+g,h=v-b,y=b-(v-h)+(g-h),g=y-w,h=y-g,fa[1]=y-(g+h)+(h-w),M=v+g,h=M-v,fa[2]=v-(M-h)+(g-h),fa[3]=M;const O=oa(4,ca,4,fa,ua);b=S*l,f=ra*S,d=f-(f-S),p=S-d,f=ra*l,_=f-(f-l),m=l-_,x=p*m-(b-d*_-p*_-d*m),w=k*u,f=ra*k,d=f-(f-k),p=k-d,f=ra*u,_=f-(f-u),m=u-_,T=p*m-(w-d*_-p*_-d*m),g=x-T,h=x-g,fa[0]=x-(g+h)+(h-T),v=b+g,h=v-b,y=b-(v-h)+(g-h),g=y-w,h=y-g,fa[1]=y-(g+h)+(h-w),M=v+g,h=M-v,fa[2]=v-(M-h)+(g-h),fa[3]=M;const R=oa(O,ua,4,fa,la);b=a*l,f=ra*a,d=f-(f-a),p=a-d,f=ra*l,_=f-(f-l),m=l-_,x=p*m-(b-d*_-p*_-d*m),w=c*u,f=ra*c,d=f-(f-c),p=c-d,f=ra*u,_=f-(f-u),m=u-_,T=p*m-(w-d*_-p*_-d*m),g=x-T,h=x-g,fa[0]=x-(g+h)+(h-T),v=b+g,h=v-b,y=b-(v-h)+(g-h),g=y-w,h=y-g,fa[1]=y-(g+h)+(h-w),M=v+g,h=M-v,fa[2]=v-(M-h)+(g-h),fa[3]=M;const q=oa(R,la,4,fa,ha);return ha[q-1]}(t,e,n,i,s,r,u)}aa(4),aa(4),aa(4),aa(4),aa(4),aa(4),aa(4),aa(4),aa(4),aa(8),aa(8),aa(8),aa(4),aa(8),aa(8),aa(8),aa(12),aa(192),aa(192),aa(4),aa(4),aa(4),aa(4),aa(4),aa(4),aa(4),aa(4),aa(8),aa(8),aa(8),aa(8),aa(8),aa(8),aa(8),aa(8),aa(8),aa(4),aa(4),aa(4),aa(8),aa(16),aa(16),aa(16),aa(32),aa(32),aa(48),aa(64),aa(1152),aa(1152),aa(4),aa(4),aa(4),aa(4),aa(4),aa(4),aa(4),aa(4),aa(4),aa(4),aa(24),aa(24),aa(24),aa(24),aa(24),aa(24),aa(24),aa(24),aa(24),aa(24),aa(1152),aa(1152),aa(1152),aa(1152),aa(1152),aa(2304),aa(2304),aa(3456),aa(5760),aa(8),aa(8),aa(8),aa(16),aa(24),aa(48),aa(48),aa(96),aa(192),aa(384),aa(384),aa(384),aa(768),aa(96),aa(96),aa(96),aa(1152);const pa=Math.pow(2,-52),_a=new Uint32Array(512);class ma{static from(t,e=wa,n=Ta){const i=t.length,s=new Float64Array(2*i);for(let r=0;r<i;r++){const i=t[r];s[2*r]=e(i),s[2*r+1]=n(i)}return new ma(s)}constructor(t){const e=t.length>>1;if(e>0&&"number"!=typeof t[0])throw new Error("Expected coords to contain numbers.");this.coords=t;const n=Math.max(2*e-5,0);this._triangles=new Uint32Array(3*n),this._halfedges=new Int32Array(3*n),this._hashSize=Math.ceil(Math.sqrt(e)),this._hullPrev=new Uint32Array(e),this._hullNext=new Uint32Array(e),this._hullTri=new Uint32Array(e),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(e),this._dists=new Float64Array(e),this.update()}update(){const{coords:t,_hullPrev:e,_hullNext:n,_hullTri:i,_hullHash:s}=this,r=t.length>>1;let o=1/0,a=1/0,c=-1/0,u=-1/0;for(let e=0;e<r;e++){const n=t[2*e],i=t[2*e+1];n<o&&(o=n),i<a&&(a=i),n>c&&(c=n),i>u&&(u=i),this._ids[e]=e}const l=(o+c)/2,h=(a+u)/2;let f,d,p,_=1/0;for(let e=0;e<r;e++){const n=ga(l,h,t[2*e],t[2*e+1]);n<_&&(f=e,_=n)}const m=t[2*f],g=t[2*f+1];_=1/0;for(let e=0;e<r;e++){if(e===f)continue;const n=ga(m,g,t[2*e],t[2*e+1]);n<_&&n>0&&(d=e,_=n)}let v=t[2*d],y=t[2*d+1],b=1/0;for(let e=0;e<r;e++){if(e===f||e===d)continue;const n=ya(m,g,v,y,t[2*e],t[2*e+1]);n<b&&(p=e,b=n)}let x=t[2*p],w=t[2*p+1];if(b===1/0){for(let e=0;e<r;e++)this._dists[e]=t[2*e]-t[0]||t[2*e+1]-t[1];ba(this._ids,this._dists,0,r-1);const e=new Uint32Array(r);let n=0;for(let t=0,i=-1/0;t<r;t++){const s=this._ids[t];this._dists[s]>i&&(e[n++]=s,i=this._dists[s])}return this.hull=e.subarray(0,n),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(da(m,g,v,y,x,w)<0){const t=d,e=v,n=y;d=p,v=x,y=w,p=t,x=e,w=n}const T=function(t,e,n,i,s,r){const o=n-t,a=i-e,c=s-t,u=r-e,l=o*o+a*a,h=c*c+u*u,f=.5/(o*u-a*c);return{x:t+(u*l-a*h)*f,y:e+(o*h-c*l)*f}}(m,g,v,y,x,w);this._cx=T.x,this._cy=T.y;for(let e=0;e<r;e++)this._dists[e]=ga(t[2*e],t[2*e+1],T.x,T.y);ba(this._ids,this._dists,0,r-1),this._hullStart=f;let M=3;n[f]=e[p]=d,n[d]=e[f]=p,n[p]=e[d]=f,i[f]=0,i[d]=1,i[p]=2,s.fill(-1),s[this._hashKey(m,g)]=f,s[this._hashKey(v,y)]=d,s[this._hashKey(x,w)]=p,this.trianglesLen=0,this._addTriangle(f,d,p,-1,-1,-1);for(let r,o,a=0;a<this._ids.length;a++){const c=this._ids[a],u=t[2*c],l=t[2*c+1];if(a>0&&Math.abs(u-r)<=pa&&Math.abs(l-o)<=pa)continue;if(r=u,o=l,c===f||c===d||c===p)continue;let h=0;for(let t=0,e=this._hashKey(u,l);t<this._hashSize&&(h=s[(e+t)%this._hashSize],-1===h||h===n[h]);t++);h=e[h];let _,m=h;for(;_=n[m],da(u,l,t[2*m],t[2*m+1],t[2*_],t[2*_+1])>=0;)if(m=_,m===h){m=-1;break}if(-1===m)continue;let g=this._addTriangle(m,c,n[m],-1,-1,i[m]);i[c]=this._legalize(g+2),i[m]=g,M++;let v=n[m];for(;_=n[v],da(u,l,t[2*v],t[2*v+1],t[2*_],t[2*_+1])<0;)g=this._addTriangle(v,c,_,i[c],-1,i[v]),i[c]=this._legalize(g+2),n[v]=v,M--,v=_;if(m===h)for(;_=e[m],da(u,l,t[2*_],t[2*_+1],t[2*m],t[2*m+1])<0;)g=this._addTriangle(_,c,m,-1,i[m],i[_]),this._legalize(g+2),i[_]=g,n[m]=m,M--,m=_;this._hullStart=e[c]=m,n[m]=e[v]=c,n[c]=v,s[this._hashKey(u,l)]=c,s[this._hashKey(t[2*m],t[2*m+1])]=m}this.hull=new Uint32Array(M);for(let t=0,e=this._hullStart;t<M;t++)this.hull[t]=e,e=n[e];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,e){return Math.floor(function(t,e){const n=t/(Math.abs(t)+Math.abs(e));return(e>0?3-n:1+n)/4}(t-this._cx,e-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:e,_halfedges:n,coords:i}=this;let s=0,r=0;for(;;){const o=n[t],a=t-t%3;if(r=a+(t+2)%3,-1===o){if(0===s)break;t=_a[--s];continue}const c=o-o%3,u=a+(t+1)%3,l=c+(o+2)%3,h=e[r],f=e[t],d=e[u],p=e[l];if(va(i[2*h],i[2*h+1],i[2*f],i[2*f+1],i[2*d],i[2*d+1],i[2*p],i[2*p+1])){e[t]=p,e[o]=h;const i=n[l];if(-1===i){let e=this._hullStart;do{if(this._hullTri[e]===l){this._hullTri[e]=t;break}e=this._hullPrev[e]}while(e!==this._hullStart)}this._link(t,i),this._link(o,n[r]),this._link(r,l);const a=c+(o+1)%3;s<_a.length&&(_a[s++]=a)}else{if(0===s)break;t=_a[--s]}}return r}_link(t,e){this._halfedges[t]=e,-1!==e&&(this._halfedges[e]=t)}_addTriangle(t,e,n,i,s,r){const o=this.trianglesLen;return this._triangles[o]=t,this._triangles[o+1]=e,this._triangles[o+2]=n,this._link(o,i),this._link(o+1,s),this._link(o+2,r),this.trianglesLen+=3,o}}function ga(t,e,n,i){const s=t-n,r=e-i;return s*s+r*r}function va(t,e,n,i,s,r,o,a){const c=t-o,u=e-a,l=n-o,h=i-a,f=s-o,d=r-a,p=l*l+h*h,_=f*f+d*d;return c*(h*_-p*d)-u*(l*_-p*f)+(c*c+u*u)*(l*d-h*f)<0}function ya(t,e,n,i,s,r){const o=n-t,a=i-e,c=s-t,u=r-e,l=o*o+a*a,h=c*c+u*u,f=.5/(o*u-a*c),d=(u*l-a*h)*f,p=(o*h-c*l)*f;return d*d+p*p}function ba(t,e,n,i){if(i-n<=20)for(let s=n+1;s<=i;s++){const i=t[s],r=e[i];let o=s-1;for(;o>=n&&e[t[o]]>r;)t[o+1]=t[o--];t[o+1]=i}else{let s=n+1,r=i;xa(t,n+i>>1,s),e[t[n]]>e[t[i]]&&xa(t,n,i),e[t[s]]>e[t[i]]&&xa(t,s,i),e[t[n]]>e[t[s]]&&xa(t,n,s);const o=t[s],a=e[o];for(;;){do{s++}while(e[t[s]]<a);do{r--}while(e[t[r]]>a);if(r<s)break;xa(t,s,r)}t[n+1]=t[r],t[r]=o,i-s+1>=r-n?(ba(t,e,s,i),ba(t,e,n,r-1)):(ba(t,e,n,r-1),ba(t,e,s,i))}}function xa(t,e,n){const i=t[e];t[e]=t[n],t[n]=i}function wa(t){return t[0]}function Ta(t){return t[1]}const Ma=1e-6;class Sa{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,e){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,e){this._+=`L${this._x1=+t},${this._y1=+e}`}arc(t,e,n){const i=(t=+t)+(n=+n),s=e=+e;if(n<0)throw new Error("negative radius");null===this._x1?this._+=`M${i},${s}`:(Math.abs(this._x1-i)>Ma||Math.abs(this._y1-s)>Ma)&&(this._+="L"+i+","+s),n&&(this._+=`A${n},${n},0,1,1,${t-n},${e}A${n},${n},0,1,1,${this._x1=i},${this._y1=s}`)}rect(t,e,n,i){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}h${+n}v${+i}h${-n}Z`}value(){return this._||null}}class Aa{constructor(){this._=[]}moveTo(t,e){this._.push([t,e])}closePath(){this._.push(this._[0].slice())}lineTo(t,e){this._.push([t,e])}value(){return this._.length?this._:null}}class ka{constructor(t,[e,n,i,s]=[0,0,960,500]){if(!((i=+i)>=(e=+e)&&(s=+s)>=(n=+n)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(2*t.points.length),this.vectors=new Float64Array(2*t.points.length),this.xmax=i,this.xmin=e,this.ymax=s,this.ymin=n,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:e,triangles:n},vectors:i}=this,s=this.circumcenters=this._circumcenters.subarray(0,n.length/3*2);for(let e,i,r=0,o=0,a=n.length;r<a;r+=3,o+=2){const a=2*n[r],c=2*n[r+1],u=2*n[r+2],l=t[a],h=t[a+1],f=t[c],d=t[c+1],p=t[u],_=t[u+1],m=f-l,g=d-h,v=p-l,y=_-h,b=2*(m*y-g*v);if(Math.abs(b)<1e-9){let s=1e9;const r=2*n[0];s*=Math.sign((t[r]-l)*y-(t[r+1]-h)*v),e=(l+p)/2-s*y,i=(h+_)/2+s*v}else{const t=1/b,n=m*m+g*g,s=v*v+y*y;e=l+(y*n-g*s)*t,i=h+(m*s-v*n)*t}s[o]=e,s[o+1]=i}let r,o,a,c=e[e.length-1],u=4*c,l=t[2*c],h=t[2*c+1];i.fill(0);for(let n=0;n<e.length;++n)c=e[n],r=u,o=l,a=h,u=4*c,l=t[2*c],h=t[2*c+1],i[r+2]=i[u]=a-h,i[r+3]=i[u+1]=l-o}render(t){const e=null==t?t=new Sa:void 0,{delaunay:{halfedges:n,inedges:i,hull:s},circumcenters:r,vectors:o}=this;if(s.length<=1)return null;for(let e=0,i=n.length;e<i;++e){const i=n[e];if(i<e)continue;const s=2*Math.floor(e/3),o=2*Math.floor(i/3),a=r[s],c=r[s+1],u=r[o],l=r[o+1];this._renderSegment(a,c,u,l,t)}let a,c=s[s.length-1];for(let e=0;e<s.length;++e){a=c,c=s[e];const n=2*Math.floor(i[c]/3),u=r[n],l=r[n+1],h=4*a,f=this._project(u,l,o[h+2],o[h+3]);f&&this._renderSegment(u,l,f[0],f[1],t)}return e&&e.value()}renderBounds(t){const e=null==t?t=new Sa:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),e&&e.value()}renderCell(t,e){const n=null==e?e=new Sa:void 0,i=this._clip(t);if(null===i||!i.length)return;e.moveTo(i[0],i[1]);let s=i.length;for(;i[0]===i[s-2]&&i[1]===i[s-1]&&s>1;)s-=2;for(let t=2;t<s;t+=2)i[t]===i[t-2]&&i[t+1]===i[t-1]||e.lineTo(i[t],i[t+1]);return e.closePath(),n&&n.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let e=0,n=t.length/2;e<n;++e){const t=this.cellPolygon(e);t&&(t.index=e,yield t)}}cellPolygon(t){const e=new Aa;return this.renderCell(t,e),e.value()}_renderSegment(t,e,n,i,s){let r;const o=this._regioncode(t,e),a=this._regioncode(n,i);0===o&&0===a?(s.moveTo(t,e),s.lineTo(n,i)):(r=this._clipSegment(t,e,n,i,o,a))&&(s.moveTo(r[0],r[1]),s.lineTo(r[2],r[3]))}contains(t,e,n){return(e=+e)==e&&(n=+n)==n&&this.delaunay._step(t,e,n)===t}*neighbors(t){const e=this._clip(t);if(e)for(const n of this.delaunay.neighbors(t)){const t=this._clip(n);if(t)t:for(let i=0,s=e.length;i<s;i+=2)for(let r=0,o=t.length;r<o;r+=2)if(e[i]==t[r]&&e[i+1]==t[r+1]&&e[(i+2)%s]==t[(r+o-2)%o]&&e[(i+3)%s]==t[(r+o-1)%o]){yield n;break t}}}_cell(t){const{circumcenters:e,delaunay:{inedges:n,halfedges:i,triangles:s}}=this,r=n[t];if(-1===r)return null;const o=[];let a=r;do{const n=Math.floor(a/3);if(o.push(e[2*n],e[2*n+1]),a=a%3==2?a-2:a+1,s[a]!==t)break;a=i[a]}while(a!==r&&-1!==a);return o}_clip(t){if(0===t&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const e=this._cell(t);if(null===e)return null;const{vectors:n}=this,i=4*t;return n[i]||n[i+1]?this._clipInfinite(t,e,n[i],n[i+1],n[i+2],n[i+3]):this._clipFinite(t,e)}_clipFinite(t,e){const n=e.length;let i,s,r,o,a=null,c=e[n-2],u=e[n-1],l=this._regioncode(c,u),h=0;for(let f=0;f<n;f+=2)if(i=c,s=u,c=e[f],u=e[f+1],r=l,l=this._regioncode(c,u),0===r&&0===l)o=h,h=0,a?a.push(c,u):a=[c,u];else{let e,n,f,d,p;if(0===r){if(null===(e=this._clipSegment(i,s,c,u,r,l)))continue;[n,f,d,p]=e}else{if(null===(e=this._clipSegment(c,u,i,s,l,r)))continue;[d,p,n,f]=e,o=h,h=this._edgecode(n,f),o&&h&&this._edge(t,o,h,a,a.length),a?a.push(n,f):a=[n,f]}o=h,h=this._edgecode(d,p),o&&h&&this._edge(t,o,h,a,a.length),a?a.push(d,p):a=[d,p]}if(a)o=h,h=this._edgecode(a[0],a[1]),o&&h&&this._edge(t,o,h,a,a.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return a}_clipSegment(t,e,n,i,s,r){for(;;){if(0===s&&0===r)return[t,e,n,i];if(s&r)return null;let o,a,c=s||r;8&c?(o=t+(n-t)*(this.ymax-e)/(i-e),a=this.ymax):4&c?(o=t+(n-t)*(this.ymin-e)/(i-e),a=this.ymin):2&c?(a=e+(i-e)*(this.xmax-t)/(n-t),o=this.xmax):(a=e+(i-e)*(this.xmin-t)/(n-t),o=this.xmin),s?(t=o,e=a,s=this._regioncode(t,e)):(n=o,i=a,r=this._regioncode(n,i))}}_clipInfinite(t,e,n,i,s,r){let o,a=Array.from(e);if((o=this._project(a[0],a[1],n,i))&&a.unshift(o[0],o[1]),(o=this._project(a[a.length-2],a[a.length-1],s,r))&&a.push(o[0],o[1]),a=this._clipFinite(t,a))for(let e,n=0,i=a.length,s=this._edgecode(a[i-2],a[i-1]);n<i;n+=2)e=s,s=this._edgecode(a[n],a[n+1]),e&&s&&(n=this._edge(t,e,s,a,n),i=a.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(t,e,n,i,s){for(;e!==n;){let n,r;switch(e){case 5:e=4;continue;case 4:e=6,n=this.xmax,r=this.ymin;break;case 6:e=2;continue;case 2:e=10,n=this.xmax,r=this.ymax;break;case 10:e=8;continue;case 8:e=9,n=this.xmin,r=this.ymax;break;case 9:e=1;continue;case 1:e=5,n=this.xmin,r=this.ymin}i[s]===n&&i[s+1]===r||!this.contains(t,n,r)||(i.splice(s,0,n,r),s+=2)}if(i.length>4)for(let t=0;t<i.length;t+=2){const e=(t+2)%i.length,n=(t+4)%i.length;(i[t]===i[e]&&i[e]===i[n]||i[t+1]===i[e+1]&&i[e+1]===i[n+1])&&(i.splice(e,2),t-=2)}return s}_project(t,e,n,i){let s,r,o,a=1/0;if(i<0){if(e<=this.ymin)return null;(s=(this.ymin-e)/i)<a&&(o=this.ymin,r=t+(a=s)*n)}else if(i>0){if(e>=this.ymax)return null;(s=(this.ymax-e)/i)<a&&(o=this.ymax,r=t+(a=s)*n)}if(n>0){if(t>=this.xmax)return null;(s=(this.xmax-t)/n)<a&&(r=this.xmax,o=e+(a=s)*i)}else if(n<0){if(t<=this.xmin)return null;(s=(this.xmin-t)/n)<a&&(r=this.xmin,o=e+(a=s)*i)}return[r,o]}_edgecode(t,e){return(t===this.xmin?1:t===this.xmax?2:0)|(e===this.ymin?4:e===this.ymax?8:0)}_regioncode(t,e){return(t<this.xmin?1:t>this.xmax?2:0)|(e<this.ymin?4:e>this.ymax?8:0)}}const Ca=2*Math.PI,Da=Math.pow;function Ea(t){return t[0]}function Oa(t){return t[1]}function Ra(t,e,n){return[t+Math.sin(t+e)*n,e+Math.cos(t-e)*n]}class qa{static from(t,e=Ea,n=Oa,i){return new qa("length"in t?function(t,e,n,i){const s=t.length,r=new Float64Array(2*s);for(let o=0;o<s;++o){const s=t[o];r[2*o]=e.call(i,s,o,t),r[2*o+1]=n.call(i,s,o,t)}return r}(t,e,n,i):Float64Array.from(function*(t,e,n,i){let s=0;for(const r of t)yield e.call(i,r,s,t),yield n.call(i,r,s,t),++s}(t,e,n,i)))}constructor(t){this._delaunator=new ma(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,e=this.points;if(t.hull&&t.hull.length>2&&function(t){const{triangles:e,coords:n}=t;for(let t=0;t<e.length;t+=3){const i=2*e[t],s=2*e[t+1],r=2*e[t+2];if((n[r]-n[i])*(n[s+1]-n[i+1])-(n[s]-n[i])*(n[r+1]-n[i+1])>1e-10)return!1}return!0}(t)){this.collinear=Int32Array.from({length:e.length/2},((t,e)=>e)).sort(((t,n)=>e[2*t]-e[2*n]||e[2*t+1]-e[2*n+1]));const t=this.collinear[0],n=this.collinear[this.collinear.length-1],i=[e[2*t],e[2*t+1],e[2*n],e[2*n+1]],s=1e-8*Math.hypot(i[3]-i[1],i[2]-i[0]);for(let t=0,n=e.length/2;t<n;++t){const n=Ra(e[2*t],e[2*t+1],s);e[2*t]=n[0],e[2*t+1]=n[1]}this._delaunator=new ma(e)}else delete this.collinear;const n=this.halfedges=this._delaunator.halfedges,i=this.hull=this._delaunator.hull,s=this.triangles=this._delaunator.triangles,r=this.inedges.fill(-1),o=this._hullIndex.fill(-1);for(let t=0,e=n.length;t<e;++t){const e=s[t%3==2?t-2:t+1];-1!==n[t]&&-1!==r[e]||(r[e]=t)}for(let t=0,e=i.length;t<e;++t)o[i[t]]=t;i.length<=2&&i.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=i[0],r[i[0]]=1,2===i.length&&(r[i[1]]=0,this.triangles[1]=i[1],this.triangles[2]=i[1]))}voronoi(t){return new ka(this,t)}*neighbors(t){const{inedges:e,hull:n,_hullIndex:i,halfedges:s,triangles:r,collinear:o}=this;if(o){const e=o.indexOf(t);return e>0&&(yield o[e-1]),void(e<o.length-1&&(yield o[e+1]))}const a=e[t];if(-1===a)return;let c=a,u=-1;do{if(yield u=r[c],c=c%3==2?c-2:c+1,r[c]!==t)return;if(c=s[c],-1===c){const e=n[(i[t]+1)%n.length];return void(e!==u&&(yield e))}}while(c!==a)}find(t,e,n=0){if((t=+t)!=t||(e=+e)!=e)return-1;const i=n;let s;for(;(s=this._step(n,t,e))>=0&&s!==n&&s!==i;)n=s;return s}_step(t,e,n){const{inedges:i,hull:s,_hullIndex:r,halfedges:o,triangles:a,points:c}=this;if(-1===i[t]||!c.length)return(t+1)%(c.length>>1);let u=t,l=Da(e-c[2*t],2)+Da(n-c[2*t+1],2);const h=i[t];let f=h;do{let i=a[f];const h=Da(e-c[2*i],2)+Da(n-c[2*i+1],2);if(h<l&&(l=h,u=i),f=f%3==2?f-2:f+1,a[f]!==t)break;if(f=o[f],-1===f){if(f=s[(r[t]+1)%s.length],f!==i&&Da(e-c[2*f],2)+Da(n-c[2*f+1],2)<l)return f;break}}while(f!==h);return u}render(t){const e=null==t?t=new Sa:void 0,{points:n,halfedges:i,triangles:s}=this;for(let e=0,r=i.length;e<r;++e){const r=i[e];if(r<e)continue;const o=2*s[e],a=2*s[r];t.moveTo(n[o],n[o+1]),t.lineTo(n[a],n[a+1])}return this.renderHull(t),e&&e.value()}renderPoints(t,e){void 0!==e||t&&"function"==typeof t.moveTo||(e=t,t=null),e=null==e?2:+e;const n=null==t?t=new Sa:void 0,{points:i}=this;for(let n=0,s=i.length;n<s;n+=2){const s=i[n],r=i[n+1];t.moveTo(s+e,r),t.arc(s,r,e,0,Ca)}return n&&n.value()}renderHull(t){const e=null==t?t=new Sa:void 0,{hull:n,points:i}=this,s=2*n[0],r=n.length;t.moveTo(i[s],i[s+1]);for(let e=1;e<r;++e){const s=2*n[e];t.lineTo(i[s],i[s+1])}return t.closePath(),e&&e.value()}hullPolygon(){const t=new Aa;return this.renderHull(t),t.value()}renderTriangle(t,e){const n=null==e?e=new Sa:void 0,{points:i,triangles:s}=this,r=2*s[t*=3],o=2*s[t+1],a=2*s[t+2];return e.moveTo(i[r],i[r+1]),e.lineTo(i[o],i[o+1]),e.lineTo(i[a],i[a+1]),e.closePath(),n&&n.value()}*trianglePolygons(){const{triangles:t}=this;for(let e=0,n=t.length/3;e<n;++e)yield this.trianglePolygon(e)}trianglePolygon(t){const e=new Aa;return this.renderTriangle(t,e),e.value()}}const Na=t=>()=>t;function Fa(t,{sourceEvent:e,subject:n,target:i,identifier:s,active:r,x:o,y:a,dx:c,dy:u,dispatch:l}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:r,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:l}})}function Ia(t){return!t.ctrlKey&&!t.button}function Pa(){return this.parentNode}function Va(t,e){return null==e?{x:t.x,y:t.y}:e}function za(){return navigator.maxTouchPoints||"ontouchstart"in this}function ja(){var t,e,n,i,s=Ia,r=Pa,o=Va,a=za,c={},u=fe("start","drag","end"),l=0,h=0;function f(t){t.on("mousedown.drag",d).filter(a).on("touchstart.drag",m).on("touchmove.drag",g,En).on("touchend.drag touchcancel.drag",v).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function d(o,a){if(!i&&s.call(this,o,a)){var c=y(this,r.call(this,o,a),o,a,"mouse");c&&(Dn(o.view).on("mousemove.drag",p,On).on("mouseup.drag",_,On),Nn(o.view),Rn(o),n=!1,t=o.clientX,e=o.clientY,c("start",o))}}function p(i){if(qn(i),!n){var s=i.clientX-t,r=i.clientY-e;n=s*s+r*r>h}c.mouse("drag",i)}function _(t){Dn(t.view).on("mousemove.drag mouseup.drag",null),Fn(t.view,n),qn(t),c.mouse("end",t)}function m(t,e){if(s.call(this,t,e)){var n,i,o=t.changedTouches,a=r.call(this,t,e),c=o.length;for(n=0;n<c;++n)(i=y(this,a,t,e,o[n].identifier,o[n]))&&(Rn(t),i("start",t,o[n]))}}function g(t){var e,n,i=t.changedTouches,s=i.length;for(e=0;e<s;++e)(n=c[i[e].identifier])&&(qn(t),n("drag",t,i[e]))}function v(t){var e,n,s=t.changedTouches,r=s.length;for(i&&clearTimeout(i),i=setTimeout((function(){i=null}),500),e=0;e<r;++e)(n=c[s[e].identifier])&&(Rn(t),n("end",t,s[e]))}function y(t,e,n,i,s,r){var a,h,d,p=u.copy(),_=Pi(r||n,e);if(null!=(d=o.call(t,new Fa("beforestart",{sourceEvent:n,target:f,identifier:s,active:l,x:_[0],y:_[1],dx:0,dy:0,dispatch:p}),i)))return a=d.x-_[0]||0,h=d.y-_[1]||0,function n(r,o,u){var m,g=_;switch(r){case"start":c[s]=n,m=l++;break;case"end":delete c[s],--l;case"drag":_=Pi(u||o,e),m=l}p.call(r,t,new Fa(r,{sourceEvent:o,subject:d,target:f,identifier:s,active:m,x:_[0]+a,y:_[1]+h,dx:_[0]-g[0],dy:_[1]-g[1],dispatch:p}),i)}}return f.filter=function(t){return arguments.length?(s="function"==typeof t?t:Na(!!t),f):s},f.container=function(t){return arguments.length?(r="function"==typeof t?t:Na(t),f):r},f.subject=function(t){return arguments.length?(o="function"==typeof t?t:Na(t),f):o},f.touchable=function(t){return arguments.length?(a="function"==typeof t?t:Na(!!t),f):a},f.on=function(){var t=u.on.apply(u,arguments);return t===u?f:t},f.clickDistance=function(t){return arguments.length?(h=(t=+t)*t,f):Math.sqrt(h)},f}Fa.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var La={},Ba={};function Ua(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function Wa(t){var e=Object.create(null),n=[];return t.forEach((function(t){for(var i in t)i in e||n.push(e[i]=i)})),n}function Ga(t,e){var n=t+"",i=n.length;return i<e?new Array(e-i+1).join(0)+n:n}function Ya(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function i(t,e){var i,s=[],r=t.length,o=0,a=0,c=r<=0,u=!1;function l(){if(c)return Ba;if(u)return u=!1,La;var e,i,s=o;if(34===t.charCodeAt(s)){for(;o++<r&&34!==t.charCodeAt(o)||34===t.charCodeAt(++o););return(e=o)>=r?c=!0:10===(i=t.charCodeAt(o++))?u=!0:13===i&&(u=!0,10===t.charCodeAt(o)&&++o),t.slice(s+1,e-1).replace(/""/g,'"')}for(;o<r;){if(10===(i=t.charCodeAt(e=o++)))u=!0;else if(13===i)u=!0,10===t.charCodeAt(o)&&++o;else if(i!==n)continue;return t.slice(s,e)}return c=!0,t.slice(s,r)}for(10===t.charCodeAt(r-1)&&--r,13===t.charCodeAt(r-1)&&--r;(i=l())!==Ba;){for(var h=[];i!==La&&i!==Ba;)h.push(i),i=l();e&&null==(h=e(h,a++))||s.push(h)}return s}function s(e,n){return e.map((function(e){return n.map((function(t){return o(e[t])})).join(t)}))}function r(e){return e.map(o).join(t)}function o(t){return null==t?"":t instanceof Date?function(t){var e=t.getUTCHours(),n=t.getUTCMinutes(),i=t.getUTCSeconds(),s=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":function(t){return t<0?"-"+Ga(-t,6):t>9999?"+"+Ga(t,6):Ga(t,4)}(t.getUTCFullYear())+"-"+Ga(t.getUTCMonth()+1,2)+"-"+Ga(t.getUTCDate(),2)+(s?"T"+Ga(e,2)+":"+Ga(n,2)+":"+Ga(i,2)+"."+Ga(s,3)+"Z":i?"T"+Ga(e,2)+":"+Ga(n,2)+":"+Ga(i,2)+"Z":n||e?"T"+Ga(e,2)+":"+Ga(n,2)+"Z":"")}(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var n,s,r=i(t,(function(t,i){if(n)return n(t,i-1);s=t,n=e?function(t,e){var n=Ua(t);return function(i,s){return e(n(i),s,t)}}(t,e):Ua(t)}));return r.columns=s||[],r},parseRows:i,format:function(e,n){return null==n&&(n=Wa(e)),[n.map(o).join(t)].concat(s(e,n)).join("\n")},formatBody:function(t,e){return null==e&&(e=Wa(t)),s(t,e).join("\n")},formatRows:function(t){return t.map(r).join("\n")},formatRow:r,formatValue:o}}var Ha=Ya(","),Xa=Ha.parse,Za=Ha.parseRows,$a=Ha.format,Qa=Ha.formatBody,Ja=Ha.formatRows,Ka=Ha.formatRow,tc=Ha.formatValue,ec=Ya("\t"),nc=ec.parse,ic=ec.parseRows,sc=ec.format,rc=ec.formatBody,oc=ec.formatRows,ac=ec.formatRow,cc=ec.formatValue;function uc(t){for(var e in t){var n,i,s=t[e].trim();if(s)if("true"===s)s=!0;else if("false"===s)s=!1;else if("NaN"===s)s=NaN;else if(isNaN(n=+s)){if(!(i=s.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/)))continue;lc&&i[4]&&!i[7]&&(s=s.replace(/-/g,"/").replace(/T/," ")),s=new Date(s)}else s=n;else s=null;t[e]=s}return t}const lc=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours(),hc=t=>+t;function fc(t){return t*t}function dc(t){return t*(2-t)}function pc(t){return((t*=2)<=1?t*t:--t*(2-t)+1)/2}var _c=function t(e){function n(t){return Math.pow(t,e)}return e=+e,n.exponent=t,n}(3),mc=function t(e){function n(t){return 1-Math.pow(1-t,e)}return e=+e,n.exponent=t,n}(3),gc=function t(e){function n(t){return((t*=2)<=1?Math.pow(t,e):2-Math.pow(2-t,e))/2}return e=+e,n.exponent=t,n}(3),vc=Math.PI,yc=vc/2;function bc(t){return 1==+t?1:1-Math.cos(t*yc)}function xc(t){return Math.sin(t*yc)}function wc(t){return(1-Math.cos(vc*t))/2}function Tc(t){return 1.0009775171065494*(Math.pow(2,-10*t)-.0009765625)}function Mc(t){return Tc(1-+t)}function Sc(t){return 1-Tc(t)}function Ac(t){return((t*=2)<=1?Tc(1-t):2-Tc(t-1))/2}function kc(t){return 1-Math.sqrt(1-t*t)}function Cc(t){return Math.sqrt(1- --t*t)}function Dc(t){return((t*=2)<=1?1-Math.sqrt(1-t*t):Math.sqrt(1-(t-=2)*t)+1)/2}var Ec=7.5625;function Oc(t){return 1-Rc(1-t)}function Rc(t){return(t=+t)<.36363636363636365?Ec*t*t:t<.7272727272727273?Ec*(t-=.5454545454545454)*t+.75:t<.9090909090909091?Ec*(t-=.8181818181818182)*t+.9375:Ec*(t-=.9545454545454546)*t+.984375}function qc(t){return((t*=2)<=1?1-Rc(1-t):Rc(t-1)+1)/2}var Nc=1.70158,Fc=function t(e){function n(t){return(t=+t)*t*(e*(t-1)+t)}return e=+e,n.overshoot=t,n}(Nc),Ic=function t(e){function n(t){return--t*t*((t+1)*e+t)+1}return e=+e,n.overshoot=t,n}(Nc),Pc=function t(e){function n(t){return((t*=2)<1?t*t*((e+1)*t-e):(t-=2)*t*((e+1)*t+e)+2)/2}return e=+e,n.overshoot=t,n}(Nc),Vc=2*Math.PI,zc=function t(e,n){var i=Math.asin(1/(e=Math.max(1,e)))*(n/=Vc);function s(t){return e*Tc(- --t)*Math.sin((i-t)/n)}return s.amplitude=function(e){return t(e,n*Vc)},s.period=function(n){return t(e,n)},s}(1,.3),jc=function t(e,n){var i=Math.asin(1/(e=Math.max(1,e)))*(n/=Vc);function s(t){return 1-e*Tc(t=+t)*Math.sin((t+i)/n)}return s.amplitude=function(e){return t(e,n*Vc)},s.period=function(n){return t(e,n)},s}(1,.3),Lc=function t(e,n){var i=Math.asin(1/(e=Math.max(1,e)))*(n/=Vc);function s(t){return((t=2*t-1)<0?e*Tc(-t)*Math.sin((i-t)/n):2-e*Tc(t)*Math.sin((i+t)/n))/2}return s.amplitude=function(e){return t(e,n*Vc)},s.period=function(n){return t(e,n)},s}(1,.3);function Bc(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.blob()}function Uc(t,e){return fetch(t,e).then(Bc)}function Wc(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.arrayBuffer()}function Gc(t,e){return fetch(t,e).then(Wc)}function Yc(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}function Hc(t,e){return fetch(t,e).then(Yc)}function Xc(t){return function(e,n,i){return 2===arguments.length&&"function"==typeof n&&(i=n,n=void 0),Hc(e,n).then((function(e){return t(e,i)}))}}function Zc(t,e,n,i){3===arguments.length&&"function"==typeof n&&(i=n,n=void 0);var s=Ya(t);return Hc(e,n).then((function(t){return s.parse(t,i)}))}var $c=Xc(Xa),Qc=Xc(nc);function Jc(t,e){return new Promise((function(n,i){var s=new Image;for(var r in e)s[r]=e[r];s.onerror=i,s.onload=function(){n(s)},s.src=t}))}function Kc(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);if(204!==t.status&&205!==t.status)return t.json()}function tu(t,e){return fetch(t,e).then(Kc)}function eu(t){return(e,n)=>Hc(e,n).then((e=>(new DOMParser).parseFromString(e,t)))}const nu=eu("application/xml");var iu=eu("text/html"),su=eu("image/svg+xml");function ru(t,e){var n,i=1;function s(){var s,r,o=n.length,a=0,c=0;for(s=0;s<o;++s)a+=(r=n[s]).x,c+=r.y;for(a=(a/o-t)*i,c=(c/o-e)*i,s=0;s<o;++s)(r=n[s]).x-=a,r.y-=c}return null==t&&(t=0),null==e&&(e=0),s.initialize=function(t){n=t},s.x=function(e){return arguments.length?(t=+e,s):t},s.y=function(t){return arguments.length?(e=+t,s):e},s.strength=function(t){return arguments.length?(i=+t,s):i},s}function ou(t,e,n,i){if(isNaN(e)||isNaN(n))return t;var s,r,o,a,c,u,l,h,f,d=t._root,p={data:i},_=t._x0,m=t._y0,g=t._x1,v=t._y1;if(!d)return t._root=p,t;for(;d.length;)if((u=e>=(r=(_+g)/2))?_=r:g=r,(l=n>=(o=(m+v)/2))?m=o:v=o,s=d,!(d=d[h=l<<1|u]))return s[h]=p,t;if(a=+t._x.call(null,d.data),c=+t._y.call(null,d.data),e===a&&n===c)return p.next=d,s?s[h]=p:t._root=p,t;do{s=s?s[h]=new Array(4):t._root=new Array(4),(u=e>=(r=(_+g)/2))?_=r:g=r,(l=n>=(o=(m+v)/2))?m=o:v=o}while((h=l<<1|u)==(f=(c>=o)<<1|a>=r));return s[f]=d,s[h]=p,t}function au(t,e,n,i,s){this.node=t,this.x0=e,this.y0=n,this.x1=i,this.y1=s}function cu(t){return t[0]}function uu(t){return t[1]}function lu(t,e,n){var i=new hu(null==e?cu:e,null==n?uu:n,NaN,NaN,NaN,NaN);return null==t?i:i.addAll(t)}function hu(t,e,n,i,s,r){this._x=t,this._y=e,this._x0=n,this._y0=i,this._x1=s,this._y1=r,this._root=void 0}function fu(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var du=lu.prototype=hu.prototype;function pu(t){return function(){return t}}function _u(t){return 1e-6*(t()-.5)}function mu(t){return t.x+t.vx}function gu(t){return t.y+t.vy}function vu(t){var e,n,i,s=1,r=1;function o(){for(var t,o,c,u,l,h,f,d=e.length,p=0;p<r;++p)for(o=lu(e,mu,gu).visitAfter(a),t=0;t<d;++t)c=e[t],h=n[c.index],f=h*h,u=c.x+c.vx,l=c.y+c.vy,o.visit(_);function _(t,e,n,r,o){var a=t.data,d=t.r,p=h+d;if(!a)return e>u+p||r<u-p||n>l+p||o<l-p;if(a.index>c.index){var _=u-a.x-a.vx,m=l-a.y-a.vy,g=_*_+m*m;g<p*p&&(0===_&&(g+=(_=_u(i))*_),0===m&&(g+=(m=_u(i))*m),g=(p-(g=Math.sqrt(g)))/g*s,c.vx+=(_*=g)*(p=(d*=d)/(f+d)),c.vy+=(m*=g)*p,a.vx-=_*(p=1-p),a.vy-=m*p)}}}function a(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function c(){if(e){var i,s,r=e.length;for(n=new Array(r),i=0;i<r;++i)s=e[i],n[s.index]=+t(s,i,e)}}return"function"!=typeof t&&(t=pu(null==t?1:+t)),o.initialize=function(t,n){e=t,i=n,c()},o.iterations=function(t){return arguments.length?(r=+t,o):r},o.strength=function(t){return arguments.length?(s=+t,o):s},o.radius=function(e){return arguments.length?(t="function"==typeof e?e:pu(+e),c(),o):t},o}function yu(t){return t.index}function bu(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function xu(t){var e,n,i,s,r,o,a=yu,c=function(t){return 1/Math.min(s[t.source.index],s[t.target.index])},u=pu(30),l=1;function h(i){for(var s=0,a=t.length;s<l;++s)for(var c,u,h,f,d,p,_,m=0;m<a;++m)u=(c=t[m]).source,f=(h=c.target).x+h.vx-u.x-u.vx||_u(o),d=h.y+h.vy-u.y-u.vy||_u(o),f*=p=((p=Math.sqrt(f*f+d*d))-n[m])/p*i*e[m],d*=p,h.vx-=f*(_=r[m]),h.vy-=d*_,u.vx+=f*(_=1-_),u.vy+=d*_}function f(){if(i){var o,c,u=i.length,l=t.length,h=new Map(i.map(((t,e)=>[a(t,e,i),t])));for(o=0,s=new Array(u);o<l;++o)(c=t[o]).index=o,"object"!=typeof c.source&&(c.source=bu(h,c.source)),"object"!=typeof c.target&&(c.target=bu(h,c.target)),s[c.source.index]=(s[c.source.index]||0)+1,s[c.target.index]=(s[c.target.index]||0)+1;for(o=0,r=new Array(l);o<l;++o)c=t[o],r[o]=s[c.source.index]/(s[c.source.index]+s[c.target.index]);e=new Array(l),d(),n=new Array(l),p()}}function d(){if(i)for(var n=0,s=t.length;n<s;++n)e[n]=+c(t[n],n,t)}function p(){if(i)for(var e=0,s=t.length;e<s;++e)n[e]=+u(t[e],e,t)}return null==t&&(t=[]),h.initialize=function(t,e){i=t,o=e,f()},h.links=function(e){return arguments.length?(t=e,f(),h):t},h.id=function(t){return arguments.length?(a=t,h):a},h.iterations=function(t){return arguments.length?(l=+t,h):l},h.strength=function(t){return arguments.length?(c="function"==typeof t?t:pu(+t),d(),h):c},h.distance=function(t){return arguments.length?(u="function"==typeof t?t:pu(+t),p(),h):u},h}du.copy=function(){var t,e,n=new hu(this._x,this._y,this._x0,this._y0,this._x1,this._y1),i=this._root;if(!i)return n;if(!i.length)return n._root=fu(i),n;for(t=[{source:i,target:n._root=new Array(4)}];i=t.pop();)for(var s=0;s<4;++s)(e=i.source[s])&&(e.length?t.push({source:e,target:i.target[s]=new Array(4)}):i.target[s]=fu(e));return n},du.add=function(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return ou(this.cover(e,n),e,n,t)},du.addAll=function(t){var e,n,i,s,r=t.length,o=new Array(r),a=new Array(r),c=1/0,u=1/0,l=-1/0,h=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,e=t[n]))||isNaN(s=+this._y.call(null,e))||(o[n]=i,a[n]=s,i<c&&(c=i),i>l&&(l=i),s<u&&(u=s),s>h&&(h=s));if(c>l||u>h)return this;for(this.cover(c,u).cover(l,h),n=0;n<r;++n)ou(this,o[n],a[n],t[n]);return this},du.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,i=this._y0,s=this._x1,r=this._y1;if(isNaN(n))s=(n=Math.floor(t))+1,r=(i=Math.floor(e))+1;else{for(var o,a,c=s-n||1,u=this._root;n>t||t>=s||i>e||e>=r;)switch(a=(e<i)<<1|t<n,(o=new Array(4))[a]=u,u=o,c*=2,a){case 0:s=n+c,r=i+c;break;case 1:n=s-c,r=i+c;break;case 2:s=n+c,i=r-c;break;case 3:n=s-c,i=r-c}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=i,this._x1=s,this._y1=r,this},du.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},du.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},du.find=function(t,e,n){var i,s,r,o,a,c,u,l=this._x0,h=this._y0,f=this._x1,d=this._y1,p=[],_=this._root;for(_&&p.push(new au(_,l,h,f,d)),null==n?n=1/0:(l=t-n,h=e-n,f=t+n,d=e+n,n*=n);c=p.pop();)if(!(!(_=c.node)||(s=c.x0)>f||(r=c.y0)>d||(o=c.x1)<l||(a=c.y1)<h))if(_.length){var m=(s+o)/2,g=(r+a)/2;p.push(new au(_[3],m,g,o,a),new au(_[2],s,g,m,a),new au(_[1],m,r,o,g),new au(_[0],s,r,m,g)),(u=(e>=g)<<1|t>=m)&&(c=p[p.length-1],p[p.length-1]=p[p.length-1-u],p[p.length-1-u]=c)}else{var v=t-+this._x.call(null,_.data),y=e-+this._y.call(null,_.data),b=v*v+y*y;if(b<n){var x=Math.sqrt(n=b);l=t-x,h=e-x,f=t+x,d=e+x,i=_.data}}return i},du.remove=function(t){if(isNaN(r=+this._x.call(null,t))||isNaN(o=+this._y.call(null,t)))return this;var e,n,i,s,r,o,a,c,u,l,h,f,d=this._root,p=this._x0,_=this._y0,m=this._x1,g=this._y1;if(!d)return this;if(d.length)for(;;){if((u=r>=(a=(p+m)/2))?p=a:m=a,(l=o>=(c=(_+g)/2))?_=c:g=c,e=d,!(d=d[h=l<<1|u]))return this;if(!d.length)break;(e[h+1&3]||e[h+2&3]||e[h+3&3])&&(n=e,f=h)}for(;d.data!==t;)if(i=d,!(d=d.next))return this;return(s=d.next)&&delete d.next,i?(s?i.next=s:delete i.next,this):e?(s?e[h]=s:delete e[h],(d=e[0]||e[1]||e[2]||e[3])&&d===(e[3]||e[2]||e[1]||e[0])&&!d.length&&(n?n[f]=d:this._root=d),this):(this._root=s,this)},du.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},du.root=function(){return this._root},du.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},du.visit=function(t){var e,n,i,s,r,o,a=[],c=this._root;for(c&&a.push(new au(c,this._x0,this._y0,this._x1,this._y1));e=a.pop();)if(!t(c=e.node,i=e.x0,s=e.y0,r=e.x1,o=e.y1)&&c.length){var u=(i+r)/2,l=(s+o)/2;(n=c[3])&&a.push(new au(n,u,l,r,o)),(n=c[2])&&a.push(new au(n,i,l,u,o)),(n=c[1])&&a.push(new au(n,u,s,r,l)),(n=c[0])&&a.push(new au(n,i,s,u,l))}return this},du.visitAfter=function(t){var e,n=[],i=[];for(this._root&&n.push(new au(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var s=e.node;if(s.length){var r,o=e.x0,a=e.y0,c=e.x1,u=e.y1,l=(o+c)/2,h=(a+u)/2;(r=s[0])&&n.push(new au(r,o,a,l,h)),(r=s[1])&&n.push(new au(r,l,a,c,h)),(r=s[2])&&n.push(new au(r,o,h,l,u)),(r=s[3])&&n.push(new au(r,l,h,c,u))}i.push(e)}for(;e=i.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},du.x=function(t){return arguments.length?(this._x=t,this):this._x},du.y=function(t){return arguments.length?(this._y=t,this):this._y};const wu=4294967296;function Tu(t){return t.x}function Mu(t){return t.y}var Su=Math.PI*(3-Math.sqrt(5));function Au(t){var e,n=1,i=.001,s=1-Math.pow(i,1/300),r=0,o=.6,a=new Map,c=Qi(h),u=fe("tick","end"),l=function(){let t=1;return()=>(t=(1664525*t+1013904223)%wu)/wu}();function h(){f(),u.call("tick",e),n<i&&(c.stop(),u.call("end",e))}function f(i){var c,u,l=t.length;void 0===i&&(i=1);for(var h=0;h<i;++h)for(n+=(r-n)*s,a.forEach((function(t){t(n)})),c=0;c<l;++c)null==(u=t[c]).fx?u.x+=u.vx*=o:(u.x=u.fx,u.vx=0),null==u.fy?u.y+=u.vy*=o:(u.y=u.fy,u.vy=0);return e}function d(){for(var e,n=0,i=t.length;n<i;++n){if((e=t[n]).index=n,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var s=10*Math.sqrt(.5+n),r=n*Su;e.x=s*Math.cos(r),e.y=s*Math.sin(r)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function p(e){return e.initialize&&e.initialize(t,l),e}return null==t&&(t=[]),d(),e={tick:f,restart:function(){return c.restart(h),e},stop:function(){return c.stop(),e},nodes:function(n){return arguments.length?(t=n,d(),a.forEach(p),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(i=+t,e):i},alphaDecay:function(t){return arguments.length?(s=+t,e):+s},alphaTarget:function(t){return arguments.length?(r=+t,e):r},velocityDecay:function(t){return arguments.length?(o=1-t,e):1-o},randomSource:function(t){return arguments.length?(l=t,a.forEach(p),e):l},force:function(t,n){return arguments.length>1?(null==n?a.delete(t):a.set(t,p(n)),e):a.get(t)},find:function(e,n,i){var s,r,o,a,c,u=0,l=t.length;for(null==i?i=1/0:i*=i,u=0;u<l;++u)(o=(s=e-(a=t[u]).x)*s+(r=n-a.y)*r)<i&&(c=a,i=o);return c},on:function(t,n){return arguments.length>1?(u.on(t,n),e):u.on(t)}}}function ku(){var t,e,n,i,s,r=pu(-30),o=1,a=1/0,c=.81;function u(n){var s,r=t.length,o=lu(t,Tu,Mu).visitAfter(h);for(i=n,s=0;s<r;++s)e=t[s],o.visit(f)}function l(){if(t){var e,n,i=t.length;for(s=new Array(i),e=0;e<i;++e)n=t[e],s[n.index]=+r(n,e,t)}}function h(t){var e,n,i,r,o,a=0,c=0;if(t.length){for(i=r=o=0;o<4;++o)(e=t[o])&&(n=Math.abs(e.value))&&(a+=e.value,c+=n,i+=n*e.x,r+=n*e.y);t.x=i/c,t.y=r/c}else{(e=t).x=e.data.x,e.y=e.data.y;do{a+=s[e.data.index]}while(e=e.next)}t.value=a}function f(t,r,u,l){if(!t.value)return!0;var h=t.x-e.x,f=t.y-e.y,d=l-r,p=h*h+f*f;if(d*d/c<p)return p<a&&(0===h&&(p+=(h=_u(n))*h),0===f&&(p+=(f=_u(n))*f),p<o&&(p=Math.sqrt(o*p)),e.vx+=h*t.value*i/p,e.vy+=f*t.value*i/p),!0;if(!(t.length||p>=a)){(t.data!==e||t.next)&&(0===h&&(p+=(h=_u(n))*h),0===f&&(p+=(f=_u(n))*f),p<o&&(p=Math.sqrt(o*p)));do{t.data!==e&&(d=s[t.data.index]*i/p,e.vx+=h*d,e.vy+=f*d)}while(t=t.next)}}return u.initialize=function(e,i){t=e,n=i,l()},u.strength=function(t){return arguments.length?(r="function"==typeof t?t:pu(+t),l(),u):r},u.distanceMin=function(t){return arguments.length?(o=t*t,u):Math.sqrt(o)},u.distanceMax=function(t){return arguments.length?(a=t*t,u):Math.sqrt(a)},u.theta=function(t){return arguments.length?(c=t*t,u):Math.sqrt(c)},u}function Cu(t,e,n){var i,s,r,o=pu(.1);function a(t){for(var o=0,a=i.length;o<a;++o){var c=i[o],u=c.x-e||1e-6,l=c.y-n||1e-6,h=Math.sqrt(u*u+l*l),f=(r[o]-h)*s[o]*t/h;c.vx+=u*f,c.vy+=l*f}}function c(){if(i){var e,n=i.length;for(s=new Array(n),r=new Array(n),e=0;e<n;++e)r[e]=+t(i[e],e,i),s[e]=isNaN(r[e])?0:+o(i[e],e,i)}}return"function"!=typeof t&&(t=pu(+t)),null==e&&(e=0),null==n&&(n=0),a.initialize=function(t){i=t,c()},a.strength=function(t){return arguments.length?(o="function"==typeof t?t:pu(+t),c(),a):o},a.radius=function(e){return arguments.length?(t="function"==typeof e?e:pu(+e),c(),a):t},a.x=function(t){return arguments.length?(e=+t,a):e},a.y=function(t){return arguments.length?(n=+t,a):n},a}function Du(t){var e,n,i,s=pu(.1);function r(t){for(var s,r=0,o=e.length;r<o;++r)(s=e[r]).vx+=(i[r]-s.x)*n[r]*t}function o(){if(e){var r,o=e.length;for(n=new Array(o),i=new Array(o),r=0;r<o;++r)n[r]=isNaN(i[r]=+t(e[r],r,e))?0:+s(e[r],r,e)}}return"function"!=typeof t&&(t=pu(null==t?0:+t)),r.initialize=function(t){e=t,o()},r.strength=function(t){return arguments.length?(s="function"==typeof t?t:pu(+t),o(),r):s},r.x=function(e){return arguments.length?(t="function"==typeof e?e:pu(+e),o(),r):t},r}function Eu(t){var e,n,i,s=pu(.1);function r(t){for(var s,r=0,o=e.length;r<o;++r)(s=e[r]).vy+=(i[r]-s.y)*n[r]*t}function o(){if(e){var r,o=e.length;for(n=new Array(o),i=new Array(o),r=0;r<o;++r)n[r]=isNaN(i[r]=+t(e[r],r,e))?0:+s(e[r],r,e)}}return"function"!=typeof t&&(t=pu(null==t?0:+t)),r.initialize=function(t){e=t,o()},r.strength=function(t){return arguments.length?(s="function"==typeof t?t:pu(+t),o(),r):s},r.y=function(e){return arguments.length?(t="function"==typeof e?e:pu(+e),o(),r):t},r}function Ou(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function Ru(t){return(t=Ou(Math.abs(t)))?t[1]:NaN}var qu,Nu=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Fu(t){if(!(e=Nu.exec(t)))throw new Error("invalid format: "+t);var e;return new Iu({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function Iu(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function Pu(t,e){var n=Ou(t,e);if(!n)return t+"";var i=n[0],s=n[1];return s<0?"0."+new Array(-s).join("0")+i:i.length>s+1?i.slice(0,s+1)+"."+i.slice(s+1):i+new Array(s-i.length+2).join("0")}Fu.prototype=Iu.prototype,Iu.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const Vu={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Pu(100*t,e),r:Pu,s:function(t,e){var n=Ou(t,e);if(!n)return t+"";var i=n[0],s=n[1],r=s-(qu=3*Math.max(-8,Math.min(8,Math.floor(s/3))))+1,o=i.length;return r===o?i:r>o?i+new Array(r-o+1).join("0"):r>0?i.slice(0,r)+"."+i.slice(r):"0."+new Array(1-r).join("0")+Ou(t,Math.max(0,e+r-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function zu(t){return t}var ju,Lu,Bu,Uu=Array.prototype.map,Wu=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Gu(t){var e,n,i=void 0===t.grouping||void 0===t.thousands?zu:(e=Uu.call(t.grouping,Number),n=t.thousands+"",function(t,i){for(var s=t.length,r=[],o=0,a=e[0],c=0;s>0&&a>0&&(c+a+1>i&&(a=Math.max(1,i-c)),r.push(t.substring(s-=a,s+a)),!((c+=a+1)>i));)a=e[o=(o+1)%e.length];return r.reverse().join(n)}),s=void 0===t.currency?"":t.currency[0]+"",r=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",a=void 0===t.numerals?zu:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(Uu.call(t.numerals,String)),c=void 0===t.percent?"%":t.percent+"",u=void 0===t.minus?"":t.minus+"",l=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=Fu(t)).fill,n=t.align,h=t.sign,f=t.symbol,d=t.zero,p=t.width,_=t.comma,m=t.precision,g=t.trim,v=t.type;"n"===v?(_=!0,v="g"):Vu[v]||(void 0===m&&(m=12),g=!0,v="g"),(d||"0"===e&&"="===n)&&(d=!0,e="0",n="=");var y="$"===f?s:"#"===f&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",b="$"===f?r:/[%p]/.test(v)?c:"",x=Vu[v],w=/[defgprs%]/.test(v);function T(t){var s,r,c,f=y,T=b;if("c"===v)T=x(t)+T,t="";else{var M=(t=+t)<0||1/t<0;if(t=isNaN(t)?l:x(Math.abs(t),m),g&&(t=function(t){t:for(var e,n=t.length,i=1,s=-1;i<n;++i)switch(t[i]){case".":s=e=i;break;case"0":0===s&&(s=i),e=i;break;default:if(!+t[i])break t;s>0&&(s=0)}return s>0?t.slice(0,s)+t.slice(e+1):t}(t)),M&&0==+t&&"+"!==h&&(M=!1),f=(M?"("===h?h:u:"-"===h||"("===h?"":h)+f,T=("s"===v?Wu[8+qu/3]:"")+T+(M&&"("===h?")":""),w)for(s=-1,r=t.length;++s<r;)if(48>(c=t.charCodeAt(s))||c>57){T=(46===c?o+t.slice(s+1):t.slice(s))+T,t=t.slice(0,s);break}}_&&!d&&(t=i(t,1/0));var S=f.length+t.length+T.length,A=S<p?new Array(p-S+1).join(e):"";switch(_&&d&&(t=i(A+t,A.length?p-T.length:1/0),A=""),n){case"<":t=f+t+T+A;break;case"=":t=f+A+t+T;break;case"^":t=A.slice(0,S=A.length>>1)+f+t+T+A.slice(S);break;default:t=A+f+t+T}return a(t)}return m=void 0===m?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),T.toString=function(){return t+""},T}return{format:h,formatPrefix:function(t,e){var n=h(((t=Fu(t)).type="f",t)),i=3*Math.max(-8,Math.min(8,Math.floor(Ru(e)/3))),s=Math.pow(10,-i),r=Wu[8+i/3];return function(t){return n(s*t)+r}}}}function Yu(t){return ju=Gu(t),Lu=ju.format,Bu=ju.formatPrefix,ju}function Hu(t){return Math.max(0,-Ru(Math.abs(t)))}function Xu(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Ru(e)/3)))-Ru(Math.abs(t)))}function Zu(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Ru(e)-Ru(t))+1}Yu({thousands:",",grouping:[3],currency:["$",""]});var $u=1e-6,Qu=1e-12,Ju=Math.PI,Ku=Ju/2,tl=Ju/4,el=2*Ju,nl=180/Ju,il=Ju/180,sl=Math.abs,rl=Math.atan,ol=Math.atan2,al=Math.cos,cl=Math.ceil,ul=Math.exp,ll=(Math.floor,Math.hypot),hl=Math.log,fl=Math.pow,dl=Math.sin,pl=Math.sign||function(t){return t>0?1:t<0?-1:0},_l=Math.sqrt,ml=Math.tan;function gl(t){return t>1?0:t<-1?Ju:Math.acos(t)}function vl(t){return t>1?Ku:t<-1?-Ku:Math.asin(t)}function yl(t){return(t=dl(t/2))*t}function bl(){}function xl(t,e){t&&Tl.hasOwnProperty(t.type)&&Tl[t.type](t,e)}var wl={Feature:function(t,e){xl(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,s=n.length;++i<s;)xl(n[i].geometry,e)}},Tl={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,s=n.length;++i<s;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){Ml(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,s=n.length;++i<s;)Ml(n[i],e,0)},Polygon:function(t,e){Sl(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,s=n.length;++i<s;)Sl(n[i],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,s=n.length;++i<s;)xl(n[i],e)}};function Ml(t,e,n){var i,s=-1,r=t.length-n;for(e.lineStart();++s<r;)i=t[s],e.point(i[0],i[1],i[2]);e.lineEnd()}function Sl(t,e){var n=-1,i=t.length;for(e.polygonStart();++n<i;)Ml(t[n],e,1);e.polygonEnd()}function Al(t,e){t&&wl.hasOwnProperty(t.type)?wl[t.type](t,e):xl(t,e)}var kl,Cl,Dl,El,Ol,Rl,ql,Nl,Fl,Il,Pl,Vl,zl,jl,Ll,Bl,Ul=new x,Wl=new x,Gl={point:bl,lineStart:bl,lineEnd:bl,polygonStart:function(){Ul=new x,Gl.lineStart=Yl,Gl.lineEnd=Hl},polygonEnd:function(){var t=+Ul;Wl.add(t<0?el+t:t),this.lineStart=this.lineEnd=this.point=bl},sphere:function(){Wl.add(el)}};function Yl(){Gl.point=Xl}function Hl(){Zl(kl,Cl)}function Xl(t,e){Gl.point=Zl,kl=t,Cl=e,Dl=t*=il,El=al(e=(e*=il)/2+tl),Ol=dl(e)}function Zl(t,e){var n=(t*=il)-Dl,i=n>=0?1:-1,s=i*n,r=al(e=(e*=il)/2+tl),o=dl(e),a=Ol*o,c=El*r+a*al(s),u=a*i*dl(s);Ul.add(ol(u,c)),Dl=t,El=r,Ol=o}function $l(t){return Wl=new x,Al(t,Gl),2*Wl}function Ql(t){return[ol(t[1],t[0]),vl(t[2])]}function Jl(t){var e=t[0],n=t[1],i=al(n);return[i*al(e),i*dl(e),dl(n)]}function Kl(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function th(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function eh(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function nh(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function ih(t){var e=_l(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}var sh,rh,oh,ah,ch,uh,lh,hh,fh,dh,ph,_h,mh,gh,vh,yh,bh={point:xh,lineStart:Th,lineEnd:Mh,polygonStart:function(){bh.point=Sh,bh.lineStart=Ah,bh.lineEnd=kh,jl=new x,Gl.polygonStart()},polygonEnd:function(){Gl.polygonEnd(),bh.point=xh,bh.lineStart=Th,bh.lineEnd=Mh,Ul<0?(Rl=-(Nl=180),ql=-(Fl=90)):jl>$u?Fl=90:jl<-1e-6&&(ql=-90),Bl[0]=Rl,Bl[1]=Nl},sphere:function(){Rl=-(Nl=180),ql=-(Fl=90)}};function xh(t,e){Ll.push(Bl=[Rl=t,Nl=t]),e<ql&&(ql=e),e>Fl&&(Fl=e)}function wh(t,e){var n=Jl([t*il,e*il]);if(zl){var i=th(zl,n),s=th([i[1],-i[0],0],i);ih(s),s=Ql(s);var r,o=t-Il,a=o>0?1:-1,c=s[0]*nl*a,u=sl(o)>180;u^(a*Il<c&&c<a*t)?(r=s[1]*nl)>Fl&&(Fl=r):u^(a*Il<(c=(c+360)%360-180)&&c<a*t)?(r=-s[1]*nl)<ql&&(ql=r):(e<ql&&(ql=e),e>Fl&&(Fl=e)),u?t<Il?Ch(Rl,t)>Ch(Rl,Nl)&&(Nl=t):Ch(t,Nl)>Ch(Rl,Nl)&&(Rl=t):Nl>=Rl?(t<Rl&&(Rl=t),t>Nl&&(Nl=t)):t>Il?Ch(Rl,t)>Ch(Rl,Nl)&&(Nl=t):Ch(t,Nl)>Ch(Rl,Nl)&&(Rl=t)}else Ll.push(Bl=[Rl=t,Nl=t]);e<ql&&(ql=e),e>Fl&&(Fl=e),zl=n,Il=t}function Th(){bh.point=wh}function Mh(){Bl[0]=Rl,Bl[1]=Nl,bh.point=xh,zl=null}function Sh(t,e){if(zl){var n=t-Il;jl.add(sl(n)>180?n+(n>0?360:-360):n)}else Pl=t,Vl=e;Gl.point(t,e),wh(t,e)}function Ah(){Gl.lineStart()}function kh(){Sh(Pl,Vl),Gl.lineEnd(),sl(jl)>$u&&(Rl=-(Nl=180)),Bl[0]=Rl,Bl[1]=Nl,zl=null}function Ch(t,e){return(e-=t)<0?e+360:e}function Dh(t,e){return t[0]-e[0]}function Eh(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}function Oh(t){var e,n,i,s,r,o,a;if(Fl=Nl=-(Rl=ql=1/0),Ll=[],Al(t,bh),n=Ll.length){for(Ll.sort(Dh),e=1,r=[i=Ll[0]];e<n;++e)Eh(i,(s=Ll[e])[0])||Eh(i,s[1])?(Ch(i[0],s[1])>Ch(i[0],i[1])&&(i[1]=s[1]),Ch(s[0],i[1])>Ch(i[0],i[1])&&(i[0]=s[0])):r.push(i=s);for(o=-1/0,e=0,i=r[n=r.length-1];e<=n;i=s,++e)s=r[e],(a=Ch(i[1],s[0]))>o&&(o=a,Rl=s[0],Nl=i[1])}return Ll=Bl=null,Rl===1/0||ql===1/0?[[NaN,NaN],[NaN,NaN]]:[[Rl,ql],[Nl,Fl]]}var Rh={sphere:bl,point:qh,lineStart:Fh,lineEnd:Vh,polygonStart:function(){Rh.lineStart=zh,Rh.lineEnd=jh},polygonEnd:function(){Rh.lineStart=Fh,Rh.lineEnd=Vh}};function qh(t,e){t*=il;var n=al(e*=il);Nh(n*al(t),n*dl(t),dl(e))}function Nh(t,e,n){++sh,oh+=(t-oh)/sh,ah+=(e-ah)/sh,ch+=(n-ch)/sh}function Fh(){Rh.point=Ih}function Ih(t,e){t*=il;var n=al(e*=il);gh=n*al(t),vh=n*dl(t),yh=dl(e),Rh.point=Ph,Nh(gh,vh,yh)}function Ph(t,e){t*=il;var n=al(e*=il),i=n*al(t),s=n*dl(t),r=dl(e),o=ol(_l((o=vh*r-yh*s)*o+(o=yh*i-gh*r)*o+(o=gh*s-vh*i)*o),gh*i+vh*s+yh*r);rh+=o,uh+=o*(gh+(gh=i)),lh+=o*(vh+(vh=s)),hh+=o*(yh+(yh=r)),Nh(gh,vh,yh)}function Vh(){Rh.point=qh}function zh(){Rh.point=Lh}function jh(){Bh(_h,mh),Rh.point=qh}function Lh(t,e){_h=t,mh=e,t*=il,e*=il,Rh.point=Bh;var n=al(e);gh=n*al(t),vh=n*dl(t),yh=dl(e),Nh(gh,vh,yh)}function Bh(t,e){t*=il;var n=al(e*=il),i=n*al(t),s=n*dl(t),r=dl(e),o=vh*r-yh*s,a=yh*i-gh*r,c=gh*s-vh*i,u=ll(o,a,c),l=vl(u),h=u&&-l/u;fh.add(h*o),dh.add(h*a),ph.add(h*c),rh+=l,uh+=l*(gh+(gh=i)),lh+=l*(vh+(vh=s)),hh+=l*(yh+(yh=r)),Nh(gh,vh,yh)}function Uh(t){sh=rh=oh=ah=ch=uh=lh=hh=0,fh=new x,dh=new x,ph=new x,Al(t,Rh);var e=+fh,n=+dh,i=+ph,s=ll(e,n,i);return s<Qu&&(e=uh,n=lh,i=hh,rh<$u&&(e=oh,n=ah,i=ch),(s=ll(e,n,i))<Qu)?[NaN,NaN]:[ol(n,e)*nl,vl(i/s)*nl]}function Wh(t){return function(){return t}}function Gh(t,e){function n(n,i){return n=t(n,i),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,i){return(n=e.invert(n,i))&&t.invert(n[0],n[1])}),n}function Yh(t,e){return[sl(t)>Ju?t+Math.round(-t/el)*el:t,e]}function Hh(t,e,n){return(t%=el)?e||n?Gh(Zh(t),$h(e,n)):Zh(t):e||n?$h(e,n):Yh}function Xh(t){return function(e,n){return[(e+=t)>Ju?e-el:e<-Ju?e+el:e,n]}}function Zh(t){var e=Xh(t);return e.invert=Xh(-t),e}function $h(t,e){var n=al(t),i=dl(t),s=al(e),r=dl(e);function o(t,e){var o=al(e),a=al(t)*o,c=dl(t)*o,u=dl(e),l=u*n+a*i;return[ol(c*s-l*r,a*n-u*i),vl(l*s+c*r)]}return o.invert=function(t,e){var o=al(e),a=al(t)*o,c=dl(t)*o,u=dl(e),l=u*s-c*r;return[ol(c*s+u*r,a*n+l*i),vl(l*n-a*i)]},o}function Qh(t){function e(e){return(e=t(e[0]*il,e[1]*il))[0]*=nl,e[1]*=nl,e}return t=Hh(t[0]*il,t[1]*il,t.length>2?t[2]*il:0),e.invert=function(e){return(e=t.invert(e[0]*il,e[1]*il))[0]*=nl,e[1]*=nl,e},e}function Jh(t,e,n,i,s,r){if(n){var o=al(e),a=dl(e),c=i*n;null==s?(s=e+i*el,r=e-c/2):(s=Kh(o,s),r=Kh(o,r),(i>0?s<r:s>r)&&(s+=i*el));for(var u,l=s;i>0?l>r:l<r;l-=c)u=Ql([o,-a*al(l),-a*dl(l)]),t.point(u[0],u[1])}}function Kh(t,e){(e=Jl(e))[0]-=t,ih(e);var n=gl(-e[1]);return((-e[2]<0?-n:n)+el-$u)%el}function tf(){var t,e,n=Wh([0,0]),i=Wh(90),s=Wh(6),r={point:function(n,i){t.push(n=e(n,i)),n[0]*=nl,n[1]*=nl}};function o(){var o=n.apply(this,arguments),a=i.apply(this,arguments)*il,c=s.apply(this,arguments)*il;return t=[],e=Hh(-o[0]*il,-o[1]*il,0).invert,Jh(r,a,c,1),o={type:"Polygon",coordinates:[t]},t=e=null,o}return o.center=function(t){return arguments.length?(n="function"==typeof t?t:Wh([+t[0],+t[1]]),o):n},o.radius=function(t){return arguments.length?(i="function"==typeof t?t:Wh(+t),o):i},o.precision=function(t){return arguments.length?(s="function"==typeof t?t:Wh(+t),o):s},o}function ef(){var t,e=[];return{point:function(e,n,i){t.push([e,n,i])},lineStart:function(){e.push(t=[])},lineEnd:bl,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function nf(t,e){return sl(t[0]-e[0])<$u&&sl(t[1]-e[1])<$u}function sf(t,e,n,i){this.x=t,this.z=e,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function rf(t,e,n,i,s){var r,o,a=[],c=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,i=t[0],o=t[e];if(nf(i,o)){if(!i[2]&&!o[2]){for(s.lineStart(),r=0;r<e;++r)s.point((i=t[r])[0],i[1]);return void s.lineEnd()}o[0]+=2e-6}a.push(n=new sf(i,t,null,!0)),c.push(n.o=new sf(i,null,n,!1)),a.push(n=new sf(o,t,null,!1)),c.push(n.o=new sf(o,null,n,!0))}})),a.length){for(c.sort(e),of(a),of(c),r=0,o=c.length;r<o;++r)c[r].e=n=!n;for(var u,l,h=a[0];;){for(var f=h,d=!0;f.v;)if((f=f.n)===h)return;u=f.z,s.lineStart();do{if(f.v=f.o.v=!0,f.e){if(d)for(r=0,o=u.length;r<o;++r)s.point((l=u[r])[0],l[1]);else i(f.x,f.n.x,1,s);f=f.n}else{if(d)for(u=f.p.z,r=u.length-1;r>=0;--r)s.point((l=u[r])[0],l[1]);else i(f.x,f.p.x,-1,s);f=f.p}u=(f=f.o).z,d=!d}while(!f.v);s.lineEnd()}}}function of(t){if(e=t.length){for(var e,n,i=0,s=t[0];++i<e;)s.n=n=t[i],n.p=s,s=n;s.n=n=t[0],n.p=s}}function af(t){return sl(t[0])<=Ju?t[0]:pl(t[0])*((sl(t[0])+Ju)%el-Ju)}function cf(t,e){var n=af(e),i=e[1],s=dl(i),r=[dl(n),-al(n),0],o=0,a=0,c=new x;1===s?i=Ku+$u:-1===s&&(i=-Ku-$u);for(var u=0,l=t.length;u<l;++u)if(f=(h=t[u]).length)for(var h,f,d=h[f-1],p=af(d),_=d[1]/2+tl,m=dl(_),g=al(_),v=0;v<f;++v,p=b,m=T,g=M,d=y){var y=h[v],b=af(y),w=y[1]/2+tl,T=dl(w),M=al(w),S=b-p,A=S>=0?1:-1,k=A*S,C=k>Ju,D=m*T;if(c.add(ol(D*A*dl(k),g*M+D*al(k))),o+=C?S+A*el:S,C^p>=n^b>=n){var E=th(Jl(d),Jl(y));ih(E);var O=th(r,E);ih(O);var R=(C^S>=0?-1:1)*vl(O[2]);(i>R||i===R&&(E[0]||E[1]))&&(a+=C^S>=0?1:-1)}}return(o<-1e-6||o<$u&&c<-1e-12)^1&a}function uf(t,e,n,i){return function(s){var r,o,a,c=e(s),u=ef(),l=e(u),h=!1,f={point:d,lineStart:_,lineEnd:m,polygonStart:function(){f.point=g,f.lineStart=v,f.lineEnd=y,o=[],r=[]},polygonEnd:function(){f.point=d,f.lineStart=_,f.lineEnd=m,o=mt(o);var t=cf(r,i);o.length?(h||(s.polygonStart(),h=!0),rf(o,hf,t,n,s)):t&&(h||(s.polygonStart(),h=!0),s.lineStart(),n(null,null,1,s),s.lineEnd()),h&&(s.polygonEnd(),h=!1),o=r=null},sphere:function(){s.polygonStart(),s.lineStart(),n(null,null,1,s),s.lineEnd(),s.polygonEnd()}};function d(e,n){t(e,n)&&s.point(e,n)}function p(t,e){c.point(t,e)}function _(){f.point=p,c.lineStart()}function m(){f.point=d,c.lineEnd()}function g(t,e){a.push([t,e]),l.point(t,e)}function v(){l.lineStart(),a=[]}function y(){g(a[0][0],a[0][1]),l.lineEnd();var t,e,n,i,c=l.clean(),f=u.result(),d=f.length;if(a.pop(),r.push(a),a=null,d)if(1&c){if((e=(n=f[0]).length-1)>0){for(h||(s.polygonStart(),h=!0),s.lineStart(),t=0;t<e;++t)s.point((i=n[t])[0],i[1]);s.lineEnd()}}else d>1&&2&c&&f.push(f.pop().concat(f.shift())),o.push(f.filter(lf))}return f}}function lf(t){return t.length>1}function hf(t,e){return((t=t.x)[0]<0?t[1]-Ku-$u:Ku-t[1])-((e=e.x)[0]<0?e[1]-Ku-$u:Ku-e[1])}Yh.invert=Yh;const ff=uf((function(){return!0}),(function(t){var e,n=NaN,i=NaN,s=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(r,o){var a=r>0?Ju:-Ju,c=sl(r-n);sl(c-Ju)<$u?(t.point(n,i=(i+o)/2>0?Ku:-Ku),t.point(s,i),t.lineEnd(),t.lineStart(),t.point(a,i),t.point(r,i),e=0):s!==a&&c>=Ju&&(sl(n-s)<$u&&(n-=s*$u),sl(r-a)<$u&&(r-=a*$u),i=function(t,e,n,i){var s,r,o=dl(t-n);return sl(o)>$u?rl((dl(e)*(r=al(i))*dl(n)-dl(i)*(s=al(e))*dl(t))/(s*r*o)):(e+i)/2}(n,i,r,o),t.point(s,i),t.lineEnd(),t.lineStart(),t.point(a,i),e=0),t.point(n=r,i=o),s=a},lineEnd:function(){t.lineEnd(),n=i=NaN},clean:function(){return 2-e}}}),(function(t,e,n,i){var s;if(null==t)s=n*Ku,i.point(-Ju,s),i.point(0,s),i.point(Ju,s),i.point(Ju,0),i.point(Ju,-s),i.point(0,-s),i.point(-Ju,-s),i.point(-Ju,0),i.point(-Ju,s);else if(sl(t[0]-e[0])>$u){var r=t[0]<e[0]?Ju:-Ju;s=n*r/2,i.point(-r,s),i.point(0,s),i.point(r,s)}else i.point(e[0],e[1])}),[-Ju,-Ku]);function df(t){var e=al(t),n=6*il,i=e>0,s=sl(e)>$u;function r(t,n){return al(t)*al(n)>e}function o(t,n,i){var s=[1,0,0],r=th(Jl(t),Jl(n)),o=Kl(r,r),a=r[0],c=o-a*a;if(!c)return!i&&t;var u=e*o/c,l=-e*a/c,h=th(s,r),f=nh(s,u);eh(f,nh(r,l));var d=h,p=Kl(f,d),_=Kl(d,d),m=p*p-_*(Kl(f,f)-1);if(!(m<0)){var g=_l(m),v=nh(d,(-p-g)/_);if(eh(v,f),v=Ql(v),!i)return v;var y,b=t[0],x=n[0],w=t[1],T=n[1];x<b&&(y=b,b=x,x=y);var M=x-b,S=sl(M-Ju)<$u;if(!S&&T<w&&(y=w,w=T,T=y),S||M<$u?S?w+T>0^v[1]<(sl(v[0]-b)<$u?w:T):w<=v[1]&&v[1]<=T:M>Ju^(b<=v[0]&&v[0]<=x)){var A=nh(d,(-p+g)/_);return eh(A,f),[v,Ql(A)]}}}function a(e,n){var s=i?t:Ju-t,r=0;return e<-s?r|=1:e>s&&(r|=2),n<-s?r|=4:n>s&&(r|=8),r}return uf(r,(function(t){var e,n,c,u,l;return{lineStart:function(){u=c=!1,l=1},point:function(h,f){var d,p=[h,f],_=r(h,f),m=i?_?0:a(h,f):_?a(h+(h<0?Ju:-Ju),f):0;if(!e&&(u=c=_)&&t.lineStart(),_!==c&&(!(d=o(e,p))||nf(e,d)||nf(p,d))&&(p[2]=1),_!==c)l=0,_?(t.lineStart(),d=o(p,e),t.point(d[0],d[1])):(d=o(e,p),t.point(d[0],d[1],2),t.lineEnd()),e=d;else if(s&&e&&i^_){var g;m&n||!(g=o(p,e,!0))||(l=0,i?(t.lineStart(),t.point(g[0][0],g[0][1]),t.point(g[1][0],g[1][1]),t.lineEnd()):(t.point(g[1][0],g[1][1]),t.lineEnd(),t.lineStart(),t.point(g[0][0],g[0][1],3)))}!_||e&&nf(e,p)||t.point(p[0],p[1]),e=p,c=_,n=m},lineEnd:function(){c&&t.lineEnd(),e=null},clean:function(){return l|(u&&c)<<1}}}),(function(e,i,s,r){Jh(r,t,n,s,e,i)}),i?[0,-t]:[-Ju,t-Ju])}var pf,_f,mf,gf,vf=1e9,yf=-vf;function bf(t,e,n,i){function s(s,r){return t<=s&&s<=n&&e<=r&&r<=i}function r(s,r,a,u){var l=0,h=0;if(null==s||(l=o(s,a))!==(h=o(r,a))||c(s,r)<0^a>0)do{u.point(0===l||3===l?t:n,l>1?i:e)}while((l=(l+a+4)%4)!==h);else u.point(r[0],r[1])}function o(i,s){return sl(i[0]-t)<$u?s>0?0:3:sl(i[0]-n)<$u?s>0?2:1:sl(i[1]-e)<$u?s>0?1:0:s>0?3:2}function a(t,e){return c(t.x,e.x)}function c(t,e){var n=o(t,1),i=o(e,1);return n!==i?n-i:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(o){var c,u,l,h,f,d,p,_,m,g,v,y=o,b=ef(),x={point:w,lineStart:function(){x.point=T,u&&u.push(l=[]),g=!0,m=!1,p=_=NaN},lineEnd:function(){c&&(T(h,f),d&&m&&b.rejoin(),c.push(b.result())),x.point=w,m&&y.lineEnd()},polygonStart:function(){y=b,c=[],u=[],v=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,s=u.length;n<s;++n)for(var r,o,a=u[n],c=1,l=a.length,h=a[0],f=h[0],d=h[1];c<l;++c)r=f,o=d,f=(h=a[c])[0],d=h[1],o<=i?d>i&&(f-r)*(i-o)>(d-o)*(t-r)&&++e:d<=i&&(f-r)*(i-o)<(d-o)*(t-r)&&--e;return e}(),n=v&&e,s=(c=mt(c)).length;(n||s)&&(o.polygonStart(),n&&(o.lineStart(),r(null,null,1,o),o.lineEnd()),s&&rf(c,a,e,r,o),o.polygonEnd()),y=o,c=u=l=null}};function w(t,e){s(t,e)&&y.point(t,e)}function T(r,o){var a=s(r,o);if(u&&l.push([r,o]),g)h=r,f=o,d=a,g=!1,a&&(y.lineStart(),y.point(r,o));else if(a&&m)y.point(r,o);else{var c=[p=Math.max(yf,Math.min(vf,p)),_=Math.max(yf,Math.min(vf,_))],b=[r=Math.max(yf,Math.min(vf,r)),o=Math.max(yf,Math.min(vf,o))];!function(t,e,n,i,s,r){var o,a=t[0],c=t[1],u=0,l=1,h=e[0]-a,f=e[1]-c;if(o=n-a,h||!(o>0)){if(o/=h,h<0){if(o<u)return;o<l&&(l=o)}else if(h>0){if(o>l)return;o>u&&(u=o)}if(o=s-a,h||!(o<0)){if(o/=h,h<0){if(o>l)return;o>u&&(u=o)}else if(h>0){if(o<u)return;o<l&&(l=o)}if(o=i-c,f||!(o>0)){if(o/=f,f<0){if(o<u)return;o<l&&(l=o)}else if(f>0){if(o>l)return;o>u&&(u=o)}if(o=r-c,f||!(o<0)){if(o/=f,f<0){if(o>l)return;o>u&&(u=o)}else if(f>0){if(o<u)return;o<l&&(l=o)}return u>0&&(t[0]=a+u*h,t[1]=c+u*f),l<1&&(e[0]=a+l*h,e[1]=c+l*f),!0}}}}}(c,b,t,e,n,i)?a&&(y.lineStart(),y.point(r,o),v=!1):(m||(y.lineStart(),y.point(c[0],c[1])),y.point(b[0],b[1]),a||y.lineEnd(),v=!1)}p=r,_=o,m=a}return x}}function xf(){var t,e,n,i=0,s=0,r=960,o=500;return n={stream:function(n){return t&&e===n?t:t=bf(i,s,r,o)(e=n)},extent:function(a){return arguments.length?(i=+a[0][0],s=+a[0][1],r=+a[1][0],o=+a[1][1],t=e=null,n):[[i,s],[r,o]]}}}var wf={sphere:bl,point:bl,lineStart:function(){wf.point=Mf,wf.lineEnd=Tf},lineEnd:bl,polygonStart:bl,polygonEnd:bl};function Tf(){wf.point=wf.lineEnd=bl}function Mf(t,e){_f=t*=il,mf=dl(e*=il),gf=al(e),wf.point=Sf}function Sf(t,e){t*=il;var n=dl(e*=il),i=al(e),s=sl(t-_f),r=al(s),o=i*dl(s),a=gf*n-mf*i*r,c=mf*n+gf*i*r;pf.add(ol(_l(o*o+a*a),c)),_f=t,mf=n,gf=i}function Af(t){return pf=new x,Al(t,wf),+pf}var kf=[null,null],Cf={type:"LineString",coordinates:kf};function Df(t,e){return kf[0]=t,kf[1]=e,Af(Cf)}var Ef={Feature:function(t,e){return Rf(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,s=n.length;++i<s;)if(Rf(n[i].geometry,e))return!0;return!1}},Of={Sphere:function(){return!0},Point:function(t,e){return qf(t.coordinates,e)},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,s=n.length;++i<s;)if(qf(n[i],e))return!0;return!1},LineString:function(t,e){return Nf(t.coordinates,e)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,s=n.length;++i<s;)if(Nf(n[i],e))return!0;return!1},Polygon:function(t,e){return Ff(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,s=n.length;++i<s;)if(Ff(n[i],e))return!0;return!1},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,s=n.length;++i<s;)if(Rf(n[i],e))return!0;return!1}};function Rf(t,e){return!(!t||!Of.hasOwnProperty(t.type))&&Of[t.type](t,e)}function qf(t,e){return 0===Df(t,e)}function Nf(t,e){for(var n,i,s,r=0,o=t.length;r<o;r++){if(0===(i=Df(t[r],e)))return!0;if(r>0&&(s=Df(t[r],t[r-1]))>0&&n<=s&&i<=s&&(n+i-s)*(1-Math.pow((n-i)/s,2))<Qu*s)return!0;n=i}return!1}function Ff(t,e){return!!cf(t.map(If),Pf(e))}function If(t){return(t=t.map(Pf)).pop(),t}function Pf(t){return[t[0]*il,t[1]*il]}function Vf(t,e){return(t&&Ef.hasOwnProperty(t.type)?Ef[t.type]:Rf)(t,e)}function zf(t,e,n){var i=xt(t,e-$u,n).concat(e);return function(t){return i.map((function(e){return[t,e]}))}}function jf(t,e,n){var i=xt(t,e-$u,n).concat(e);return function(t){return i.map((function(e){return[e,t]}))}}function Lf(){var t,e,n,i,s,r,o,a,c,u,l,h,f=10,d=f,p=90,_=360,m=2.5;function g(){return{type:"MultiLineString",coordinates:v()}}function v(){return xt(cl(i/p)*p,n,p).map(l).concat(xt(cl(a/_)*_,o,_).map(h)).concat(xt(cl(e/f)*f,t,f).filter((function(t){return sl(t%p)>$u})).map(c)).concat(xt(cl(r/d)*d,s,d).filter((function(t){return sl(t%_)>$u})).map(u))}return g.lines=function(){return v().map((function(t){return{type:"LineString",coordinates:t}}))},g.outline=function(){return{type:"Polygon",coordinates:[l(i).concat(h(o).slice(1),l(n).reverse().slice(1),h(a).reverse().slice(1))]}},g.extent=function(t){return arguments.length?g.extentMajor(t).extentMinor(t):g.extentMinor()},g.extentMajor=function(t){return arguments.length?(i=+t[0][0],n=+t[1][0],a=+t[0][1],o=+t[1][1],i>n&&(t=i,i=n,n=t),a>o&&(t=a,a=o,o=t),g.precision(m)):[[i,a],[n,o]]},g.extentMinor=function(n){return arguments.length?(e=+n[0][0],t=+n[1][0],r=+n[0][1],s=+n[1][1],e>t&&(n=e,e=t,t=n),r>s&&(n=r,r=s,s=n),g.precision(m)):[[e,r],[t,s]]},g.step=function(t){return arguments.length?g.stepMajor(t).stepMinor(t):g.stepMinor()},g.stepMajor=function(t){return arguments.length?(p=+t[0],_=+t[1],g):[p,_]},g.stepMinor=function(t){return arguments.length?(f=+t[0],d=+t[1],g):[f,d]},g.precision=function(f){return arguments.length?(m=+f,c=zf(r,s,90),u=jf(e,t,m),l=zf(a,o,90),h=jf(i,n,m),g):m},g.extentMajor([[-180,-89.999999],[180,89.999999]]).extentMinor([[-180,-80.000001],[180,80.000001]])}function Bf(){return Lf()()}function Uf(t,e){var n=t[0]*il,i=t[1]*il,s=e[0]*il,r=e[1]*il,o=al(i),a=dl(i),c=al(r),u=dl(r),l=o*al(n),h=o*dl(n),f=c*al(s),d=c*dl(s),p=2*vl(_l(yl(r-i)+o*c*yl(s-n))),_=dl(p),m=p?function(t){var e=dl(t*=p)/_,n=dl(p-t)/_,i=n*l+e*f,s=n*h+e*d,r=n*a+e*u;return[ol(s,i)*nl,ol(r,_l(i*i+s*s))*nl]}:function(){return[n*nl,i*nl]};return m.distance=p,m}const Wf=t=>t;var Gf,Yf,Hf,Xf,Zf=new x,$f=new x,Qf={point:bl,lineStart:bl,lineEnd:bl,polygonStart:function(){Qf.lineStart=Jf,Qf.lineEnd=ed},polygonEnd:function(){Qf.lineStart=Qf.lineEnd=Qf.point=bl,Zf.add(sl($f)),$f=new x},result:function(){var t=Zf/2;return Zf=new x,t}};function Jf(){Qf.point=Kf}function Kf(t,e){Qf.point=td,Gf=Hf=t,Yf=Xf=e}function td(t,e){$f.add(Xf*t-Hf*e),Hf=t,Xf=e}function ed(){td(Gf,Yf)}const nd=Qf;var id=1/0,sd=id,rd=-id,od=rd,ad={point:function(t,e){t<id&&(id=t),t>rd&&(rd=t),e<sd&&(sd=e),e>od&&(od=e)},lineStart:bl,lineEnd:bl,polygonStart:bl,polygonEnd:bl,result:function(){var t=[[id,sd],[rd,od]];return rd=od=-(sd=id=1/0),t}};const cd=ad;var ud,ld,hd,fd,dd=0,pd=0,_d=0,md=0,gd=0,vd=0,yd=0,bd=0,xd=0,wd={point:Td,lineStart:Md,lineEnd:kd,polygonStart:function(){wd.lineStart=Cd,wd.lineEnd=Dd},polygonEnd:function(){wd.point=Td,wd.lineStart=Md,wd.lineEnd=kd},result:function(){var t=xd?[yd/xd,bd/xd]:vd?[md/vd,gd/vd]:_d?[dd/_d,pd/_d]:[NaN,NaN];return dd=pd=_d=md=gd=vd=yd=bd=xd=0,t}};function Td(t,e){dd+=t,pd+=e,++_d}function Md(){wd.point=Sd}function Sd(t,e){wd.point=Ad,Td(hd=t,fd=e)}function Ad(t,e){var n=t-hd,i=e-fd,s=_l(n*n+i*i);md+=s*(hd+t)/2,gd+=s*(fd+e)/2,vd+=s,Td(hd=t,fd=e)}function kd(){wd.point=Td}function Cd(){wd.point=Ed}function Dd(){Od(ud,ld)}function Ed(t,e){wd.point=Od,Td(ud=hd=t,ld=fd=e)}function Od(t,e){var n=t-hd,i=e-fd,s=_l(n*n+i*i);md+=s*(hd+t)/2,gd+=s*(fd+e)/2,vd+=s,yd+=(s=fd*t-hd*e)*(hd+t),bd+=s*(fd+e),xd+=3*s,Td(hd=t,fd=e)}const Rd=wd;function qd(t){this._context=t}qd.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,el)}},result:bl};var Nd,Fd,Id,Pd,Vd,zd=new x,jd={point:bl,lineStart:function(){jd.point=Ld},lineEnd:function(){Nd&&Bd(Fd,Id),jd.point=bl},polygonStart:function(){Nd=!0},polygonEnd:function(){Nd=null},result:function(){var t=+zd;return zd=new x,t}};function Ld(t,e){jd.point=Bd,Fd=Pd=t,Id=Vd=e}function Bd(t,e){Pd-=t,Vd-=e,zd.add(_l(Pd*Pd+Vd*Vd)),Pd=t,Vd=e}const Ud=jd;function Wd(){this._string=[]}function Gd(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function Yd(t,e){var n,i,s=4.5;function r(t){return t&&("function"==typeof s&&i.pointRadius(+s.apply(this,arguments)),Al(t,n(i))),i.result()}return r.area=function(t){return Al(t,n(nd)),nd.result()},r.measure=function(t){return Al(t,n(Ud)),Ud.result()},r.bounds=function(t){return Al(t,n(cd)),cd.result()},r.centroid=function(t){return Al(t,n(Rd)),Rd.result()},r.projection=function(e){return arguments.length?(n=null==e?(t=null,Wf):(t=e).stream,r):t},r.context=function(t){return arguments.length?(i=null==t?(e=null,new Wd):new qd(e=t),"function"!=typeof s&&i.pointRadius(s),r):e},r.pointRadius=function(t){return arguments.length?(s="function"==typeof t?t:(i.pointRadius(+t),+t),r):s},r.projection(t).context(e)}function Hd(t){return{stream:Xd(t)}}function Xd(t){return function(e){var n=new Zd;for(var i in t)n[i]=t[i];return n.stream=e,n}}function Zd(){}function $d(t,e,n){var i=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=i&&t.clipExtent(null),Al(n,t.stream(cd)),e(cd.result()),null!=i&&t.clipExtent(i),t}function Qd(t,e,n){return $d(t,(function(n){var i=e[1][0]-e[0][0],s=e[1][1]-e[0][1],r=Math.min(i/(n[1][0]-n[0][0]),s/(n[1][1]-n[0][1])),o=+e[0][0]+(i-r*(n[1][0]+n[0][0]))/2,a=+e[0][1]+(s-r*(n[1][1]+n[0][1]))/2;t.scale(150*r).translate([o,a])}),n)}function Jd(t,e,n){return Qd(t,[[0,0],e],n)}function Kd(t,e,n){return $d(t,(function(n){var i=+e,s=i/(n[1][0]-n[0][0]),r=(i-s*(n[1][0]+n[0][0]))/2,o=-s*n[0][1];t.scale(150*s).translate([r,o])}),n)}function tp(t,e,n){return $d(t,(function(n){var i=+e,s=i/(n[1][1]-n[0][1]),r=-s*n[0][0],o=(i-s*(n[1][1]+n[0][1]))/2;t.scale(150*s).translate([r,o])}),n)}Wd.prototype={_radius:4.5,_circle:Gd(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:null==this._circle&&(this._circle=Gd(this._radius)),this._string.push("M",t,",",e,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}},Zd.prototype={constructor:Zd,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var ep=al(30*il);function np(t,e){return+e?function(t,e){function n(i,s,r,o,a,c,u,l,h,f,d,p,_,m){var g=u-i,v=l-s,y=g*g+v*v;if(y>4*e&&_--){var b=o+f,x=a+d,w=c+p,T=_l(b*b+x*x+w*w),M=vl(w/=T),S=sl(sl(w)-1)<$u||sl(r-h)<$u?(r+h)/2:ol(x,b),A=t(S,M),k=A[0],C=A[1],D=k-i,E=C-s,O=v*D-g*E;(O*O/y>e||sl((g*D+v*E)/y-.5)>.3||o*f+a*d+c*p<ep)&&(n(i,s,r,o,a,c,k,C,S,b/=T,x/=T,w,_,m),m.point(k,C),n(k,C,S,b,x,w,u,l,h,f,d,p,_,m))}}return function(e){var i,s,r,o,a,c,u,l,h,f,d,p,_={point:m,lineStart:g,lineEnd:y,polygonStart:function(){e.polygonStart(),_.lineStart=b},polygonEnd:function(){e.polygonEnd(),_.lineStart=g}};function m(n,i){n=t(n,i),e.point(n[0],n[1])}function g(){l=NaN,_.point=v,e.lineStart()}function v(i,s){var r=Jl([i,s]),o=t(i,s);n(l,h,u,f,d,p,l=o[0],h=o[1],u=i,f=r[0],d=r[1],p=r[2],16,e),e.point(l,h)}function y(){_.point=m,e.lineEnd()}function b(){g(),_.point=x,_.lineEnd=w}function x(t,e){v(i=t,e),s=l,r=h,o=f,a=d,c=p,_.point=v}function w(){n(l,h,u,f,d,p,s,r,i,o,a,c,16,e),_.lineEnd=y,y()}return _}}(t,e):function(t){return Xd({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)}var ip=Xd({point:function(t,e){this.stream.point(t*il,e*il)}});function sp(t,e,n,i,s,r){if(!r)return function(t,e,n,i,s){function r(r,o){return[e+t*(r*=i),n-t*(o*=s)]}return r.invert=function(r,o){return[(r-e)/t*i,(n-o)/t*s]},r}(t,e,n,i,s);var o=al(r),a=dl(r),c=o*t,u=a*t,l=o/t,h=a/t,f=(a*n-o*e)/t,d=(a*e+o*n)/t;function p(t,r){return[c*(t*=i)-u*(r*=s)+e,n-u*t-c*r]}return p.invert=function(t,e){return[i*(l*t-h*e+f),s*(d-h*t-l*e)]},p}function rp(t){return op((function(){return t}))()}function op(t){var e,n,i,s,r,o,a,c,u,l,h=150,f=480,d=250,p=0,_=0,m=0,g=0,v=0,y=0,b=1,x=1,w=null,T=ff,M=null,S=Wf,A=.5;function k(t){return c(t[0]*il,t[1]*il)}function C(t){return(t=c.invert(t[0],t[1]))&&[t[0]*nl,t[1]*nl]}function D(){var t=sp(h,0,0,b,x,y).apply(null,e(p,_)),i=sp(h,f-t[0],d-t[1],b,x,y);return n=Hh(m,g,v),a=Gh(e,i),c=Gh(n,a),o=np(a,A),E()}function E(){return u=l=null,k}return k.stream=function(t){return u&&l===t?u:u=ip(function(t){return Xd({point:function(e,n){var i=t(e,n);return this.stream.point(i[0],i[1])}})}(n)(T(o(S(l=t)))))},k.preclip=function(t){return arguments.length?(T=t,w=void 0,E()):T},k.postclip=function(t){return arguments.length?(S=t,M=i=s=r=null,E()):S},k.clipAngle=function(t){return arguments.length?(T=+t?df(w=t*il):(w=null,ff),E()):w*nl},k.clipExtent=function(t){return arguments.length?(S=null==t?(M=i=s=r=null,Wf):bf(M=+t[0][0],i=+t[0][1],s=+t[1][0],r=+t[1][1]),E()):null==M?null:[[M,i],[s,r]]},k.scale=function(t){return arguments.length?(h=+t,D()):h},k.translate=function(t){return arguments.length?(f=+t[0],d=+t[1],D()):[f,d]},k.center=function(t){return arguments.length?(p=t[0]%360*il,_=t[1]%360*il,D()):[p*nl,_*nl]},k.rotate=function(t){return arguments.length?(m=t[0]%360*il,g=t[1]%360*il,v=t.length>2?t[2]%360*il:0,D()):[m*nl,g*nl,v*nl]},k.angle=function(t){return arguments.length?(y=t%360*il,D()):y*nl},k.reflectX=function(t){return arguments.length?(b=t?-1:1,D()):b<0},k.reflectY=function(t){return arguments.length?(x=t?-1:1,D()):x<0},k.precision=function(t){return arguments.length?(o=np(a,A=t*t),E()):_l(A)},k.fitExtent=function(t,e){return Qd(k,t,e)},k.fitSize=function(t,e){return Jd(k,t,e)},k.fitWidth=function(t,e){return Kd(k,t,e)},k.fitHeight=function(t,e){return tp(k,t,e)},function(){return e=t.apply(this,arguments),k.invert=e.invert&&C,D()}}function ap(t){var e=0,n=Ju/3,i=op(t),s=i(e,n);return s.parallels=function(t){return arguments.length?i(e=t[0]*il,n=t[1]*il):[e*nl,n*nl]},s}function cp(t,e){var n=dl(t),i=(n+dl(e))/2;if(sl(i)<$u)return function(t){var e=al(t);function n(t,n){return[t*e,dl(n)/e]}return n.invert=function(t,n){return[t/e,vl(n*e)]},n}(t);var s=1+n*(2*i-n),r=_l(s)/i;function o(t,e){var n=_l(s-2*i*dl(e))/i;return[n*dl(t*=i),r-n*al(t)]}return o.invert=function(t,e){var n=r-e,o=ol(t,sl(n))*pl(n);return n*i<0&&(o-=Ju*pl(t)*pl(n)),[o/i,vl((s-(t*t+n*n)*i*i)/(2*i))]},o}function up(){return ap(cp).scale(155.424).center([0,33.6442])}function lp(){return up().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function hp(){var t,e,n,i,s,r,o=lp(),a=up().rotate([154,0]).center([-2,58.5]).parallels([55,65]),c=up().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u={point:function(t,e){r=[t,e]}};function l(t){var e=t[0],o=t[1];return r=null,n.point(e,o),r||(i.point(e,o),r)||(s.point(e,o),r)}function h(){return t=e=null,l}return l.invert=function(t){var e=o.scale(),n=o.translate(),i=(t[0]-n[0])/e,s=(t[1]-n[1])/e;return(s>=.12&&s<.234&&i>=-.425&&i<-.214?a:s>=.166&&s<.234&&i>=-.214&&i<-.115?c:o).invert(t)},l.stream=function(n){return t&&e===n?t:(i=[o.stream(e=n),a.stream(n),c.stream(n)],s=i.length,t={point:function(t,e){for(var n=-1;++n<s;)i[n].point(t,e)},sphere:function(){for(var t=-1;++t<s;)i[t].sphere()},lineStart:function(){for(var t=-1;++t<s;)i[t].lineStart()},lineEnd:function(){for(var t=-1;++t<s;)i[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<s;)i[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<s;)i[t].polygonEnd()}});var i,s},l.precision=function(t){return arguments.length?(o.precision(t),a.precision(t),c.precision(t),h()):o.precision()},l.scale=function(t){return arguments.length?(o.scale(t),a.scale(.35*t),c.scale(t),l.translate(o.translate())):o.scale()},l.translate=function(t){if(!arguments.length)return o.translate();var e=o.scale(),r=+t[0],l=+t[1];return n=o.translate(t).clipExtent([[r-.455*e,l-.238*e],[r+.455*e,l+.238*e]]).stream(u),i=a.translate([r-.307*e,l+.201*e]).clipExtent([[r-.425*e+$u,l+.12*e+$u],[r-.214*e-$u,l+.234*e-$u]]).stream(u),s=c.translate([r-.205*e,l+.212*e]).clipExtent([[r-.214*e+$u,l+.166*e+$u],[r-.115*e-$u,l+.234*e-$u]]).stream(u),h()},l.fitExtent=function(t,e){return Qd(l,t,e)},l.fitSize=function(t,e){return Jd(l,t,e)},l.fitWidth=function(t,e){return Kd(l,t,e)},l.fitHeight=function(t,e){return tp(l,t,e)},l.scale(1070)}function fp(t){return function(e,n){var i=al(e),s=al(n),r=t(i*s);return r===1/0?[2,0]:[r*s*dl(e),r*dl(n)]}}function dp(t){return function(e,n){var i=_l(e*e+n*n),s=t(i),r=dl(s),o=al(s);return[ol(e*r,i*o),vl(i&&n*r/i)]}}var pp=fp((function(t){return _l(2/(1+t))}));function _p(){return rp(pp).scale(124.75).clipAngle(179.999)}pp.invert=dp((function(t){return 2*vl(t/2)}));var mp=fp((function(t){return(t=gl(t))&&t/dl(t)}));function gp(){return rp(mp).scale(79.4188).clipAngle(179.999)}function vp(t,e){return[t,hl(ml((Ku+e)/2))]}function yp(){return bp(vp).scale(961/el)}function bp(t){var e,n,i,s=rp(t),r=s.center,o=s.scale,a=s.translate,c=s.clipExtent,u=null;function l(){var r=Ju*o(),a=s(Qh(s.rotate()).invert([0,0]));return c(null==u?[[a[0]-r,a[1]-r],[a[0]+r,a[1]+r]]:t===vp?[[Math.max(a[0]-r,u),e],[Math.min(a[0]+r,n),i]]:[[u,Math.max(a[1]-r,e)],[n,Math.min(a[1]+r,i)]])}return s.scale=function(t){return arguments.length?(o(t),l()):o()},s.translate=function(t){return arguments.length?(a(t),l()):a()},s.center=function(t){return arguments.length?(r(t),l()):r()},s.clipExtent=function(t){return arguments.length?(null==t?u=e=n=i=null:(u=+t[0][0],e=+t[0][1],n=+t[1][0],i=+t[1][1]),l()):null==u?null:[[u,e],[n,i]]},l()}function xp(t){return ml((Ku+t)/2)}function wp(t,e){var n=al(t),i=t===e?dl(t):hl(n/al(e))/hl(xp(e)/xp(t)),s=n*fl(xp(t),i)/i;if(!i)return vp;function r(t,e){s>0?e<-Ku+$u&&(e=-Ku+$u):e>Ku-$u&&(e=Ku-$u);var n=s/fl(xp(e),i);return[n*dl(i*t),s-n*al(i*t)]}return r.invert=function(t,e){var n=s-e,r=pl(i)*_l(t*t+n*n),o=ol(t,sl(n))*pl(n);return n*i<0&&(o-=Ju*pl(t)*pl(n)),[o/i,2*rl(fl(s/r,1/i))-Ku]},r}function Tp(){return ap(wp).scale(109.5).parallels([30,30])}function Mp(t,e){return[t,e]}function Sp(){return rp(Mp).scale(152.63)}function Ap(t,e){var n=al(t),i=t===e?dl(t):(n-al(e))/(e-t),s=n/i+t;if(sl(i)<$u)return Mp;function r(t,e){var n=s-e,r=i*t;return[n*dl(r),s-n*al(r)]}return r.invert=function(t,e){var n=s-e,r=ol(t,sl(n))*pl(n);return n*i<0&&(r-=Ju*pl(t)*pl(n)),[r/i,s-pl(i)*_l(t*t+n*n)]},r}function kp(){return ap(Ap).scale(131.154).center([0,13.9389])}mp.invert=dp((function(t){return t})),vp.invert=function(t,e){return[t,2*rl(ul(e))-Ku]},Mp.invert=Mp;var Cp=1.340264,Dp=-.081106,Ep=893e-6,Op=.003796,Rp=_l(3)/2;function qp(t,e){var n=vl(Rp*dl(e)),i=n*n,s=i*i*i;return[t*al(n)/(Rp*(Cp+3*Dp*i+s*(7*Ep+9*Op*i))),n*(Cp+Dp*i+s*(Ep+Op*i))]}function Np(){return rp(qp).scale(177.158)}function Fp(t,e){var n=al(e),i=al(t)*n;return[n*dl(t)/i,dl(e)/i]}function Ip(){return rp(Fp).scale(144.049).clipAngle(60)}function Pp(){var t,e,n,i,s,r,o,a=1,c=0,u=0,l=1,h=1,f=0,d=null,p=1,_=1,m=Xd({point:function(t,e){var n=y([t,e]);this.stream.point(n[0],n[1])}}),g=Wf;function v(){return p=a*l,_=a*h,r=o=null,y}function y(n){var i=n[0]*p,s=n[1]*_;if(f){var r=s*t-i*e;i=i*t+s*e,s=r}return[i+c,s+u]}return y.invert=function(n){var i=n[0]-c,s=n[1]-u;if(f){var r=s*t+i*e;i=i*t-s*e,s=r}return[i/p,s/_]},y.stream=function(t){return r&&o===t?r:r=m(g(o=t))},y.postclip=function(t){return arguments.length?(g=t,d=n=i=s=null,v()):g},y.clipExtent=function(t){return arguments.length?(g=null==t?(d=n=i=s=null,Wf):bf(d=+t[0][0],n=+t[0][1],i=+t[1][0],s=+t[1][1]),v()):null==d?null:[[d,n],[i,s]]},y.scale=function(t){return arguments.length?(a=+t,v()):a},y.translate=function(t){return arguments.length?(c=+t[0],u=+t[1],v()):[c,u]},y.angle=function(n){return arguments.length?(e=dl(f=n%360*il),t=al(f),v()):f*nl},y.reflectX=function(t){return arguments.length?(l=t?-1:1,v()):l<0},y.reflectY=function(t){return arguments.length?(h=t?-1:1,v()):h<0},y.fitExtent=function(t,e){return Qd(y,t,e)},y.fitSize=function(t,e){return Jd(y,t,e)},y.fitWidth=function(t,e){return Kd(y,t,e)},y.fitHeight=function(t,e){return tp(y,t,e)},y}function Vp(t,e){var n=e*e,i=n*n;return[t*(.8707-.131979*n+i*(i*(.003971*n-.001529*i)-.013791)),e*(1.007226+n*(.015085+i*(.028874*n-.044475-.005916*i)))]}function zp(){return rp(Vp).scale(175.295)}function jp(t,e){return[al(e)*dl(t),dl(e)]}function Lp(){return rp(jp).scale(249.5).clipAngle(90.000001)}function Bp(t,e){var n=al(e),i=1+al(t)*n;return[n*dl(t)/i,dl(e)/i]}function Up(){return rp(Bp).scale(250).clipAngle(142)}function Wp(t,e){return[hl(ml((Ku+e)/2)),-t]}function Gp(){var t=bp(Wp),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)}function Yp(t,e){return t.parent===e.parent?1:2}function Hp(t,e){return t+e.x}function Xp(t,e){return Math.max(t,e.y)}function Zp(){var t=Yp,e=1,n=1,i=!1;function s(s){var r,o=0;s.eachAfter((function(e){var n=e.children;n?(e.x=function(t){return t.reduce(Hp,0)/t.length}(n),e.y=function(t){return 1+t.reduce(Xp,0)}(n)):(e.x=r?o+=t(e,r):0,e.y=0,r=e)}));var a=function(t){for(var e;e=t.children;)t=e[0];return t}(s),c=function(t){for(var e;e=t.children;)t=e[e.length-1];return t}(s),u=a.x-t(a,c)/2,l=c.x+t(c,a)/2;return s.eachAfter(i?function(t){t.x=(t.x-s.x)*e,t.y=(s.y-t.y)*n}:function(t){t.x=(t.x-u)/(l-u)*e,t.y=(1-(s.y?t.y/s.y:1))*n})}return s.separation=function(e){return arguments.length?(t=e,s):t},s.size=function(t){return arguments.length?(i=!1,e=+t[0],n=+t[1],s):i?null:[e,n]},s.nodeSize=function(t){return arguments.length?(i=!0,e=+t[0],n=+t[1],s):i?[e,n]:null},s}function $p(t){var e=0,n=t.children,i=n&&n.length;if(i)for(;--i>=0;)e+=n[i].value;else e=1;t.value=e}function Qp(t,e){t instanceof Map?(t=[void 0,t],void 0===e&&(e=Kp)):void 0===e&&(e=Jp);for(var n,i,s,r,o,a=new n_(t),c=[a];n=c.pop();)if((s=e(n.data))&&(o=(s=Array.from(s)).length))for(n.children=s,r=o-1;r>=0;--r)c.push(i=s[r]=new n_(s[r])),i.parent=n,i.depth=n.depth+1;return a.eachBefore(e_)}function Jp(t){return t.children}function Kp(t){return Array.isArray(t)?t[1]:null}function t_(t){void 0!==t.data.value&&(t.value=t.data.value),t.data=t.data.data}function e_(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function n_(t){this.data=t,this.depth=this.height=0,this.parent=null}function i_(t){for(var e,n,i=0,s=(t=function(t){for(var e,n,i=t.length;i;)n=Math.random()*i--|0,e=t[i],t[i]=t[n],t[n]=e;return t}(Array.from(t))).length,r=[];i<s;)e=t[i],n&&o_(n,e)?++i:(n=c_(r=s_(r,e)),i=0);return n}function s_(t,e){var n,i;if(a_(e,t))return[e];for(n=0;n<t.length;++n)if(r_(e,t[n])&&a_(u_(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(i=n+1;i<t.length;++i)if(r_(u_(t[n],t[i]),e)&&r_(u_(t[n],e),t[i])&&r_(u_(t[i],e),t[n])&&a_(l_(t[n],t[i],e),t))return[t[n],t[i],e];throw new Error}function r_(t,e){var n=t.r-e.r,i=e.x-t.x,s=e.y-t.y;return n<0||n*n<i*i+s*s}function o_(t,e){var n=t.r-e.r+1e-9*Math.max(t.r,e.r,1),i=e.x-t.x,s=e.y-t.y;return n>0&&n*n>i*i+s*s}function a_(t,e){for(var n=0;n<e.length;++n)if(!o_(t,e[n]))return!1;return!0}function c_(t){switch(t.length){case 1:return{x:(e=t[0]).x,y:e.y,r:e.r};case 2:return u_(t[0],t[1]);case 3:return l_(t[0],t[1],t[2])}var e}function u_(t,e){var n=t.x,i=t.y,s=t.r,r=e.x,o=e.y,a=e.r,c=r-n,u=o-i,l=a-s,h=Math.sqrt(c*c+u*u);return{x:(n+r+c/h*l)/2,y:(i+o+u/h*l)/2,r:(h+s+a)/2}}function l_(t,e,n){var i=t.x,s=t.y,r=t.r,o=e.x,a=e.y,c=e.r,u=n.x,l=n.y,h=n.r,f=i-o,d=i-u,p=s-a,_=s-l,m=c-r,g=h-r,v=i*i+s*s-r*r,y=v-o*o-a*a+c*c,b=v-u*u-l*l+h*h,x=d*p-f*_,w=(p*b-_*y)/(2*x)-i,T=(_*m-p*g)/x,M=(d*y-f*b)/(2*x)-s,S=(f*g-d*m)/x,A=T*T+S*S-1,k=2*(r+w*T+M*S),C=w*w+M*M-r*r,D=-(A?(k+Math.sqrt(k*k-4*A*C))/(2*A):C/k);return{x:i+w+T*D,y:s+M+S*D,r:D}}function h_(t,e,n){var i,s,r,o,a=t.x-e.x,c=t.y-e.y,u=a*a+c*c;u?(s=e.r+n.r,s*=s,o=t.r+n.r,s>(o*=o)?(i=(u+o-s)/(2*u),r=Math.sqrt(Math.max(0,o/u-i*i)),n.x=t.x-i*a-r*c,n.y=t.y-i*c+r*a):(i=(u+s-o)/(2*u),r=Math.sqrt(Math.max(0,s/u-i*i)),n.x=e.x+i*a-r*c,n.y=e.y+i*c+r*a)):(n.x=e.x+n.r,n.y=e.y)}function f_(t,e){var n=t.r+e.r-1e-6,i=e.x-t.x,s=e.y-t.y;return n>0&&n*n>i*i+s*s}function d_(t){var e=t._,n=t.next._,i=e.r+n.r,s=(e.x*n.r+n.x*e.r)/i,r=(e.y*n.r+n.y*e.r)/i;return s*s+r*r}function p_(t){this._=t,this.next=null,this.previous=null}function __(t){if(!(r=(e=t,t="object"==typeof e&&"length"in e?e:Array.from(e)).length))return 0;var e,n,i,s,r,o,a,c,u,l,h,f;if((n=t[0]).x=0,n.y=0,!(r>1))return n.r;if(i=t[1],n.x=-i.r,i.x=n.r,i.y=0,!(r>2))return n.r+i.r;h_(i,n,s=t[2]),n=new p_(n),i=new p_(i),s=new p_(s),n.next=s.previous=i,i.next=n.previous=s,s.next=i.previous=n;t:for(c=3;c<r;++c){h_(n._,i._,s=t[c]),s=new p_(s),u=i.next,l=n.previous,h=i._.r,f=n._.r;do{if(h<=f){if(f_(u._,s._)){i=u,n.next=i,i.previous=n,--c;continue t}h+=u._.r,u=u.next}else{if(f_(l._,s._)){(n=l).next=i,i.previous=n,--c;continue t}f+=l._.r,l=l.previous}}while(u!==l.next);for(s.previous=n,s.next=i,n.next=i.previous=i=s,o=d_(n);(s=s.next)!==i;)(a=d_(s))<o&&(n=s,o=a);i=n.next}for(n=[i._],s=i;(s=s.next)!==i;)n.push(s._);for(s=i_(n),c=0;c<r;++c)(n=t[c]).x-=s.x,n.y-=s.y;return s.r}function m_(t){return __(t),t}function g_(t){return null==t?null:v_(t)}function v_(t){if("function"!=typeof t)throw new Error;return t}function y_(){return 0}function b_(t){return function(){return t}}function x_(t){return Math.sqrt(t.value)}function w_(){var t=null,e=1,n=1,i=y_;function s(s){return s.x=e/2,s.y=n/2,t?s.eachBefore(T_(t)).eachAfter(M_(i,.5)).eachBefore(S_(1)):s.eachBefore(T_(x_)).eachAfter(M_(y_,1)).eachAfter(M_(i,s.r/Math.min(e,n))).eachBefore(S_(Math.min(e,n)/(2*s.r))),s}return s.radius=function(e){return arguments.length?(t=g_(e),s):t},s.size=function(t){return arguments.length?(e=+t[0],n=+t[1],s):[e,n]},s.padding=function(t){return arguments.length?(i="function"==typeof t?t:b_(+t),s):i},s}function T_(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function M_(t,e){return function(n){if(i=n.children){var i,s,r,o=i.length,a=t(n)*e||0;if(a)for(s=0;s<o;++s)i[s].r+=a;if(r=__(i),a)for(s=0;s<o;++s)i[s].r-=a;n.r=r+a}}}function S_(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}function A_(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function k_(t,e,n,i,s){for(var r,o=t.children,a=-1,c=o.length,u=t.value&&(i-e)/t.value;++a<c;)(r=o[a]).y0=n,r.y1=s,r.x0=e,r.x1=e+=r.value*u}function C_(){var t=1,e=1,n=0,i=!1;function s(s){var r=s.height+1;return s.x0=s.y0=n,s.x1=t,s.y1=e/r,s.eachBefore(function(t,e){return function(i){i.children&&k_(i,i.x0,t*(i.depth+1)/e,i.x1,t*(i.depth+2)/e);var s=i.x0,r=i.y0,o=i.x1-n,a=i.y1-n;o<s&&(s=o=(s+o)/2),a<r&&(r=a=(r+a)/2),i.x0=s,i.y0=r,i.x1=o,i.y1=a}}(e,r)),i&&s.eachBefore(A_),s}return s.round=function(t){return arguments.length?(i=!!t,s):i},s.size=function(n){return arguments.length?(t=+n[0],e=+n[1],s):[t,e]},s.padding=function(t){return arguments.length?(n=+t,s):n},s}qp.invert=function(t,e){for(var n,i=e,s=i*i,r=s*s*s,o=0;o<12&&(r=(s=(i-=n=(i*(Cp+Dp*s+r*(Ep+Op*s))-e)/(Cp+3*Dp*s+r*(7*Ep+9*Op*s)))*i)*s*s,!(sl(n)<Qu));++o);return[Rp*t*(Cp+3*Dp*s+r*(7*Ep+9*Op*s))/al(i),vl(dl(i)/Rp)]},Fp.invert=dp(rl),Vp.invert=function(t,e){var n,i=e,s=25;do{var r=i*i,o=r*r;i-=n=(i*(1.007226+r*(.015085+o*(.028874*r-.044475-.005916*o)))-e)/(1.007226+r*(.045255+o*(.259866*r-.311325-.005916*11*o)))}while(sl(n)>$u&&--s>0);return[t/(.8707+(r=i*i)*(r*(r*r*r*(.003971-.001529*r)-.013791)-.131979)),i]},jp.invert=dp(vl),Bp.invert=dp((function(t){return 2*rl(t)})),Wp.invert=function(t,e){return[-e,2*rl(ul(t))-Ku]},n_.prototype=Qp.prototype={constructor:n_,count:function(){return this.eachAfter($p)},each:function(t,e){let n=-1;for(const i of this)t.call(e,i,++n,this);return this},eachAfter:function(t,e){for(var n,i,s,r=this,o=[r],a=[],c=-1;r=o.pop();)if(a.push(r),n=r.children)for(i=0,s=n.length;i<s;++i)o.push(n[i]);for(;r=a.pop();)t.call(e,r,++c,this);return this},eachBefore:function(t,e){for(var n,i,s=this,r=[s],o=-1;s=r.pop();)if(t.call(e,s,++o,this),n=s.children)for(i=n.length-1;i>=0;--i)r.push(n[i]);return this},find:function(t,e){let n=-1;for(const i of this)if(t.call(e,i,++n,this))return i},sum:function(t){return this.eachAfter((function(e){for(var n=+t(e.data)||0,i=e.children,s=i&&i.length;--s>=0;)n+=i[s].value;e.value=n}))},sort:function(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),i=e.ancestors(),s=null;for(t=n.pop(),e=i.pop();t===e;)s=t,t=n.pop(),e=i.pop();return s}(e,t),i=[e];e!==n;)e=e.parent,i.push(e);for(var s=i.length;t!==n;)i.splice(s,0,t),t=t.parent;return i},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){return Array.from(this)},leaves:function(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t},links:function(){var t=this,e=[];return t.each((function(n){n!==t&&e.push({source:n.parent,target:n})})),e},copy:function(){return Qp(this).eachBefore(t_)},[Symbol.iterator]:function*(){var t,e,n,i,s=this,r=[s];do{for(t=r.reverse(),r=[];s=t.pop();)if(yield s,e=s.children)for(n=0,i=e.length;n<i;++n)r.push(e[n])}while(r.length)}};var D_={depth:-1},E_={},O_={};function R_(t){return t.id}function q_(t){return t.parentId}function N_(){var t,e=R_,n=q_;function i(i){var s,r,o,a,c,u,l,h,f=Array.from(i),d=e,p=n,_=new Map;if(null!=t){const e=f.map(((e,n)=>function(t){let e=(t=`${t}`).length;return I_(t,e-1)&&!I_(t,e-2)&&(t=t.slice(0,-1)),"/"===t[0]?t:`/${t}`}(t(e,n,i)))),n=e.map(F_),s=new Set(e).add("");for(const t of n)s.has(t)||(s.add(t),e.push(t),n.push(F_(t)),f.push(O_));d=(t,n)=>e[n],p=(t,e)=>n[e]}for(o=0,s=f.length;o<s;++o)r=f[o],u=f[o]=new n_(r),null!=(l=d(r,o,i))&&(l+="")&&(h=u.id=l,_.set(h,_.has(h)?E_:u)),null!=(l=p(r,o,i))&&(l+="")&&(u.parent=l);for(o=0;o<s;++o)if(l=(u=f[o]).parent){if(!(c=_.get(l)))throw new Error("missing: "+l);if(c===E_)throw new Error("ambiguous: "+l);c.children?c.children.push(u):c.children=[u],u.parent=c}else{if(a)throw new Error("multiple roots");a=u}if(!a)throw new Error("no root");if(null!=t){for(;a.data===O_&&1===a.children.length;)a=a.children[0],--s;for(let t=f.length-1;t>=0&&(u=f[t],u.data===O_);--t)u.data=null}if(a.parent=D_,a.eachBefore((function(t){t.depth=t.parent.depth+1,--s})).eachBefore(e_),a.parent=null,s>0)throw new Error("cycle");return a}return i.id=function(t){return arguments.length?(e=g_(t),i):e},i.parentId=function(t){return arguments.length?(n=g_(t),i):n},i.path=function(e){return arguments.length?(t=g_(e),i):t},i}function F_(t){let e=t.length;if(e<2)return"";for(;--e>1&&!I_(t,e););return t.slice(0,e)}function I_(t,e){if("/"===t[e]){let n=0;for(;e>0&&"\\"===t[--e];)++n;if(0==(1&n))return!0}return!1}function P_(t,e){return t.parent===e.parent?1:2}function V_(t){var e=t.children;return e?e[0]:t.t}function z_(t){var e=t.children;return e?e[e.length-1]:t.t}function j_(t,e,n){var i=n/(e.i-t.i);e.c-=i,e.s+=n,t.c+=i,e.z+=n,e.m+=n}function L_(t,e,n){return t.a.parent===e.parent?t.a:n}function B_(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}function U_(){var t=P_,e=1,n=1,i=null;function s(s){var c=function(t){for(var e,n,i,s,r,o=new B_(t,0),a=[o];e=a.pop();)if(i=e._.children)for(e.children=new Array(r=i.length),s=r-1;s>=0;--s)a.push(n=e.children[s]=new B_(i[s],s)),n.parent=e;return(o.parent=new B_(null,0)).children=[o],o}(s);if(c.eachAfter(r),c.parent.m=-c.z,c.eachBefore(o),i)s.eachBefore(a);else{var u=s,l=s,h=s;s.eachBefore((function(t){t.x<u.x&&(u=t),t.x>l.x&&(l=t),t.depth>h.depth&&(h=t)}));var f=u===l?1:t(u,l)/2,d=f-u.x,p=e/(l.x+f+d),_=n/(h.depth||1);s.eachBefore((function(t){t.x=(t.x+d)*p,t.y=t.depth*_}))}return s}function r(e){var n=e.children,i=e.parent.children,s=e.i?i[e.i-1]:null;if(n){!function(t){for(var e,n=0,i=0,s=t.children,r=s.length;--r>=0;)(e=s[r]).z+=n,e.m+=n,n+=e.s+(i+=e.c)}(e);var r=(n[0].z+n[n.length-1].z)/2;s?(e.z=s.z+t(e._,s._),e.m=e.z-r):e.z=r}else s&&(e.z=s.z+t(e._,s._));e.parent.A=function(e,n,i){if(n){for(var s,r=e,o=e,a=n,c=r.parent.children[0],u=r.m,l=o.m,h=a.m,f=c.m;a=z_(a),r=V_(r),a&&r;)c=V_(c),(o=z_(o)).a=e,(s=a.z+h-r.z-u+t(a._,r._))>0&&(j_(L_(a,e,i),e,s),u+=s,l+=s),h+=a.m,u+=r.m,f+=c.m,l+=o.m;a&&!z_(o)&&(o.t=a,o.m+=h-l),r&&!V_(c)&&(c.t=r,c.m+=u-f,i=e)}return i}(e,s,e.parent.A||i[0])}function o(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function a(t){t.x*=e,t.y=t.depth*n}return s.separation=function(e){return arguments.length?(t=e,s):t},s.size=function(t){return arguments.length?(i=!1,e=+t[0],n=+t[1],s):i?null:[e,n]},s.nodeSize=function(t){return arguments.length?(i=!0,e=+t[0],n=+t[1],s):i?[e,n]:null},s}function W_(t,e,n,i,s){for(var r,o=t.children,a=-1,c=o.length,u=t.value&&(s-n)/t.value;++a<c;)(r=o[a]).x0=e,r.x1=i,r.y0=n,r.y1=n+=r.value*u}B_.prototype=Object.create(n_.prototype);var G_=(1+Math.sqrt(5))/2;function Y_(t,e,n,i,s,r){for(var o,a,c,u,l,h,f,d,p,_,m,g=[],v=e.children,y=0,b=0,x=v.length,w=e.value;y<x;){c=s-n,u=r-i;do{l=v[b++].value}while(!l&&b<x);for(h=f=l,m=l*l*(_=Math.max(u/c,c/u)/(w*t)),p=Math.max(f/m,m/h);b<x;++b){if(l+=a=v[b].value,a<h&&(h=a),a>f&&(f=a),m=l*l*_,(d=Math.max(f/m,m/h))>p){l-=a;break}p=d}g.push(o={value:l,dice:c<u,children:v.slice(y,b)}),o.dice?k_(o,n,i,s,w?i+=u*l/w:r):W_(o,n,i,w?n+=c*l/w:s,r),w-=l,y=b}return g}const H_=function t(e){function n(t,n,i,s,r){Y_(e,t,n,i,s,r)}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(G_);function X_(){var t=H_,e=!1,n=1,i=1,s=[0],r=y_,o=y_,a=y_,c=y_,u=y_;function l(t){return t.x0=t.y0=0,t.x1=n,t.y1=i,t.eachBefore(h),s=[0],e&&t.eachBefore(A_),t}function h(e){var n=s[e.depth],i=e.x0+n,l=e.y0+n,h=e.x1-n,f=e.y1-n;h<i&&(i=h=(i+h)/2),f<l&&(l=f=(l+f)/2),e.x0=i,e.y0=l,e.x1=h,e.y1=f,e.children&&(n=s[e.depth+1]=r(e)/2,i+=u(e)-n,l+=o(e)-n,(h-=a(e)-n)<i&&(i=h=(i+h)/2),(f-=c(e)-n)<l&&(l=f=(l+f)/2),t(e,i,l,h,f))}return l.round=function(t){return arguments.length?(e=!!t,l):e},l.size=function(t){return arguments.length?(n=+t[0],i=+t[1],l):[n,i]},l.tile=function(e){return arguments.length?(t=v_(e),l):t},l.padding=function(t){return arguments.length?l.paddingInner(t).paddingOuter(t):l.paddingInner()},l.paddingInner=function(t){return arguments.length?(r="function"==typeof t?t:b_(+t),l):r},l.paddingOuter=function(t){return arguments.length?l.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):l.paddingTop()},l.paddingTop=function(t){return arguments.length?(o="function"==typeof t?t:b_(+t),l):o},l.paddingRight=function(t){return arguments.length?(a="function"==typeof t?t:b_(+t),l):a},l.paddingBottom=function(t){return arguments.length?(c="function"==typeof t?t:b_(+t),l):c},l.paddingLeft=function(t){return arguments.length?(u="function"==typeof t?t:b_(+t),l):u},l}function Z_(t,e,n,i,s){var r,o,a=t.children,c=a.length,u=new Array(c+1);for(u[0]=o=r=0;r<c;++r)u[r+1]=o+=a[r].value;!function t(e,n,i,s,r,o,c){if(e>=n-1){var l=a[e];return l.x0=s,l.y0=r,l.x1=o,void(l.y1=c)}for(var h=u[e],f=i/2+h,d=e+1,p=n-1;d<p;){var _=d+p>>>1;u[_]<f?d=_+1:p=_}f-u[d-1]<u[d]-f&&e+1<d&&--d;var m=u[d]-h,g=i-m;if(o-s>c-r){var v=i?(s*g+o*m)/i:o;t(e,d,m,s,r,v,c),t(d,n,g,v,r,o,c)}else{var y=i?(r*g+c*m)/i:c;t(e,d,m,s,r,o,y),t(d,n,g,s,y,o,c)}}(0,c,t.value,e,n,i,s)}function $_(t,e,n,i,s){(1&t.depth?W_:k_)(t,e,n,i,s)}const Q_=function t(e){function n(t,n,i,s,r){if((o=t._squarify)&&o.ratio===e)for(var o,a,c,u,l,h=-1,f=o.length,d=t.value;++h<f;){for(c=(a=o[h]).children,u=a.value=0,l=c.length;u<l;++u)a.value+=c[u].value;a.dice?k_(a,n,i,s,d?i+=(r-i)*a.value/d:r):W_(a,n,i,d?n+=(s-n)*a.value/d:s,r),d-=a.value}else t._squarify=o=Y_(e,t,n,i,s,r),o.ratio=e}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(G_);function J_(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}function K_(t,e){var n=yi(+t,+e);return function(t){var e=n(t);return e-360*Math.floor(e/360)}}function tm(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function em(t){return((t=Math.exp(t))+1/t)/2}const nm=function t(e,n,i){function s(t,s){var r,o,a=t[0],c=t[1],u=t[2],l=s[0],h=s[1],f=s[2],d=l-a,p=h-c,_=d*d+p*p;if(_<1e-12)o=Math.log(f/u)/e,r=function(t){return[a+t*d,c+t*p,u*Math.exp(e*t*o)]};else{var m=Math.sqrt(_),g=(f*f-u*u+i*_)/(2*u*n*m),v=(f*f-u*u-i*_)/(2*f*n*m),y=Math.log(Math.sqrt(g*g+1)-g),b=Math.log(Math.sqrt(v*v+1)-v);o=(b-y)/e,r=function(t){var i,s=t*o,r=em(y),l=u/(n*m)*(r*(i=e*s+y,((i=Math.exp(2*i))-1)/(i+1))-function(t){return((t=Math.exp(t))-1/t)/2}(y));return[a+l*d,c+l*p,u*r/em(e*s+y)]}}return r.duration=1e3*o*e/Math.SQRT2,r}return s.rho=function(e){var n=Math.max(.001,+e),i=n*n;return t(n,i,i*i)},s}(Math.SQRT2,2,4);function im(t){return function(e,n){var i=t((e=hi(e)).h,(n=hi(n)).h),s=bi(e.s,n.s),r=bi(e.l,n.l),o=bi(e.opacity,n.opacity);return function(t){return e.h=i(t),e.s=s(t),e.l=r(t),e.opacity=o(t),e+""}}}const sm=im(yi);var rm=im(bi);function om(t,e){var n=bi((t=wo(t)).l,(e=wo(e)).l),i=bi(t.a,e.a),s=bi(t.b,e.b),r=bi(t.opacity,e.opacity);return function(e){return t.l=n(e),t.a=i(e),t.b=s(e),t.opacity=r(e),t+""}}function am(t){return function(e,n){var i=t((e=Eo(e)).h,(n=Eo(n)).h),s=bi(e.c,n.c),r=bi(e.l,n.l),o=bi(e.opacity,n.opacity);return function(t){return e.h=i(t),e.c=s(t),e.l=r(t),e.opacity=o(t),e+""}}}const cm=am(yi);var um=am(bi);function lm(t){return function e(n){function i(e,i){var s=t((e=Bo(e)).h,(i=Bo(i)).h),r=bi(e.s,i.s),o=bi(e.l,i.l),a=bi(e.opacity,i.opacity);return function(t){return e.h=s(t),e.s=r(t),e.l=o(Math.pow(t,n)),e.opacity=a(t),e+""}}return n=+n,i.gamma=e,i}(1)}const hm=lm(yi);var fm=lm(bi);function dm(t,e){void 0===e&&(e=t,t=Fi);for(var n=0,i=e.length-1,s=e[0],r=new Array(i<0?0:i);n<i;)r[n]=t(s,s=e[++n]);return function(t){var e=Math.max(0,Math.min(i-1,Math.floor(t*=i)));return r[e](t-e)}}function pm(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t(i/(e-1));return n}function _m(t){for(var e,n=-1,i=t.length,s=t[i-1],r=0;++n<i;)e=s,s=t[n],r+=e[1]*s[0]-e[0]*s[1];return r/2}function mm(t){for(var e,n,i=-1,s=t.length,r=0,o=0,a=t[s-1],c=0;++i<s;)e=a,a=t[i],c+=n=e[0]*a[1]-a[0]*e[1],r+=(e[0]+a[0])*n,o+=(e[1]+a[1])*n;return[r/(c*=3),o/c]}function gm(t,e){return t[0]-e[0]||t[1]-e[1]}function vm(t){const e=t.length,n=[0,1];let i,s=2;for(i=2;i<e;++i){for(;s>1&&(r=t[n[s-2]],o=t[n[s-1]],a=t[i],(o[0]-r[0])*(a[1]-r[1])-(o[1]-r[1])*(a[0]-r[0])<=0);)--s;n[s++]=i}var r,o,a;return n.slice(0,s)}function ym(t){if((n=t.length)<3)return null;var e,n,i=new Array(n),s=new Array(n);for(e=0;e<n;++e)i[e]=[+t[e][0],+t[e][1],e];for(i.sort(gm),e=0;e<n;++e)s[e]=[i[e][0],-i[e][1]];var r=vm(i),o=vm(s),a=o[0]===r[0],c=o[o.length-1]===r[r.length-1],u=[];for(e=r.length-1;e>=0;--e)u.push(t[i[r[e]][2]]);for(e=+a;e<o.length-c;++e)u.push(t[i[o[e]][2]]);return u}function bm(t,e){for(var n,i,s=t.length,r=t[s-1],o=e[0],a=e[1],c=r[0],u=r[1],l=!1,h=0;h<s;++h)n=(r=t[h])[0],(i=r[1])>a!=u>a&&o<(c-n)*(a-i)/(u-i)+n&&(l=!l),c=n,u=i;return l}function xm(t){for(var e,n,i=-1,s=t.length,r=t[s-1],o=r[0],a=r[1],c=0;++i<s;)e=o,n=a,e-=o=(r=t[i])[0],n-=a=r[1],c+=Math.hypot(e,n);return c}const wm=Math.random,Tm=function t(e){function n(t,n){return t=null==t?0:+t,n=null==n?1:+n,1===arguments.length?(n=t,t=0):n-=t,function(){return e()*n+t}}return n.source=t,n}(wm),Mm=function t(e){function n(t,n){return arguments.length<2&&(n=t,t=0),t=Math.floor(t),n=Math.floor(n)-t,function(){return Math.floor(e()*n+t)}}return n.source=t,n}(wm),Sm=function t(e){function n(t,n){var i,s;return t=null==t?0:+t,n=null==n?1:+n,function(){var r;if(null!=i)r=i,i=null;else do{i=2*e()-1,r=2*e()-1,s=i*i+r*r}while(!s||s>1);return t+n*r*Math.sqrt(-2*Math.log(s)/s)}}return n.source=t,n}(wm),Am=function t(e){var n=Sm.source(e);function i(){var t=n.apply(this,arguments);return function(){return Math.exp(t())}}return i.source=t,i}(wm),km=function t(e){function n(t){return(t=+t)<=0?()=>0:function(){for(var n=0,i=t;i>1;--i)n+=e();return n+i*e()}}return n.source=t,n}(wm),Cm=function t(e){var n=km.source(e);function i(t){if(0==(t=+t))return e;var i=n(t);return function(){return i()/t}}return i.source=t,i}(wm),Dm=function t(e){function n(t){return function(){return-Math.log1p(-e())/t}}return n.source=t,n}(wm),Em=function t(e){function n(t){if((t=+t)<0)throw new RangeError("invalid alpha");return t=1/-t,function(){return Math.pow(1-e(),t)}}return n.source=t,n}(wm),Om=function t(e){function n(t){if((t=+t)<0||t>1)throw new RangeError("invalid p");return function(){return Math.floor(e()+t)}}return n.source=t,n}(wm),Rm=function t(e){function n(t){if((t=+t)<0||t>1)throw new RangeError("invalid p");return 0===t?()=>1/0:1===t?()=>1:(t=Math.log1p(-t),function(){return 1+Math.floor(Math.log1p(-e())/t)})}return n.source=t,n}(wm),qm=function t(e){var n=Sm.source(e)();function i(t,i){if((t=+t)<0)throw new RangeError("invalid k");if(0===t)return()=>0;if(i=null==i?1:+i,1===t)return()=>-Math.log1p(-e())*i;var s=(t<1?t+1:t)-1/3,r=1/(3*Math.sqrt(s)),o=t<1?()=>Math.pow(e(),1/t):()=>1;return function(){do{do{var t=n(),a=1+r*t}while(a<=0);a*=a*a;var c=1-e()}while(c>=1-.0331*t*t*t*t&&Math.log(c)>=.5*t*t+s*(1-a+Math.log(a)));return s*a*o()*i}}return i.source=t,i}(wm),Nm=function t(e){var n=qm.source(e);function i(t,e){var i=n(t),s=n(e);return function(){var t=i();return 0===t?0:t/(t+s())}}return i.source=t,i}(wm),Fm=function t(e){var n=Rm.source(e),i=Nm.source(e);function s(t,e){return t=+t,(e=+e)>=1?()=>t:e<=0?()=>0:function(){for(var s=0,r=t,o=e;r*o>16&&r*(1-o)>16;){var a=Math.floor((r+1)*o),c=i(a,r-a+1)();c<=o?(s+=a,r-=a,o=(o-c)/(1-c)):(r=a-1,o/=c)}for(var u=o<.5,l=n(u?o:1-o),h=l(),f=0;h<=r;++f)h+=l();return s+(u?f:r-f)}}return s.source=t,s}(wm),Im=function t(e){function n(t,n,i){var s;return 0==(t=+t)?s=t=>-Math.log(t):(t=1/t,s=e=>Math.pow(e,t)),n=null==n?0:+n,i=null==i?1:+i,function(){return n+i*s(-Math.log1p(-e()))}}return n.source=t,n}(wm),Pm=function t(e){function n(t,n){return t=null==t?0:+t,n=null==n?1:+n,function(){return t+n*Math.tan(Math.PI*e())}}return n.source=t,n}(wm),Vm=function t(e){function n(t,n){return t=null==t?0:+t,n=null==n?1:+n,function(){var i=e();return t+n*Math.log(i/(1-i))}}return n.source=t,n}(wm),zm=function t(e){var n=qm.source(e),i=Fm.source(e);function s(t){return function(){for(var s=0,r=t;r>16;){var o=Math.floor(.875*r),a=n(o)();if(a>r)return s+i(o-1,r/a)();s+=o,r-=a}for(var c=-Math.log1p(-e()),u=0;c<=r;++u)c-=Math.log1p(-e());return s+u}}return s.source=t,s}(wm),jm=1/4294967296;function Lm(t=Math.random()){let e=0|(0<=t&&t<1?t/jm:Math.abs(t));return()=>(e=1664525*e+1013904223|0,jm*(e>>>0))}function Bm(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function Um(t,e){switch(arguments.length){case 0:break;case 1:"function"==typeof t?this.interpolator(t):this.range(t);break;default:this.domain(t),"function"==typeof e?this.interpolator(e):this.range(e)}return this}const Wm=Symbol("implicit");function Gm(){var t=new M,e=[],n=[],i=Wm;function s(s){let r=t.get(s);if(void 0===r){if(i!==Wm)return i;t.set(s,r=e.push(s)-1)}return n[r%n.length]}return s.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new M;for(const i of n)t.has(i)||t.set(i,e.push(i)-1);return s},s.range=function(t){return arguments.length?(n=Array.from(t),s):n.slice()},s.unknown=function(t){return arguments.length?(i=t,s):i},s.copy=function(){return Gm(e,n).unknown(i)},Bm.apply(s,arguments),s}function Ym(){var t,e,n=Gm().unknown(void 0),i=n.domain,s=n.range,r=0,o=1,a=!1,c=0,u=0,l=.5;function h(){var n=i().length,h=o<r,f=h?o:r,d=h?r:o;t=(d-f)/Math.max(1,n-c+2*u),a&&(t=Math.floor(t)),f+=(d-f-t*(n-c))*l,e=t*(1-c),a&&(f=Math.round(f),e=Math.round(e));var p=xt(n).map((function(e){return f+t*e}));return s(h?p.reverse():p)}return delete n.unknown,n.domain=function(t){return arguments.length?(i(t),h()):i()},n.range=function(t){return arguments.length?([r,o]=t,r=+r,o=+o,h()):[r,o]},n.rangeRound=function(t){return[r,o]=t,r=+r,o=+o,a=!0,h()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(a=!!t,h()):a},n.padding=function(t){return arguments.length?(c=Math.min(1,u=+t),h()):c},n.paddingInner=function(t){return arguments.length?(c=Math.min(1,t),h()):c},n.paddingOuter=function(t){return arguments.length?(u=+t,h()):u},n.align=function(t){return arguments.length?(l=Math.max(0,Math.min(1,t)),h()):l},n.copy=function(){return Ym(i(),[r,o]).round(a).paddingInner(c).paddingOuter(u).align(l)},Bm.apply(h(),arguments)}function Hm(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return Hm(e())},t}function Xm(){return Hm(Ym.apply(null,arguments).paddingInner(1))}function Zm(t){return+t}var $m=[0,1];function Qm(t){return t}function Jm(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function Km(t,e,n){var i=t[0],s=t[1],r=e[0],o=e[1];return s<i?(i=Jm(s,i),r=n(o,r)):(i=Jm(i,s),r=n(r,o)),function(t){return r(i(t))}}function tg(t,e,n){var i=Math.min(t.length,e.length)-1,s=new Array(i),r=new Array(i),o=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<i;)s[o]=Jm(t[o],t[o+1]),r[o]=n(e[o],e[o+1]);return function(e){var n=l(t,e,1,i)-1;return r[n](s[n](e))}}function eg(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function ng(){var t,e,n,i,s,r,o=$m,a=$m,c=Fi,u=Qm;function l(){var t,e,n,c=Math.min(o.length,a.length);return u!==Qm&&(t=o[0],e=o[c-1],t>e&&(n=t,t=e,e=n),u=function(n){return Math.max(t,Math.min(e,n))}),i=c>2?tg:Km,s=r=null,h}function h(e){return null==e||isNaN(e=+e)?n:(s||(s=i(o.map(t),a,c)))(t(u(e)))}return h.invert=function(n){return u(e((r||(r=i(a,o.map(t),Ei)))(n)))},h.domain=function(t){return arguments.length?(o=Array.from(t,Zm),l()):o.slice()},h.range=function(t){return arguments.length?(a=Array.from(t),l()):a.slice()},h.rangeRound=function(t){return a=Array.from(t),c=tm,l()},h.clamp=function(t){return arguments.length?(u=!!t||Qm,l()):u!==Qm},h.interpolate=function(t){return arguments.length?(c=t,l()):c},h.unknown=function(t){return arguments.length?(n=t,h):n},function(n,i){return t=n,e=i,l()}}function ig(){return ng()(Qm,Qm)}function sg(t,e,n,i){var s,r=et(t,e,n);switch((i=Fu(null==i?",f":i)).type){case"s":var o=Math.max(Math.abs(t),Math.abs(e));return null!=i.precision||isNaN(s=Xu(r,o))||(i.precision=s),Bu(i,o);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN(s=Zu(r,Math.max(Math.abs(t),Math.abs(e))))||(i.precision=s-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(s=Hu(r))||(i.precision=s-2*("%"===i.type))}return Lu(i)}function rg(t){var e=t.domain;return t.ticks=function(t){var n=e();return K(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var i=e();return sg(i[0],i[i.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var i,s,r=e(),o=0,a=r.length-1,c=r[o],u=r[a],l=10;for(u<c&&(s=c,c=u,u=s,s=o,o=a,a=s);l-- >0;){if((s=tt(c,u,n))===i)return r[o]=c,r[a]=u,e(r);if(s>0)c=Math.floor(c/s)*s,u=Math.ceil(u/s)*s;else{if(!(s<0))break;c=Math.ceil(c*s)/s,u=Math.floor(u*s)/s}i=s}return t},t}function og(){var t=ig();return t.copy=function(){return eg(t,og())},Bm.apply(t,arguments),rg(t)}function ag(t){var e;function n(t){return null==t||isNaN(t=+t)?e:t}return n.invert=n,n.domain=n.range=function(e){return arguments.length?(t=Array.from(e,Zm),n):t.slice()},n.unknown=function(t){return arguments.length?(e=t,n):e},n.copy=function(){return ag(t).unknown(e)},t=arguments.length?Array.from(t,Zm):[0,1],rg(n)}function cg(t,e){var n,i=0,s=(t=t.slice()).length-1,r=t[i],o=t[s];return o<r&&(n=i,i=s,s=n,n=r,r=o,o=n),t[i]=e.floor(r),t[s]=e.ceil(o),t}function ug(t){return Math.log(t)}function lg(t){return Math.exp(t)}function hg(t){return-Math.log(-t)}function fg(t){return-Math.exp(-t)}function dg(t){return isFinite(t)?+("1e"+t):t<0?0:t}function pg(t){return(e,n)=>-t(-e,n)}function _g(t){const e=t(ug,lg),n=e.domain;let i,s,r=10;function o(){return i=function(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}(r),s=function(t){return 10===t?dg:t===Math.E?Math.exp:e=>Math.pow(t,e)}(r),n()[0]<0?(i=pg(i),s=pg(s),t(hg,fg)):t(ug,lg),e}return e.base=function(t){return arguments.length?(r=+t,o()):r},e.domain=function(t){return arguments.length?(n(t),o()):n()},e.ticks=t=>{const e=n();let o=e[0],a=e[e.length-1];const c=a<o;c&&([o,a]=[a,o]);let u,l,h=i(o),f=i(a);const d=null==t?10:+t;let p=[];if(!(r%1)&&f-h<d){if(h=Math.floor(h),f=Math.ceil(f),o>0){for(;h<=f;++h)for(u=1;u<r;++u)if(l=h<0?u/s(-h):u*s(h),!(l<o)){if(l>a)break;p.push(l)}}else for(;h<=f;++h)for(u=r-1;u>=1;--u)if(l=h>0?u/s(-h):u*s(h),!(l<o)){if(l>a)break;p.push(l)}2*p.length<d&&(p=K(o,a,d))}else p=K(h,f,Math.min(f-h,d)).map(s);return c?p.reverse():p},e.tickFormat=(t,n)=>{if(null==t&&(t=10),null==n&&(n=10===r?"s":","),"function"!=typeof n&&(r%1||null!=(n=Fu(n)).precision||(n.trim=!0),n=Lu(n)),t===1/0)return n;const o=Math.max(1,r*t/e.ticks().length);return t=>{let e=t/s(Math.round(i(t)));return e*r<r-.5&&(e*=r),e<=o?n(t):""}},e.nice=()=>n(cg(n(),{floor:t=>s(Math.floor(i(t))),ceil:t=>s(Math.ceil(i(t)))})),e}function mg(){const t=_g(ng()).domain([1,10]);return t.copy=()=>eg(t,mg()).base(t.base()),Bm.apply(t,arguments),t}function gg(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function vg(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function yg(t){var e=1,n=t(gg(e),vg(e));return n.constant=function(n){return arguments.length?t(gg(e=+n),vg(e)):e},rg(n)}function bg(){var t=yg(ng());return t.copy=function(){return eg(t,bg()).constant(t.constant())},Bm.apply(t,arguments)}function xg(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function wg(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Tg(t){return t<0?-t*t:t*t}function Mg(t){var e=t(Qm,Qm),n=1;function i(){return 1===n?t(Qm,Qm):.5===n?t(wg,Tg):t(xg(n),xg(1/n))}return e.exponent=function(t){return arguments.length?(n=+t,i()):n},rg(e)}function Sg(){var t=Mg(ng());return t.copy=function(){return eg(t,Sg()).exponent(t.exponent())},Bm.apply(t,arguments),t}function Ag(){return Sg.apply(null,arguments).exponent(.5)}function kg(t){return Math.sign(t)*t*t}function Cg(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function Dg(){var t,e=ig(),n=[0,1],i=!1;function s(n){var s=Cg(e(n));return isNaN(s)?t:i?Math.round(s):s}return s.invert=function(t){return e.invert(kg(t))},s.domain=function(t){return arguments.length?(e.domain(t),s):e.domain()},s.range=function(t){return arguments.length?(e.range((n=Array.from(t,Zm)).map(kg)),s):n.slice()},s.rangeRound=function(t){return s.range(t).round(!0)},s.round=function(t){return arguments.length?(i=!!t,s):i},s.clamp=function(t){return arguments.length?(e.clamp(t),s):e.clamp()},s.unknown=function(e){return arguments.length?(t=e,s):t},s.copy=function(){return Dg(e.domain(),n).round(i).clamp(e.clamp()).unknown(t)},Bm.apply(s,arguments),rg(s)}function Eg(){var t,e=[],n=[],s=[];function r(){var t=0,i=Math.max(1,n.length);for(s=new Array(i-1);++t<i;)s[t-1]=lt(e,t/i);return o}function o(e){return null==e||isNaN(e=+e)?t:n[l(s,e)]}return o.invertExtent=function(t){var i=n.indexOf(t);return i<0?[NaN,NaN]:[i>0?s[i-1]:e[0],i<s.length?s[i]:e[e.length-1]]},o.domain=function(t){if(!arguments.length)return e.slice();e=[];for(let n of t)null==n||isNaN(n=+n)||e.push(n);return e.sort(i),r()},o.range=function(t){return arguments.length?(n=Array.from(t),r()):n.slice()},o.unknown=function(e){return arguments.length?(t=e,o):t},o.quantiles=function(){return s.slice()},o.copy=function(){return Eg().domain(e).range(n).unknown(t)},Bm.apply(o,arguments)}function Og(){var t,e=0,n=1,i=1,s=[.5],r=[0,1];function o(e){return null!=e&&e<=e?r[l(s,e,0,i)]:t}function a(){var t=-1;for(s=new Array(i);++t<i;)s[t]=((t+1)*n-(t-i)*e)/(i+1);return o}return o.domain=function(t){return arguments.length?([e,n]=t,e=+e,n=+n,a()):[e,n]},o.range=function(t){return arguments.length?(i=(r=Array.from(t)).length-1,a()):r.slice()},o.invertExtent=function(t){var o=r.indexOf(t);return o<0?[NaN,NaN]:o<1?[e,s[0]]:o>=i?[s[i-1],n]:[s[o-1],s[o]]},o.unknown=function(e){return arguments.length?(t=e,o):o},o.thresholds=function(){return s.slice()},o.copy=function(){return Og().domain([e,n]).range(r).unknown(t)},Bm.apply(rg(o),arguments)}function Rg(){var t,e=[.5],n=[0,1],i=1;function s(s){return null!=s&&s<=s?n[l(e,s,0,i)]:t}return s.domain=function(t){return arguments.length?(e=Array.from(t),i=Math.min(e.length,n.length-1),s):e.slice()},s.range=function(t){return arguments.length?(n=Array.from(t),i=Math.min(e.length,n.length-1),s):n.slice()},s.invertExtent=function(t){var i=n.indexOf(t);return[e[i-1],e[i]]},s.unknown=function(e){return arguments.length?(t=e,s):t},s.copy=function(){return Rg().domain(e).range(n).unknown(t)},Bm.apply(s,arguments)}const qg=1e3,Ng=6e4,Fg=36e5,Ig=864e5,Pg=6048e5,Vg=31536e6;var zg=new Date,jg=new Date;function Lg(t,e,n,i){function s(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return s.floor=function(e){return t(e=new Date(+e)),e},s.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},s.round=function(t){var e=s(t),n=s.ceil(t);return t-e<n-t?e:n},s.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},s.range=function(n,i,r){var o,a=[];if(n=s.ceil(n),r=null==r?1:Math.floor(r),!(n<i&&r>0))return a;do{a.push(o=new Date(+n)),e(n,r),t(n)}while(o<n&&n<i);return a},s.filter=function(n){return Lg((function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),(function(t,i){if(t>=t)if(i<0)for(;++i<=0;)for(;e(t,-1),!n(t););else for(;--i>=0;)for(;e(t,1),!n(t););}))},n&&(s.count=function(e,i){return zg.setTime(+e),jg.setTime(+i),t(zg),t(jg),Math.floor(n(zg,jg))},s.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?s.filter(i?function(e){return i(e)%t==0}:function(e){return s.count(0,e)%t==0}):s:null}),s}var Bg=Lg((function(){}),(function(t,e){t.setTime(+t+e)}),(function(t,e){return e-t}));Bg.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?Lg((function(e){e.setTime(Math.floor(e/t)*t)}),(function(e,n){e.setTime(+e+n*t)}),(function(e,n){return(n-e)/t})):Bg:null};const Ug=Bg;var Wg=Bg.range,Gg=Lg((function(t){t.setTime(t-t.getMilliseconds())}),(function(t,e){t.setTime(+t+e*qg)}),(function(t,e){return(e-t)/qg}),(function(t){return t.getUTCSeconds()}));const Yg=Gg;var Hg=Gg.range,Xg=Lg((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*qg)}),(function(t,e){t.setTime(+t+e*Ng)}),(function(t,e){return(e-t)/Ng}),(function(t){return t.getMinutes()}));const Zg=Xg;var $g=Xg.range,Qg=Lg((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*qg-t.getMinutes()*Ng)}),(function(t,e){t.setTime(+t+e*Fg)}),(function(t,e){return(e-t)/Fg}),(function(t){return t.getHours()}));const Jg=Qg;var Kg=Qg.range,tv=Lg((t=>t.setHours(0,0,0,0)),((t,e)=>t.setDate(t.getDate()+e)),((t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Ng)/Ig),(t=>t.getDate()-1));const ev=tv;var nv=tv.range;function iv(t){return Lg((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+7*e)}),(function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Ng)/Pg}))}var sv=iv(0),rv=iv(1),ov=iv(2),av=iv(3),cv=iv(4),uv=iv(5),lv=iv(6),hv=sv.range,fv=rv.range,dv=ov.range,pv=av.range,_v=cv.range,mv=uv.range,gv=lv.range,vv=Lg((function(t){t.setDate(1),t.setHours(0,0,0,0)}),(function(t,e){t.setMonth(t.getMonth()+e)}),(function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())}),(function(t){return t.getMonth()}));const yv=vv;var bv=vv.range,xv=Lg((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()}));xv.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Lg((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)})):null};const wv=xv;var Tv=xv.range,Mv=Lg((function(t){t.setUTCSeconds(0,0)}),(function(t,e){t.setTime(+t+e*Ng)}),(function(t,e){return(e-t)/Ng}),(function(t){return t.getUTCMinutes()}));const Sv=Mv;var Av=Mv.range,kv=Lg((function(t){t.setUTCMinutes(0,0,0)}),(function(t,e){t.setTime(+t+e*Fg)}),(function(t,e){return(e-t)/Fg}),(function(t){return t.getUTCHours()}));const Cv=kv;var Dv=kv.range,Ev=Lg((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/Ig}),(function(t){return t.getUTCDate()-1}));const Ov=Ev;var Rv=Ev.range;function qv(t){return Lg((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+7*e)}),(function(t,e){return(e-t)/Pg}))}var Nv=qv(0),Fv=qv(1),Iv=qv(2),Pv=qv(3),Vv=qv(4),zv=qv(5),jv=qv(6),Lv=Nv.range,Bv=Fv.range,Uv=Iv.range,Wv=Pv.range,Gv=Vv.range,Yv=zv.range,Hv=jv.range,Xv=Lg((function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCMonth(t.getUTCMonth()+e)}),(function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())}),(function(t){return t.getUTCMonth()}));const Zv=Xv;var $v=Xv.range,Qv=Lg((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()}));Qv.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Lg((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null};const Jv=Qv;var Kv=Qv.range;function ty(t,e,n,i,r,o){const a=[[Yg,1,qg],[Yg,5,5e3],[Yg,15,15e3],[Yg,30,3e4],[o,1,Ng],[o,5,3e5],[o,15,9e5],[o,30,18e5],[r,1,Fg],[r,3,108e5],[r,6,216e5],[r,12,432e5],[i,1,Ig],[i,2,1728e5],[n,1,Pg],[e,1,2592e6],[e,3,7776e6],[t,1,Vg]];function c(e,n,i){const r=Math.abs(n-e)/i,o=s((([,,t])=>t)).right(a,r);if(o===a.length)return t.every(et(e/Vg,n/Vg,i));if(0===o)return Ug.every(Math.max(et(e,n,i),1));const[c,u]=a[r/a[o-1][2]<a[o][2]/r?o-1:o];return c.every(u)}return[function(t,e,n){const i=e<t;i&&([t,e]=[e,t]);const s=n&&"function"==typeof n.range?n:c(t,e,n),r=s?s.range(t,+e+1):[];return i?r.reverse():r},c]}const[ey,ny]=ty(Jv,Zv,Nv,Ov,Cv,Sv),[iy,sy]=ty(wv,yv,sv,ev,Jg,Zg);function ry(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function oy(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function ay(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function cy(t){var e=t.dateTime,n=t.date,i=t.time,s=t.periods,r=t.days,o=t.shortDays,a=t.months,c=t.shortMonths,u=by(s),l=xy(s),h=by(r),f=xy(r),d=by(o),p=xy(o),_=by(a),m=xy(a),g=by(c),v=xy(c),y={a:function(t){return o[t.getDay()]},A:function(t){return r[t.getDay()]},b:function(t){return c[t.getMonth()]},B:function(t){return a[t.getMonth()]},c:null,d:By,e:By,f:Hy,g:sb,G:ob,H:Uy,I:Wy,j:Gy,L:Yy,m:Xy,M:Zy,p:function(t){return s[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:Db,s:Eb,S:$y,u:Qy,U:Jy,V:tb,w:eb,W:nb,x:null,X:null,y:ib,Y:rb,Z:ab,"%":Cb},b={a:function(t){return o[t.getUTCDay()]},A:function(t){return r[t.getUTCDay()]},b:function(t){return c[t.getUTCMonth()]},B:function(t){return a[t.getUTCMonth()]},c:null,d:cb,e:cb,f:db,g:Mb,G:Ab,H:ub,I:lb,j:hb,L:fb,m:pb,M:_b,p:function(t){return s[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:Db,s:Eb,S:mb,u:gb,U:vb,V:bb,w:xb,W:wb,x:null,X:null,y:Tb,Y:Sb,Z:kb,"%":Cb},x={a:function(t,e,n){var i=d.exec(e.slice(n));return i?(t.w=p.get(i[0].toLowerCase()),n+i[0].length):-1},A:function(t,e,n){var i=h.exec(e.slice(n));return i?(t.w=f.get(i[0].toLowerCase()),n+i[0].length):-1},b:function(t,e,n){var i=g.exec(e.slice(n));return i?(t.m=v.get(i[0].toLowerCase()),n+i[0].length):-1},B:function(t,e,n){var i=_.exec(e.slice(n));return i?(t.m=m.get(i[0].toLowerCase()),n+i[0].length):-1},c:function(t,n,i){return M(t,e,n,i)},d:Ry,e:Ry,f:Vy,g:Cy,G:ky,H:Ny,I:Ny,j:qy,L:Py,m:Oy,M:Fy,p:function(t,e,n){var i=u.exec(e.slice(n));return i?(t.p=l.get(i[0].toLowerCase()),n+i[0].length):-1},q:Ey,Q:jy,s:Ly,S:Iy,u:Ty,U:My,V:Sy,w:wy,W:Ay,x:function(t,e,i){return M(t,n,e,i)},X:function(t,e,n){return M(t,i,e,n)},y:Cy,Y:ky,Z:Dy,"%":zy};function w(t,e){return function(n){var i,s,r,o=[],a=-1,c=0,u=t.length;for(n instanceof Date||(n=new Date(+n));++a<u;)37===t.charCodeAt(a)&&(o.push(t.slice(c,a)),null!=(s=py[i=t.charAt(++a)])?i=t.charAt(++a):s="e"===i?" ":"0",(r=e[i])&&(i=r(n,s)),o.push(i),c=a+1);return o.push(t.slice(c,a)),o.join("")}}function T(t,e){return function(n){var i,s,r=ay(1900,void 0,1);if(M(r,t,n+="",0)!=n.length)return null;if("Q"in r)return new Date(r.Q);if("s"in r)return new Date(1e3*r.s+("L"in r?r.L:0));if(e&&!("Z"in r)&&(r.Z=0),"p"in r&&(r.H=r.H%12+12*r.p),void 0===r.m&&(r.m="q"in r?r.q:0),"V"in r){if(r.V<1||r.V>53)return null;"w"in r||(r.w=1),"Z"in r?(s=(i=oy(ay(r.y,0,1))).getUTCDay(),i=s>4||0===s?Fv.ceil(i):Fv(i),i=Ov.offset(i,7*(r.V-1)),r.y=i.getUTCFullYear(),r.m=i.getUTCMonth(),r.d=i.getUTCDate()+(r.w+6)%7):(s=(i=ry(ay(r.y,0,1))).getDay(),i=s>4||0===s?rv.ceil(i):rv(i),i=ev.offset(i,7*(r.V-1)),r.y=i.getFullYear(),r.m=i.getMonth(),r.d=i.getDate()+(r.w+6)%7)}else("W"in r||"U"in r)&&("w"in r||(r.w="u"in r?r.u%7:"W"in r?1:0),s="Z"in r?oy(ay(r.y,0,1)).getUTCDay():ry(ay(r.y,0,1)).getDay(),r.m=0,r.d="W"in r?(r.w+6)%7+7*r.W-(s+5)%7:r.w+7*r.U-(s+6)%7);return"Z"in r?(r.H+=r.Z/100|0,r.M+=r.Z%100,oy(r)):ry(r)}}function M(t,e,n,i){for(var s,r,o=0,a=e.length,c=n.length;o<a;){if(i>=c)return-1;if(37===(s=e.charCodeAt(o++))){if(s=e.charAt(o++),!(r=x[s in py?e.charAt(o++):s])||(i=r(t,n,i))<0)return-1}else if(s!=n.charCodeAt(i++))return-1}return i}return y.x=w(n,y),y.X=w(i,y),y.c=w(e,y),b.x=w(n,b),b.X=w(i,b),b.c=w(e,b),{format:function(t){var e=w(t+="",y);return e.toString=function(){return t},e},parse:function(t){var e=T(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=w(t+="",b);return e.toString=function(){return t},e},utcParse:function(t){var e=T(t+="",!0);return e.toString=function(){return t},e}}}var uy,ly,hy,fy,dy,py={"-":"",_:" ",0:"0"},_y=/^\s*\d+/,my=/^%/,gy=/[\\^$*+?|[\]().{}]/g;function vy(t,e,n){var i=t<0?"-":"",s=(i?-t:t)+"",r=s.length;return i+(r<n?new Array(n-r+1).join(e)+s:s)}function yy(t){return t.replace(gy,"\\$&")}function by(t){return new RegExp("^(?:"+t.map(yy).join("|")+")","i")}function xy(t){return new Map(t.map(((t,e)=>[t.toLowerCase(),e])))}function wy(t,e,n){var i=_y.exec(e.slice(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function Ty(t,e,n){var i=_y.exec(e.slice(n,n+1));return i?(t.u=+i[0],n+i[0].length):-1}function My(t,e,n){var i=_y.exec(e.slice(n,n+2));return i?(t.U=+i[0],n+i[0].length):-1}function Sy(t,e,n){var i=_y.exec(e.slice(n,n+2));return i?(t.V=+i[0],n+i[0].length):-1}function Ay(t,e,n){var i=_y.exec(e.slice(n,n+2));return i?(t.W=+i[0],n+i[0].length):-1}function ky(t,e,n){var i=_y.exec(e.slice(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function Cy(t,e,n){var i=_y.exec(e.slice(n,n+2));return i?(t.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function Dy(t,e,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return i?(t.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function Ey(t,e,n){var i=_y.exec(e.slice(n,n+1));return i?(t.q=3*i[0]-3,n+i[0].length):-1}function Oy(t,e,n){var i=_y.exec(e.slice(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function Ry(t,e,n){var i=_y.exec(e.slice(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function qy(t,e,n){var i=_y.exec(e.slice(n,n+3));return i?(t.m=0,t.d=+i[0],n+i[0].length):-1}function Ny(t,e,n){var i=_y.exec(e.slice(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function Fy(t,e,n){var i=_y.exec(e.slice(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function Iy(t,e,n){var i=_y.exec(e.slice(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function Py(t,e,n){var i=_y.exec(e.slice(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function Vy(t,e,n){var i=_y.exec(e.slice(n,n+6));return i?(t.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function zy(t,e,n){var i=my.exec(e.slice(n,n+1));return i?n+i[0].length:-1}function jy(t,e,n){var i=_y.exec(e.slice(n));return i?(t.Q=+i[0],n+i[0].length):-1}function Ly(t,e,n){var i=_y.exec(e.slice(n));return i?(t.s=+i[0],n+i[0].length):-1}function By(t,e){return vy(t.getDate(),e,2)}function Uy(t,e){return vy(t.getHours(),e,2)}function Wy(t,e){return vy(t.getHours()%12||12,e,2)}function Gy(t,e){return vy(1+ev.count(wv(t),t),e,3)}function Yy(t,e){return vy(t.getMilliseconds(),e,3)}function Hy(t,e){return Yy(t,e)+"000"}function Xy(t,e){return vy(t.getMonth()+1,e,2)}function Zy(t,e){return vy(t.getMinutes(),e,2)}function $y(t,e){return vy(t.getSeconds(),e,2)}function Qy(t){var e=t.getDay();return 0===e?7:e}function Jy(t,e){return vy(sv.count(wv(t)-1,t),e,2)}function Ky(t){var e=t.getDay();return e>=4||0===e?cv(t):cv.ceil(t)}function tb(t,e){return t=Ky(t),vy(cv.count(wv(t),t)+(4===wv(t).getDay()),e,2)}function eb(t){return t.getDay()}function nb(t,e){return vy(rv.count(wv(t)-1,t),e,2)}function ib(t,e){return vy(t.getFullYear()%100,e,2)}function sb(t,e){return vy((t=Ky(t)).getFullYear()%100,e,2)}function rb(t,e){return vy(t.getFullYear()%1e4,e,4)}function ob(t,e){var n=t.getDay();return vy((t=n>=4||0===n?cv(t):cv.ceil(t)).getFullYear()%1e4,e,4)}function ab(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+vy(e/60|0,"0",2)+vy(e%60,"0",2)}function cb(t,e){return vy(t.getUTCDate(),e,2)}function ub(t,e){return vy(t.getUTCHours(),e,2)}function lb(t,e){return vy(t.getUTCHours()%12||12,e,2)}function hb(t,e){return vy(1+Ov.count(Jv(t),t),e,3)}function fb(t,e){return vy(t.getUTCMilliseconds(),e,3)}function db(t,e){return fb(t,e)+"000"}function pb(t,e){return vy(t.getUTCMonth()+1,e,2)}function _b(t,e){return vy(t.getUTCMinutes(),e,2)}function mb(t,e){return vy(t.getUTCSeconds(),e,2)}function gb(t){var e=t.getUTCDay();return 0===e?7:e}function vb(t,e){return vy(Nv.count(Jv(t)-1,t),e,2)}function yb(t){var e=t.getUTCDay();return e>=4||0===e?Vv(t):Vv.ceil(t)}function bb(t,e){return t=yb(t),vy(Vv.count(Jv(t),t)+(4===Jv(t).getUTCDay()),e,2)}function xb(t){return t.getUTCDay()}function wb(t,e){return vy(Fv.count(Jv(t)-1,t),e,2)}function Tb(t,e){return vy(t.getUTCFullYear()%100,e,2)}function Mb(t,e){return vy((t=yb(t)).getUTCFullYear()%100,e,2)}function Sb(t,e){return vy(t.getUTCFullYear()%1e4,e,4)}function Ab(t,e){var n=t.getUTCDay();return vy((t=n>=4||0===n?Vv(t):Vv.ceil(t)).getUTCFullYear()%1e4,e,4)}function kb(){return"+0000"}function Cb(){return"%"}function Db(t){return+t}function Eb(t){return Math.floor(+t/1e3)}function Ob(t){return uy=cy(t),ly=uy.format,hy=uy.parse,fy=uy.utcFormat,dy=uy.utcParse,uy}function Rb(t){return new Date(t)}function qb(t){return t instanceof Date?+t:+new Date(+t)}function Nb(t,e,n,i,s,r,o,a,c,u){var l=ig(),h=l.invert,f=l.domain,d=u(".%L"),p=u(":%S"),_=u("%I:%M"),m=u("%I %p"),g=u("%a %d"),v=u("%b %d"),y=u("%B"),b=u("%Y");function x(t){return(c(t)<t?d:a(t)<t?p:o(t)<t?_:r(t)<t?m:i(t)<t?s(t)<t?g:v:n(t)<t?y:b)(t)}return l.invert=function(t){return new Date(h(t))},l.domain=function(t){return arguments.length?f(Array.from(t,qb)):f().map(Rb)},l.ticks=function(e){var n=f();return t(n[0],n[n.length-1],null==e?10:e)},l.tickFormat=function(t,e){return null==e?x:u(e)},l.nice=function(t){var n=f();return t&&"function"==typeof t.range||(t=e(n[0],n[n.length-1],null==t?10:t)),t?f(cg(n,t)):l},l.copy=function(){return eg(l,Nb(t,e,n,i,s,r,o,a,c,u))},l}function Fb(){return Bm.apply(Nb(iy,sy,wv,yv,sv,ev,Jg,Zg,Yg,ly).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Ib(){return Bm.apply(Nb(ey,ny,Jv,Zv,Nv,Ov,Cv,Sv,Yg,fy).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Pb(){var t,e,n,i,s,r=0,o=1,a=Qm,c=!1;function u(e){return null==e||isNaN(e=+e)?s:a(0===n?.5:(e=(i(e)-t)*n,c?Math.max(0,Math.min(1,e)):e))}function l(t){return function(e){var n,i;return arguments.length?([n,i]=e,a=t(n,i),u):[a(0),a(1)]}}return u.domain=function(s){return arguments.length?([r,o]=s,t=i(r=+r),e=i(o=+o),n=t===e?0:1/(e-t),u):[r,o]},u.clamp=function(t){return arguments.length?(c=!!t,u):c},u.interpolator=function(t){return arguments.length?(a=t,u):a},u.range=l(Fi),u.rangeRound=l(tm),u.unknown=function(t){return arguments.length?(s=t,u):s},function(s){return i=s,t=s(r),e=s(o),n=t===e?0:1/(e-t),u}}function Vb(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function zb(){var t=rg(Pb()(Qm));return t.copy=function(){return Vb(t,zb())},Um.apply(t,arguments)}function jb(){var t=_g(Pb()).domain([1,10]);return t.copy=function(){return Vb(t,jb()).base(t.base())},Um.apply(t,arguments)}function Lb(){var t=yg(Pb());return t.copy=function(){return Vb(t,Lb()).constant(t.constant())},Um.apply(t,arguments)}function Bb(){var t=Mg(Pb());return t.copy=function(){return Vb(t,Bb()).exponent(t.exponent())},Um.apply(t,arguments)}function Ub(){return Bb.apply(null,arguments).exponent(.5)}function Wb(){var t=[],e=Qm;function n(n){if(null!=n&&!isNaN(n=+n))return e((l(t,n,1)-1)/(t.length-1))}return n.domain=function(e){if(!arguments.length)return t.slice();t=[];for(let n of e)null==n||isNaN(n=+n)||t.push(n);return t.sort(i),n},n.interpolator=function(t){return arguments.length?(e=t,n):e},n.range=function(){return t.map(((n,i)=>e(i/(t.length-1))))},n.quantiles=function(e){return Array.from({length:e+1},((n,i)=>ut(t,i/e)))},n.copy=function(){return Wb(e).domain(t)},Um.apply(n,arguments)}function Gb(){var t,e,n,i,s,r,o,a=0,c=.5,u=1,l=1,h=Qm,f=!1;function d(t){return isNaN(t=+t)?o:(t=.5+((t=+r(t))-e)*(l*t<l*e?i:s),h(f?Math.max(0,Math.min(1,t)):t))}function p(t){return function(e){var n,i,s;return arguments.length?([n,i,s]=e,h=dm(t,[n,i,s]),d):[h(0),h(.5),h(1)]}}return d.domain=function(o){return arguments.length?([a,c,u]=o,t=r(a=+a),e=r(c=+c),n=r(u=+u),i=t===e?0:.5/(e-t),s=e===n?0:.5/(n-e),l=e<t?-1:1,d):[a,c,u]},d.clamp=function(t){return arguments.length?(f=!!t,d):f},d.interpolator=function(t){return arguments.length?(h=t,d):h},d.range=p(Fi),d.rangeRound=p(tm),d.unknown=function(t){return arguments.length?(o=t,d):o},function(o){return r=o,t=o(a),e=o(c),n=o(u),i=t===e?0:.5/(e-t),s=e===n?0:.5/(n-e),l=e<t?-1:1,d}}function Yb(){var t=rg(Gb()(Qm));return t.copy=function(){return Vb(t,Yb())},Um.apply(t,arguments)}function Hb(){var t=_g(Gb()).domain([.1,1,10]);return t.copy=function(){return Vb(t,Hb()).base(t.base())},Um.apply(t,arguments)}function Xb(){var t=yg(Gb());return t.copy=function(){return Vb(t,Xb()).constant(t.constant())},Um.apply(t,arguments)}function Zb(){var t=Mg(Gb());return t.copy=function(){return Vb(t,Zb()).exponent(t.exponent())},Um.apply(t,arguments)}function $b(){return Zb.apply(null,arguments).exponent(.5)}function Qb(t){for(var e=t.length/6|0,n=new Array(e),i=0;i<e;)n[i]="#"+t.slice(6*i,6*++i);return n}Ob({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});const Jb=Qb("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Kb=Qb("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),tx=Qb("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),ex=Qb("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),nx=Qb("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),ix=Qb("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),sx=Qb("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),rx=Qb("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),ox=Qb("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),ax=Qb("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),cx=t=>Ti(t[t.length-1]);var ux=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(Qb);const lx=cx(ux);var hx=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(Qb);const fx=cx(hx);var dx=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(Qb);const px=cx(dx);var _x=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(Qb);const mx=cx(_x);var gx=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(Qb);const vx=cx(gx);var yx=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(Qb);const bx=cx(yx);var xx=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(Qb);const wx=cx(xx);var Tx=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(Qb);const Mx=cx(Tx);var Sx=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(Qb);const Ax=cx(Sx);var kx=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(Qb);const Cx=cx(kx);var Dx=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(Qb);const Ex=cx(Dx);var Ox=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(Qb);const Rx=cx(Ox);var qx=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(Qb);const Nx=cx(qx);var Fx=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(Qb);const Ix=cx(Fx);var Px=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(Qb);const Vx=cx(Px);var zx=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(Qb);const jx=cx(zx);var Lx=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(Qb);const Bx=cx(Lx);var Ux=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(Qb);const Wx=cx(Ux);var Gx=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(Qb);const Yx=cx(Gx);var Hx=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(Qb);const Xx=cx(Hx);var Zx=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(Qb);const $x=cx(Zx);var Qx=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(Qb);const Jx=cx(Qx);var Kx=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(Qb);const tw=cx(Kx);var ew=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(Qb);const nw=cx(ew);var iw=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(Qb);const sw=cx(iw);var rw=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(Qb);const ow=cx(rw);var aw=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(Qb);const cw=cx(aw);function uw(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-t*(35.34-t*(2381.73-t*(6402.7-t*(7024.72-2710.57*t)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+t*(170.73+t*(52.82-t*(131.46-t*(176.58-67.37*t)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+t*(442.36-t*(2482.43-t*(6167.24-t*(6614.94-2475.67*t)))))))+")"}const lw=fm(Bo(300,.5,0),Bo(-240,.5,1));var hw=fm(Bo(-100,.75,.35),Bo(80,1.5,.8)),fw=fm(Bo(260,.75,.35),Bo(80,1.5,.8)),dw=Bo();function pw(t){(t<0||t>1)&&(t-=Math.floor(t));var e=Math.abs(t-.5);return dw.h=360*t-100,dw.s=1.5-1.5*e,dw.l=.8-.9*e,dw+""}var _w=si(),mw=Math.PI/3,gw=2*Math.PI/3;function vw(t){var e;return t=(.5-t)*Math.PI,_w.r=255*(e=Math.sin(t))*e,_w.g=255*(e=Math.sin(t+mw))*e,_w.b=255*(e=Math.sin(t+gw))*e,_w+""}function yw(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+t*(1172.33-t*(10793.56-t*(33300.12-t*(38394.49-14825.05*t)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+t*(557.33+t*(1225.33-t*(3574.96-t*(1073.77+707.56*t)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+t*(3211.1-t*(15327.97-t*(27814-t*(22569.18-6838.66*t)))))))+")"}function bw(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}const xw=bw(Qb("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));var ww=bw(Qb("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),Tw=bw(Qb("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),Mw=bw(Qb("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function Sw(t){return Dn(pn(t).call(document.documentElement))}var Aw=0;function kw(){return new Cw}function Cw(){this._="@"+(++Aw).toString(36)}function Dw(t,e){return t.target&&(t=Ii(t),void 0===e&&(e=t.currentTarget),t=t.touches||[t]),Array.from(t,(t=>Pi(t,e)))}function Ew(t){return"string"==typeof t?new An([document.querySelectorAll(t)],[document.documentElement]):new An([_e(t)],Sn)}function Ow(t){return function(){return t}}Cw.prototype=kw.prototype={constructor:Cw,get:function(t){for(var e=this._;!(e in t);)if(!(t=t.parentNode))return;return t[e]},set:function(t,e){return t[this._]=e},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}};var Rw=Math.abs,qw=Math.atan2,Nw=Math.cos,Fw=Math.max,Iw=Math.min,Pw=Math.sin,Vw=Math.sqrt,zw=1e-12,jw=Math.PI,Lw=jw/2,Bw=2*jw;function Uw(t){return t>1?0:t<-1?jw:Math.acos(t)}function Ww(t){return t>=1?Lw:t<=-1?-Lw:Math.asin(t)}function Gw(t){return t.innerRadius}function Yw(t){return t.outerRadius}function Hw(t){return t.startAngle}function Xw(t){return t.endAngle}function Zw(t){return t&&t.padAngle}function $w(t,e,n,i,s,r,o,a){var c=n-t,u=i-e,l=o-s,h=a-r,f=h*c-l*u;if(!(f*f<zw))return[t+(f=(l*(e-r)-h*(t-s))/f)*c,e+f*u]}function Qw(t,e,n,i,s,r,o){var a=t-n,c=e-i,u=(o?r:-r)/Vw(a*a+c*c),l=u*c,h=-u*a,f=t+l,d=e+h,p=n+l,_=i+h,m=(f+p)/2,g=(d+_)/2,v=p-f,y=_-d,b=v*v+y*y,x=s-r,w=f*_-p*d,T=(y<0?-1:1)*Vw(Fw(0,x*x*b-w*w)),M=(w*y-v*T)/b,S=(-w*v-y*T)/b,A=(w*y+v*T)/b,k=(-w*v+y*T)/b,C=M-m,D=S-g,E=A-m,O=k-g;return C*C+D*D>E*E+O*O&&(M=A,S=k),{cx:M,cy:S,x01:-l,y01:-h,x11:M*(s/x-1),y11:S*(s/x-1)}}function Jw(){var t=Gw,e=Yw,n=Ow(0),i=null,s=Hw,r=Xw,o=Zw,a=null;function c(){var c,u,l=+t.apply(this,arguments),h=+e.apply(this,arguments),f=s.apply(this,arguments)-Lw,d=r.apply(this,arguments)-Lw,p=Rw(d-f),_=d>f;if(a||(a=c=Kr()),h<l&&(u=h,h=l,l=u),h>zw)if(p>Bw-zw)a.moveTo(h*Nw(f),h*Pw(f)),a.arc(0,0,h,f,d,!_),l>zw&&(a.moveTo(l*Nw(d),l*Pw(d)),a.arc(0,0,l,d,f,_));else{var m,g,v=f,y=d,b=f,x=d,w=p,T=p,M=o.apply(this,arguments)/2,S=M>zw&&(i?+i.apply(this,arguments):Vw(l*l+h*h)),A=Iw(Rw(h-l)/2,+n.apply(this,arguments)),k=A,C=A;if(S>zw){var D=Ww(S/l*Pw(M)),E=Ww(S/h*Pw(M));(w-=2*D)>zw?(b+=D*=_?1:-1,x-=D):(w=0,b=x=(f+d)/2),(T-=2*E)>zw?(v+=E*=_?1:-1,y-=E):(T=0,v=y=(f+d)/2)}var O=h*Nw(v),R=h*Pw(v),q=l*Nw(x),N=l*Pw(x);if(A>zw){var F,I=h*Nw(y),P=h*Pw(y),V=l*Nw(b),z=l*Pw(b);if(p<jw&&(F=$w(O,R,V,z,I,P,q,N))){var j=O-F[0],L=R-F[1],B=I-F[0],U=P-F[1],W=1/Pw(Uw((j*B+L*U)/(Vw(j*j+L*L)*Vw(B*B+U*U)))/2),G=Vw(F[0]*F[0]+F[1]*F[1]);k=Iw(A,(l-G)/(W-1)),C=Iw(A,(h-G)/(W+1))}}T>zw?C>zw?(m=Qw(V,z,O,R,h,C,_),g=Qw(I,P,q,N,h,C,_),a.moveTo(m.cx+m.x01,m.cy+m.y01),C<A?a.arc(m.cx,m.cy,C,qw(m.y01,m.x01),qw(g.y01,g.x01),!_):(a.arc(m.cx,m.cy,C,qw(m.y01,m.x01),qw(m.y11,m.x11),!_),a.arc(0,0,h,qw(m.cy+m.y11,m.cx+m.x11),qw(g.cy+g.y11,g.cx+g.x11),!_),a.arc(g.cx,g.cy,C,qw(g.y11,g.x11),qw(g.y01,g.x01),!_))):(a.moveTo(O,R),a.arc(0,0,h,v,y,!_)):a.moveTo(O,R),l>zw&&w>zw?k>zw?(m=Qw(q,N,I,P,l,-k,_),g=Qw(O,R,V,z,l,-k,_),a.lineTo(m.cx+m.x01,m.cy+m.y01),k<A?a.arc(m.cx,m.cy,k,qw(m.y01,m.x01),qw(g.y01,g.x01),!_):(a.arc(m.cx,m.cy,k,qw(m.y01,m.x01),qw(m.y11,m.x11),!_),a.arc(0,0,l,qw(m.cy+m.y11,m.cx+m.x11),qw(g.cy+g.y11,g.cx+g.x11),_),a.arc(g.cx,g.cy,k,qw(g.y11,g.x11),qw(g.y01,g.x01),!_))):a.arc(0,0,l,x,b,_):a.lineTo(q,N)}else a.moveTo(0,0);if(a.closePath(),c)return a=null,c+""||null}return c.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,i=(+s.apply(this,arguments)+ +r.apply(this,arguments))/2-jw/2;return[Nw(i)*n,Pw(i)*n]},c.innerRadius=function(e){return arguments.length?(t="function"==typeof e?e:Ow(+e),c):t},c.outerRadius=function(t){return arguments.length?(e="function"==typeof t?t:Ow(+t),c):e},c.cornerRadius=function(t){return arguments.length?(n="function"==typeof t?t:Ow(+t),c):n},c.padRadius=function(t){return arguments.length?(i=null==t?null:"function"==typeof t?t:Ow(+t),c):i},c.startAngle=function(t){return arguments.length?(s="function"==typeof t?t:Ow(+t),c):s},c.endAngle=function(t){return arguments.length?(r="function"==typeof t?t:Ow(+t),c):r},c.padAngle=function(t){return arguments.length?(o="function"==typeof t?t:Ow(+t),c):o},c.context=function(t){return arguments.length?(a=null==t?null:t,c):a},c}var Kw=Array.prototype.slice;function tT(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function eT(t){this._context=t}function nT(t){return new eT(t)}function iT(t){return t[0]}function sT(t){return t[1]}function rT(t,e){var n=Ow(!0),i=null,s=nT,r=null;function o(o){var a,c,u,l=(o=tT(o)).length,h=!1;for(null==i&&(r=s(u=Kr())),a=0;a<=l;++a)!(a<l&&n(c=o[a],a,o))===h&&((h=!h)?r.lineStart():r.lineEnd()),h&&r.point(+t(c,a,o),+e(c,a,o));if(u)return r=null,u+""||null}return t="function"==typeof t?t:void 0===t?iT:Ow(t),e="function"==typeof e?e:void 0===e?sT:Ow(e),o.x=function(e){return arguments.length?(t="function"==typeof e?e:Ow(+e),o):t},o.y=function(t){return arguments.length?(e="function"==typeof t?t:Ow(+t),o):e},o.defined=function(t){return arguments.length?(n="function"==typeof t?t:Ow(!!t),o):n},o.curve=function(t){return arguments.length?(s=t,null!=i&&(r=s(i)),o):s},o.context=function(t){return arguments.length?(null==t?i=r=null:r=s(i=t),o):i},o}function oT(t,e,n){var i=null,s=Ow(!0),r=null,o=nT,a=null;function c(c){var u,l,h,f,d,p=(c=tT(c)).length,_=!1,m=new Array(p),g=new Array(p);for(null==r&&(a=o(d=Kr())),u=0;u<=p;++u){if(!(u<p&&s(f=c[u],u,c))===_)if(_=!_)l=u,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),h=u-1;h>=l;--h)a.point(m[h],g[h]);a.lineEnd(),a.areaEnd()}_&&(m[u]=+t(f,u,c),g[u]=+e(f,u,c),a.point(i?+i(f,u,c):m[u],n?+n(f,u,c):g[u]))}if(d)return a=null,d+""||null}function u(){return rT().defined(s).curve(o).context(r)}return t="function"==typeof t?t:void 0===t?iT:Ow(+t),e="function"==typeof e?e:Ow(void 0===e?0:+e),n="function"==typeof n?n:void 0===n?sT:Ow(+n),c.x=function(e){return arguments.length?(t="function"==typeof e?e:Ow(+e),i=null,c):t},c.x0=function(e){return arguments.length?(t="function"==typeof e?e:Ow(+e),c):t},c.x1=function(t){return arguments.length?(i=null==t?null:"function"==typeof t?t:Ow(+t),c):i},c.y=function(t){return arguments.length?(e="function"==typeof t?t:Ow(+t),n=null,c):e},c.y0=function(t){return arguments.length?(e="function"==typeof t?t:Ow(+t),c):e},c.y1=function(t){return arguments.length?(n=null==t?null:"function"==typeof t?t:Ow(+t),c):n},c.lineX0=c.lineY0=function(){return u().x(t).y(e)},c.lineY1=function(){return u().x(t).y(n)},c.lineX1=function(){return u().x(i).y(e)},c.defined=function(t){return arguments.length?(s="function"==typeof t?t:Ow(!!t),c):s},c.curve=function(t){return arguments.length?(o=t,null!=r&&(a=o(r)),c):o},c.context=function(t){return arguments.length?(null==t?r=a=null:a=o(r=t),c):r},c}function aT(t,e){return e<t?-1:e>t?1:e>=t?0:NaN}function cT(t){return t}function uT(){var t=cT,e=aT,n=null,i=Ow(0),s=Ow(Bw),r=Ow(0);function o(o){var a,c,u,l,h,f=(o=tT(o)).length,d=0,p=new Array(f),_=new Array(f),m=+i.apply(this,arguments),g=Math.min(Bw,Math.max(-Bw,s.apply(this,arguments)-m)),v=Math.min(Math.abs(g)/f,r.apply(this,arguments)),y=v*(g<0?-1:1);for(a=0;a<f;++a)(h=_[p[a]=a]=+t(o[a],a,o))>0&&(d+=h);for(null!=e?p.sort((function(t,n){return e(_[t],_[n])})):null!=n&&p.sort((function(t,e){return n(o[t],o[e])})),a=0,u=d?(g-f*y)/d:0;a<f;++a,m=l)c=p[a],l=m+((h=_[c])>0?h*u:0)+y,_[c]={data:o[c],index:a,value:h,startAngle:m,endAngle:l,padAngle:v};return _}return o.value=function(e){return arguments.length?(t="function"==typeof e?e:Ow(+e),o):t},o.sortValues=function(t){return arguments.length?(e=t,n=null,o):e},o.sort=function(t){return arguments.length?(n=t,e=null,o):n},o.startAngle=function(t){return arguments.length?(i="function"==typeof t?t:Ow(+t),o):i},o.endAngle=function(t){return arguments.length?(s="function"==typeof t?t:Ow(+t),o):s},o.padAngle=function(t){return arguments.length?(r="function"==typeof t?t:Ow(+t),o):r},o}eT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var lT=fT(nT);function hT(t){this._curve=t}function fT(t){function e(e){return new hT(t(e))}return e._curve=t,e}function dT(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(t){return arguments.length?e(fT(t)):e()._curve},t}function pT(){return dT(rT().curve(lT))}function _T(){var t=oT().curve(lT),e=t.curve,n=t.lineX0,i=t.lineX1,s=t.lineY0,r=t.lineY1;return t.angle=t.x,delete t.x,t.startAngle=t.x0,delete t.x0,t.endAngle=t.x1,delete t.x1,t.radius=t.y,delete t.y,t.innerRadius=t.y0,delete t.y0,t.outerRadius=t.y1,delete t.y1,t.lineStartAngle=function(){return dT(n())},delete t.lineX0,t.lineEndAngle=function(){return dT(i())},delete t.lineX1,t.lineInnerRadius=function(){return dT(s())},delete t.lineY0,t.lineOuterRadius=function(){return dT(r())},delete t.lineY1,t.curve=function(t){return arguments.length?e(fT(t)):e()._curve},t}function mT(t,e){return[(e=+e)*Math.cos(t-=Math.PI/2),e*Math.sin(t)]}function gT(t){return t.source}function vT(t){return t.target}function yT(t){var e=gT,n=vT,i=iT,s=sT,r=null;function o(){var o,a=Kw.call(arguments),c=e.apply(this,a),u=n.apply(this,a);if(r||(r=o=Kr()),t(r,+i.apply(this,(a[0]=c,a)),+s.apply(this,a),+i.apply(this,(a[0]=u,a)),+s.apply(this,a)),o)return r=null,o+""||null}return o.source=function(t){return arguments.length?(e=t,o):e},o.target=function(t){return arguments.length?(n=t,o):n},o.x=function(t){return arguments.length?(i="function"==typeof t?t:Ow(+t),o):i},o.y=function(t){return arguments.length?(s="function"==typeof t?t:Ow(+t),o):s},o.context=function(t){return arguments.length?(r=null==t?null:t,o):r},o}function bT(t,e,n,i,s){t.moveTo(e,n),t.bezierCurveTo(e=(e+i)/2,n,e,s,i,s)}function xT(t,e,n,i,s){t.moveTo(e,n),t.bezierCurveTo(e,n=(n+s)/2,i,n,i,s)}function wT(t,e,n,i,s){var r=mT(e,n),o=mT(e,n=(n+s)/2),a=mT(i,n),c=mT(i,s);t.moveTo(r[0],r[1]),t.bezierCurveTo(o[0],o[1],a[0],a[1],c[0],c[1])}function TT(){return yT(bT)}function MT(){return yT(xT)}function ST(){var t=yT(wT);return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t}hT.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};const AT={draw:function(t,e){var n=Math.sqrt(e/jw);t.moveTo(n,0),t.arc(0,0,n,0,Bw)}},kT={draw:function(t,e){var n=Math.sqrt(e/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}};var CT=Math.sqrt(1/3),DT=2*CT;const ET={draw:function(t,e){var n=Math.sqrt(e/DT),i=n*CT;t.moveTo(0,-n),t.lineTo(i,0),t.lineTo(0,n),t.lineTo(-i,0),t.closePath()}};var OT=Math.sin(jw/10)/Math.sin(7*jw/10),RT=Math.sin(Bw/10)*OT,qT=-Math.cos(Bw/10)*OT;const NT={draw:function(t,e){var n=Math.sqrt(.8908130915292852*e),i=RT*n,s=qT*n;t.moveTo(0,-n),t.lineTo(i,s);for(var r=1;r<5;++r){var o=Bw*r/5,a=Math.cos(o),c=Math.sin(o);t.lineTo(c*n,-a*n),t.lineTo(a*i-c*s,c*i+a*s)}t.closePath()}},FT={draw:function(t,e){var n=Math.sqrt(e),i=-n/2;t.rect(i,i,n,n)}};var IT=Math.sqrt(3);const PT={draw:function(t,e){var n=-Math.sqrt(e/(3*IT));t.moveTo(0,2*n),t.lineTo(-IT*n,-n),t.lineTo(IT*n,-n),t.closePath()}};var VT=-.5,zT=Math.sqrt(3)/2,jT=1/Math.sqrt(12),LT=3*(jT/2+1);const BT={draw:function(t,e){var n=Math.sqrt(e/LT),i=n/2,s=n*jT,r=i,o=n*jT+n,a=-r,c=o;t.moveTo(i,s),t.lineTo(r,o),t.lineTo(a,c),t.lineTo(VT*i-zT*s,zT*i+VT*s),t.lineTo(VT*r-zT*o,zT*r+VT*o),t.lineTo(VT*a-zT*c,zT*a+VT*c),t.lineTo(VT*i+zT*s,VT*s-zT*i),t.lineTo(VT*r+zT*o,VT*o-zT*r),t.lineTo(VT*a+zT*c,VT*c-zT*a),t.closePath()}};var UT=[AT,kT,ET,FT,NT,PT,BT];function WT(t,e){var n=null;function i(){var i;if(n||(n=i=Kr()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),i)return n=null,i+""||null}return t="function"==typeof t?t:Ow(t||AT),e="function"==typeof e?e:Ow(void 0===e?64:+e),i.type=function(e){return arguments.length?(t="function"==typeof e?e:Ow(e),i):t},i.size=function(t){return arguments.length?(e="function"==typeof t?t:Ow(+t),i):e},i.context=function(t){return arguments.length?(n=null==t?null:t,i):n},i}function GT(){}function YT(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function HT(t){this._context=t}function XT(t){return new HT(t)}function ZT(t){this._context=t}function $T(t){return new ZT(t)}function QT(t){this._context=t}function JT(t){return new QT(t)}HT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:YT(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:YT(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},ZT.prototype={areaStart:GT,areaEnd:GT,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:YT(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},QT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,i=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:YT(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};class KT{constructor(t,e){this._context=t,this._x=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line}point(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,e,t,e):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+e)/2,t,this._y0,t,e)}this._x0=t,this._y0=e}}function tM(t){return new KT(t,!0)}function eM(t){return new KT(t,!1)}function nM(t,e){this._basis=new HT(t),this._beta=e}nM.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var i,s=t[0],r=e[0],o=t[n]-s,a=e[n]-r,c=-1;++c<=n;)i=c/n,this._basis.point(this._beta*t[c]+(1-this._beta)*(s+i*o),this._beta*e[c]+(1-this._beta)*(r+i*a));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};const iM=function t(e){function n(t){return 1===e?new HT(t):new nM(t,e)}return n.beta=function(e){return t(+e)},n}(.85);function sM(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function rM(t,e){this._context=t,this._k=(1-e)/6}rM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:sM(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:sM(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const oM=function t(e){function n(t){return new rM(t,e)}return n.tension=function(e){return t(+e)},n}(0);function aM(t,e){this._context=t,this._k=(1-e)/6}aM.prototype={areaStart:GT,areaEnd:GT,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:sM(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const cM=function t(e){function n(t){return new aM(t,e)}return n.tension=function(e){return t(+e)},n}(0);function uM(t,e){this._context=t,this._k=(1-e)/6}uM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:sM(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const lM=function t(e){function n(t){return new uM(t,e)}return n.tension=function(e){return t(+e)},n}(0);function hM(t,e,n){var i=t._x1,s=t._y1,r=t._x2,o=t._y2;if(t._l01_a>zw){var a=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,c=3*t._l01_a*(t._l01_a+t._l12_a);i=(i*a-t._x0*t._l12_2a+t._x2*t._l01_2a)/c,s=(s*a-t._y0*t._l12_2a+t._y2*t._l01_2a)/c}if(t._l23_a>zw){var u=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,l=3*t._l23_a*(t._l23_a+t._l12_a);r=(r*u+t._x1*t._l23_2a-e*t._l12_2a)/l,o=(o*u+t._y1*t._l23_2a-n*t._l12_2a)/l}t._context.bezierCurveTo(i,s,r,o,t._x2,t._y2)}function fM(t,e){this._context=t,this._alpha=e}fM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:hM(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const dM=function t(e){function n(t){return e?new fM(t,e):new rM(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function pM(t,e){this._context=t,this._alpha=e}pM.prototype={areaStart:GT,areaEnd:GT,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:hM(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const _M=function t(e){function n(t){return e?new pM(t,e):new aM(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function mM(t,e){this._context=t,this._alpha=e}mM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:hM(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const gM=function t(e){function n(t){return e?new mM(t,e):new uM(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function vM(t){this._context=t}function yM(t){return new vM(t)}function bM(t){return t<0?-1:1}function xM(t,e,n){var i=t._x1-t._x0,s=e-t._x1,r=(t._y1-t._y0)/(i||s<0&&-0),o=(n-t._y1)/(s||i<0&&-0),a=(r*s+o*i)/(i+s);return(bM(r)+bM(o))*Math.min(Math.abs(r),Math.abs(o),.5*Math.abs(a))||0}function wM(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function TM(t,e,n){var i=t._x0,s=t._y0,r=t._x1,o=t._y1,a=(r-i)/3;t._context.bezierCurveTo(i+a,s+a*e,r-a,o-a*n,r,o)}function MM(t){this._context=t}function SM(t){this._context=new AM(t)}function AM(t){this._context=t}function kM(t){return new MM(t)}function CM(t){return new SM(t)}function DM(t){this._context=t}function EM(t){var e,n,i=t.length-1,s=new Array(i),r=new Array(i),o=new Array(i);for(s[0]=0,r[0]=2,o[0]=t[0]+2*t[1],e=1;e<i-1;++e)s[e]=1,r[e]=4,o[e]=4*t[e]+2*t[e+1];for(s[i-1]=2,r[i-1]=7,o[i-1]=8*t[i-1]+t[i],e=1;e<i;++e)n=s[e]/r[e-1],r[e]-=n,o[e]-=n*o[e-1];for(s[i-1]=o[i-1]/r[i-1],e=i-2;e>=0;--e)s[e]=(o[e]-s[e+1])/r[e];for(r[i-1]=(t[i]+s[i-1])/2,e=0;e<i-1;++e)r[e]=2*t[e+1]-s[e+1];return[s,r]}function OM(t){return new DM(t)}function RM(t,e){this._context=t,this._t=e}function qM(t){return new RM(t,.5)}function NM(t){return new RM(t,0)}function FM(t){return new RM(t,1)}function IM(t,e){if((s=t.length)>1)for(var n,i,s,r=1,o=t[e[0]],a=o.length;r<s;++r)for(i=o,o=t[e[r]],n=0;n<a;++n)o[n][1]+=o[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}function PM(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n}function VM(t,e){return t[e]}function zM(t){const e=[];return e.key=t,e}function jM(){var t=Ow([]),e=PM,n=IM,i=VM;function s(s){var r,o,a=Array.from(t.apply(this,arguments),zM),c=a.length,u=-1;for(const t of s)for(r=0,++u;r<c;++r)(a[r][u]=[0,+i(t,a[r].key,u,s)]).data=t;for(r=0,o=tT(e(a));r<c;++r)a[o[r]].index=r;return n(a,o),a}return s.keys=function(e){return arguments.length?(t="function"==typeof e?e:Ow(Array.from(e)),s):t},s.value=function(t){return arguments.length?(i="function"==typeof t?t:Ow(+t),s):i},s.order=function(t){return arguments.length?(e=null==t?PM:"function"==typeof t?t:Ow(Array.from(t)),s):e},s.offset=function(t){return arguments.length?(n=null==t?IM:t,s):n},s}function LM(t,e){if((i=t.length)>0){for(var n,i,s,r=0,o=t[0].length;r<o;++r){for(s=n=0;n<i;++n)s+=t[n][r][1]||0;if(s)for(n=0;n<i;++n)t[n][r][1]/=s}IM(t,e)}}function BM(t,e){if((a=t.length)>0)for(var n,i,s,r,o,a,c=0,u=t[e[0]].length;c<u;++c)for(r=o=0,n=0;n<a;++n)(s=(i=t[e[n]][c])[1]-i[0])>0?(i[0]=r,i[1]=r+=s):s<0?(i[1]=o,i[0]=o+=s):(i[0]=0,i[1]=s)}function UM(t,e){if((n=t.length)>0){for(var n,i=0,s=t[e[0]],r=s.length;i<r;++i){for(var o=0,a=0;o<n;++o)a+=t[o][i][1]||0;s[i][1]+=s[i][0]=-a/2}IM(t,e)}}function WM(t,e){if((s=t.length)>0&&(i=(n=t[e[0]]).length)>0){for(var n,i,s,r=0,o=1;o<i;++o){for(var a=0,c=0,u=0;a<s;++a){for(var l=t[e[a]],h=l[o][1]||0,f=(h-(l[o-1][1]||0))/2,d=0;d<a;++d){var p=t[e[d]];f+=(p[o][1]||0)-(p[o-1][1]||0)}c+=h,u+=f*h}n[o-1][1]+=n[o-1][0]=r,c&&(r-=u/c)}n[o-1][1]+=n[o-1][0]=r,IM(t,e)}}function GM(t){var e=t.map(YM);return PM(t).sort((function(t,n){return e[t]-e[n]}))}function YM(t){for(var e,n=-1,i=0,s=t.length,r=-1/0;++n<s;)(e=+t[n][1])>r&&(r=e,i=n);return i}function HM(t){var e=t.map(XM);return PM(t).sort((function(t,n){return e[t]-e[n]}))}function XM(t){for(var e,n=0,i=-1,s=t.length;++i<s;)(e=+t[i][1])&&(n+=e);return n}function ZM(t){return HM(t).reverse()}function $M(t){var e,n,i=t.length,s=t.map(XM),r=GM(t),o=0,a=0,c=[],u=[];for(e=0;e<i;++e)n=r[e],o<a?(o+=s[n],c.push(n)):(a+=s[n],u.push(n));return u.reverse().concat(c)}function QM(t){return PM(t).reverse()}vM.prototype={areaStart:GT,areaEnd:GT,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}},MM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:TM(this,this._t0,wM(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,TM(this,wM(this,n=xM(this,t,e)),n);break;default:TM(this,this._t0,n=xM(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(SM.prototype=Object.create(MM.prototype)).point=function(t,e){MM.prototype.point.call(this,e,t)},AM.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,i,s,r){this._context.bezierCurveTo(e,t,i,n,r,s)}},DM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var i=EM(t),s=EM(e),r=0,o=1;o<n;++r,++o)this._context.bezierCurveTo(i[0][r],s[0][r],i[1][r],s[1][r],t[o],e[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}},RM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};var JM="%Y-%m-%dT%H:%M:%S.%LZ",KM=Date.prototype.toISOString?function(t){return t.toISOString()}:fy(JM);const tS=KM;var eS=+new Date("2000-01-01T00:00:00.000Z")?function(t){var e=new Date(t);return isNaN(e)?null:e}:dy(JM);const nS=eS;function iS(t,e,n){var i=new $i,s=e;return null==e?(i.restart(t,e,n),i):(i._restart=i.restart,i.restart=function(t,e,n){e=+e,n=null==n?Xi():+n,i._restart((function r(o){o+=s,i._restart(r,s+=e,n),t(o)}),e,n)},i.restart(t,e,n),i)}const sS=t=>()=>t;function rS(t,{sourceEvent:e,target:n,transform:i,dispatch:s}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:s}})}function oS(t,e,n){this.k=t,this.x=e,this.y=n}oS.prototype={constructor:oS,scale:function(t){return 1===t?this:new oS(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new oS(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var aS=new oS(1,0,0);function cS(t){for(;!t.__zoom;)if(!(t=t.parentNode))return aS;return t.__zoom}function uS(t){t.stopImmediatePropagation()}function lS(t){t.preventDefault(),t.stopImmediatePropagation()}function hS(t){return!(t.ctrlKey&&"wheel"!==t.type||t.button)}function fS(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function dS(){return this.__zoom||aS}function pS(t){return-t.deltaY*(1===t.deltaMode?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function _S(){return navigator.maxTouchPoints||"ontouchstart"in this}function mS(t,e,n){var i=t.invertX(e[0][0])-n[0][0],s=t.invertX(e[1][0])-n[1][0],r=t.invertY(e[0][1])-n[0][1],o=t.invertY(e[1][1])-n[1][1];return t.translate(s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s),o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o))}function gS(){var t,e,n,i=hS,s=fS,r=mS,o=pS,a=_S,c=[0,1/0],u=[[-1/0,-1/0],[1/0,1/0]],l=250,h=nm,f=fe("start","zoom","end"),d=500,p=0,_=10;function m(t){t.property("__zoom",dS).on("wheel.zoom",T,{passive:!1}).on("mousedown.zoom",M).on("dblclick.zoom",S).filter(a).on("touchstart.zoom",A).on("touchmove.zoom",k).on("touchend.zoom touchcancel.zoom",C).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(t,e){return(e=Math.max(c[0],Math.min(c[1],e)))===t.k?t:new oS(e,t.x,t.y)}function v(t,e,n){var i=e[0]-n[0]*t.k,s=e[1]-n[1]*t.k;return i===t.x&&s===t.y?t:new oS(t.k,i,s)}function y(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function b(t,e,n,i){t.on("start.zoom",(function(){x(this,arguments).event(i).start()})).on("interrupt.zoom end.zoom",(function(){x(this,arguments).event(i).end()})).tween("zoom",(function(){var t=this,r=arguments,o=x(t,r).event(i),a=s.apply(t,r),c=null==n?y(a):"function"==typeof n?n.apply(t,r):n,u=Math.max(a[1][0]-a[0][0],a[1][1]-a[0][1]),l=t.__zoom,f="function"==typeof e?e.apply(t,r):e,d=h(l.invert(c).concat(u/l.k),f.invert(c).concat(u/f.k));return function(t){if(1===t)t=f;else{var e=d(t),n=u/e[2];t=new oS(n,c[0]-e[0]*n,c[1]-e[1]*n)}o.zoom(null,t)}}))}function x(t,e,n){return!n&&t.__zooming||new w(t,e)}function w(t,e){this.that=t,this.args=e,this.active=0,this.sourceEvent=null,this.extent=s.apply(t,e),this.taps=0}function T(t,...e){if(i.apply(this,arguments)){var n=x(this,e).event(t),s=this.__zoom,a=Math.max(c[0],Math.min(c[1],s.k*Math.pow(2,o.apply(this,arguments)))),l=Pi(t);if(n.wheel)n.mouse[0][0]===l[0]&&n.mouse[0][1]===l[1]||(n.mouse[1]=s.invert(n.mouse[0]=l)),clearTimeout(n.wheel);else{if(s.k===a)return;n.mouse=[l,s.invert(l)],us(this),n.start()}lS(t),n.wheel=setTimeout(h,150),n.zoom("mouse",r(v(g(s,a),n.mouse[0],n.mouse[1]),n.extent,u))}function h(){n.wheel=null,n.end()}}function M(t,...e){if(!n&&i.apply(this,arguments)){var s=t.currentTarget,o=x(this,e,!0).event(t),a=Dn(t.view).on("mousemove.zoom",f,!0).on("mouseup.zoom",d,!0),c=Pi(t,s),l=t.clientX,h=t.clientY;Nn(t.view),uS(t),o.mouse=[c,this.__zoom.invert(c)],us(this),o.start()}function f(t){if(lS(t),!o.moved){var e=t.clientX-l,n=t.clientY-h;o.moved=e*e+n*n>p}o.event(t).zoom("mouse",r(v(o.that.__zoom,o.mouse[0]=Pi(t,s),o.mouse[1]),o.extent,u))}function d(t){a.on("mousemove.zoom mouseup.zoom",null),Fn(t.view,o.moved),lS(t),o.event(t).end()}}function S(t,...e){if(i.apply(this,arguments)){var n=this.__zoom,o=Pi(t.changedTouches?t.changedTouches[0]:t,this),a=n.invert(o),c=n.k*(t.shiftKey?.5:2),h=r(v(g(n,c),o,a),s.apply(this,e),u);lS(t),l>0?Dn(this).transition().duration(l).call(b,h,o,t):Dn(this).call(m.transform,h,o,t)}}function A(n,...s){if(i.apply(this,arguments)){var r,o,a,c,u=n.touches,l=u.length,h=x(this,s,n.changedTouches.length===l).event(n);for(uS(n),o=0;o<l;++o)c=[c=Pi(a=u[o],this),this.__zoom.invert(c),a.identifier],h.touch0?h.touch1||h.touch0[2]===c[2]||(h.touch1=c,h.taps=0):(h.touch0=c,r=!0,h.taps=1+!!t);t&&(t=clearTimeout(t)),r&&(h.taps<2&&(e=c[0],t=setTimeout((function(){t=null}),d)),us(this),h.start())}}function k(t,...e){if(this.__zooming){var n,i,s,o,a=x(this,e).event(t),c=t.changedTouches,l=c.length;for(lS(t),n=0;n<l;++n)s=Pi(i=c[n],this),a.touch0&&a.touch0[2]===i.identifier?a.touch0[0]=s:a.touch1&&a.touch1[2]===i.identifier&&(a.touch1[0]=s);if(i=a.that.__zoom,a.touch1){var h=a.touch0[0],f=a.touch0[1],d=a.touch1[0],p=a.touch1[1],_=(_=d[0]-h[0])*_+(_=d[1]-h[1])*_,m=(m=p[0]-f[0])*m+(m=p[1]-f[1])*m;i=g(i,Math.sqrt(_/m)),s=[(h[0]+d[0])/2,(h[1]+d[1])/2],o=[(f[0]+p[0])/2,(f[1]+p[1])/2]}else{if(!a.touch0)return;s=a.touch0[0],o=a.touch0[1]}a.zoom("touch",r(v(i,s,o),a.extent,u))}}function C(t,...i){if(this.__zooming){var s,r,o=x(this,i).event(t),a=t.changedTouches,c=a.length;for(uS(t),n&&clearTimeout(n),n=setTimeout((function(){n=null}),d),s=0;s<c;++s)r=a[s],o.touch0&&o.touch0[2]===r.identifier?delete o.touch0:o.touch1&&o.touch1[2]===r.identifier&&delete o.touch1;if(o.touch1&&!o.touch0&&(o.touch0=o.touch1,delete o.touch1),o.touch0)o.touch0[1]=this.__zoom.invert(o.touch0[0]);else if(o.end(),2===o.taps&&(r=Pi(r,this),Math.hypot(e[0]-r[0],e[1]-r[1])<_)){var u=Dn(this).on("dblclick.zoom");u&&u.apply(this,arguments)}}}return m.transform=function(t,e,n,i){var s=t.selection?t.selection():t;s.property("__zoom",dS),t!==s?b(t,e,n,i):s.interrupt().each((function(){x(this,arguments).event(i).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()}))},m.scaleBy=function(t,e,n,i){m.scaleTo(t,(function(){var t=this.__zoom.k,n="function"==typeof e?e.apply(this,arguments):e;return t*n}),n,i)},m.scaleTo=function(t,e,n,i){m.transform(t,(function(){var t=s.apply(this,arguments),i=this.__zoom,o=null==n?y(t):"function"==typeof n?n.apply(this,arguments):n,a=i.invert(o),c="function"==typeof e?e.apply(this,arguments):e;return r(v(g(i,c),o,a),t,u)}),n,i)},m.translateBy=function(t,e,n,i){m.transform(t,(function(){return r(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof n?n.apply(this,arguments):n),s.apply(this,arguments),u)}),null,i)},m.translateTo=function(t,e,n,i,o){m.transform(t,(function(){var t=s.apply(this,arguments),o=this.__zoom,a=null==i?y(t):"function"==typeof i?i.apply(this,arguments):i;return r(aS.translate(a[0],a[1]).scale(o.k).translate("function"==typeof e?-e.apply(this,arguments):-e,"function"==typeof n?-n.apply(this,arguments):-n),t,u)}),i,o)},w.prototype={event:function(t){return t&&(this.sourceEvent=t),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){var e=Dn(this.that).datum();f.call(t,this.that,new rS(t,{sourceEvent:this.sourceEvent,target:m,type:t,transform:this.that.__zoom,dispatch:f}),e)}},m.wheelDelta=function(t){return arguments.length?(o="function"==typeof t?t:sS(+t),m):o},m.filter=function(t){return arguments.length?(i="function"==typeof t?t:sS(!!t),m):i},m.touchable=function(t){return arguments.length?(a="function"==typeof t?t:sS(!!t),m):a},m.extent=function(t){return arguments.length?(s="function"==typeof t?t:sS([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),m):s},m.scaleExtent=function(t){return arguments.length?(c[0]=+t[0],c[1]=+t[1],m):[c[0],c[1]]},m.translateExtent=function(t){return arguments.length?(u[0][0]=+t[0][0],u[1][0]=+t[1][0],u[0][1]=+t[0][1],u[1][1]=+t[1][1],m):[[u[0][0],u[0][1]],[u[1][0],u[1][1]]]},m.constrain=function(t){return arguments.length?(r=t,m):r},m.duration=function(t){return arguments.length?(l=+t,m):l},m.interpolate=function(t){return arguments.length?(h=t,m):h},m.on=function(){var t=f.on.apply(f,arguments);return t===f?m:t},m.clickDistance=function(t){return arguments.length?(p=(t=+t)*t,m):Math.sqrt(p)},m.tapDistance=function(t){return arguments.length?(_=+t,m):_},m}cS.prototype=oS.prototype}},e={};function n(i){var s=e[i];if(void 0!==s)return s.exports;var r=e[i]={exports:{}};return t[i].call(r.exports,r,r.exports,n),r.exports}n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{"use strict";var t=n(785);const e=n(543),i=n(504),s=n(663),r=n(634),o=n(440),a=n(290),c=n(503),u=n(92),l=n(214),h=new o,f=new a,d=new c,p=(new t.Synth).toDestination(),_=new t.Loop((t=>{C=15==C?0:C+=1,e.selectAll(".drum-step .transport").style("background-color","#999"),e.select("#drum-transport-"+C%16).style("background-color","yellow"),1==O[C][0]&&h.hit(t),1==O[C][1]&&f.hit(t),1==O[C][2]&&d.hit(t),C%E==0&&(D=D==T.length-1?0:D+=1,v=T[D],"REST"!=v&&p.triggerAttackRelease(v,"16n",t),e.selectAll("svg .transport .step").attr("fill","#999"),e.select(`svg .transport .step-${D}`).attr("fill","yellow"))}),"16n"),m={"4N":4,"8N":2,"16N":1},g={Kick:0,Snare:1,Hat:2};let v,y,b,x,w,T,M,S,A,k=!1,C=-1,D=-1,E=2,O=[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]];const R=()=>{"started"!==t.Transport.state?(t.Transport.bpm.value=document.getElementById("bpm").value,_.start(0),t.Transport.start()):(t.Transport.stop(),_.stop(),C=-1,D=-1)},q=t=>{p.triggerAttackRelease(l[t].note_full,"16n")},N=t=>{t.target.classList.toggle("active")},F=(t,e,n)=>{t.target.classList.toggle("active"),O[e][g[n]]=t.target.classList.contains("active")?1:0},I=t=>{let e=document.getElementById("apply-rhythm").checked;document.getElementById("rhythm").classList.toggle("active"),document.querySelectorAll("#rhythm button").forEach((t=>t.disabled=!e)),document.querySelectorAll("#rhythm input[type=number]").forEach((t=>t.disabled=!e))},P=e=>{document.getElementById("bpm-value").textContent=e.target.value,t.Transport.bpm.rampTo(e.target.value,2)},V=t=>{E=m[t.target.value]},z=t=>{document.querySelectorAll("#rhythm button").forEach(((e,n)=>{n>=t.target.value?e.disabled=!0:e.disabled=!1}))};document.addEventListener("DOMContentLoaded",(()=>{e.select("#tonic").selectAll(".tonic-note").data(l).enter().append("option").attr("class",".tonic-note").attr("id",(t=>`note-${t.note_full}`)).attr("value",(t=>t.note_full)).text((t=>t.note_full)),e.select("#note-C3").property("selected","selected"),b=new s("#drum-machine"),b.render(F),document.querySelector("button#generate").addEventListener("click",(()=>{k||(t.start(),k=!0),(()=>{A=document.getElementById("tonic").value,M=parseInt(document.getElementById("seed-distance").value),S=parseInt(document.getElementById("series-length").value),x=u(S,M,0);let t=l.findIndex((t=>t.note_full==A));if(w=x.map((e=>e+t)),document.getElementById("apply-rhythm").checked){let t=Array.from(document.querySelectorAll("#rhythm button:enabled")).map((t=>t.classList.contains("active")?1:0));w=new r(w).rhythm(t,"wrap")}T=w.map((t=>null==t?"REST":l[t].note_full))})(),y=new i("#infinity-series .piano-roll",A,w.length,e.extent(x)),document.querySelector("#infinity-series .sequence").textContent=x.join(" "),y.render(),y.setNotes(w,q),e.select("#play-pause").property("disabled",!1),e.select("#bpm").property("disabled",!1),e.select("#step-rate").property("disabled",!1),document.getElementById("current-sequence").style.visibility="visible"})),document.querySelector("button#play-pause").addEventListener("click",R),document.querySelectorAll("#rhythm button").forEach((t=>t.addEventListener("click",N))),document.getElementById("bpm").addEventListener("input",P),document.getElementById("step-rate").addEventListener("input",V),document.getElementById("rhythm-step-count").addEventListener("change",z),document.getElementById("apply-rhythm").addEventListener("change",I)}))})()})();